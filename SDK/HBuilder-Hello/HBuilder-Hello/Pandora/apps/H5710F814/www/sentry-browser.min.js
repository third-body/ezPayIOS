(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],2:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const DEBUG_BUILD=typeof __SENTRY_DEBUG__==="undefined"||__SENTRY_DEBUG__;exports.DEBUG_BUILD=DEBUG_BUILD},{}],3:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const debugBuild=require("./debug-build.js");const types=require("./types.js");const cachedImplementations={};function getNativeImplementation(name){const cached=cachedImplementations[name];if(cached){return cached}let impl=types.WINDOW[name];if(core.isNativeFunction(impl)){return cachedImplementations[name]=impl.bind(types.WINDOW)}const document=types.WINDOW.document;if(document&&typeof document.createElement==="function"){try{const sandbox=document.createElement("iframe");sandbox.hidden=true;document.head.appendChild(sandbox);const contentWindow=sandbox.contentWindow;if(contentWindow&&contentWindow[name]){impl=contentWindow[name]}document.head.removeChild(sandbox)}catch(e){debugBuild.DEBUG_BUILD&&core.logger.warn(`Could not create sandbox iframe for ${name} check, bailing to window.${name}: `,e)}}if(!impl){return impl}return cachedImplementations[name]=impl.bind(types.WINDOW)}function clearCachedImplementation(name){cachedImplementations[name]=undefined}function fetch(...rest){return getNativeImplementation("fetch")(...rest)}function setTimeout(...rest){return getNativeImplementation("setTimeout")(...rest)}exports.clearCachedImplementation=clearCachedImplementation;exports.fetch=fetch;exports.getNativeImplementation=getNativeImplementation;exports.setTimeout=setTimeout},{"./debug-build.js":2,"./types.js":32,"@sentry/core":87}],4:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const instrument=require("./metrics/instrument.js");const browserMetrics=require("./metrics/browserMetrics.js");const dom=require("./instrument/dom.js");const history=require("./instrument/history.js");const getNativeImplementation=require("./getNativeImplementation.js");const xhr=require("./instrument/xhr.js");const inp=require("./metrics/inp.js");exports.addClsInstrumentationHandler=instrument.addClsInstrumentationHandler;exports.addFidInstrumentationHandler=instrument.addFidInstrumentationHandler;exports.addInpInstrumentationHandler=instrument.addInpInstrumentationHandler;exports.addLcpInstrumentationHandler=instrument.addLcpInstrumentationHandler;exports.addPerformanceInstrumentationHandler=instrument.addPerformanceInstrumentationHandler;exports.addTtfbInstrumentationHandler=instrument.addTtfbInstrumentationHandler;exports.addPerformanceEntries=browserMetrics.addPerformanceEntries;exports.startTrackingInteractions=browserMetrics.startTrackingInteractions;exports.startTrackingLongAnimationFrames=browserMetrics.startTrackingLongAnimationFrames;exports.startTrackingLongTasks=browserMetrics.startTrackingLongTasks;exports.startTrackingWebVitals=browserMetrics.startTrackingWebVitals;exports.addClickKeypressInstrumentationHandler=dom.addClickKeypressInstrumentationHandler;exports.addHistoryInstrumentationHandler=history.addHistoryInstrumentationHandler;exports.clearCachedImplementation=getNativeImplementation.clearCachedImplementation;exports.fetch=getNativeImplementation.fetch;exports.getNativeImplementation=getNativeImplementation.getNativeImplementation;exports.setTimeout=getNativeImplementation.setTimeout;exports.SENTRY_XHR_DATA_KEY=xhr.SENTRY_XHR_DATA_KEY;exports.addXhrInstrumentationHandler=xhr.addXhrInstrumentationHandler;exports.registerInpInteractionListener=inp.registerInpInteractionListener;exports.startTrackingINP=inp.startTrackingINP},{"./getNativeImplementation.js":3,"./instrument/dom.js":5,"./instrument/history.js":6,"./instrument/xhr.js":7,"./metrics/browserMetrics.js":8,"./metrics/inp.js":10,"./metrics/instrument.js":11}],5:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const types=require("../types.js");const DEBOUNCE_DURATION=1e3;let debounceTimerID;let lastCapturedEventType;let lastCapturedEventTargetId;function addClickKeypressInstrumentationHandler(handler){const type="dom";core.addHandler(type,handler);core.maybeInstrument(type,instrumentDOM)}function instrumentDOM(){if(!types.WINDOW.document){return}const triggerDOMHandler=core.triggerHandlers.bind(null,"dom");const globalDOMEventHandler=makeDOMEventHandler(triggerDOMHandler,true);types.WINDOW.document.addEventListener("click",globalDOMEventHandler,false);types.WINDOW.document.addEventListener("keypress",globalDOMEventHandler,false);["EventTarget","Node"].forEach(target=>{const globalObject=types.WINDOW;const targetObj=globalObject[target];const proto=targetObj&&targetObj.prototype;if(!proto||!proto.hasOwnProperty||!proto.hasOwnProperty("addEventListener")){return}core.fill(proto,"addEventListener",function(originalAddEventListener){return function(type,listener,options){if(type==="click"||type=="keypress"){try{const handlers=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{};const handlerForType=handlers[type]=handlers[type]||{refCount:0};if(!handlerForType.handler){const handler=makeDOMEventHandler(triggerDOMHandler);handlerForType.handler=handler;originalAddEventListener.call(this,type,handler,options)}handlerForType.refCount++}catch(e){}}return originalAddEventListener.call(this,type,listener,options)}});core.fill(proto,"removeEventListener",function(originalRemoveEventListener){return function(type,listener,options){if(type==="click"||type=="keypress"){try{const handlers=this.__sentry_instrumentation_handlers__||{};const handlerForType=handlers[type];if(handlerForType){handlerForType.refCount--;if(handlerForType.refCount<=0){originalRemoveEventListener.call(this,type,handlerForType.handler,options);handlerForType.handler=undefined;delete handlers[type]}if(Object.keys(handlers).length===0){delete this.__sentry_instrumentation_handlers__}}}catch(e){}}return originalRemoveEventListener.call(this,type,listener,options)}})})}function isSimilarToLastCapturedEvent(event){if(event.type!==lastCapturedEventType){return false}try{if(!event.target||event.target._sentryId!==lastCapturedEventTargetId){return false}}catch(e){}return true}function shouldSkipDOMEvent(eventType,target){if(eventType!=="keypress"){return false}if(!target||!target.tagName){return true}if(target.tagName==="INPUT"||target.tagName==="TEXTAREA"||target.isContentEditable){return false}return true}function makeDOMEventHandler(handler,globalListener=false){return event=>{if(!event||event["_sentryCaptured"]){return}const target=getEventTarget(event);if(shouldSkipDOMEvent(event.type,target)){return}core.addNonEnumerableProperty(event,"_sentryCaptured",true);if(target&&!target._sentryId){core.addNonEnumerableProperty(target,"_sentryId",core.uuid4())}const name=event.type==="keypress"?"input":event.type;if(!isSimilarToLastCapturedEvent(event)){const handlerData={event:event,name:name,global:globalListener};handler(handlerData);lastCapturedEventType=event.type;lastCapturedEventTargetId=target?target._sentryId:undefined}clearTimeout(debounceTimerID);debounceTimerID=types.WINDOW.setTimeout(()=>{lastCapturedEventTargetId=undefined;lastCapturedEventType=undefined},DEBOUNCE_DURATION)}}function getEventTarget(event){try{return event.target}catch(e){return null}}exports.addClickKeypressInstrumentationHandler=addClickKeypressInstrumentationHandler;exports.instrumentDOM=instrumentDOM},{"../types.js":32,"@sentry/core":87}],6:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const types=require("../types.js");let lastHref;function addHistoryInstrumentationHandler(handler){const type="history";core.addHandler(type,handler);core.maybeInstrument(type,instrumentHistory)}function instrumentHistory(){if(!core.supportsHistory()){return}const oldOnPopState=types.WINDOW.onpopstate;types.WINDOW.onpopstate=function(...args){const to=types.WINDOW.location.href;const from=lastHref;lastHref=to;const handlerData={from:from,to:to};core.triggerHandlers("history",handlerData);if(oldOnPopState){try{return oldOnPopState.apply(this,args)}catch(_oO){}}};function historyReplacementFunction(originalHistoryFunction){return function(...args){const url=args.length>2?args[2]:undefined;if(url){const from=lastHref;const to=String(url);lastHref=to;const handlerData={from:from,to:to};core.triggerHandlers("history",handlerData)}return originalHistoryFunction.apply(this,args)}}core.fill(types.WINDOW.history,"pushState",historyReplacementFunction);core.fill(types.WINDOW.history,"replaceState",historyReplacementFunction)}exports.addHistoryInstrumentationHandler=addHistoryInstrumentationHandler},{"../types.js":32,"@sentry/core":87}],7:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const types=require("../types.js");const SENTRY_XHR_DATA_KEY="__sentry_xhr_v3__";function addXhrInstrumentationHandler(handler){const type="xhr";core.addHandler(type,handler);core.maybeInstrument(type,instrumentXHR)}function instrumentXHR(){if(!types.WINDOW.XMLHttpRequest){return}const xhrproto=XMLHttpRequest.prototype;xhrproto.open=new Proxy(xhrproto.open,{apply(originalOpen,xhrOpenThisArg,xhrOpenArgArray){const virtualError=new Error;const startTimestamp=core.timestampInSeconds()*1e3;const method=core.isString(xhrOpenArgArray[0])?xhrOpenArgArray[0].toUpperCase():undefined;const url=parseUrl(xhrOpenArgArray[1]);if(!method||!url){return originalOpen.apply(xhrOpenThisArg,xhrOpenArgArray)}xhrOpenThisArg[SENTRY_XHR_DATA_KEY]={method:method,url:url,request_headers:{}};if(method==="POST"&&url.match(/sentry_key/)){xhrOpenThisArg.__sentry_own_request__=true}const onreadystatechangeHandler=()=>{const xhrInfo=xhrOpenThisArg[SENTRY_XHR_DATA_KEY];if(!xhrInfo){return}if(xhrOpenThisArg.readyState===4){try{xhrInfo.status_code=xhrOpenThisArg.status}catch(e){}const handlerData={endTimestamp:core.timestampInSeconds()*1e3,startTimestamp:startTimestamp,xhr:xhrOpenThisArg,virtualError:virtualError};core.triggerHandlers("xhr",handlerData)}};if("onreadystatechange"in xhrOpenThisArg&&typeof xhrOpenThisArg.onreadystatechange==="function"){xhrOpenThisArg.onreadystatechange=new Proxy(xhrOpenThisArg.onreadystatechange,{apply(originalOnreadystatechange,onreadystatechangeThisArg,onreadystatechangeArgArray){onreadystatechangeHandler();return originalOnreadystatechange.apply(onreadystatechangeThisArg,onreadystatechangeArgArray)}})}else{xhrOpenThisArg.addEventListener("readystatechange",onreadystatechangeHandler)}xhrOpenThisArg.setRequestHeader=new Proxy(xhrOpenThisArg.setRequestHeader,{apply(originalSetRequestHeader,setRequestHeaderThisArg,setRequestHeaderArgArray){const[header,value]=setRequestHeaderArgArray;const xhrInfo=setRequestHeaderThisArg[SENTRY_XHR_DATA_KEY];if(xhrInfo&&core.isString(header)&&core.isString(value)){xhrInfo.request_headers[header.toLowerCase()]=value}return originalSetRequestHeader.apply(setRequestHeaderThisArg,setRequestHeaderArgArray)}});return originalOpen.apply(xhrOpenThisArg,xhrOpenArgArray)}});xhrproto.send=new Proxy(xhrproto.send,{apply(originalSend,sendThisArg,sendArgArray){const sentryXhrData=sendThisArg[SENTRY_XHR_DATA_KEY];if(!sentryXhrData){return originalSend.apply(sendThisArg,sendArgArray)}if(sendArgArray[0]!==undefined){sentryXhrData.body=sendArgArray[0]}const handlerData={startTimestamp:core.timestampInSeconds()*1e3,xhr:sendThisArg};core.triggerHandlers("xhr",handlerData);return originalSend.apply(sendThisArg,sendArgArray)}})}function parseUrl(url){if(core.isString(url)){return url}try{return url.toString()}catch(e2){}return undefined}exports.SENTRY_XHR_DATA_KEY=SENTRY_XHR_DATA_KEY;exports.addXhrInstrumentationHandler=addXhrInstrumentationHandler;exports.instrumentXHR=instrumentXHR},{"../types.js":32,"@sentry/core":87}],8:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const types=require("../types.js");const cls=require("./cls.js");const instrument=require("./instrument.js");const utils=require("./utils.js");const getActivationStart=require("./web-vitals/lib/getActivationStart.js");const getNavigationEntry=require("./web-vitals/lib/getNavigationEntry.js");const getVisibilityWatcher=require("./web-vitals/lib/getVisibilityWatcher.js");const MAX_INT_AS_BYTES=2147483647;let _performanceCursor=0;let _measurements={};let _lcpEntry;let _clsEntry;function startTrackingWebVitals({recordClsStandaloneSpans}){const performance=utils.getBrowserPerformanceAPI();if(performance&&core.browserPerformanceTimeOrigin){if(performance.mark){types.WINDOW.performance.mark("sentry-tracing-init")}const fidCleanupCallback=_trackFID();const lcpCleanupCallback=_trackLCP();const ttfbCleanupCallback=_trackTtfb();const clsCleanupCallback=recordClsStandaloneSpans?cls.trackClsAsStandaloneSpan():_trackCLS();return()=>{fidCleanupCallback();lcpCleanupCallback();ttfbCleanupCallback();clsCleanupCallback&&clsCleanupCallback()}}return()=>undefined}function startTrackingLongTasks(){instrument.addPerformanceInstrumentationHandler("longtask",({entries})=>{const parent=core.getActiveSpan();if(!parent){return}const{op:parentOp,start_timestamp:parentStartTimestamp}=core.spanToJSON(parent);for(const entry of entries){const startTime=utils.msToSec(core.browserPerformanceTimeOrigin+entry.startTime);const duration=utils.msToSec(entry.duration);if(parentOp==="navigation"&&parentStartTimestamp&&startTime<parentStartTimestamp){continue}utils.startAndEndSpan(parent,startTime,startTime+duration,{name:"Main UI thread blocked",op:"ui.long-task",attributes:{[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.ui.browser.metrics"}})}})}function startTrackingLongAnimationFrames(){const observer=new PerformanceObserver(list=>{const parent=core.getActiveSpan();if(!parent){return}for(const entry of list.getEntries()){if(!entry.scripts[0]){continue}const startTime=utils.msToSec(core.browserPerformanceTimeOrigin+entry.startTime);const{start_timestamp:parentStartTimestamp,op:parentOp}=core.spanToJSON(parent);if(parentOp==="navigation"&&parentStartTimestamp&&startTime<parentStartTimestamp){continue}const duration=utils.msToSec(entry.duration);const attributes={[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.ui.browser.metrics"};const initialScript=entry.scripts[0];const{invoker,invokerType,sourceURL,sourceFunctionName,sourceCharPosition}=initialScript;attributes["browser.script.invoker"]=invoker;attributes["browser.script.invoker_type"]=invokerType;if(sourceURL){attributes["code.filepath"]=sourceURL}if(sourceFunctionName){attributes["code.function"]=sourceFunctionName}if(sourceCharPosition!==-1){attributes["browser.script.source_char_position"]=sourceCharPosition}utils.startAndEndSpan(parent,startTime,startTime+duration,{name:"Main UI thread blocked",op:"ui.long-animation-frame",attributes:attributes})}});observer.observe({type:"long-animation-frame",buffered:true})}function startTrackingInteractions(){instrument.addPerformanceInstrumentationHandler("event",({entries})=>{const parent=core.getActiveSpan();if(!parent){return}for(const entry of entries){if(entry.name==="click"){const startTime=utils.msToSec(core.browserPerformanceTimeOrigin+entry.startTime);const duration=utils.msToSec(entry.duration);const spanOptions={name:core.htmlTreeAsString(entry.target),op:`ui.interaction.${entry.name}`,startTime:startTime,attributes:{[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.ui.browser.metrics"}};const componentName=core.getComponentName(entry.target);if(componentName){spanOptions.attributes["ui.component_name"]=componentName}utils.startAndEndSpan(parent,startTime,startTime+duration,spanOptions)}}})}function _trackCLS(){return instrument.addClsInstrumentationHandler(({metric})=>{const entry=metric.entries[metric.entries.length-1];if(!entry){return}_measurements["cls"]={value:metric.value,unit:""};_clsEntry=entry},true)}function _trackLCP(){return instrument.addLcpInstrumentationHandler(({metric})=>{const entry=metric.entries[metric.entries.length-1];if(!entry){return}_measurements["lcp"]={value:metric.value,unit:"millisecond"};_lcpEntry=entry},true)}function _trackFID(){return instrument.addFidInstrumentationHandler(({metric})=>{const entry=metric.entries[metric.entries.length-1];if(!entry){return}const timeOrigin=utils.msToSec(core.browserPerformanceTimeOrigin);const startTime=utils.msToSec(entry.startTime);_measurements["fid"]={value:metric.value,unit:"millisecond"};_measurements["mark.fid"]={value:timeOrigin+startTime,unit:"second"}})}function _trackTtfb(){return instrument.addTtfbInstrumentationHandler(({metric})=>{const entry=metric.entries[metric.entries.length-1];if(!entry){return}_measurements["ttfb"]={value:metric.value,unit:"millisecond"}})}function addPerformanceEntries(span,options){const performance=utils.getBrowserPerformanceAPI();if(!performance||!performance.getEntries||!core.browserPerformanceTimeOrigin){return}const timeOrigin=utils.msToSec(core.browserPerformanceTimeOrigin);const performanceEntries=performance.getEntries();const{op,start_timestamp:transactionStartTime}=core.spanToJSON(span);performanceEntries.slice(_performanceCursor).forEach(entry=>{const startTime=utils.msToSec(entry.startTime);const duration=utils.msToSec(Math.max(0,entry.duration));if(op==="navigation"&&transactionStartTime&&timeOrigin+startTime<transactionStartTime){return}switch(entry.entryType){case"navigation":{_addNavigationSpans(span,entry,timeOrigin);break}case"mark":case"paint":case"measure":{_addMeasureSpans(span,entry,startTime,duration,timeOrigin);const firstHidden=getVisibilityWatcher.getVisibilityWatcher();const shouldRecord=entry.startTime<firstHidden.firstHiddenTime;if(entry.name==="first-paint"&&shouldRecord){_measurements["fp"]={value:entry.startTime,unit:"millisecond"}}if(entry.name==="first-contentful-paint"&&shouldRecord){_measurements["fcp"]={value:entry.startTime,unit:"millisecond"}}break}case"resource":{_addResourceSpans(span,entry,entry.name,startTime,duration,timeOrigin);break}}});_performanceCursor=Math.max(performanceEntries.length-1,0);_trackNavigator(span);if(op==="pageload"){_addTtfbRequestTimeToMeasurements(_measurements);const fidMark=_measurements["mark.fid"];if(fidMark&&_measurements["fid"]){utils.startAndEndSpan(span,fidMark.value,fidMark.value+utils.msToSec(_measurements["fid"].value),{name:"first input delay",op:"ui.action",attributes:{[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.ui.browser.metrics"}});delete _measurements["mark.fid"]}if(!("fcp"in _measurements)||!options.recordClsOnPageloadSpan){delete _measurements.cls}Object.entries(_measurements).forEach(([measurementName,measurement])=>{core.setMeasurement(measurementName,measurement.value,measurement.unit)});span.setAttribute("performance.timeOrigin",timeOrigin);span.setAttribute("performance.activationStart",getActivationStart.getActivationStart());_setWebVitalAttributes(span)}_lcpEntry=undefined;_clsEntry=undefined;_measurements={}}function _addMeasureSpans(span,entry,startTime,duration,timeOrigin){const navEntry=getNavigationEntry.getNavigationEntry(false);const requestTime=utils.msToSec(navEntry?navEntry.requestStart:0);const measureStartTimestamp=timeOrigin+Math.max(startTime,requestTime);const startTimeStamp=timeOrigin+startTime;const measureEndTimestamp=startTimeStamp+duration;const attributes={[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.resource.browser.metrics"};if(measureStartTimestamp!==startTimeStamp){attributes["sentry.browser.measure_happened_before_request"]=true;attributes["sentry.browser.measure_start_time"]=measureStartTimestamp}utils.startAndEndSpan(span,measureStartTimestamp,measureEndTimestamp,{name:entry.name,op:entry.entryType,attributes:attributes});return measureStartTimestamp}function _addNavigationSpans(span,entry,timeOrigin){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(event=>{_addPerformanceNavigationTiming(span,entry,event,timeOrigin)});_addPerformanceNavigationTiming(span,entry,"secureConnection",timeOrigin,"TLS/SSL");_addPerformanceNavigationTiming(span,entry,"fetch",timeOrigin,"cache");_addPerformanceNavigationTiming(span,entry,"domainLookup",timeOrigin,"DNS");_addRequest(span,entry,timeOrigin)}function _addPerformanceNavigationTiming(span,entry,event,timeOrigin,name=event){const eventEnd=_getEndPropertyNameForNavigationTiming(event);const end=entry[eventEnd];const start=entry[`${event}Start`];if(!start||!end){return}utils.startAndEndSpan(span,timeOrigin+utils.msToSec(start),timeOrigin+utils.msToSec(end),{op:`browser.${name}`,name:entry.name,attributes:{[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.ui.browser.metrics"}})}function _getEndPropertyNameForNavigationTiming(event){if(event==="secureConnection"){return"connectEnd"}if(event==="fetch"){return"domainLookupStart"}return`${event}End`}function _addRequest(span,entry,timeOrigin){const requestStartTimestamp=timeOrigin+utils.msToSec(entry.requestStart);const responseEndTimestamp=timeOrigin+utils.msToSec(entry.responseEnd);const responseStartTimestamp=timeOrigin+utils.msToSec(entry.responseStart);if(entry.responseEnd){utils.startAndEndSpan(span,requestStartTimestamp,responseEndTimestamp,{op:"browser.request",name:entry.name,attributes:{[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.ui.browser.metrics"}});utils.startAndEndSpan(span,responseStartTimestamp,responseEndTimestamp,{op:"browser.response",name:entry.name,attributes:{[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.ui.browser.metrics"}})}}function _addResourceSpans(span,entry,resourceUrl,startTime,duration,timeOrigin){if(entry.initiatorType==="xmlhttprequest"||entry.initiatorType==="fetch"){return}const parsedUrl=core.parseUrl(resourceUrl);const attributes={[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.resource.browser.metrics"};setResourceEntrySizeData(attributes,entry,"transferSize","http.response_transfer_size");setResourceEntrySizeData(attributes,entry,"encodedBodySize","http.response_content_length");setResourceEntrySizeData(attributes,entry,"decodedBodySize","http.decoded_response_content_length");const deliveryType=entry.deliveryType;if(deliveryType!=null){attributes["http.response_delivery_type"]=deliveryType}const renderBlockingStatus=entry.renderBlockingStatus;if(renderBlockingStatus){attributes["resource.render_blocking_status"]=renderBlockingStatus}if(parsedUrl.protocol){attributes["url.scheme"]=parsedUrl.protocol.split(":").pop()}if(parsedUrl.host){attributes["server.address"]=parsedUrl.host}attributes["url.same_origin"]=resourceUrl.includes(types.WINDOW.location.origin);const startTimestamp=timeOrigin+startTime;const endTimestamp=startTimestamp+duration;utils.startAndEndSpan(span,startTimestamp,endTimestamp,{name:resourceUrl.replace(types.WINDOW.location.origin,""),op:entry.initiatorType?`resource.${entry.initiatorType}`:"resource.other",attributes:attributes})}function _trackNavigator(span){const navigator=types.WINDOW.navigator;if(!navigator){return}const connection=navigator.connection;if(connection){if(connection.effectiveType){span.setAttribute("effectiveConnectionType",connection.effectiveType)}if(connection.type){span.setAttribute("connectionType",connection.type)}if(utils.isMeasurementValue(connection.rtt)){_measurements["connection.rtt"]={value:connection.rtt,unit:"millisecond"}}}if(utils.isMeasurementValue(navigator.deviceMemory)){span.setAttribute("deviceMemory",`${navigator.deviceMemory} GB`)}if(utils.isMeasurementValue(navigator.hardwareConcurrency)){span.setAttribute("hardwareConcurrency",String(navigator.hardwareConcurrency))}}function _setWebVitalAttributes(span){if(_lcpEntry){if(_lcpEntry.element){span.setAttribute("lcp.element",core.htmlTreeAsString(_lcpEntry.element))}if(_lcpEntry.id){span.setAttribute("lcp.id",_lcpEntry.id)}if(_lcpEntry.url){span.setAttribute("lcp.url",_lcpEntry.url.trim().slice(0,200))}if(_lcpEntry.loadTime!=null){span.setAttribute("lcp.loadTime",_lcpEntry.loadTime)}if(_lcpEntry.renderTime!=null){span.setAttribute("lcp.renderTime",_lcpEntry.renderTime)}span.setAttribute("lcp.size",_lcpEntry.size)}if(_clsEntry&&_clsEntry.sources){_clsEntry.sources.forEach((source,index)=>span.setAttribute(`cls.source.${index+1}`,core.htmlTreeAsString(source.node)))}}function setResourceEntrySizeData(attributes,entry,key,dataKey){const entryVal=entry[key];if(entryVal!=null&&entryVal<MAX_INT_AS_BYTES){attributes[dataKey]=entryVal}}function _addTtfbRequestTimeToMeasurements(_measurements){const navEntry=getNavigationEntry.getNavigationEntry(false);if(!navEntry){return}const{responseStart,requestStart}=navEntry;if(requestStart<=responseStart){_measurements["ttfb.requestTime"]={value:responseStart-requestStart,unit:"millisecond"}}}exports._addMeasureSpans=_addMeasureSpans;exports._addResourceSpans=_addResourceSpans;exports.addPerformanceEntries=addPerformanceEntries;exports.startTrackingInteractions=startTrackingInteractions;exports.startTrackingLongAnimationFrames=startTrackingLongAnimationFrames;exports.startTrackingLongTasks=startTrackingLongTasks;exports.startTrackingWebVitals=startTrackingWebVitals},{"../types.js":32,"./cls.js":9,"./instrument.js":11,"./utils.js":12,"./web-vitals/lib/getActivationStart.js":19,"./web-vitals/lib/getNavigationEntry.js":20,"./web-vitals/lib/getVisibilityWatcher.js":21,"@sentry/core":87}],9:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const debugBuild=require("../debug-build.js");const instrument=require("./instrument.js");const utils=require("./utils.js");const onHidden=require("./web-vitals/lib/onHidden.js");function trackClsAsStandaloneSpan(){let standaloneCLsValue=0;let standaloneClsEntry;let pageloadSpanId;if(!supportsLayoutShift()){return}let sentSpan=false;function _collectClsOnce(){if(sentSpan){return}sentSpan=true;if(pageloadSpanId){sendStandaloneClsSpan(standaloneCLsValue,standaloneClsEntry,pageloadSpanId)}cleanupClsHandler()}const cleanupClsHandler=instrument.addClsInstrumentationHandler(({metric})=>{const entry=metric.entries[metric.entries.length-1];if(!entry){return}standaloneCLsValue=metric.value;standaloneClsEntry=entry},true);onHidden.onHidden(()=>{_collectClsOnce()});setTimeout(()=>{const client=core.getClient();if(!client){return}const unsubscribeStartNavigation=client.on("startNavigationSpan",()=>{_collectClsOnce();unsubscribeStartNavigation&&unsubscribeStartNavigation()});const activeSpan=core.getActiveSpan();const rootSpan=activeSpan&&core.getRootSpan(activeSpan);const spanJSON=rootSpan&&core.spanToJSON(rootSpan);if(spanJSON&&spanJSON.op==="pageload"){pageloadSpanId=rootSpan.spanContext().spanId}},0)}function sendStandaloneClsSpan(clsValue,entry,pageloadSpanId){debugBuild.DEBUG_BUILD&&core.logger.log(`Sending CLS span (${clsValue})`);const startTime=utils.msToSec((core.browserPerformanceTimeOrigin||0)+(entry&&entry.startTime||0));const routeName=core.getCurrentScope().getScopeData().transactionName;const name=entry?core.htmlTreeAsString(entry.sources[0]&&entry.sources[0].node):"Layout shift";const attributes=core.dropUndefinedKeys({[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.http.browser.cls",[core.SEMANTIC_ATTRIBUTE_SENTRY_OP]:"ui.webvital.cls",[core.SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME]:entry&&entry.duration||0,"sentry.pageload.span_id":pageloadSpanId});const span=utils.startStandaloneWebVitalSpan({name:name,transaction:routeName,attributes:attributes,startTime:startTime});if(span){span.addEvent("cls",{[core.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT]:"",[core.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE]:clsValue});span.end(startTime)}}function supportsLayoutShift(){try{return PerformanceObserver.supportedEntryTypes.includes("layout-shift")}catch(e){return false}}exports.trackClsAsStandaloneSpan=trackClsAsStandaloneSpan},{"../debug-build.js":2,"./instrument.js":11,"./utils.js":12,"./web-vitals/lib/onHidden.js":25,"@sentry/core":87}],10:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const instrument=require("./instrument.js");const utils=require("./utils.js");const LAST_INTERACTIONS=[];const INTERACTIONS_SPAN_MAP=new Map;function startTrackingINP(){const performance=utils.getBrowserPerformanceAPI();if(performance&&core.browserPerformanceTimeOrigin){const inpCallback=_trackINP();return()=>{inpCallback()}}return()=>undefined}const INP_ENTRY_MAP={click:"click",pointerdown:"click",pointerup:"click",mousedown:"click",mouseup:"click",touchstart:"click",touchend:"click",mouseover:"hover",mouseout:"hover",mouseenter:"hover",mouseleave:"hover",pointerover:"hover",pointerout:"hover",pointerenter:"hover",pointerleave:"hover",dragstart:"drag",dragend:"drag",drag:"drag",dragenter:"drag",dragleave:"drag",dragover:"drag",drop:"drag",keydown:"press",keyup:"press",keypress:"press",input:"press"};function _trackINP(){return instrument.addInpInstrumentationHandler(({metric})=>{if(metric.value==undefined){return}const entry=metric.entries.find(entry=>entry.duration===metric.value&&INP_ENTRY_MAP[entry.name]);if(!entry){return}const{interactionId}=entry;const interactionType=INP_ENTRY_MAP[entry.name];const startTime=utils.msToSec(core.browserPerformanceTimeOrigin+entry.startTime);const duration=utils.msToSec(metric.value);const activeSpan=core.getActiveSpan();const rootSpan=activeSpan?core.getRootSpan(activeSpan):undefined;const cachedSpan=interactionId!=null?INTERACTIONS_SPAN_MAP.get(interactionId):undefined;const spanToUse=cachedSpan||rootSpan;const routeName=spanToUse?core.spanToJSON(spanToUse).description:core.getCurrentScope().getScopeData().transactionName;const name=core.htmlTreeAsString(entry.target);const attributes=core.dropUndefinedKeys({[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.http.browser.inp",[core.SEMANTIC_ATTRIBUTE_SENTRY_OP]:`ui.interaction.${interactionType}`,[core.SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME]:entry.duration});const span=utils.startStandaloneWebVitalSpan({name:name,transaction:routeName,attributes:attributes,startTime:startTime});if(span){span.addEvent("inp",{[core.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT]:"millisecond",[core.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE]:metric.value});span.end(startTime+duration)}})}function registerInpInteractionListener(_latestRoute){const handleEntries=({entries})=>{const activeSpan=core.getActiveSpan();const activeRootSpan=activeSpan&&core.getRootSpan(activeSpan);entries.forEach(entry=>{if(!instrument.isPerformanceEventTiming(entry)||!activeRootSpan){return}const interactionId=entry.interactionId;if(interactionId==null){return}if(INTERACTIONS_SPAN_MAP.has(interactionId)){return}if(LAST_INTERACTIONS.length>10){const last=LAST_INTERACTIONS.shift();INTERACTIONS_SPAN_MAP.delete(last)}LAST_INTERACTIONS.push(interactionId);INTERACTIONS_SPAN_MAP.set(interactionId,activeRootSpan)})};instrument.addPerformanceInstrumentationHandler("event",handleEntries);instrument.addPerformanceInstrumentationHandler("first-input",handleEntries)}exports.registerInpInteractionListener=registerInpInteractionListener;exports.startTrackingINP=startTrackingINP},{"./instrument.js":11,"./utils.js":12,"@sentry/core":87}],11:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const debugBuild=require("../debug-build.js");const getCLS=require("./web-vitals/getCLS.js");const getFID=require("./web-vitals/getFID.js");const getINP=require("./web-vitals/getINP.js");const getLCP=require("./web-vitals/getLCP.js");const observe=require("./web-vitals/lib/observe.js");const onTTFB=require("./web-vitals/onTTFB.js");const handlers={};const instrumented={};let _previousCls;let _previousFid;let _previousLcp;let _previousTtfb;let _previousInp;function addClsInstrumentationHandler(callback,stopOnCallback=false){return addMetricObserver("cls",callback,instrumentCls,_previousCls,stopOnCallback)}function addLcpInstrumentationHandler(callback,stopOnCallback=false){return addMetricObserver("lcp",callback,instrumentLcp,_previousLcp,stopOnCallback)}function addFidInstrumentationHandler(callback){return addMetricObserver("fid",callback,instrumentFid,_previousFid)}function addTtfbInstrumentationHandler(callback){return addMetricObserver("ttfb",callback,instrumentTtfb,_previousTtfb)}function addInpInstrumentationHandler(callback){return addMetricObserver("inp",callback,instrumentInp,_previousInp)}function addPerformanceInstrumentationHandler(type,callback){addHandler(type,callback);if(!instrumented[type]){instrumentPerformanceObserver(type);instrumented[type]=true}return getCleanupCallback(type,callback)}function triggerHandlers(type,data){const typeHandlers=handlers[type];if(!typeHandlers||!typeHandlers.length){return}for(const handler of typeHandlers){try{handler(data)}catch(e){debugBuild.DEBUG_BUILD&&core.logger.error(`Error while triggering instrumentation handler.\nType: ${type}\nName: ${core.getFunctionName(handler)}\nError:`,e)}}}function instrumentCls(){return getCLS.onCLS(metric=>{triggerHandlers("cls",{metric:metric});_previousCls=metric},{reportAllChanges:true})}function instrumentFid(){return getFID.onFID(metric=>{triggerHandlers("fid",{metric:metric});_previousFid=metric})}function instrumentLcp(){return getLCP.onLCP(metric=>{triggerHandlers("lcp",{metric:metric});_previousLcp=metric},{reportAllChanges:true})}function instrumentTtfb(){return onTTFB.onTTFB(metric=>{triggerHandlers("ttfb",{metric:metric});_previousTtfb=metric})}function instrumentInp(){return getINP.onINP(metric=>{triggerHandlers("inp",{metric:metric});_previousInp=metric})}function addMetricObserver(type,callback,instrumentFn,previousValue,stopOnCallback=false){addHandler(type,callback);let stopListening;if(!instrumented[type]){stopListening=instrumentFn();instrumented[type]=true}if(previousValue){callback({metric:previousValue})}return getCleanupCallback(type,callback,stopOnCallback?stopListening:undefined)}function instrumentPerformanceObserver(type){const options={};if(type==="event"){options.durationThreshold=0}observe.observe(type,entries=>{triggerHandlers(type,{entries:entries})},options)}function addHandler(type,handler){handlers[type]=handlers[type]||[];handlers[type].push(handler)}function getCleanupCallback(type,callback,stopListening){return()=>{if(stopListening){stopListening()}const typeHandlers=handlers[type];if(!typeHandlers){return}const index=typeHandlers.indexOf(callback);if(index!==-1){typeHandlers.splice(index,1)}}}function isPerformanceEventTiming(entry){return"duration"in entry}exports.addClsInstrumentationHandler=addClsInstrumentationHandler;exports.addFidInstrumentationHandler=addFidInstrumentationHandler;exports.addInpInstrumentationHandler=addInpInstrumentationHandler;exports.addLcpInstrumentationHandler=addLcpInstrumentationHandler;exports.addPerformanceInstrumentationHandler=addPerformanceInstrumentationHandler;exports.addTtfbInstrumentationHandler=addTtfbInstrumentationHandler;exports.isPerformanceEventTiming=isPerformanceEventTiming},{"../debug-build.js":2,"./web-vitals/getCLS.js":13,"./web-vitals/getFID.js":14,"./web-vitals/getINP.js":15,"./web-vitals/getLCP.js":16,"./web-vitals/lib/observe.js":24,"./web-vitals/onTTFB.js":31,"@sentry/core":87}],12:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const types=require("../types.js");function isMeasurementValue(value){return typeof value==="number"&&isFinite(value)}function startAndEndSpan(parentSpan,startTimeInSeconds,endTime,{...ctx}){const parentStartTime=core.spanToJSON(parentSpan).start_timestamp;if(parentStartTime&&parentStartTime>startTimeInSeconds){if(typeof parentSpan.updateStartTime==="function"){parentSpan.updateStartTime(startTimeInSeconds)}}return core.withActiveSpan(parentSpan,()=>{const span=core.startInactiveSpan({startTime:startTimeInSeconds,...ctx});if(span){span.end(endTime)}return span})}function startStandaloneWebVitalSpan(options){const client=core.getClient();if(!client){return}const{name,transaction,attributes:passedAttributes,startTime}=options;const{release,environment}=client.getOptions();const replay=client.getIntegrationByName("Replay");const replayId=replay&&replay.getReplayId();const scope=core.getCurrentScope();const user=scope.getUser();const userDisplay=user!==undefined?user.email||user.id||user.ip_address:undefined;let profileId;try{profileId=scope.getScopeData().contexts.profile.profile_id}catch(e){}const attributes={release:release,environment:environment,user:userDisplay||undefined,profile_id:profileId||undefined,replay_id:replayId||undefined,transaction:transaction,"user_agent.original":types.WINDOW.navigator&&types.WINDOW.navigator.userAgent,...passedAttributes};return core.startInactiveSpan({name:name,attributes:attributes,startTime:startTime,experimental:{standalone:true}})}function getBrowserPerformanceAPI(){return types.WINDOW&&types.WINDOW.addEventListener&&types.WINDOW.performance}function msToSec(time){return time/1e3}exports.getBrowserPerformanceAPI=getBrowserPerformanceAPI;exports.isMeasurementValue=isMeasurementValue;exports.msToSec=msToSec;exports.startAndEndSpan=startAndEndSpan;exports.startStandaloneWebVitalSpan=startStandaloneWebVitalSpan},{"../types.js":32,"@sentry/core":87}],13:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const bindReporter=require("./lib/bindReporter.js");const initMetric=require("./lib/initMetric.js");const observe=require("./lib/observe.js");const onHidden=require("./lib/onHidden.js");const runOnce=require("./lib/runOnce.js");const onFCP=require("./onFCP.js");const CLSThresholds=[.1,.25];const onCLS=(onReport,opts={})=>{onFCP.onFCP(runOnce.runOnce(()=>{const metric=initMetric.initMetric("CLS",0);let report;let sessionValue=0;let sessionEntries=[];const handleEntries=entries=>{entries.forEach(entry=>{if(!entry.hadRecentInput){const firstSessionEntry=sessionEntries[0];const lastSessionEntry=sessionEntries[sessionEntries.length-1];if(sessionValue&&firstSessionEntry&&lastSessionEntry&&entry.startTime-lastSessionEntry.startTime<1e3&&entry.startTime-firstSessionEntry.startTime<5e3){sessionValue+=entry.value;sessionEntries.push(entry)}else{sessionValue=entry.value;sessionEntries=[entry]}}});if(sessionValue>metric.value){metric.value=sessionValue;metric.entries=sessionEntries;report()}};const po=observe.observe("layout-shift",handleEntries);if(po){report=bindReporter.bindReporter(onReport,metric,CLSThresholds,opts.reportAllChanges);onHidden.onHidden(()=>{handleEntries(po.takeRecords());report(true)});setTimeout(report,0)}}))};exports.CLSThresholds=CLSThresholds;exports.onCLS=onCLS},{"./lib/bindReporter.js":17,"./lib/initMetric.js":22,"./lib/observe.js":24,"./lib/onHidden.js":25,"./lib/runOnce.js":27,"./onFCP.js":30}],14:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const bindReporter=require("./lib/bindReporter.js");const getVisibilityWatcher=require("./lib/getVisibilityWatcher.js");const initMetric=require("./lib/initMetric.js");const observe=require("./lib/observe.js");const onHidden=require("./lib/onHidden.js");const runOnce=require("./lib/runOnce.js");const whenActivated=require("./lib/whenActivated.js");const FIDThresholds=[100,300];const onFID=(onReport,opts={})=>{whenActivated.whenActivated(()=>{const visibilityWatcher=getVisibilityWatcher.getVisibilityWatcher();const metric=initMetric.initMetric("FID");let report;const handleEntry=entry=>{if(entry.startTime<visibilityWatcher.firstHiddenTime){metric.value=entry.processingStart-entry.startTime;metric.entries.push(entry);report(true)}};const handleEntries=entries=>{entries.forEach(handleEntry)};const po=observe.observe("first-input",handleEntries);report=bindReporter.bindReporter(onReport,metric,FIDThresholds,opts.reportAllChanges);if(po){onHidden.onHidden(runOnce.runOnce(()=>{handleEntries(po.takeRecords());po.disconnect()}))}})};exports.FIDThresholds=FIDThresholds;exports.onFID=onFID},{"./lib/bindReporter.js":17,"./lib/getVisibilityWatcher.js":21,"./lib/initMetric.js":22,"./lib/observe.js":24,"./lib/onHidden.js":25,"./lib/runOnce.js":27,"./lib/whenActivated.js":28}],15:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const types=require("../../types.js");const bindReporter=require("./lib/bindReporter.js");const initMetric=require("./lib/initMetric.js");const interactions=require("./lib/interactions.js");const observe=require("./lib/observe.js");const onHidden=require("./lib/onHidden.js");const interactionCountPolyfill=require("./lib/polyfills/interactionCountPolyfill.js");const whenActivated=require("./lib/whenActivated.js");const whenIdle=require("./lib/whenIdle.js");const INPThresholds=[200,500];const onINP=(onReport,opts={})=>{if(!("PerformanceEventTiming"in types.WINDOW&&"interactionId"in PerformanceEventTiming.prototype)){return}whenActivated.whenActivated(()=>{interactionCountPolyfill.initInteractionCountPolyfill();const metric=initMetric.initMetric("INP");let report;const handleEntries=entries=>{whenIdle.whenIdle(()=>{entries.forEach(interactions.processInteractionEntry);const inp=interactions.estimateP98LongestInteraction();if(inp&&inp.latency!==metric.value){metric.value=inp.latency;metric.entries=inp.entries;report()}})};const po=observe.observe("event",handleEntries,{durationThreshold:opts.durationThreshold!=null?opts.durationThreshold:interactions.DEFAULT_DURATION_THRESHOLD});report=bindReporter.bindReporter(onReport,metric,INPThresholds,opts.reportAllChanges);if(po){po.observe({type:"first-input",buffered:true});onHidden.onHidden(()=>{handleEntries(po.takeRecords());report(true)})}})};exports.INPThresholds=INPThresholds;exports.onINP=onINP},{"../../types.js":32,"./lib/bindReporter.js":17,"./lib/initMetric.js":22,"./lib/interactions.js":23,"./lib/observe.js":24,"./lib/onHidden.js":25,"./lib/polyfills/interactionCountPolyfill.js":26,"./lib/whenActivated.js":28,"./lib/whenIdle.js":29}],16:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const types=require("../../types.js");const bindReporter=require("./lib/bindReporter.js");const getActivationStart=require("./lib/getActivationStart.js");const getVisibilityWatcher=require("./lib/getVisibilityWatcher.js");const initMetric=require("./lib/initMetric.js");const observe=require("./lib/observe.js");const onHidden=require("./lib/onHidden.js");const runOnce=require("./lib/runOnce.js");const whenActivated=require("./lib/whenActivated.js");const whenIdle=require("./lib/whenIdle.js");const LCPThresholds=[2500,4e3];const reportedMetricIDs={};const onLCP=(onReport,opts={})=>{whenActivated.whenActivated(()=>{const visibilityWatcher=getVisibilityWatcher.getVisibilityWatcher();const metric=initMetric.initMetric("LCP");let report;const handleEntries=entries=>{if(!opts.reportAllChanges){entries=entries.slice(-1)}entries.forEach(entry=>{if(entry.startTime<visibilityWatcher.firstHiddenTime){metric.value=Math.max(entry.startTime-getActivationStart.getActivationStart(),0);metric.entries=[entry];report()}})};const po=observe.observe("largest-contentful-paint",handleEntries);if(po){report=bindReporter.bindReporter(onReport,metric,LCPThresholds,opts.reportAllChanges);const stopListening=runOnce.runOnce(()=>{if(!reportedMetricIDs[metric.id]){handleEntries(po.takeRecords());po.disconnect();reportedMetricIDs[metric.id]=true;report(true)}});["keydown","click"].forEach(type=>{if(types.WINDOW.document){addEventListener(type,()=>whenIdle.whenIdle(stopListening),{once:true,capture:true})}});onHidden.onHidden(stopListening)}})};exports.LCPThresholds=LCPThresholds;exports.onLCP=onLCP},{"../../types.js":32,"./lib/bindReporter.js":17,"./lib/getActivationStart.js":19,"./lib/getVisibilityWatcher.js":21,"./lib/initMetric.js":22,"./lib/observe.js":24,"./lib/onHidden.js":25,"./lib/runOnce.js":27,"./lib/whenActivated.js":28,"./lib/whenIdle.js":29}],17:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const getRating=(value,thresholds)=>{if(value>thresholds[1]){return"poor"}if(value>thresholds[0]){return"needs-improvement"}return"good"};const bindReporter=(callback,metric,thresholds,reportAllChanges)=>{let prevValue;let delta;return forceReport=>{if(metric.value>=0){if(forceReport||reportAllChanges){delta=metric.value-(prevValue||0);if(delta||prevValue===undefined){prevValue=metric.value;metric.delta=delta;metric.rating=getRating(metric.value,thresholds);callback(metric)}}}}};exports.bindReporter=bindReporter},{}],18:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const generateUniqueID=()=>{return`v4-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`};exports.generateUniqueID=generateUniqueID},{}],19:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const getNavigationEntry=require("./getNavigationEntry.js");const getActivationStart=()=>{const navEntry=getNavigationEntry.getNavigationEntry();return navEntry&&navEntry.activationStart||0};exports.getActivationStart=getActivationStart},{"./getNavigationEntry.js":20}],20:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const types=require("../../../types.js");const getNavigationEntry=(checkResponseStart=true)=>{const navigationEntry=types.WINDOW.performance&&types.WINDOW.performance.getEntriesByType&&types.WINDOW.performance.getEntriesByType("navigation")[0];if(!checkResponseStart||navigationEntry&&navigationEntry.responseStart>0&&navigationEntry.responseStart<performance.now()){return navigationEntry}};exports.getNavigationEntry=getNavigationEntry},{"../../../types.js":32}],21:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const types=require("../../../types.js");let firstHiddenTime=-1;const initHiddenTime=()=>{return types.WINDOW.document.visibilityState==="hidden"&&!types.WINDOW.document.prerendering?0:Infinity};const onVisibilityUpdate=event=>{if(types.WINDOW.document.visibilityState==="hidden"&&firstHiddenTime>-1){firstHiddenTime=event.type==="visibilitychange"?event.timeStamp:0;removeChangeListeners()}};const addChangeListeners=()=>{addEventListener("visibilitychange",onVisibilityUpdate,true);addEventListener("prerenderingchange",onVisibilityUpdate,true)};const removeChangeListeners=()=>{removeEventListener("visibilitychange",onVisibilityUpdate,true);removeEventListener("prerenderingchange",onVisibilityUpdate,true)};const getVisibilityWatcher=()=>{if(types.WINDOW.document&&firstHiddenTime<0){firstHiddenTime=initHiddenTime();addChangeListeners()}return{get firstHiddenTime(){return firstHiddenTime}}};exports.getVisibilityWatcher=getVisibilityWatcher},{"../../../types.js":32}],22:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const types=require("../../../types.js");const generateUniqueID=require("./generateUniqueID.js");const getActivationStart=require("./getActivationStart.js");const getNavigationEntry=require("./getNavigationEntry.js");const initMetric=(name,value)=>{const navEntry=getNavigationEntry.getNavigationEntry();let navigationType="navigate";if(navEntry){if(types.WINDOW.document&&types.WINDOW.document.prerendering||getActivationStart.getActivationStart()>0){navigationType="prerender"}else if(types.WINDOW.document&&types.WINDOW.document.wasDiscarded){navigationType="restore"}else if(navEntry.type){navigationType=navEntry.type.replace(/_/g,"-")}}const entries=[];return{name:name,value:typeof value==="undefined"?-1:value,rating:"good",delta:0,entries:entries,id:generateUniqueID.generateUniqueID(),navigationType:navigationType}};exports.initMetric=initMetric},{"../../../types.js":32,"./generateUniqueID.js":18,"./getActivationStart.js":19,"./getNavigationEntry.js":20}],23:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const interactionCountPolyfill=require("./polyfills/interactionCountPolyfill.js");const longestInteractionList=[];const longestInteractionMap=new Map;const DEFAULT_DURATION_THRESHOLD=40;let prevInteractionCount=0;const getInteractionCountForNavigation=()=>{return interactionCountPolyfill.getInteractionCount()-prevInteractionCount};const estimateP98LongestInteraction=()=>{const candidateInteractionIndex=Math.min(longestInteractionList.length-1,Math.floor(getInteractionCountForNavigation()/50));return longestInteractionList[candidateInteractionIndex]};const MAX_INTERACTIONS_TO_CONSIDER=10;const entryPreProcessingCallbacks=[];const processInteractionEntry=entry=>{entryPreProcessingCallbacks.forEach(cb=>cb(entry));if(!(entry.interactionId||entry.entryType==="first-input"))return;const minLongestInteraction=longestInteractionList[longestInteractionList.length-1];const existingInteraction=longestInteractionMap.get(entry.interactionId);if(existingInteraction||longestInteractionList.length<MAX_INTERACTIONS_TO_CONSIDER||minLongestInteraction&&entry.duration>minLongestInteraction.latency){if(existingInteraction){if(entry.duration>existingInteraction.latency){existingInteraction.entries=[entry];existingInteraction.latency=entry.duration}else if(entry.duration===existingInteraction.latency&&entry.startTime===(existingInteraction.entries[0]&&existingInteraction.entries[0].startTime)){existingInteraction.entries.push(entry)}}else{const interaction={id:entry.interactionId,latency:entry.duration,entries:[entry]};longestInteractionMap.set(interaction.id,interaction);longestInteractionList.push(interaction)}longestInteractionList.sort((a,b)=>b.latency-a.latency);if(longestInteractionList.length>MAX_INTERACTIONS_TO_CONSIDER){longestInteractionList.splice(MAX_INTERACTIONS_TO_CONSIDER).forEach(i=>longestInteractionMap.delete(i.id))}}};exports.DEFAULT_DURATION_THRESHOLD=DEFAULT_DURATION_THRESHOLD;exports.entryPreProcessingCallbacks=entryPreProcessingCallbacks;exports.estimateP98LongestInteraction=estimateP98LongestInteraction;exports.longestInteractionList=longestInteractionList;exports.longestInteractionMap=longestInteractionMap;exports.processInteractionEntry=processInteractionEntry},{"./polyfills/interactionCountPolyfill.js":26}],24:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const observe=(type,callback,opts)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(type)){const po=new PerformanceObserver(list=>{Promise.resolve().then(()=>{callback(list.getEntries())})});po.observe(Object.assign({type:type,buffered:true},opts||{}));return po}}catch(e){}return};exports.observe=observe},{}],25:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const types=require("../../../types.js");const onHidden=cb=>{const onHiddenOrPageHide=event=>{if(event.type==="pagehide"||types.WINDOW.document&&types.WINDOW.document.visibilityState==="hidden"){cb(event)}};if(types.WINDOW.document){addEventListener("visibilitychange",onHiddenOrPageHide,true);addEventListener("pagehide",onHiddenOrPageHide,true)}};exports.onHidden=onHidden},{"../../../types.js":32}],26:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const observe=require("../observe.js");let interactionCountEstimate=0;let minKnownInteractionId=Infinity;let maxKnownInteractionId=0;const updateEstimate=entries=>{entries.forEach(e=>{if(e.interactionId){minKnownInteractionId=Math.min(minKnownInteractionId,e.interactionId);maxKnownInteractionId=Math.max(maxKnownInteractionId,e.interactionId);interactionCountEstimate=maxKnownInteractionId?(maxKnownInteractionId-minKnownInteractionId)/7+1:0}})};let po;const getInteractionCount=()=>{return po?interactionCountEstimate:performance.interactionCount||0};const initInteractionCountPolyfill=()=>{if("interactionCount"in performance||po)return;po=observe.observe("event",updateEstimate,{type:"event",buffered:true,durationThreshold:0})};exports.getInteractionCount=getInteractionCount;exports.initInteractionCountPolyfill=initInteractionCountPolyfill},{"../observe.js":24}],27:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const runOnce=cb=>{let called=false;return()=>{if(!called){cb();called=true}}};exports.runOnce=runOnce},{}],28:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const types=require("../../../types.js");const whenActivated=callback=>{if(types.WINDOW.document&&types.WINDOW.document.prerendering){addEventListener("prerenderingchange",()=>callback(),true)}else{callback()}};exports.whenActivated=whenActivated},{"../../../types.js":32}],29:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const types=require("../../../types.js");const onHidden=require("./onHidden.js");const runOnce=require("./runOnce.js");const whenIdle=cb=>{const rIC=types.WINDOW.requestIdleCallback||types.WINDOW.setTimeout;let handle=-1;cb=runOnce.runOnce(cb);if(types.WINDOW.document&&types.WINDOW.document.visibilityState==="hidden"){cb()}else{handle=rIC(cb);onHidden.onHidden(cb)}return handle};exports.whenIdle=whenIdle},{"../../../types.js":32,"./onHidden.js":25,"./runOnce.js":27}],30:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const bindReporter=require("./lib/bindReporter.js");const getActivationStart=require("./lib/getActivationStart.js");const getVisibilityWatcher=require("./lib/getVisibilityWatcher.js");const initMetric=require("./lib/initMetric.js");const observe=require("./lib/observe.js");const whenActivated=require("./lib/whenActivated.js");const FCPThresholds=[1800,3e3];const onFCP=(onReport,opts={})=>{whenActivated.whenActivated(()=>{const visibilityWatcher=getVisibilityWatcher.getVisibilityWatcher();const metric=initMetric.initMetric("FCP");let report;const handleEntries=entries=>{entries.forEach(entry=>{if(entry.name==="first-contentful-paint"){po.disconnect();if(entry.startTime<visibilityWatcher.firstHiddenTime){metric.value=Math.max(entry.startTime-getActivationStart.getActivationStart(),0);metric.entries.push(entry);report(true)}}})};const po=observe.observe("paint",handleEntries);if(po){report=bindReporter.bindReporter(onReport,metric,FCPThresholds,opts.reportAllChanges)}})};exports.FCPThresholds=FCPThresholds;exports.onFCP=onFCP},{"./lib/bindReporter.js":17,"./lib/getActivationStart.js":19,"./lib/getVisibilityWatcher.js":21,"./lib/initMetric.js":22,"./lib/observe.js":24,"./lib/whenActivated.js":28}],31:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const types=require("../../types.js");const bindReporter=require("./lib/bindReporter.js");const getActivationStart=require("./lib/getActivationStart.js");const getNavigationEntry=require("./lib/getNavigationEntry.js");const initMetric=require("./lib/initMetric.js");const whenActivated=require("./lib/whenActivated.js");const TTFBThresholds=[800,1800];const whenReady=callback=>{if(types.WINDOW.document&&types.WINDOW.document.prerendering){whenActivated.whenActivated(()=>whenReady(callback))}else if(types.WINDOW.document&&types.WINDOW.document.readyState!=="complete"){addEventListener("load",()=>whenReady(callback),true)}else{setTimeout(callback,0)}};const onTTFB=(onReport,opts={})=>{const metric=initMetric.initMetric("TTFB");const report=bindReporter.bindReporter(onReport,metric,TTFBThresholds,opts.reportAllChanges);whenReady(()=>{const navigationEntry=getNavigationEntry.getNavigationEntry();if(navigationEntry){metric.value=Math.max(navigationEntry.responseStart-getActivationStart.getActivationStart(),0);metric.entries=[navigationEntry];report(true)}})};exports.TTFBThresholds=TTFBThresholds;exports.onTTFB=onTTFB},{"../../types.js":32,"./lib/bindReporter.js":17,"./lib/getActivationStart.js":19,"./lib/getNavigationEntry.js":20,"./lib/initMetric.js":22,"./lib/whenActivated.js":28}],32:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const WINDOW=core.GLOBAL_OBJ;exports.WINDOW=WINDOW},{"@sentry/core":87}],33:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const WINDOW=core.GLOBAL_OBJ;const DOCUMENT=WINDOW.document;const NAVIGATOR=WINDOW.navigator;const TRIGGER_LABEL="Report a Bug";const CANCEL_BUTTON_LABEL="Cancel";const SUBMIT_BUTTON_LABEL="Send Bug Report";const CONFIRM_BUTTON_LABEL="Confirm";const FORM_TITLE="Report a Bug";const EMAIL_PLACEHOLDER="your.email@example.org";const EMAIL_LABEL="Email";const MESSAGE_PLACEHOLDER="What's the bug? What did you expect?";const MESSAGE_LABEL="Description";const NAME_PLACEHOLDER="Your Name";const NAME_LABEL="Name";const SUCCESS_MESSAGE_TEXT="Thank you for your report!";const IS_REQUIRED_LABEL="(required)";const ADD_SCREENSHOT_LABEL="Add a screenshot";const REMOVE_SCREENSHOT_LABEL="Remove screenshot";const FEEDBACK_WIDGET_SOURCE="widget";const FEEDBACK_API_SOURCE="api";const SUCCESS_MESSAGE_TIMEOUT=5e3;const sendFeedback=(params,hint={includeReplay:true})=>{if(!params.message){throw new Error("Unable to submit feedback with empty message")}const client=core.getClient();if(!client){throw new Error("No client setup, cannot send feedback.")}if(params.tags&&Object.keys(params.tags).length){core.getCurrentScope().setTags(params.tags)}const eventId=core.captureFeedback({source:FEEDBACK_API_SOURCE,url:core.getLocationHref(),...params},hint);return new Promise((resolve,reject)=>{const timeout=setTimeout(()=>reject("Unable to determine if Feedback was correctly sent."),5e3);const cleanup=client.on("afterSendEvent",(event,response)=>{if(event.event_id!==eventId){return}clearTimeout(timeout);cleanup();if(response&&typeof response.statusCode==="number"&&response.statusCode>=200&&response.statusCode<300){return resolve(eventId)}if(response&&typeof response.statusCode==="number"&&response.statusCode===0){return reject("Unable to send Feedback. This is because of network issues, or because you are using an ad-blocker.")}if(response&&typeof response.statusCode==="number"&&response.statusCode===403){return reject("Unable to send Feedback. This could be because this domain is not in your list of allowed domains.")}return reject("Unable to send Feedback. This could be because of network issues, or because you are using an ad-blocker")})})};const DEBUG_BUILD=typeof __SENTRY_DEBUG__==="undefined"||__SENTRY_DEBUG__;function isScreenshotSupported(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(NAVIGATOR.userAgent)){return false}if(/Macintosh/i.test(NAVIGATOR.userAgent)&&NAVIGATOR.maxTouchPoints&&NAVIGATOR.maxTouchPoints>1){return false}if(!isSecureContext){return false}return true}function mergeOptions(defaultOptions,optionOverrides){return{...defaultOptions,...optionOverrides,tags:{...defaultOptions.tags,...optionOverrides.tags},onFormOpen:()=>{optionOverrides.onFormOpen&&optionOverrides.onFormOpen();defaultOptions.onFormOpen&&defaultOptions.onFormOpen()},onFormClose:()=>{optionOverrides.onFormClose&&optionOverrides.onFormClose();defaultOptions.onFormClose&&defaultOptions.onFormClose()},onSubmitSuccess:data=>{optionOverrides.onSubmitSuccess&&optionOverrides.onSubmitSuccess(data);defaultOptions.onSubmitSuccess&&defaultOptions.onSubmitSuccess(data)},onSubmitError:error=>{optionOverrides.onSubmitError&&optionOverrides.onSubmitError(error);defaultOptions.onSubmitError&&defaultOptions.onSubmitError(error)},onFormSubmitted:()=>{optionOverrides.onFormSubmitted&&optionOverrides.onFormSubmitted();defaultOptions.onFormSubmitted&&defaultOptions.onFormSubmitted()},themeDark:{...defaultOptions.themeDark,...optionOverrides.themeDark},themeLight:{...defaultOptions.themeLight,...optionOverrides.themeLight}}}function createActorStyles(styleNonce){const style=DOCUMENT.createElement("style");style.textContent=`
.widget__actor {
  position: fixed;
  z-index: var(--z-index);
  margin: var(--page-margin);
  inset: var(--actor-inset);

  display: flex;
  align-items: center;
  gap: 8px;
  padding: 16px;

  font-family: inherit;
  font-size: var(--font-size);
  font-weight: 600;
  line-height: 1.14em;
  text-decoration: none;

  background: var(--actor-background, var(--background));
  border-radius: var(--actor-border-radius, 1.7em/50%);
  border: var(--actor-border, var(--border));
  box-shadow: var(--actor-box-shadow, var(--box-shadow));
  color: var(--actor-color, var(--foreground));
  fill: var(--actor-color, var(--foreground));
  cursor: pointer;
  opacity: 1;
  transition: transform 0.2s ease-in-out;
  transform: translate(0, 0) scale(1);
}
.widget__actor[aria-hidden="true"] {
  opacity: 0;
  pointer-events: none;
  visibility: hidden;
  transform: translate(0, 16px) scale(0.98);
}

.widget__actor:hover {
  background: var(--actor-hover-background, var(--background));
  filter: var(--interactive-filter);
}

.widget__actor svg {
  width: 1.14em;
  height: 1.14em;
}

@media (max-width: 600px) {
  .widget__actor span {
    display: none;
  }
}
`;if(styleNonce){style.setAttribute("nonce",styleNonce)}return style}function setAttributesNS(el,attributes){Object.entries(attributes).forEach(([key,val])=>{el.setAttributeNS(null,key,val)});return el}const SIZE=20;const XMLNS$2="http://www.w3.org/2000/svg";function FeedbackIcon(){const createElementNS=tagName=>WINDOW.document.createElementNS(XMLNS$2,tagName);const svg=setAttributesNS(createElementNS("svg"),{width:`${SIZE}`,height:`${SIZE}`,viewBox:`0 0 ${SIZE} ${SIZE}`,fill:"var(--actor-color, var(--foreground))"});const g=setAttributesNS(createElementNS("g"),{clipPath:"url(#clip0_57_80)"});const path=setAttributesNS(createElementNS("path"),{["fill-rule"]:"evenodd",["clip-rule"]:"evenodd",d:"M15.6622 15H12.3997C12.2129 14.9959 12.031 14.9396 11.8747 14.8375L8.04965 12.2H7.49956V19.1C7.4875 19.3348 7.3888 19.5568 7.22256 19.723C7.05632 19.8892 6.83435 19.9879 6.59956 20H2.04956C1.80193 19.9968 1.56535 19.8969 1.39023 19.7218C1.21511 19.5467 1.1153 19.3101 1.11206 19.0625V12.2H0.949652C0.824431 12.2017 0.700142 12.1783 0.584123 12.1311C0.468104 12.084 0.362708 12.014 0.274155 11.9255C0.185602 11.8369 0.115689 11.7315 0.0685419 11.6155C0.0213952 11.4995 -0.00202913 11.3752 -0.00034808 11.25V3.75C-0.00900498 3.62067 0.0092504 3.49095 0.0532651 3.36904C0.0972798 3.24712 0.166097 3.13566 0.255372 3.04168C0.344646 2.94771 0.452437 2.87327 0.571937 2.82307C0.691437 2.77286 0.82005 2.74798 0.949652 2.75H8.04965L11.8747 0.1625C12.031 0.0603649 12.2129 0.00407221 12.3997 0H15.6622C15.9098 0.00323746 16.1464 0.103049 16.3215 0.278167C16.4966 0.453286 16.5964 0.689866 16.5997 0.9375V3.25269C17.3969 3.42959 18.1345 3.83026 18.7211 4.41679C19.5322 5.22788 19.9878 6.32796 19.9878 7.47502C19.9878 8.62209 19.5322 9.72217 18.7211 10.5333C18.1345 11.1198 17.3969 11.5205 16.5997 11.6974V14.0125C16.6047 14.1393 16.5842 14.2659 16.5395 14.3847C16.4948 14.5035 16.4268 14.6121 16.3394 14.7042C16.252 14.7962 16.147 14.8698 16.0307 14.9206C15.9144 14.9714 15.7891 14.9984 15.6622 15ZM1.89695 10.325H1.88715V4.625H8.33715C8.52423 4.62301 8.70666 4.56654 8.86215 4.4625L12.6872 1.875H14.7247V13.125H12.6872L8.86215 10.4875C8.70666 10.3835 8.52423 10.327 8.33715 10.325H2.20217C2.15205 10.3167 2.10102 10.3125 2.04956 10.3125C1.9981 10.3125 1.94708 10.3167 1.89695 10.325ZM2.98706 12.2V18.1625H5.66206V12.2H2.98706ZM16.5997 9.93612V5.01393C16.6536 5.02355 16.7072 5.03495 16.7605 5.04814C17.1202 5.13709 17.4556 5.30487 17.7425 5.53934C18.0293 5.77381 18.2605 6.06912 18.4192 6.40389C18.578 6.73866 18.6603 7.10452 18.6603 7.47502C18.6603 7.84552 18.578 8.21139 18.4192 8.54616C18.2605 8.88093 18.0293 9.17624 17.7425 9.41071C17.4556 9.64518 17.1202 9.81296 16.7605 9.90191C16.7072 9.91509 16.6536 9.9265 16.5997 9.93612Z"});svg.appendChild(g).appendChild(path);const speakerDefs=createElementNS("defs");const speakerClipPathDef=setAttributesNS(createElementNS("clipPath"),{id:"clip0_57_80"});const speakerRect=setAttributesNS(createElementNS("rect"),{width:`${SIZE}`,height:`${SIZE}`,fill:"white"});speakerClipPathDef.appendChild(speakerRect);speakerDefs.appendChild(speakerClipPathDef);svg.appendChild(speakerDefs).appendChild(speakerClipPathDef).appendChild(speakerRect);return svg}function Actor({triggerLabel,triggerAriaLabel,shadow,styleNonce}){const el=DOCUMENT.createElement("button");el.type="button";el.className="widget__actor";el.ariaHidden="false";el.ariaLabel=triggerAriaLabel||triggerLabel||TRIGGER_LABEL;el.appendChild(FeedbackIcon());if(triggerLabel){const label=DOCUMENT.createElement("span");label.appendChild(DOCUMENT.createTextNode(triggerLabel));el.appendChild(label)}const style=createActorStyles(styleNonce);return{el:el,appendToDom(){shadow.appendChild(style);shadow.appendChild(el)},removeFromDom(){shadow.removeChild(el);shadow.removeChild(style)},show(){el.ariaHidden="false"},hide(){el.ariaHidden="true"}}}const PURPLE="rgba(88, 74, 192, 1)";const DEFAULT_LIGHT={foreground:"#2b2233",background:"#ffffff",accentForeground:"white",accentBackground:PURPLE,successColor:"#268d75",errorColor:"#df3338",border:"1.5px solid rgba(41, 35, 47, 0.13)",boxShadow:"0px 4px 24px 0px rgba(43, 34, 51, 0.12)",outline:"1px auto var(--accent-background)",interactiveFilter:"brightness(95%)"};const DEFAULT_DARK={foreground:"#ebe6ef",background:"#29232f",accentForeground:"white",accentBackground:PURPLE,successColor:"#2da98c",errorColor:"#f55459",border:"1.5px solid rgba(235, 230, 239, 0.15)",boxShadow:"0px 4px 24px 0px rgba(43, 34, 51, 0.12)",outline:"1px auto var(--accent-background)",interactiveFilter:"brightness(150%)"};function getThemedCssVariables(theme){return`
  --foreground: ${theme.foreground};
  --background: ${theme.background};
  --accent-foreground: ${theme.accentForeground};
  --accent-background: ${theme.accentBackground};
  --success-color: ${theme.successColor};
  --error-color: ${theme.errorColor};
  --border: ${theme.border};
  --box-shadow: ${theme.boxShadow};
  --outline: ${theme.outline};
  --interactive-filter: ${theme.interactiveFilter};
  `}function createMainStyles({colorScheme,themeDark,themeLight,styleNonce}){const style=DOCUMENT.createElement("style");style.textContent=`
:host {
  --font-family: system-ui, 'Helvetica Neue', Arial, sans-serif;
  --font-size: 14px;
  --z-index: 100000;

  --page-margin: 16px;
  --inset: auto 0 0 auto;
  --actor-inset: var(--inset);

  font-family: var(--font-family);
  font-size: var(--font-size);

  ${colorScheme!=="system"?"color-scheme: only light;":""}

  ${getThemedCssVariables(colorScheme==="dark"?{...DEFAULT_DARK,...themeDark}:{...DEFAULT_LIGHT,...themeLight})}
}

${colorScheme==="system"?`
@media (prefers-color-scheme: dark) {
  :host {
    ${getThemedCssVariables({...DEFAULT_DARK,...themeDark})}
  }
}`:""}
}
`;if(styleNonce){style.setAttribute("nonce",styleNonce)}return style}const buildFeedbackIntegration=({lazyLoadIntegration,getModalIntegration,getScreenshotIntegration})=>{const feedbackIntegration=({id="sentry-feedback",autoInject=true,showBranding=true,isEmailRequired=false,isNameRequired=false,showEmail=true,showName=true,enableScreenshot=true,useSentryUser={email:"email",name:"username"},tags,styleNonce,scriptNonce,colorScheme="system",themeLight={},themeDark={},addScreenshotButtonLabel=ADD_SCREENSHOT_LABEL,cancelButtonLabel=CANCEL_BUTTON_LABEL,confirmButtonLabel=CONFIRM_BUTTON_LABEL,emailLabel=EMAIL_LABEL,emailPlaceholder=EMAIL_PLACEHOLDER,formTitle=FORM_TITLE,isRequiredLabel=IS_REQUIRED_LABEL,messageLabel=MESSAGE_LABEL,messagePlaceholder=MESSAGE_PLACEHOLDER,nameLabel=NAME_LABEL,namePlaceholder=NAME_PLACEHOLDER,removeScreenshotButtonLabel=REMOVE_SCREENSHOT_LABEL,submitButtonLabel=SUBMIT_BUTTON_LABEL,successMessageText=SUCCESS_MESSAGE_TEXT,triggerLabel=TRIGGER_LABEL,triggerAriaLabel="",onFormOpen,onFormClose,onSubmitSuccess,onSubmitError,onFormSubmitted}={})=>{const _options={id:id,autoInject:autoInject,showBranding:showBranding,isEmailRequired:isEmailRequired,isNameRequired:isNameRequired,showEmail:showEmail,showName:showName,enableScreenshot:enableScreenshot,useSentryUser:useSentryUser,tags:tags,styleNonce:styleNonce,scriptNonce:scriptNonce,colorScheme:colorScheme,themeDark:themeDark,themeLight:themeLight,triggerLabel:triggerLabel,triggerAriaLabel:triggerAriaLabel,cancelButtonLabel:cancelButtonLabel,submitButtonLabel:submitButtonLabel,confirmButtonLabel:confirmButtonLabel,formTitle:formTitle,emailLabel:emailLabel,emailPlaceholder:emailPlaceholder,messageLabel:messageLabel,messagePlaceholder:messagePlaceholder,nameLabel:nameLabel,namePlaceholder:namePlaceholder,successMessageText:successMessageText,isRequiredLabel:isRequiredLabel,addScreenshotButtonLabel:addScreenshotButtonLabel,removeScreenshotButtonLabel:removeScreenshotButtonLabel,onFormClose:onFormClose,onFormOpen:onFormOpen,onSubmitError:onSubmitError,onSubmitSuccess:onSubmitSuccess,onFormSubmitted:onFormSubmitted};let _shadow=null;let _subscriptions=[];const _createShadow=options=>{if(!_shadow){const host=DOCUMENT.createElement("div");host.id=String(options.id);DOCUMENT.body.appendChild(host);_shadow=host.attachShadow({mode:"open"});_shadow.appendChild(createMainStyles(options))}return _shadow};const _loadAndRenderDialog=async options=>{const screenshotRequired=options.enableScreenshot&&isScreenshotSupported();let modalIntegration;let screenshotIntegration;try{const modalIntegrationFn=getModalIntegration?getModalIntegration():await lazyLoadIntegration("feedbackModalIntegration",scriptNonce);modalIntegration=modalIntegrationFn();core.addIntegration(modalIntegration)}catch(e){DEBUG_BUILD&&core.logger.error("[Feedback] Error when trying to load feedback integrations. Try using `feedbackSyncIntegration` in your `Sentry.init`.");throw new Error("[Feedback] Missing feedback modal integration!")}try{const screenshotIntegrationFn=screenshotRequired?getScreenshotIntegration?getScreenshotIntegration():await lazyLoadIntegration("feedbackScreenshotIntegration",scriptNonce):undefined;if(screenshotIntegrationFn){screenshotIntegration=screenshotIntegrationFn();core.addIntegration(screenshotIntegration)}}catch(e2){DEBUG_BUILD&&core.logger.error("[Feedback] Missing feedback screenshot integration. Proceeding without screenshots.")}const dialog=modalIntegration.createDialog({options:{...options,onFormClose:()=>{dialog&&dialog.close();options.onFormClose&&options.onFormClose()},onFormSubmitted:()=>{dialog&&dialog.close();options.onFormSubmitted&&options.onFormSubmitted()}},screenshotIntegration:screenshotIntegration,sendFeedback:sendFeedback,shadow:_createShadow(options)});return dialog};const _attachTo=(el,optionOverrides={})=>{const mergedOptions=mergeOptions(_options,optionOverrides);const targetEl=typeof el==="string"?DOCUMENT.querySelector(el):typeof el.addEventListener==="function"?el:null;if(!targetEl){DEBUG_BUILD&&core.logger.error("[Feedback] Unable to attach to target element");throw new Error("Unable to attach to target element")}let dialog=null;const handleClick=async()=>{if(!dialog){dialog=await _loadAndRenderDialog({...mergedOptions,onFormSubmitted:()=>{dialog&&dialog.removeFromDom();mergedOptions.onFormSubmitted&&mergedOptions.onFormSubmitted()}})}dialog.appendToDom();dialog.open()};targetEl.addEventListener("click",handleClick);const unsubscribe=()=>{_subscriptions=_subscriptions.filter(sub=>sub!==unsubscribe);dialog&&dialog.removeFromDom();dialog=null;targetEl.removeEventListener("click",handleClick)};_subscriptions.push(unsubscribe);return unsubscribe};const _createActor=(optionOverrides={})=>{const mergedOptions=mergeOptions(_options,optionOverrides);const shadow=_createShadow(mergedOptions);const actor=Actor({triggerLabel:mergedOptions.triggerLabel,triggerAriaLabel:mergedOptions.triggerAriaLabel,shadow:shadow,styleNonce:styleNonce});_attachTo(actor.el,{...mergedOptions,onFormOpen(){actor.hide()},onFormClose(){actor.show()},onFormSubmitted(){actor.show()}});return actor};return{name:"Feedback",setupOnce(){if(!core.isBrowser()||!_options.autoInject){return}if(DOCUMENT.readyState==="loading"){DOCUMENT.addEventListener("DOMContentLoaded",()=>_createActor().appendToDom())}else{_createActor().appendToDom()}},attachTo:_attachTo,createWidget(optionOverrides={}){const actor=_createActor(mergeOptions(_options,optionOverrides));actor.appendToDom();return actor},async createForm(optionOverrides={}){return _loadAndRenderDialog(mergeOptions(_options,optionOverrides))},remove(){if(_shadow){_shadow.parentElement&&_shadow.parentElement.remove();_shadow=null}_subscriptions.forEach(sub=>sub());_subscriptions=[]}}};return feedbackIntegration};function getFeedback(){const client=core.getClient();return client&&client.getIntegrationByName("Feedback")}var n,l$1,u$1,i$1,o$1,r$1,f$1,c$1={},s$1=[],a$1=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,h$1=Array.isArray;function v$1(n,l){for(var u in l)n[u]=l[u];return n}function p$1(n){var l=n.parentNode;l&&l.removeChild(n)}function y$1(l,u,t){var i,o,r,f={};for(r in u)"key"==r?i=u[r]:"ref"==r?o=u[r]:f[r]=u[r];if(arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):t),"function"==typeof l&&null!=l.defaultProps)for(r in l.defaultProps)void 0===f[r]&&(f[r]=l.defaultProps[r]);return d$1(l,f,i,o,null)}function d$1(n,t,i,o,r){var f={type:n,props:t,key:i,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==r?++u$1:r,__i:-1,__u:0};return null==r&&null!=l$1.vnode&&l$1.vnode(f),f}function g$1(n){return n.children}function b$1(n,l){this.props=n,this.context=l}function m$1(n,l){if(null==l)return n.__?m$1(n.__,n.__i+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return"function"==typeof n.type?m$1(n):null}function w$1(n,u,t){var i,o=n.__v,r=o.__e,f=n.__P;if(f)return(i=v$1({},o)).__v=o.__v+1,l$1.vnode&&l$1.vnode(i),M(f,i,o,n.__n,void 0!==f.ownerSVGElement,32&o.__u?[r]:null,u,null==r?m$1(o):r,!!(32&o.__u),t),i.__.__k[i.__i]=i,i.__d=void 0,i.__e!=r&&k$1(i),i}function k$1(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return k$1(n)}}function x$1(n){(!n.__d&&(n.__d=!0)&&i$1.push(n)&&!C$1.__r++||o$1!==l$1.debounceRendering)&&((o$1=l$1.debounceRendering)||r$1)(C$1)}function C$1(){var n,u,t,o=[],r=[];for(i$1.sort(f$1);n=i$1.shift();)n.__d&&(t=i$1.length,u=w$1(n,o,r)||u,0===t||i$1.length>t?(j$1(o,u,r),r.length=o.length=0,u=void 0,i$1.sort(f$1)):u&&l$1.__c&&l$1.__c(u,s$1));u&&j$1(o,u,r),C$1.__r=0}function P$1(n,l,u,t,i,o,r,f,e,a,h){var v,p,y,d,_,g=t&&t.__k||s$1,b=l.length;for(u.__d=e,S(u,l,g),e=u.__d,v=0;v<b;v++)null!=(y=u.__k[v])&&"boolean"!=typeof y&&"function"!=typeof y&&(p=-1===y.__i?c$1:g[y.__i]||c$1,y.__i=v,M(n,y,p,i,o,r,f,e,a,h),d=y.__e,y.ref&&p.ref!=y.ref&&(p.ref&&N(p.ref,null,y),h.push(y.ref,y.__c||d,y)),null==_&&null!=d&&(_=d),65536&y.__u||p.__k===y.__k?e=$(y,e,n):"function"==typeof y.type&&void 0!==y.__d?e=y.__d:d&&(e=d.nextSibling),y.__d=void 0,y.__u&=-196609);u.__d=e,u.__e=_}function S(n,l,u){var t,i,o,r,f,e=l.length,c=u.length,s=c,a=0;for(n.__k=[],t=0;t<e;t++)null!=(i=n.__k[t]=null==(i=l[t])||"boolean"==typeof i||"function"==typeof i?null:"string"==typeof i||"number"==typeof i||"bigint"==typeof i||i.constructor==String?d$1(null,i,null,null,i):h$1(i)?d$1(g$1,{children:i},null,null,null):void 0===i.constructor&&i.__b>0?d$1(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i)?(i.__=n,i.__b=n.__b+1,f=I(i,u,r=t+a,s),i.__i=f,o=null,-1!==f&&(s--,(o=u[f])&&(o.__u|=131072)),null==o||null===o.__v?(-1==f&&a--,"function"!=typeof i.type&&(i.__u|=65536)):f!==r&&(f===r+1?a++:f>r?s>e-r?a+=f-r:a--:a=f<r&&f==r-1?f-r:0,f!==t+a&&(i.__u|=65536))):(o=u[t])&&null==o.key&&o.__e&&(o.__e==n.__d&&(n.__d=m$1(o)),O(o,o,!1),u[t]=null,s--);if(s)for(t=0;t<c;t++)null!=(o=u[t])&&0==(131072&o.__u)&&(o.__e==n.__d&&(n.__d=m$1(o)),O(o,o))}function $(n,l,u){var t,i;if("function"==typeof n.type){for(t=n.__k,i=0;t&&i<t.length;i++)t[i]&&(t[i].__=n,l=$(t[i],l,u));return l}n.__e!=l&&(u.insertBefore(n.__e,l||null),l=n.__e);do{l=l&&l.nextSibling}while(null!=l&&8===l.nodeType);return l}function I(n,l,u,t){var i=n.key,o=n.type,r=u-1,f=u+1,e=l[u];if(null===e||e&&i==e.key&&o===e.type)return u;if(t>(null!=e&&0==(131072&e.__u)?1:0))for(;r>=0||f<l.length;){if(r>=0){if((e=l[r])&&0==(131072&e.__u)&&i==e.key&&o===e.type)return r;r--}if(f<l.length){if((e=l[f])&&0==(131072&e.__u)&&i==e.key&&o===e.type)return f;f++}}return-1}function T$1(n,l,u){"-"===l[0]?n.setProperty(l,null==u?"":u):n[l]=null==u?"":"number"!=typeof u||a$1.test(l)?u:u+"px"}function A$1(n,l,u,t,i){var o;n:if("style"===l)if("string"==typeof u)n.style.cssText=u;else{if("string"==typeof t&&(n.style.cssText=t=""),t)for(l in t)u&&l in u||T$1(n.style,l,"");if(u)for(l in u)t&&u[l]===t[l]||T$1(n.style,l,u[l])}else if("o"===l[0]&&"n"===l[1])o=l!==(l=l.replace(/(PointerCapture)$|Capture$/i,"$1")),l=l.toLowerCase()in n?l.toLowerCase().slice(2):l.slice(2),n.l||(n.l={}),n.l[l+o]=u,u?t?u.u=t.u:(u.u=Date.now(),n.addEventListener(l,o?L:D$1,o)):n.removeEventListener(l,o?L:D$1,o);else{if(i)l=l.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==l&&"height"!==l&&"href"!==l&&"list"!==l&&"form"!==l&&"tabIndex"!==l&&"download"!==l&&"rowSpan"!==l&&"colSpan"!==l&&"role"!==l&&l in n)try{n[l]=null==u?"":u;break n}catch(n){}"function"==typeof u||(null==u||!1===u&&"-"!==l[4]?n.removeAttribute(l):n.setAttribute(l,u))}}function D$1(n){if(this.l){var u=this.l[n.type+!1];if(n.t){if(n.t<=u.u)return}else n.t=Date.now();return u(l$1.event?l$1.event(n):n)}}function L(n){if(this.l)return this.l[n.type+!0](l$1.event?l$1.event(n):n)}function M(n,u,t,i,o,r,f,e,c,s){var a,p,y,d,_,m,w,k,x,C,S,$,H,I,T,A=u.type;if(void 0!==u.constructor)return null;128&t.__u&&(c=!!(32&t.__u),r=[e=u.__e=t.__e]),(a=l$1.__b)&&a(u);n:if("function"==typeof A)try{if(k=u.props,x=(a=A.contextType)&&i[a.__c],C=a?x?x.props.value:a.__:i,t.__c?w=(p=u.__c=t.__c).__=p.__E:("prototype"in A&&A.prototype.render?u.__c=p=new A(k,C):(u.__c=p=new b$1(k,C),p.constructor=A,p.render=q$1),x&&x.sub(p),p.props=k,p.state||(p.state={}),p.context=C,p.__n=i,y=p.__d=!0,p.__h=[],p._sb=[]),null==p.__s&&(p.__s=p.state),null!=A.getDerivedStateFromProps&&(p.__s==p.state&&(p.__s=v$1({},p.__s)),v$1(p.__s,A.getDerivedStateFromProps(k,p.__s))),d=p.props,_=p.state,p.__v=u,y)null==A.getDerivedStateFromProps&&null!=p.componentWillMount&&p.componentWillMount(),null!=p.componentDidMount&&p.__h.push(p.componentDidMount);else{if(null==A.getDerivedStateFromProps&&k!==d&&null!=p.componentWillReceiveProps&&p.componentWillReceiveProps(k,C),!p.__e&&(null!=p.shouldComponentUpdate&&!1===p.shouldComponentUpdate(k,p.__s,C)||u.__v===t.__v)){for(u.__v!==t.__v&&(p.props=k,p.state=p.__s,p.__d=!1),u.__e=t.__e,u.__k=t.__k,u.__k.forEach(function(n){n&&(n.__=u)}),S=0;S<p._sb.length;S++)p.__h.push(p._sb[S]);p._sb=[],p.__h.length&&f.push(p);break n}null!=p.componentWillUpdate&&p.componentWillUpdate(k,p.__s,C),null!=p.componentDidUpdate&&p.__h.push(function(){p.componentDidUpdate(d,_,m)})}if(p.context=C,p.props=k,p.__P=n,p.__e=!1,$=l$1.__r,H=0,"prototype"in A&&A.prototype.render){for(p.state=p.__s,p.__d=!1,$&&$(u),a=p.render(p.props,p.state,p.context),I=0;I<p._sb.length;I++)p.__h.push(p._sb[I]);p._sb=[]}else do{p.__d=!1,$&&$(u),a=p.render(p.props,p.state,p.context),p.state=p.__s}while(p.__d&&++H<25);p.state=p.__s,null!=p.getChildContext&&(i=v$1(v$1({},i),p.getChildContext())),y||null==p.getSnapshotBeforeUpdate||(m=p.getSnapshotBeforeUpdate(d,_)),P$1(n,h$1(T=null!=a&&a.type===g$1&&null==a.key?a.props.children:a)?T:[T],u,t,i,o,r,f,e,c,s),p.base=u.__e,u.__u&=-161,p.__h.length&&f.push(p),w&&(p.__E=p.__=null)}catch(n){u.__v=null,c||null!=r?(u.__e=e,u.__u|=c?160:32,r[r.indexOf(e)]=null):(u.__e=t.__e,u.__k=t.__k),l$1.__e(n,u,t)}else null==r&&u.__v===t.__v?(u.__k=t.__k,u.__e=t.__e):u.__e=z$1(t.__e,u,t,i,o,r,f,c,s);(a=l$1.diffed)&&a(u)}function j$1(n,u,t){for(var i=0;i<t.length;i++)N(t[i],t[++i],t[++i]);l$1.__c&&l$1.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l$1.__e(n,u.__v)}})}function z$1(l,u,t,i,o,r,f,e,s){var a,v,y,d,_,g,b,w=t.props,k=u.props,x=u.type;if("svg"===x&&(o=!0),null!=r)for(a=0;a<r.length;a++)if((_=r[a])&&"setAttribute"in _==!!x&&(x?_.localName===x:3===_.nodeType)){l=_,r[a]=null;break}if(null==l){if(null===x)return document.createTextNode(k);l=o?document.createElementNS("http://www.w3.org/2000/svg",x):document.createElement(x,k.is&&k),r=null,e=!1}if(null===x)w===k||e&&l.data===k||(l.data=k);else{if(r=r&&n.call(l.childNodes),w=t.props||c$1,!e&&null!=r)for(w={},a=0;a<l.attributes.length;a++)w[(_=l.attributes[a]).name]=_.value;for(a in w)_=w[a],"children"==a||("dangerouslySetInnerHTML"==a?y=_:"key"===a||a in k||A$1(l,a,null,_,o));for(a in k)_=k[a],"children"==a?d=_:"dangerouslySetInnerHTML"==a?v=_:"value"==a?g=_:"checked"==a?b=_:"key"===a||e&&"function"!=typeof _||w[a]===_||A$1(l,a,_,w[a],o);if(v)e||y&&(v.__html===y.__html||v.__html===l.innerHTML)||(l.innerHTML=v.__html),u.__k=[];else if(y&&(l.innerHTML=""),P$1(l,h$1(d)?d:[d],u,t,i,o&&"foreignObject"!==x,r,f,r?r[0]:t.__k&&m$1(t,0),e,s),null!=r)for(a=r.length;a--;)null!=r[a]&&p$1(r[a]);e||(a="value",void 0!==g&&(g!==l[a]||"progress"===x&&!g||"option"===x&&g!==w[a])&&A$1(l,a,g,w[a],!1),a="checked",void 0!==b&&b!==l[a]&&A$1(l,a,b,w[a],!1))}return l}function N(n,u,t){try{"function"==typeof n?n(u):n.current=u}catch(n){l$1.__e(n,t)}}function O(n,u,t){var i,o;if(l$1.unmount&&l$1.unmount(n),(i=n.ref)&&(i.current&&i.current!==n.__e||N(i,null,u)),null!=(i=n.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(n){l$1.__e(n,u)}i.base=i.__P=null,n.__c=void 0}if(i=n.__k)for(o=0;o<i.length;o++)i[o]&&O(i[o],u,t||"function"!=typeof n.type);t||null==n.__e||p$1(n.__e),n.__=n.__e=n.__d=void 0}function q$1(n,l,u){return this.constructor(n,u)}function B$1(u,t,i){var o,r,f,e;l$1.__&&l$1.__(u,t),r=(o="function"==typeof i)?null:t.__k,f=[],e=[],M(t,u=(!o&&i||t).__k=y$1(g$1,null,[u]),r||c$1,c$1,void 0!==t.ownerSVGElement,!o&&i?[i]:r?null:t.firstChild?n.call(t.childNodes):null,f,!o&&i?i:r?r.__e:t.firstChild,o,e),u.__d=void 0,j$1(f,u,e)}n=s$1.slice,l$1={__e:function(n,l,u,t){for(var i,o,r;l=l.__;)if((i=l.__c)&&!i.__)try{if((o=i.constructor)&&null!=o.getDerivedStateFromError&&(i.setState(o.getDerivedStateFromError(n)),r=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(n,t||{}),r=i.__d),r)return i.__E=i}catch(l){n=l}throw n}},u$1=0,b$1.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=v$1({},this.state),"function"==typeof n&&(n=n(v$1({},u),this.props)),n&&v$1(u,n),null!=n&&this.__v&&(l&&this._sb.push(l),x$1(this))},b$1.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),x$1(this))},b$1.prototype.render=g$1,i$1=[],r$1="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,f$1=function(n,l){return n.__v.__b-l.__v.__b},C$1.__r=0;var t,r,u,i,o=0,f=[],c=[],e=l$1,a=e.__b,v=e.__r,l=e.diffed,m=e.__c,s=e.unmount,d=e.__;function h(n,t){e.__h&&e.__h(r,n,o||t),o=0;var u=r.__H||(r.__H={__:[],__h:[]});return n>=u.__.length&&u.__.push({__V:c}),u.__[n]}function p(n){return o=1,y(D,n)}function y(n,u,i){var o=h(t++,2);if(o.t=n,!o.__c&&(o.__=[i?i(u):D(void 0,u),function(n){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,n);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=r,!r.u)){var f=function(n,t,r){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(n){return!!n.__c});if(u.every(function(n){return!n.__N}))return!c||c.call(this,n,t,r);var i=!1;return u.forEach(function(n){if(n.__N){var t=n.__[0];n.__=n.__N,n.__N=void 0,t!==n.__[0]&&(i=!0)}}),!(!i&&o.__c.props===n)&&(!c||c.call(this,n,t,r))};r.u=!0;var c=r.shouldComponentUpdate,e=r.componentWillUpdate;r.componentWillUpdate=function(n,t,r){if(this.__e){var u=c;c=void 0,f(n,t,r),c=u}e&&e.call(this,n,t,r)},r.shouldComponentUpdate=f}return o.__N||o.__}function _(n,u){var i=h(t++,3);!e.__s&&C(i.__H,u)&&(i.__=n,i.i=u,r.__H.__h.push(i))}function A(n,u){var i=h(t++,4);!e.__s&&C(i.__H,u)&&(i.__=n,i.i=u,r.__h.push(i))}function F(n){return o=5,q(function(){return{current:n}},[])}function T(n,t,r){o=6,A(function(){return"function"==typeof n?(n(t()),function(){return n(null)}):n?(n.current=t(),function(){return n.current=null}):void 0},null==r?r:r.concat(n))}function q(n,r){var u=h(t++,7);return C(u.__H,r)?(u.__V=n(),u.i=r,u.__h=n,u.__V):u.__}function x(n,t){return o=8,q(function(){return n},t)}function P(n){var u=r.context[n.__c],i=h(t++,9);return i.c=n,u?(null==i.__&&(i.__=!0,u.sub(r)),u.props.value):n.__}function V(n,t){e.useDebugValue&&e.useDebugValue(t?t(n):n)}function b(n){var u=h(t++,10),i=p();return u.__=n,r.componentDidCatch||(r.componentDidCatch=function(n,t){u.__&&u.__(n,t),i[1](n)}),[i[0],function(){i[1](void 0)}]}function g(){var n=h(t++,11);if(!n.__){for(var u=r.__v;null!==u&&!u.__m&&null!==u.__;)u=u.__;var i=u.__m||(u.__m=[0,0]);n.__="P"+i[0]+"-"+i[1]++}return n.__}function j(){for(var n;n=f.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(z),n.__H.__h.forEach(B),n.__H.__h=[]}catch(t){n.__H.__h=[],e.__e(t,n.__v)}}e.__b=function(n){r=null,a&&a(n)},e.__=function(n,t){t.__k&&t.__k.__m&&(n.__m=t.__k.__m),d&&d(n,t)},e.__r=function(n){v&&v(n),t=0;var i=(r=n.__c).__H;i&&(u===r?(i.__h=[],r.__h=[],i.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=c,n.__N=n.i=void 0})):(i.__h.forEach(z),i.__h.forEach(B),i.__h=[],t=0)),u=r},e.diffed=function(n){l&&l(n);var t=n.__c;t&&t.__H&&(t.__H.__h.length&&(1!==f.push(t)&&i===e.requestAnimationFrame||((i=e.requestAnimationFrame)||w)(j)),t.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==c&&(n.__=n.__V),n.i=void 0,n.__V=c})),u=r=null},e.__c=function(n,t){t.some(function(n){try{n.__h.forEach(z),n.__h=n.__h.filter(function(n){return!n.__||B(n)})}catch(r){t.some(function(n){n.__h&&(n.__h=[])}),t=[],e.__e(r,n.__v)}}),m&&m(n,t)},e.unmount=function(n){s&&s(n);var t,r=n.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{z(n)}catch(n){t=n}}),r.__H=void 0,t&&e.__e(t,r.__v))};var k="function"==typeof requestAnimationFrame;function w(n){var t,r=function(){clearTimeout(u),k&&cancelAnimationFrame(t),setTimeout(n)},u=setTimeout(r,100);k&&(t=requestAnimationFrame(r))}function z(n){var t=r,u=n.__c;"function"==typeof u&&(n.__c=void 0,u()),r=t}function B(n){var t=r;n.__c=n.__(),r=t}function C(n,t){return!n||n.length!==t.length||t.some(function(t,r){return t!==n[r]})}function D(n,t){return"function"==typeof t?t(n):t}const hooks={__proto__:null,useCallback:x,useContext:P,useDebugValue:V,useEffect:_,useErrorBoundary:b,useId:g,useImperativeHandle:T,useLayoutEffect:A,useMemo:q,useReducer:y,useRef:F,useState:p};const XMLNS$1="http://www.w3.org/2000/svg";function SentryLogo(){const createElementNS=tagName=>DOCUMENT.createElementNS(XMLNS$1,tagName);const svg=setAttributesNS(createElementNS("svg"),{width:"32",height:"30",viewBox:"0 0 72 66",fill:"inherit"});const path=setAttributesNS(createElementNS("path"),{transform:"translate(11, 11)",d:"M29,2.26a4.67,4.67,0,0,0-8,0L14.42,13.53A32.21,32.21,0,0,1,32.17,40.19H27.55A27.68,27.68,0,0,0,12.09,17.47L6,28a15.92,15.92,0,0,1,9.23,12.17H4.62A.76.76,0,0,1,4,39.06l2.94-5a10.74,10.74,0,0,0-3.36-1.9l-2.91,5a4.54,4.54,0,0,0,1.69,6.24A4.66,4.66,0,0,0,4.62,44H19.15a19.4,19.4,0,0,0-8-17.31l2.31-4A23.87,23.87,0,0,1,23.76,44H36.07a35.88,35.88,0,0,0-16.41-31.8l4.67-8a.77.77,0,0,1,1.05-.27c.53.29,20.29,34.77,20.66,35.17a.76.76,0,0,1-.68,1.13H40.6q.09,1.91,0,3.81h4.78A4.59,4.59,0,0,0,50,39.43a4.49,4.49,0,0,0-.62-2.28Z"});svg.appendChild(path);return svg}function DialogHeader({options}){const logoHtml=q(()=>({__html:SentryLogo().outerHTML}),[]);return y$1("h2",{class:"dialog__header"},y$1("span",{class:"dialog__title"},options.formTitle),options.showBranding?y$1("a",{class:"brand-link",target:"_blank",href:"https://sentry.io/welcome/",title:"Powered by Sentry",rel:"noopener noreferrer",dangerouslySetInnerHTML:logoHtml}):null)}function getMissingFields(feedback,props){const emptyFields=[];if(props.isNameRequired&&!feedback.name){emptyFields.push(props.nameLabel)}if(props.isEmailRequired&&!feedback.email){emptyFields.push(props.emailLabel)}if(!feedback.message){emptyFields.push(props.messageLabel)}return emptyFields}function retrieveStringValue(formData,key){const value=formData.get(key);if(typeof value==="string"){return value.trim()}return""}function Form({options,defaultEmail,defaultName,onFormClose,onSubmit,onSubmitSuccess,onSubmitError,showEmail,showName,screenshotInput}){const{tags,addScreenshotButtonLabel,removeScreenshotButtonLabel,cancelButtonLabel,emailLabel,emailPlaceholder,isEmailRequired,isNameRequired,messageLabel,messagePlaceholder,nameLabel,namePlaceholder,submitButtonLabel,isRequiredLabel}=options;const[error,setError]=p(null);const[showScreenshotInput,setShowScreenshotInput]=p(false);const ScreenshotInputComponent=screenshotInput&&screenshotInput.input;const[screenshotError,setScreenshotError]=p(null);const onScreenshotError=x(error=>{setScreenshotError(error);setShowScreenshotInput(false)},[]);const hasAllRequiredFields=x(data=>{const missingFields=getMissingFields(data,{emailLabel:emailLabel,isEmailRequired:isEmailRequired,isNameRequired:isNameRequired,messageLabel:messageLabel,nameLabel:nameLabel});if(missingFields.length>0){setError(`Please enter in the following required fields: ${missingFields.join(", ")}`)}else{setError(null)}return missingFields.length===0},[emailLabel,isEmailRequired,isNameRequired,messageLabel,nameLabel]);const handleSubmit=x(async e=>{try{e.preventDefault();if(!(e.target instanceof HTMLFormElement)){return}const formData=new FormData(e.target);const attachment=await(screenshotInput&&showScreenshotInput?screenshotInput.value():undefined);const data={name:retrieveStringValue(formData,"name"),email:retrieveStringValue(formData,"email"),message:retrieveStringValue(formData,"message"),attachments:attachment?[attachment]:undefined};if(!hasAllRequiredFields(data)){return}try{await onSubmit({name:data.name,email:data.email,message:data.message,source:FEEDBACK_WIDGET_SOURCE,tags:tags},{attachments:data.attachments});onSubmitSuccess(data)}catch(error){DEBUG_BUILD&&core.logger.error(error);setError(error);onSubmitError(error)}}catch(e2){}},[screenshotInput&&showScreenshotInput,onSubmitSuccess,onSubmitError]);return y$1("form",{class:"form",onSubmit:handleSubmit},ScreenshotInputComponent&&showScreenshotInput?y$1(ScreenshotInputComponent,{onError:onScreenshotError}):null,y$1("div",{class:"form__right","data-sentry-feedback":true},y$1("div",{class:"form__top"},error?y$1("div",{class:"form__error-container"},error):null,showName?y$1("label",{for:"name",class:"form__label"},y$1(LabelText,{label:nameLabel,isRequiredLabel:isRequiredLabel,isRequired:isNameRequired}),y$1("input",{class:"form__input",defaultValue:defaultName,id:"name",name:"name",placeholder:namePlaceholder,required:isNameRequired,type:"text"})):y$1("input",{"aria-hidden":true,value:defaultName,name:"name",type:"hidden"}),showEmail?y$1("label",{for:"email",class:"form__label"},y$1(LabelText,{label:emailLabel,isRequiredLabel:isRequiredLabel,isRequired:isEmailRequired}),y$1("input",{class:"form__input",defaultValue:defaultEmail,id:"email",name:"email",placeholder:emailPlaceholder,required:isEmailRequired,type:"email"})):y$1("input",{"aria-hidden":true,value:defaultEmail,name:"email",type:"hidden"}),y$1("label",{for:"message",class:"form__label"},y$1(LabelText,{label:messageLabel,isRequiredLabel:isRequiredLabel,isRequired:true}),y$1("textarea",{autoFocus:true,class:"form__input form__input--textarea",id:"message",name:"message",placeholder:messagePlaceholder,required:true,rows:5})),ScreenshotInputComponent?y$1("label",{for:"screenshot",class:"form__label"},y$1("button",{class:"btn btn--default",type:"button",onClick:()=>{setScreenshotError(null);setShowScreenshotInput(prev=>!prev)}},showScreenshotInput?removeScreenshotButtonLabel:addScreenshotButtonLabel),screenshotError?y$1("div",{class:"form__error-container"},screenshotError.message):null):null),y$1("div",{class:"btn-group"},y$1("button",{class:"btn btn--primary",type:"submit"},submitButtonLabel),y$1("button",{class:"btn btn--default",type:"button",onClick:onFormClose},cancelButtonLabel))))}function LabelText({label,isRequired,isRequiredLabel}){return y$1("span",{class:"form__label__text"},label,isRequired&&y$1("span",{class:"form__label__text--required"},isRequiredLabel))}const WIDTH=16;const HEIGHT=17;const XMLNS="http://www.w3.org/2000/svg";function SuccessIcon(){const createElementNS=tagName=>WINDOW.document.createElementNS(XMLNS,tagName);const svg=setAttributesNS(createElementNS("svg"),{width:`${WIDTH}`,height:`${HEIGHT}`,viewBox:`0 0 ${WIDTH} ${HEIGHT}`,fill:"inherit"});const g=setAttributesNS(createElementNS("g"),{clipPath:"url(#clip0_57_156)"});const path2=setAttributesNS(createElementNS("path"),{["fill-rule"]:"evenodd",["clip-rule"]:"evenodd",d:"M3.55544 15.1518C4.87103 16.0308 6.41775 16.5 8 16.5C10.1217 16.5 12.1566 15.6571 13.6569 14.1569C15.1571 12.6566 16 10.6217 16 8.5C16 6.91775 15.5308 5.37103 14.6518 4.05544C13.7727 2.73985 12.5233 1.71447 11.0615 1.10897C9.59966 0.503466 7.99113 0.34504 6.43928 0.653721C4.88743 0.962403 3.46197 1.72433 2.34315 2.84315C1.22433 3.96197 0.462403 5.38743 0.153721 6.93928C-0.15496 8.49113 0.00346625 10.0997 0.608967 11.5615C1.21447 13.0233 2.23985 14.2727 3.55544 15.1518ZM4.40546 3.1204C5.46945 2.40946 6.72036 2.03 8 2.03C9.71595 2.03 11.3616 2.71166 12.575 3.92502C13.7883 5.13838 14.47 6.78405 14.47 8.5C14.47 9.77965 14.0905 11.0306 13.3796 12.0945C12.6687 13.1585 11.6582 13.9878 10.476 14.4775C9.29373 14.9672 7.99283 15.0953 6.73777 14.8457C5.48271 14.596 4.32987 13.9798 3.42502 13.075C2.52018 12.1701 1.90397 11.0173 1.65432 9.76224C1.40468 8.50718 1.5328 7.20628 2.0225 6.02404C2.5122 4.8418 3.34148 3.83133 4.40546 3.1204Z"});const path=setAttributesNS(createElementNS("path"),{d:"M6.68775 12.4297C6.78586 12.4745 6.89218 12.4984 7 12.5C7.11275 12.4955 7.22315 12.4664 7.32337 12.4145C7.4236 12.3627 7.51121 12.2894 7.58 12.2L12 5.63999C12.0848 5.47724 12.1071 5.28902 12.0625 5.11098C12.0178 4.93294 11.9095 4.77744 11.7579 4.67392C11.6064 4.57041 11.4221 4.52608 11.24 4.54931C11.0579 4.57254 10.8907 4.66173 10.77 4.79999L6.88 10.57L5.13 8.56999C5.06508 8.49566 4.98613 8.43488 4.89768 8.39111C4.80922 8.34735 4.713 8.32148 4.61453 8.31498C4.51605 8.30847 4.41727 8.32147 4.32382 8.35322C4.23038 8.38497 4.14413 8.43484 4.07 8.49999C3.92511 8.63217 3.83692 8.81523 3.82387 9.01092C3.81083 9.2066 3.87393 9.39976 4 9.54999L6.43 12.24C6.50187 12.3204 6.58964 12.385 6.68775 12.4297Z"});svg.appendChild(g).append(path,path2);const speakerDefs=createElementNS("defs");const speakerClipPathDef=setAttributesNS(createElementNS("clipPath"),{id:"clip0_57_156"});const speakerRect=setAttributesNS(createElementNS("rect"),{width:`${WIDTH}`,height:`${WIDTH}`,fill:"white",transform:"translate(0 0.5)"});speakerClipPathDef.appendChild(speakerRect);speakerDefs.appendChild(speakerClipPathDef);svg.appendChild(speakerDefs).appendChild(speakerClipPathDef).appendChild(speakerRect);return svg}function Dialog({open,onFormSubmitted,...props}){const options=props.options;const successIconHtml=q(()=>({__html:SuccessIcon().outerHTML}),[]);const[timeoutId,setTimeoutId]=p(null);const handleOnSuccessClick=x(()=>{if(timeoutId){clearTimeout(timeoutId);setTimeoutId(null)}onFormSubmitted()},[timeoutId]);const onSubmitSuccess=x(data=>{props.onSubmitSuccess(data);setTimeoutId(setTimeout(()=>{onFormSubmitted();setTimeoutId(null)},SUCCESS_MESSAGE_TIMEOUT))},[onFormSubmitted]);return y$1(g$1,null,timeoutId?y$1("div",{class:"success__position",onClick:handleOnSuccessClick},y$1("div",{class:"success__content"},options.successMessageText,y$1("span",{class:"success__icon",dangerouslySetInnerHTML:successIconHtml}))):y$1("dialog",{class:"dialog",onClick:options.onFormClose,open:open},y$1("div",{class:"dialog__position"},y$1("div",{class:"dialog__content",onClick:e=>{e.stopPropagation()}},y$1(DialogHeader,{options:options}),y$1(Form,{...props,onSubmitSuccess:onSubmitSuccess})))))}const DIALOG=`
.dialog {
  position: fixed;
  z-index: var(--z-index);
  margin: 0;
  inset: 0;

  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  height: 100vh;
  width: 100vw;

  color: var(--dialog-color, var(--foreground));
  fill: var(--dialog-color, var(--foreground));
  line-height: 1.75em;

  background-color: rgba(0, 0, 0, 0.05);
  border: none;
  inset: 0;
  opacity: 1;
  transition: opacity 0.2s ease-in-out;
}

.dialog__position {
  position: fixed;
  z-index: var(--z-index);
  inset: var(--dialog-inset);
  padding: var(--page-margin);
  display: flex;
  max-height: calc(100vh - (2 * var(--page-margin)));
}
@media (max-width: 600px) {
  .dialog__position {
    inset: var(--page-margin);
    padding: 0;
  }
}

.dialog__position:has(.editor) {
  inset: var(--page-margin);
  padding: 0;
}

.dialog:not([open]) {
  opacity: 0;
  pointer-events: none;
  visibility: hidden;
}
.dialog:not([open]) .dialog__content {
  transform: translate(0, -16px) scale(0.98);
}

.dialog__content {
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding: var(--dialog-padding, 24px);
  max-width: 100%;
  width: 100%;
  max-height: 100%;
  overflow: auto;

  background: var(--dialog-background, var(--background));
  border-radius: var(--dialog-border-radius, 20px);
  border: var(--dialog-border, var(--border));
  box-shadow: var(--dialog-box-shadow, var(--box-shadow));
  transform: translate(0, 0) scale(1);
  transition: transform 0.2s ease-in-out;
}

`;const DIALOG_HEADER=`
.dialog__header {
  display: flex;
  gap: 4px;
  justify-content: space-between;
  font-weight: var(--dialog-header-weight, 600);
  margin: 0;
}
.dialog__title {
  align-self: center;
  width: var(--form-width, 272px);
}

@media (max-width: 600px) {
  .dialog__title {
    width: auto;
  }
}

.dialog__position:has(.editor) .dialog__title {
  width: auto;
}


.brand-link {
  display: inline-flex;
}
.brand-link:focus-visible {
  outline: var(--outline);
}
`;const FORM=`
.form {
  display: flex;
  overflow: auto;
  flex-direction: row;
  gap: 16px;
  flex: 1 0;
}

.form__right {
  flex: 0 0 auto;
  display: flex;
  overflow: auto;
  flex-direction: column;
  justify-content: space-between;
  gap: 20px;
  width: var(--form-width, 100%);
}

.dialog__position:has(.editor) .form__right {
  width: var(--form-width, 272px);
}

.form__top {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.form__error-container {
  color: var(--error-color);
  fill: var(--error-color);
}

.form__label {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin: 0px;
}

.form__label__text {
  display: flex;
  gap: 4px;
  align-items: center;
}

.form__label__text--required {
  font-size: 0.85em;
}

.form__input {
  font-family: inherit;
  line-height: inherit;
  background: transparent;
  box-sizing: border-box;
  border: var(--input-border, var(--border));
  border-radius: var(--input-border-radius, 6px);
  color: var(--input-color, inherit);
  fill: var(--input-color, inherit);
  font-size: var(--input-font-size, inherit);
  font-weight: var(--input-font-weight, 500);
  padding: 6px 12px;
}

.form__input::placeholder {
  opacity: 0.65;
  color: var(--input-placeholder-color, inherit);
  filter: var(--interactive-filter);
}

.form__input:focus-visible {
  outline: var(--input-focus-outline, var(--outline));
}

.form__input--textarea {
  font-family: inherit;
  resize: vertical;
}

.error {
  color: var(--error-color);
  fill: var(--error-color);
}
`;const BUTTON=`
.btn-group {
  display: grid;
  gap: 8px;
}

.btn {
  line-height: inherit;
  border: var(--button-border, var(--border));
  border-radius: var(--button-border-radius, 6px);
  cursor: pointer;
  font-family: inherit;
  font-size: var(--button-font-size, inherit);
  font-weight: var(--button-font-weight, 600);
  padding: var(--button-padding, 6px 16px);
}
.btn[disabled] {
  opacity: 0.6;
  pointer-events: none;
}

.btn--primary {
  color: var(--button-primary-color, var(--accent-foreground));
  fill: var(--button-primary-color, var(--accent-foreground));
  background: var(--button-primary-background, var(--accent-background));
  border: var(--button-primary-border, var(--border));
  border-radius: var(--button-primary-border-radius, 6px);
  font-weight: var(--button-primary-font-weight, 500);
}
.btn--primary:hover {
  color: var(--button-primary-hover-color, var(--accent-foreground));
  fill: var(--button-primary-hover-color, var(--accent-foreground));
  background: var(--button-primary-hover-background, var(--accent-background));
  filter: var(--interactive-filter);
}
.btn--primary:focus-visible {
  background: var(--button-primary-hover-background, var(--accent-background));
  filter: var(--interactive-filter);
  outline: var(--button-primary-focus-outline, var(--outline));
}

.btn--default {
  color: var(--button-color, var(--foreground));
  fill: var(--button-color, var(--foreground));
  background: var(--button-background, var(--background));
  border: var(--button-border, var(--border));
  border-radius: var(--button-border-radius, 6px);
  font-weight: var(--button-font-weight, 500);
}
.btn--default:hover {
  color: var(--button-color, var(--foreground));
  fill: var(--button-color, var(--foreground));
  background: var(--button-hover-background, var(--background));
  filter: var(--interactive-filter);
}
.btn--default:focus-visible {
  background: var(--button-hover-background, var(--background));
  filter: var(--interactive-filter);
  outline: var(--button-focus-outline, var(--outline));
}
`;const SUCCESS=`
.success__position {
  position: fixed;
  inset: var(--dialog-inset);
  padding: var(--page-margin);
  z-index: var(--z-index);
}
.success__content {
  background: var(--success-background, var(--background));
  border: var(--success-border, var(--border));
  border-radius: var(--success-border-radius, 1.7em/50%);
  box-shadow: var(--success-box-shadow, var(--box-shadow));
  font-weight: var(--success-font-weight, 600);
  color: var(--success-color);
  fill: var(--success-color);
  padding: 12px 24px;
  line-height: 1.75em;

  display: grid;
  align-items: center;
  grid-auto-flow: column;
  gap: 6px;
  cursor: default;
}

.success__icon {
  display: flex;
}
`;function createDialogStyles(styleNonce){const style=DOCUMENT.createElement("style");style.textContent=`
:host {
  --dialog-inset: var(--inset);
}

${DIALOG}
${DIALOG_HEADER}
${FORM}
${BUTTON}
${SUCCESS}
`;if(styleNonce){style.setAttribute("nonce",styleNonce)}return style}function getUser(){const currentUser=core.getCurrentScope().getUser();const isolationUser=core.getIsolationScope().getUser();const globalUser=core.getGlobalScope().getUser();if(currentUser&&Object.keys(currentUser).length){return currentUser}if(isolationUser&&Object.keys(isolationUser).length){return isolationUser}return globalUser}const feedbackModalIntegration=()=>{return{name:"FeedbackModal",setupOnce(){},createDialog:({options,screenshotIntegration,sendFeedback,shadow})=>{const shadowRoot=shadow;const userKey=options.useSentryUser;const user=getUser();const el=DOCUMENT.createElement("div");const style=createDialogStyles(options.styleNonce);let originalOverflow="";const dialog={get el(){return el},appendToDom(){if(!shadowRoot.contains(style)&&!shadowRoot.contains(el)){shadowRoot.appendChild(style);shadowRoot.appendChild(el)}},removeFromDom(){shadowRoot.removeChild(el);shadowRoot.removeChild(style);DOCUMENT.body.style.overflow=originalOverflow},open(){renderContent(true);options.onFormOpen&&options.onFormOpen();originalOverflow=DOCUMENT.body.style.overflow;DOCUMENT.body.style.overflow="hidden"},close(){renderContent(false);DOCUMENT.body.style.overflow=originalOverflow}};const screenshotInput=screenshotIntegration&&screenshotIntegration.createInput({h:y$1,hooks:hooks,dialog:dialog,options:options});const renderContent=open=>{B$1(y$1(Dialog,{options:options,screenshotInput:screenshotInput,showName:options.showName||options.isNameRequired,showEmail:options.showEmail||options.isEmailRequired,defaultName:userKey&&user&&user[userKey.name]||"",defaultEmail:userKey&&user&&user[userKey.email]||"",onFormClose:()=>{renderContent(false);options.onFormClose&&options.onFormClose()},onSubmit:sendFeedback,onSubmitSuccess:data=>{renderContent(false);options.onSubmitSuccess&&options.onSubmitSuccess(data)},onSubmitError:error=>{options.onSubmitError&&options.onSubmitError(error)},onFormSubmitted:()=>{options.onFormSubmitted&&options.onFormSubmitted()},open:open}),el)};return dialog}}};function CropCornerFactory({h}){return function CropCorner({top,left,corner,onGrabButton}){return h("button",{class:`editor__crop-corner editor__crop-corner--${corner} `,style:{top:top,left:left},onMouseDown:e=>{e.preventDefault();onGrabButton(e,corner)},onClick:e=>{e.preventDefault()}})}}function createScreenshotInputStyles(styleNonce){const style=DOCUMENT.createElement("style");const surface200="#1A141F";const gray100="#302735";style.textContent=`
.editor {
  padding: 10px;
  padding-top: 65px;
  padding-bottom: 65px;
  flex-grow: 1;

  background-color: ${surface200};
  background-image: repeating-linear-gradient(
      -145deg,
      transparent,
      transparent 8px,
      ${surface200} 8px,
      ${surface200} 11px
    ),
    repeating-linear-gradient(
      -45deg,
      transparent,
      transparent 15px,
      ${gray100} 15px,
      ${gray100} 16px
    );
}

.editor__canvas-container {
  width: 100%;
  height: 100%;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.editor__canvas-container canvas {
  object-fit: contain;
  position: relative;
}

.editor__crop-btn-group {
  padding: 8px;
  gap: 8px;
  border-radius: var(--menu-border-radius, 6px);
  background: var(--button-primary-background, var(--background));
  width: 175px;
  position: absolute;
}

.editor__crop-corner {
  width: 30px;
  height: 30px;
  position: absolute;
  background: none;
  border: 3px solid #ffffff;
}

.editor__crop-corner--top-left {
  cursor: nwse-resize;
  border-right: none;
  border-bottom: none;
}
.editor__crop-corner--top-right {
  cursor: nesw-resize;
  border-left: none;
  border-bottom: none;
}
.editor__crop-corner--bottom-left {
  cursor: nesw-resize;
  border-right: none;
  border-top: none;
}
.editor__crop-corner--bottom-right {
  cursor: nwse-resize;
  border-left: none;
  border-top: none;
}
`;if(styleNonce){style.setAttribute("nonce",styleNonce)}return style}function useTakeScreenshotFactory({hooks}){return function useTakeScreenshot({onBeforeScreenshot,onScreenshot,onAfterScreenshot,onError}){hooks.useEffect(()=>{const takeScreenshot=async()=>{onBeforeScreenshot();const stream=await NAVIGATOR.mediaDevices.getDisplayMedia({video:{width:WINDOW.innerWidth*WINDOW.devicePixelRatio,height:WINDOW.innerHeight*WINDOW.devicePixelRatio},audio:false,monitorTypeSurfaces:"exclude",preferCurrentTab:true,selfBrowserSurface:"include",surfaceSwitching:"exclude"});const video=DOCUMENT.createElement("video");await new Promise((resolve,reject)=>{video.srcObject=stream;video.onloadedmetadata=()=>{onScreenshot(video);stream.getTracks().forEach(track=>track.stop());resolve()};video.play().catch(reject)});onAfterScreenshot()};takeScreenshot().catch(onError)},[])}}const CROP_BUTTON_SIZE=30;const CROP_BUTTON_BORDER=3;const CROP_BUTTON_OFFSET=CROP_BUTTON_SIZE+CROP_BUTTON_BORDER;const DPI=WINDOW.devicePixelRatio;const constructRect=box=>{return{x:Math.min(box.startX,box.endX),y:Math.min(box.startY,box.endY),width:Math.abs(box.startX-box.endX),height:Math.abs(box.startY-box.endY)}};const getContainedSize=img=>{const imgClientHeight=img.clientHeight;const imgClientWidth=img.clientWidth;const ratio=img.width/img.height;let width=imgClientHeight*ratio;let height=imgClientHeight;if(width>imgClientWidth){width=imgClientWidth;height=imgClientWidth/ratio}const x=(imgClientWidth-width)/2;const y=(imgClientHeight-height)/2;return{startX:x,startY:y,endX:width+x,endY:height+y}};function ScreenshotEditorFactory({h,hooks,imageBuffer,dialog,options}){const useTakeScreenshot=useTakeScreenshotFactory({hooks:hooks});return function ScreenshotEditor({onError}){const styles=hooks.useMemo(()=>({__html:createScreenshotInputStyles(options.styleNonce).innerText}),[]);const CropCorner=CropCornerFactory({h:h});const canvasContainerRef=hooks.useRef(null);const cropContainerRef=hooks.useRef(null);const croppingRef=hooks.useRef(null);const[croppingRect,setCroppingRect]=hooks.useState({startX:0,startY:0,endX:0,endY:0});const[confirmCrop,setConfirmCrop]=hooks.useState(false);const[isResizing,setIsResizing]=hooks.useState(false);hooks.useEffect(()=>{WINDOW.addEventListener("resize",resizeCropper,false)},[]);function resizeCropper(){const cropper=croppingRef.current;const imageDimensions=constructRect(getContainedSize(imageBuffer));if(cropper){cropper.width=imageDimensions.width*DPI;cropper.height=imageDimensions.height*DPI;cropper.style.width=`${imageDimensions.width}px`;cropper.style.height=`${imageDimensions.height}px`;const ctx=cropper.getContext("2d");if(ctx){ctx.scale(DPI,DPI)}}const cropButton=cropContainerRef.current;if(cropButton){cropButton.style.width=`${imageDimensions.width}px`;cropButton.style.height=`${imageDimensions.height}px`}setCroppingRect({startX:0,startY:0,endX:imageDimensions.width,endY:imageDimensions.height})}hooks.useEffect(()=>{const cropper=croppingRef.current;if(!cropper){return}const ctx=cropper.getContext("2d");if(!ctx){return}const imageDimensions=constructRect(getContainedSize(imageBuffer));const croppingBox=constructRect(croppingRect);ctx.clearRect(0,0,imageDimensions.width,imageDimensions.height);ctx.fillStyle="rgba(0, 0, 0, 0.5)";ctx.fillRect(0,0,imageDimensions.width,imageDimensions.height);ctx.clearRect(croppingBox.x,croppingBox.y,croppingBox.width,croppingBox.height);ctx.strokeStyle="#ffffff";ctx.lineWidth=3;ctx.strokeRect(croppingBox.x+1,croppingBox.y+1,croppingBox.width-2,croppingBox.height-2);ctx.strokeStyle="#000000";ctx.lineWidth=1;ctx.strokeRect(croppingBox.x+3,croppingBox.y+3,croppingBox.width-6,croppingBox.height-6)},[croppingRect]);function onGrabButton(e,corner){setConfirmCrop(false);setIsResizing(true);const handleMouseMove=makeHandleMouseMove(corner);const handleMouseUp=()=>{DOCUMENT.removeEventListener("mousemove",handleMouseMove);DOCUMENT.removeEventListener("mouseup",handleMouseUp);setConfirmCrop(true);setIsResizing(false)};DOCUMENT.addEventListener("mouseup",handleMouseUp);DOCUMENT.addEventListener("mousemove",handleMouseMove)}const makeHandleMouseMove=hooks.useCallback(corner=>{return function(e){if(!croppingRef.current){return}const cropCanvas=croppingRef.current;const cropBoundingRect=cropCanvas.getBoundingClientRect();const mouseX=e.clientX-cropBoundingRect.x;const mouseY=e.clientY-cropBoundingRect.y;switch(corner){case"top-left":setCroppingRect(prev=>({...prev,startX:Math.min(Math.max(0,mouseX),prev.endX-CROP_BUTTON_OFFSET),startY:Math.min(Math.max(0,mouseY),prev.endY-CROP_BUTTON_OFFSET)}));break;case"top-right":setCroppingRect(prev=>({...prev,endX:Math.max(Math.min(mouseX,cropCanvas.width/DPI),prev.startX+CROP_BUTTON_OFFSET),startY:Math.min(Math.max(0,mouseY),prev.endY-CROP_BUTTON_OFFSET)}));break;case"bottom-left":setCroppingRect(prev=>({...prev,startX:Math.min(Math.max(0,mouseX),prev.endX-CROP_BUTTON_OFFSET),endY:Math.max(Math.min(mouseY,cropCanvas.height/DPI),prev.startY+CROP_BUTTON_OFFSET)}));break;case"bottom-right":setCroppingRect(prev=>({...prev,endX:Math.max(Math.min(mouseX,cropCanvas.width/DPI),prev.startX+CROP_BUTTON_OFFSET),endY:Math.max(Math.min(mouseY,cropCanvas.height/DPI),prev.startY+CROP_BUTTON_OFFSET)}));break}}},[]);const initialPositionRef=hooks.useRef({initialX:0,initialY:0});function onDragStart(e){if(isResizing)return;initialPositionRef.current={initialX:e.clientX,initialY:e.clientY};const handleMouseMove=moveEvent=>{const cropCanvas=croppingRef.current;if(!cropCanvas)return;const deltaX=moveEvent.clientX-initialPositionRef.current.initialX;const deltaY=moveEvent.clientY-initialPositionRef.current.initialY;setCroppingRect(prev=>{const newStartX=Math.max(0,Math.min(prev.startX+deltaX,cropCanvas.width/DPI-(prev.endX-prev.startX)));const newStartY=Math.max(0,Math.min(prev.startY+deltaY,cropCanvas.height/DPI-(prev.endY-prev.startY)));const newEndX=newStartX+(prev.endX-prev.startX);const newEndY=newStartY+(prev.endY-prev.startY);initialPositionRef.current.initialX=moveEvent.clientX;initialPositionRef.current.initialY=moveEvent.clientY;return{startX:newStartX,startY:newStartY,endX:newEndX,endY:newEndY}})};const handleMouseUp=()=>{DOCUMENT.removeEventListener("mousemove",handleMouseMove);DOCUMENT.removeEventListener("mouseup",handleMouseUp)};DOCUMENT.addEventListener("mousemove",handleMouseMove);DOCUMENT.addEventListener("mouseup",handleMouseUp)}function submit(){const cutoutCanvas=DOCUMENT.createElement("canvas");const imageBox=constructRect(getContainedSize(imageBuffer));const croppingBox=constructRect(croppingRect);cutoutCanvas.width=croppingBox.width*DPI;cutoutCanvas.height=croppingBox.height*DPI;const cutoutCtx=cutoutCanvas.getContext("2d");if(cutoutCtx&&imageBuffer){cutoutCtx.drawImage(imageBuffer,croppingBox.x/imageBox.width*imageBuffer.width,croppingBox.y/imageBox.height*imageBuffer.height,croppingBox.width/imageBox.width*imageBuffer.width,croppingBox.height/imageBox.height*imageBuffer.height,0,0,cutoutCanvas.width,cutoutCanvas.height)}const ctx=imageBuffer.getContext("2d");if(ctx){ctx.clearRect(0,0,imageBuffer.width,imageBuffer.height);imageBuffer.width=cutoutCanvas.width;imageBuffer.height=cutoutCanvas.height;imageBuffer.style.width=`${croppingBox.width}px`;imageBuffer.style.height=`${croppingBox.height}px`;ctx.drawImage(cutoutCanvas,0,0);resizeCropper()}}useTakeScreenshot({onBeforeScreenshot:hooks.useCallback(()=>{dialog.el.style.display="none"},[]),onScreenshot:hooks.useCallback(imageSource=>{const context=imageBuffer.getContext("2d");if(!context){throw new Error("Could not get canvas context")}imageBuffer.width=imageSource.videoWidth;imageBuffer.height=imageSource.videoHeight;imageBuffer.style.width="100%";imageBuffer.style.height="100%";context.drawImage(imageSource,0,0)},[imageBuffer]),onAfterScreenshot:hooks.useCallback(()=>{dialog.el.style.display="block";const container=canvasContainerRef.current;container&&container.appendChild(imageBuffer);resizeCropper()},[]),onError:hooks.useCallback(error=>{dialog.el.style.display="block";onError(error)},[])});return h("div",{class:"editor"},h("style",{nonce:options.styleNonce,dangerouslySetInnerHTML:styles}),h("div",{class:"editor__canvas-container",ref:canvasContainerRef},h("div",{class:"editor__crop-container",style:{position:"absolute",zIndex:1},ref:cropContainerRef},h("canvas",{onMouseDown:onDragStart,style:{position:"absolute",cursor:confirmCrop?"move":"auto"},ref:croppingRef}),h(CropCorner,{left:croppingRect.startX-CROP_BUTTON_BORDER,top:croppingRect.startY-CROP_BUTTON_BORDER,onGrabButton:onGrabButton,corner:"top-left"}),h(CropCorner,{left:croppingRect.endX-CROP_BUTTON_SIZE+CROP_BUTTON_BORDER,top:croppingRect.startY-CROP_BUTTON_BORDER,onGrabButton:onGrabButton,corner:"top-right"}),h(CropCorner,{left:croppingRect.startX-CROP_BUTTON_BORDER,top:croppingRect.endY-CROP_BUTTON_SIZE+CROP_BUTTON_BORDER,onGrabButton:onGrabButton,corner:"bottom-left"}),h(CropCorner,{left:croppingRect.endX-CROP_BUTTON_SIZE+CROP_BUTTON_BORDER,top:croppingRect.endY-CROP_BUTTON_SIZE+CROP_BUTTON_BORDER,onGrabButton:onGrabButton,corner:"bottom-right"}),h("div",{style:{left:Math.max(0,croppingRect.endX-191),top:Math.max(0,croppingRect.endY+8),display:confirmCrop?"flex":"none"},class:"editor__crop-btn-group"},h("button",{onClick:e=>{e.preventDefault();if(croppingRef.current){setCroppingRect({startX:0,startY:0,endX:croppingRef.current.width/DPI,endY:croppingRef.current.height/DPI})}setConfirmCrop(false)},class:"btn btn--default"},options.cancelButtonLabel),h("button",{onClick:e=>{e.preventDefault();submit();setConfirmCrop(false)},class:"btn btn--primary"},options.confirmButtonLabel)))))}}const feedbackScreenshotIntegration=()=>{return{name:"FeedbackScreenshot",setupOnce(){},createInput:({h,hooks,dialog,options})=>{const imageBuffer=DOCUMENT.createElement("canvas");return{input:ScreenshotEditorFactory({h:h,hooks:hooks,imageBuffer:imageBuffer,dialog:dialog,options:options}),value:async()=>{const blob=await new Promise(resolve=>{imageBuffer.toBlob(resolve,"image/png")});if(blob){const data=new Uint8Array(await blob.arrayBuffer());const attachment={data:data,filename:"screenshot.png",contentType:"application/png"};return attachment}return undefined}}}}};exports.buildFeedbackIntegration=buildFeedbackIntegration;exports.feedbackModalIntegration=feedbackModalIntegration;exports.feedbackScreenshotIntegration=feedbackScreenshotIntegration;exports.getFeedback=getFeedback;exports.sendFeedback=sendFeedback},{"@sentry/core":87}],34:[function(require,module,exports){var{_optionalChain}=require("@sentry/core");Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");var NodeType;(function(NodeType){NodeType[NodeType["Document"]=0]="Document";NodeType[NodeType["DocumentType"]=1]="DocumentType";NodeType[NodeType["Element"]=2]="Element";NodeType[NodeType["Text"]=3]="Text";NodeType[NodeType["CDATA"]=4]="CDATA";NodeType[NodeType["Comment"]=5]="Comment"})(NodeType||(NodeType={}));function elementClassMatchesRegex(el,regex){for(let eIndex=el.classList.length;eIndex--;){const className=el.classList[eIndex];if(regex.test(className)){return true}}return false}function distanceToMatch(node,matchPredicate,limit=Infinity,distance=0){if(!node)return-1;if(node.nodeType!==node.ELEMENT_NODE)return-1;if(distance>limit)return-1;if(matchPredicate(node))return distance;return distanceToMatch(node.parentNode,matchPredicate,limit,distance+1)}function createMatchPredicate(className,selector){return node=>{const el=node;if(el===null)return false;try{if(className){if(typeof className==="string"){if(el.matches(`.${className}`))return true}else if(elementClassMatchesRegex(el,className)){return true}}if(selector&&el.matches(selector))return true;return false}catch(e2){return false}}}const DEPARTED_MIRROR_ACCESS_WARNING="Please stop import mirror directly. Instead of that,"+"\r\n"+"now you can use replayer.getMirror() to access the mirror instance of a replayer,"+"\r\n"+"or you can use record.mirror to access the mirror instance during recording.";let _mirror={map:{},getId(){console.error(DEPARTED_MIRROR_ACCESS_WARNING);return-1},getNode(){console.error(DEPARTED_MIRROR_ACCESS_WARNING);return null},removeNodeFromMap(){console.error(DEPARTED_MIRROR_ACCESS_WARNING)},has(){console.error(DEPARTED_MIRROR_ACCESS_WARNING);return false},reset(){console.error(DEPARTED_MIRROR_ACCESS_WARNING)}};if(typeof window!=="undefined"&&window.Proxy&&window.Reflect){_mirror=new Proxy(_mirror,{get(target,prop,receiver){if(prop==="map"){console.error(DEPARTED_MIRROR_ACCESS_WARNING)}return Reflect.get(target,prop,receiver)}})}function hookSetter(target,key,d,isRevoked,win=window){const original=win.Object.getOwnPropertyDescriptor(target,key);win.Object.defineProperty(target,key,isRevoked?d:{set(value){setTimeout(()=>{d.set.call(this,value)},0);if(original&&original.set){original.set.call(this,value)}}});return()=>hookSetter(target,key,original||{},true)}function patch(source,name,replacement){try{if(!(name in source)){return()=>{}}const original=source[name];const wrapped=replacement(original);if(typeof wrapped==="function"){wrapped.prototype=wrapped.prototype||{};Object.defineProperties(wrapped,{__rrweb_original__:{enumerable:false,value:original}})}source[name]=wrapped;return()=>{source[name]=original}}catch(e2){return()=>{}}}if(!/[1-9][0-9]{12}/.test(Date.now().toString()));function closestElementOfNode(node){if(!node){return null}const el=node.nodeType===node.ELEMENT_NODE?node:node.parentElement;return el}function isBlocked(node,blockClass,blockSelector,unblockSelector,checkAncestors){if(!node){return false}const el=closestElementOfNode(node);if(!el){return false}const blockedPredicate=createMatchPredicate(blockClass,blockSelector);const blockDistance=distanceToMatch(el,blockedPredicate);let unblockDistance=-1;if(blockDistance<0){return false}if(unblockSelector){unblockDistance=distanceToMatch(el,createMatchPredicate(null,unblockSelector))}if(blockDistance>-1&&unblockDistance<0){return true}return blockDistance<unblockDistance}const cachedImplementations={};function getImplementation(name){const cached=cachedImplementations[name];if(cached){return cached}const document=window.document;let impl=window[name];if(document&&typeof document.createElement==="function"){try{const sandbox=document.createElement("iframe");sandbox.hidden=true;document.head.appendChild(sandbox);const contentWindow=sandbox.contentWindow;if(contentWindow&&contentWindow[name]){impl=contentWindow[name]}document.head.removeChild(sandbox)}catch(e){}}return cachedImplementations[name]=impl.bind(window)}function onRequestAnimationFrame(...rest){return getImplementation("requestAnimationFrame")(...rest)}function setTimeout(...rest){return getImplementation("setTimeout")(...rest)}var CanvasContext=(CanvasContext2=>{CanvasContext2[CanvasContext2["2D"]=0]="2D";CanvasContext2[CanvasContext2["WebGL"]=1]="WebGL";CanvasContext2[CanvasContext2["WebGL2"]=2]="WebGL2";return CanvasContext2})(CanvasContext||{});let errorHandler;function registerErrorHandler(handler){errorHandler=handler}const callbackWrapper=cb=>{if(!errorHandler){return cb}const rrwebWrapped=(...rest)=>{try{return cb(...rest)}catch(error){if(errorHandler&&errorHandler(error)===true){return()=>{}}throw error}};return rrwebWrapped};var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var lookup=typeof Uint8Array==="undefined"?[]:new Uint8Array(256);for(var i=0;i<chars.length;i++){lookup[chars.charCodeAt(i)]=i}var encode=function(arraybuffer){var bytes=new Uint8Array(arraybuffer),i,len=bytes.length,base64="";for(i=0;i<len;i+=3){base64+=chars[bytes[i]>>2];base64+=chars[(bytes[i]&3)<<4|bytes[i+1]>>4];base64+=chars[(bytes[i+1]&15)<<2|bytes[i+2]>>6];base64+=chars[bytes[i+2]&63]}if(len%3===2){base64=base64.substring(0,base64.length-1)+"="}else if(len%3===1){base64=base64.substring(0,base64.length-2)+"=="}return base64};const canvasVarMap=new Map;function variableListFor(ctx,ctor){let contextMap=canvasVarMap.get(ctx);if(!contextMap){contextMap=new Map;canvasVarMap.set(ctx,contextMap)}if(!contextMap.has(ctor)){contextMap.set(ctor,[])}return contextMap.get(ctor)}const saveWebGLVar=(value,win,ctx)=>{if(!value||!(isInstanceOfWebGLObject(value,win)||typeof value==="object"))return;const name=value.constructor.name;const list=variableListFor(ctx,name);let index=list.indexOf(value);if(index===-1){index=list.length;list.push(value)}return index};function serializeArg(value,win,ctx){if(value instanceof Array){return value.map(arg=>serializeArg(arg,win,ctx))}else if(value===null){return value}else if(value instanceof Float32Array||value instanceof Float64Array||value instanceof Int32Array||value instanceof Uint32Array||value instanceof Uint8Array||value instanceof Uint16Array||value instanceof Int16Array||value instanceof Int8Array||value instanceof Uint8ClampedArray){const name=value.constructor.name;return{rr_type:name,args:[Object.values(value)]}}else if(value instanceof ArrayBuffer){const name=value.constructor.name;const base64=encode(value);return{rr_type:name,base64:base64}}else if(value instanceof DataView){const name=value.constructor.name;return{rr_type:name,args:[serializeArg(value.buffer,win,ctx),value.byteOffset,value.byteLength]}}else if(value instanceof HTMLImageElement){const name=value.constructor.name;const{src}=value;return{rr_type:name,src:src}}else if(value instanceof HTMLCanvasElement){const name="HTMLImageElement";const src=value.toDataURL();return{rr_type:name,src:src}}else if(value instanceof ImageData){const name=value.constructor.name;return{rr_type:name,args:[serializeArg(value.data,win,ctx),value.width,value.height]}}else if(isInstanceOfWebGLObject(value,win)||typeof value==="object"){const name=value.constructor.name;const index=saveWebGLVar(value,win,ctx);return{rr_type:name,index:index}}return value}const serializeArgs=(args,win,ctx)=>{return args.map(arg=>serializeArg(arg,win,ctx))};const isInstanceOfWebGLObject=(value,win)=>{const webGLConstructorNames=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"];const supportedWebGLConstructorNames=webGLConstructorNames.filter(name=>typeof win[name]==="function");return Boolean(supportedWebGLConstructorNames.find(name=>value instanceof win[name]))};function initCanvas2DMutationObserver(cb,win,blockClass,blockSelector,unblockSelector){const handlers=[];const props2D=Object.getOwnPropertyNames(win.CanvasRenderingContext2D.prototype);for(const prop of props2D){try{if(typeof win.CanvasRenderingContext2D.prototype[prop]!=="function"){continue}const restoreHandler=patch(win.CanvasRenderingContext2D.prototype,prop,function(original){return function(...args){if(!isBlocked(this.canvas,blockClass,blockSelector,unblockSelector,true)){setTimeout(()=>{const recordArgs=serializeArgs(args,win,this);cb(this.canvas,{type:CanvasContext["2D"],property:prop,args:recordArgs})},0)}return original.apply(this,args)}});handlers.push(restoreHandler)}catch(e){const hookHandler=hookSetter(win.CanvasRenderingContext2D.prototype,prop,{set(v){cb(this.canvas,{type:CanvasContext["2D"],property:prop,args:[v],setter:true})}});handlers.push(hookHandler)}}return()=>{handlers.forEach(h=>h())}}function getNormalizedContextName(contextType){return contextType==="experimental-webgl"?"webgl":contextType}function initCanvasContextObserver(win,blockClass,blockSelector,unblockSelector,setPreserveDrawingBufferToTrue){const handlers=[];try{const restoreHandler=patch(win.HTMLCanvasElement.prototype,"getContext",function(original){return function(contextType,...args){if(!isBlocked(this,blockClass,blockSelector,unblockSelector,true)){const ctxName=getNormalizedContextName(contextType);if(!("__context"in this))this.__context=ctxName;if(setPreserveDrawingBufferToTrue&&["webgl","webgl2"].includes(ctxName)){if(args[0]&&typeof args[0]==="object"){const contextAttributes=args[0];if(!contextAttributes.preserveDrawingBuffer){contextAttributes.preserveDrawingBuffer=true}}else{args.splice(0,1,{preserveDrawingBuffer:true})}}}return original.apply(this,[contextType,...args])}});handlers.push(restoreHandler)}catch(e){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{handlers.forEach(h=>h())}}function patchGLPrototype(prototype,type,cb,blockClass,blockSelector,unblockSelector,mirror,win){const handlers=[];const props=Object.getOwnPropertyNames(prototype);for(const prop of props){if(["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(prop)){continue}try{if(typeof prototype[prop]!=="function"){continue}const restoreHandler=patch(prototype,prop,function(original){return function(...args){const result=original.apply(this,args);saveWebGLVar(result,win,this);if("tagName"in this.canvas&&!isBlocked(this.canvas,blockClass,blockSelector,unblockSelector,true)){const recordArgs=serializeArgs(args,win,this);const mutation={type:type,property:prop,args:recordArgs};cb(this.canvas,mutation)}return result}});handlers.push(restoreHandler)}catch(e){const hookHandler=hookSetter(prototype,prop,{set(v){cb(this.canvas,{type:type,property:prop,args:[v],setter:true})}});handlers.push(hookHandler)}}return handlers}function initCanvasWebGLMutationObserver(cb,win,blockClass,blockSelector,unblockSelector,mirror){const handlers=[];handlers.push(...patchGLPrototype(win.WebGLRenderingContext.prototype,CanvasContext.WebGL,cb,blockClass,blockSelector,unblockSelector,mirror,win));if(typeof win.WebGL2RenderingContext!=="undefined"){handlers.push(...patchGLPrototype(win.WebGL2RenderingContext.prototype,CanvasContext.WebGL2,cb,blockClass,blockSelector,unblockSelector,mirror,win))}return()=>{handlers.forEach(h=>h())}}var r=`for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t="undefined"==typeof Uint8Array?[]:new Uint8Array(256),a=0;a<64;a++)t[e.charCodeAt(a)]=a;var n=function(t){var a,n=new Uint8Array(t),r=n.length,s="";for(a=0;a<r;a+=3)s+=e[n[a]>>2],s+=e[(3&n[a])<<4|n[a+1]>>4],s+=e[(15&n[a+1])<<2|n[a+2]>>6],s+=e[63&n[a+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s};const r=new Map,s=new Map;const i=self;i.onmessage=async function(e){if(!("OffscreenCanvas"in globalThis))return i.postMessage({id:e.data.id});{const{id:t,bitmap:a,width:o,height:f,maxCanvasSize:c,dataURLOptions:g}=e.data,u=async function(e,t,a){const r=e+"-"+t;if("OffscreenCanvas"in globalThis){if(s.has(r))return s.get(r);const i=new OffscreenCanvas(e,t);i.getContext("2d");const o=await i.convertToBlob(a),f=await o.arrayBuffer(),c=n(f);return s.set(r,c),c}return""}(o,f,g),[h,d]=function(e,t,a){if(!a)return[e,t];const[n,r]=a;if(e<=n&&t<=r)return[e,t];let s=e,i=t;return s>n&&(i=Math.floor(n*t/e),s=n),i>r&&(s=Math.floor(r*e/t),i=r),[s,i]}(o,f,c),l=new OffscreenCanvas(h,d),w=l.getContext("bitmaprenderer"),p=h===o&&d===f?a:await createImageBitmap(a,{resizeWidth:h,resizeHeight:d,resizeQuality:"low"});w.transferFromImageBitmap(p),a.close();const y=await l.convertToBlob(g),v=y.type,b=await y.arrayBuffer(),m=n(b);if(p.close(),!r.has(t)&&await u===m)return r.set(t,m),i.postMessage({id:t});if(r.get(t)===m)return i.postMessage({id:t});i.postMessage({id:t,type:v,base64:m,width:o,height:f}),r.set(t,m)}};`;function t(){const t=new Blob([r]);return URL.createObjectURL(t)}class CanvasManager{reset(){this.pendingCanvasMutations.clear();this.restoreHandlers.forEach(handler=>{try{handler()}catch(e){}});this.restoreHandlers=[];this.windowsSet=new WeakSet;this.windows=[];this.shadowDoms=new Set;_optionalChain([this,"access",_=>_.worker,"optionalAccess",_2=>_2.terminate,"call",_3=>_3()]);this.worker=null;this.snapshotInProgressMap=new Map}freeze(){this.frozen=true}unfreeze(){this.frozen=false}lock(){this.locked=true}unlock(){this.locked=false}constructor(options){this.pendingCanvasMutations=new Map;this.rafStamps={latestId:0,invokeId:null};this.shadowDoms=new Set;this.windowsSet=new WeakSet;this.windows=[];this.restoreHandlers=[];this.frozen=false;this.locked=false;this.snapshotInProgressMap=new Map;this.worker=null;this.processMutation=(target,mutation)=>{const newFrame=this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId;if(newFrame||!this.rafStamps.invokeId)this.rafStamps.invokeId=this.rafStamps.latestId;if(!this.pendingCanvasMutations.has(target)){this.pendingCanvasMutations.set(target,[])}this.pendingCanvasMutations.get(target).push(mutation)};const{sampling="all",win,blockClass,blockSelector,unblockSelector,maxCanvasSize,recordCanvas,dataURLOptions,errorHandler}=options;this.mutationCb=options.mutationCb;this.mirror=options.mirror;this.options=options;if(errorHandler){registerErrorHandler(errorHandler)}if(recordCanvas&&typeof sampling==="number"||options.enableManualSnapshot){this.worker=this.initFPSWorker()}this.addWindow(win);if(options.enableManualSnapshot){return}callbackWrapper(()=>{if(recordCanvas&&sampling==="all"){this.startRAFTimestamping();this.startPendingCanvasMutationFlusher()}if(recordCanvas&&typeof sampling==="number"){this.initCanvasFPSObserver(sampling,blockClass,blockSelector,unblockSelector,maxCanvasSize,{dataURLOptions:dataURLOptions})}})()}addWindow(win){const{sampling="all",blockClass,blockSelector,unblockSelector,recordCanvas,enableManualSnapshot}=this.options;if(this.windowsSet.has(win))return;if(enableManualSnapshot){this.windowsSet.add(win);this.windows.push(new WeakRef(win));return}callbackWrapper(()=>{if(recordCanvas&&sampling==="all"){this.initCanvasMutationObserver(win,blockClass,blockSelector,unblockSelector)}if(recordCanvas&&typeof sampling==="number"){const canvasContextReset=initCanvasContextObserver(win,blockClass,blockSelector,unblockSelector,true);this.restoreHandlers.push(()=>{canvasContextReset()})}})();this.windowsSet.add(win);this.windows.push(new WeakRef(win))}addShadowRoot(shadowRoot){this.shadowDoms.add(new WeakRef(shadowRoot))}resetShadowRoots(){this.shadowDoms=new Set}initFPSWorker(){const worker=new Worker(t());worker.onmessage=e=>{const data=e.data;const{id}=data;this.snapshotInProgressMap.set(id,false);if(!("base64"in data))return;const{base64,type,width,height}=data;this.mutationCb({id:id,type:CanvasContext["2D"],commands:[{property:"clearRect",args:[0,0,width,height]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:base64}],type:type}]},0,0,width,height]}]})};return worker}initCanvasFPSObserver(fps,blockClass,blockSelector,unblockSelector,maxCanvasSize,options){const rafId=this.takeSnapshot(false,fps,blockClass,blockSelector,unblockSelector,maxCanvasSize,options.dataURLOptions);this.restoreHandlers.push(()=>{cancelAnimationFrame(rafId)})}initCanvasMutationObserver(win,blockClass,blockSelector,unblockSelector){const canvasContextReset=initCanvasContextObserver(win,blockClass,blockSelector,unblockSelector,false);const canvas2DReset=initCanvas2DMutationObserver(this.processMutation.bind(this),win,blockClass,blockSelector,unblockSelector);const canvasWebGL1and2Reset=initCanvasWebGLMutationObserver(this.processMutation.bind(this),win,blockClass,blockSelector,unblockSelector,this.mirror);this.restoreHandlers.push(()=>{canvasContextReset();canvas2DReset();canvasWebGL1and2Reset()})}snapshot(canvasElement){const{options}=this;const rafId=this.takeSnapshot(true,options.sampling==="all"?2:options.sampling||2,options.blockClass,options.blockSelector,options.unblockSelector,options.maxCanvasSize,options.dataURLOptions,canvasElement);this.restoreHandlers.push(()=>{cancelAnimationFrame(rafId)})}takeSnapshot(isManualSnapshot,fps,blockClass,blockSelector,unblockSelector,maxCanvasSize,dataURLOptions,canvasElement){const timeBetweenSnapshots=1e3/fps;let lastSnapshotTime=0;let rafId;const getCanvas=canvasElement=>{if(canvasElement){return[canvasElement]}const matchedCanvas=[];const searchCanvas=root=>{root.querySelectorAll("canvas").forEach(canvas=>{if(!isBlocked(canvas,blockClass,blockSelector,unblockSelector)){matchedCanvas.push(canvas)}})};for(const item of this.windows){const window=item.deref();if(window){searchCanvas(window.document)}}for(const item of this.shadowDoms){const shadowRoot=item.deref();if(shadowRoot){searchCanvas(shadowRoot)}}return matchedCanvas};const takeCanvasSnapshots=timestamp=>{if(!this.windows.length){return}if(lastSnapshotTime&&timestamp-lastSnapshotTime<timeBetweenSnapshots){rafId=onRequestAnimationFrame(takeCanvasSnapshots);return}lastSnapshotTime=timestamp;getCanvas(canvasElement).forEach(canvas=>{if(!this.mirror.hasNode(canvas)){return}const id=this.mirror.getId(canvas);if(this.snapshotInProgressMap.get(id))return;if(!canvas.width||!canvas.height)return;this.snapshotInProgressMap.set(id,true);if(!isManualSnapshot&&["webgl","webgl2"].includes(canvas.__context)){const context=canvas.getContext(canvas.__context);if(_optionalChain([context,"optionalAccess",_4=>_4.getContextAttributes,"call",_5=>_5(),"optionalAccess",_6=>_6.preserveDrawingBuffer])===false){context.clear(context.COLOR_BUFFER_BIT)}}createImageBitmap(canvas).then(bitmap=>{_optionalChain([this,"access",_7=>_7.worker,"optionalAccess",_8=>_8.postMessage,"call",_9=>_9({id:id,bitmap:bitmap,width:canvas.width,height:canvas.height,dataURLOptions:dataURLOptions,maxCanvasSize:maxCanvasSize},[bitmap])])}).catch(error=>{callbackWrapper(()=>{throw error})()})});if(!isManualSnapshot){rafId=onRequestAnimationFrame(takeCanvasSnapshots)}};rafId=onRequestAnimationFrame(takeCanvasSnapshots);return rafId}startPendingCanvasMutationFlusher(){onRequestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const setLatestRAFTimestamp=timestamp=>{this.rafStamps.latestId=timestamp;onRequestAnimationFrame(setLatestRAFTimestamp)};onRequestAnimationFrame(setLatestRAFTimestamp)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((values,canvas)=>{const id=this.mirror.getId(canvas);this.flushPendingCanvasMutationFor(canvas,id)});onRequestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(canvas,id){if(this.frozen||this.locked){return}const valuesWithType=this.pendingCanvasMutations.get(canvas);if(!valuesWithType||id===-1)return;const values=valuesWithType.map(value=>{const{type,...rest}=value;return rest});const{type}=valuesWithType[0];this.mutationCb({id:id,type:type,commands:values});this.pendingCanvasMutations.delete(canvas)}}const CANVAS_QUALITY={low:{sampling:{canvas:1},dataURLOptions:{type:"image/webp",quality:.25}},medium:{sampling:{canvas:2},dataURLOptions:{type:"image/webp",quality:.4}},high:{sampling:{canvas:4},dataURLOptions:{type:"image/webp",quality:.5}}};const INTEGRATION_NAME="ReplayCanvas";const DEFAULT_MAX_CANVAS_SIZE=1280;const _replayCanvasIntegration=(options={})=>{const[maxCanvasWidth,maxCanvasHeight]=options.maxCanvasSize||[];const _canvasOptions={quality:options.quality||"medium",enableManualSnapshot:options.enableManualSnapshot,maxCanvasSize:[maxCanvasWidth?Math.min(maxCanvasWidth,DEFAULT_MAX_CANVAS_SIZE):DEFAULT_MAX_CANVAS_SIZE,maxCanvasHeight?Math.min(maxCanvasHeight,DEFAULT_MAX_CANVAS_SIZE):DEFAULT_MAX_CANVAS_SIZE]};let canvasManagerResolve;const _canvasManager=new Promise(resolve=>canvasManagerResolve=resolve);return{name:INTEGRATION_NAME,getOptions(){const{quality,enableManualSnapshot,maxCanvasSize}=_canvasOptions;return{enableManualSnapshot:enableManualSnapshot,recordCanvas:true,getCanvasManager:getCanvasManagerOptions=>{const manager=new CanvasManager({...getCanvasManagerOptions,enableManualSnapshot:enableManualSnapshot,maxCanvasSize:maxCanvasSize,errorHandler:err=>{try{if(typeof err==="object"){err.__rrweb__=true}}catch(error){}}});canvasManagerResolve(manager);return manager},...CANVAS_QUALITY[quality||"medium"]||CANVAS_QUALITY.medium}},async snapshot(canvasElement){const canvasManager=await _canvasManager;canvasManager.snapshot(canvasElement)}}};const replayCanvasIntegration=core.defineIntegration(_replayCanvasIntegration);exports.replayCanvasIntegration=replayCanvasIntegration},{"@sentry/core":87}],35:[function(require,module,exports){var{_nullishCoalesce,_optionalChain}=require("@sentry/core");Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const browserUtils=require("@sentry-internal/browser-utils");const WINDOW=core.GLOBAL_OBJ;const REPLAY_SESSION_KEY="sentryReplaySession";const REPLAY_EVENT_NAME="replay_event";const UNABLE_TO_SEND_REPLAY="Unable to send Replay";const SESSION_IDLE_PAUSE_DURATION=3e5;const SESSION_IDLE_EXPIRE_DURATION=9e5;const DEFAULT_FLUSH_MIN_DELAY=5e3;const DEFAULT_FLUSH_MAX_DELAY=5500;const BUFFER_CHECKOUT_TIME=6e4;const RETRY_BASE_INTERVAL=5e3;const RETRY_MAX_COUNT=3;const NETWORK_BODY_MAX_SIZE=15e4;const CONSOLE_ARG_MAX_SIZE=5e3;const SLOW_CLICK_THRESHOLD=3e3;const SLOW_CLICK_SCROLL_TIMEOUT=300;const REPLAY_MAX_EVENT_BUFFER_SIZE=2e7;const MIN_REPLAY_DURATION=4999;const MIN_REPLAY_DURATION_LIMIT=15e3;const MAX_REPLAY_DURATION=36e5;function _nullishCoalesce$1(lhs,rhsFn){if(lhs!=null){return lhs}else{return rhsFn()}}function _optionalChain$5(ops){let lastAccessLHS=undefined;let value=ops[0];let i=1;while(i<ops.length){const op=ops[i];const fn=ops[i+1];i+=2;if((op==="optionalAccess"||op==="optionalCall")&&value==null){return undefined}if(op==="access"||op==="optionalAccess"){lastAccessLHS=value;value=fn(value)}else if(op==="call"||op==="optionalCall"){value=fn((...args)=>value.call(lastAccessLHS,...args));lastAccessLHS=undefined}}return value}var NodeType$3;(function(NodeType){NodeType[NodeType["Document"]=0]="Document";NodeType[NodeType["DocumentType"]=1]="DocumentType";NodeType[NodeType["Element"]=2]="Element";NodeType[NodeType["Text"]=3]="Text";NodeType[NodeType["CDATA"]=4]="CDATA";NodeType[NodeType["Comment"]=5]="Comment"})(NodeType$3||(NodeType$3={}));function isElement$1(n){return n.nodeType===n.ELEMENT_NODE}function isShadowRoot(n){const host=_optionalChain$5([n,"optionalAccess",_=>_.host]);return Boolean(_optionalChain$5([host,"optionalAccess",_2=>_2.shadowRoot])===n)}function isNativeShadowDom(shadowRoot){return Object.prototype.toString.call(shadowRoot)==="[object ShadowRoot]"}function fixBrowserCompatibilityIssuesInCSS(cssText){if(cssText.includes(" background-clip: text;")&&!cssText.includes(" -webkit-background-clip: text;")){cssText=cssText.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")}return cssText}function escapeImportStatement(rule){const{cssText}=rule;if(cssText.split('"').length<3)return cssText;const statement=["@import",`url(${JSON.stringify(rule.href)})`];if(rule.layerName===""){statement.push(`layer`)}else if(rule.layerName){statement.push(`layer(${rule.layerName})`)}if(rule.supportsText){statement.push(`supports(${rule.supportsText})`)}if(rule.media.length){statement.push(rule.media.mediaText)}return statement.join(" ")+";"}function stringifyStylesheet(s){try{const rules=s.rules||s.cssRules;return rules?fixBrowserCompatibilityIssuesInCSS(Array.from(rules,stringifyRule).join("")):null}catch(error){return null}}function fixAllCssProperty(rule){let styles="";for(let i=0;i<rule.style.length;i++){const styleDeclaration=rule.style;const attribute=styleDeclaration[i];const isImportant=styleDeclaration.getPropertyPriority(attribute);styles+=`${attribute}:${styleDeclaration.getPropertyValue(attribute)}${isImportant?` !important`:""};`}return`${rule.selectorText} { ${styles} }`}function stringifyRule(rule){let importStringified;if(isCSSImportRule(rule)){try{importStringified=stringifyStylesheet(rule.styleSheet)||escapeImportStatement(rule)}catch(error){}}else if(isCSSStyleRule(rule)){let cssText=rule.cssText;const needsSafariColonFix=rule.selectorText.includes(":");const needsAllFix=typeof rule.style["all"]==="string"&&rule.style["all"];if(needsAllFix){cssText=fixAllCssProperty(rule)}if(needsSafariColonFix){cssText=fixSafariColons(cssText)}if(needsSafariColonFix||needsAllFix){return cssText}}return importStringified||rule.cssText}function fixSafariColons(cssStringified){const regex=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return cssStringified.replace(regex,"$1\\$2")}function isCSSImportRule(rule){return"styleSheet"in rule}function isCSSStyleRule(rule){return"selectorText"in rule}class Mirror{constructor(){this.idNodeMap=new Map;this.nodeMetaMap=new WeakMap}getId(n){if(!n)return-1;const id=_optionalChain$5([this,"access",_3=>_3.getMeta,"call",_4=>_4(n),"optionalAccess",_5=>_5.id]);return _nullishCoalesce$1(id,()=>-1)}getNode(id){return this.idNodeMap.get(id)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(n){return this.nodeMetaMap.get(n)||null}removeNodeFromMap(n){const id=this.getId(n);this.idNodeMap.delete(id);if(n.childNodes){n.childNodes.forEach(childNode=>this.removeNodeFromMap(childNode))}}has(id){return this.idNodeMap.has(id)}hasNode(node){return this.nodeMetaMap.has(node)}add(n,meta){const id=meta.id;this.idNodeMap.set(id,n);this.nodeMetaMap.set(n,meta)}replace(id,n){const oldNode=this.getNode(id);if(oldNode){const meta=this.nodeMetaMap.get(oldNode);if(meta)this.nodeMetaMap.set(n,meta)}this.idNodeMap.set(id,n)}reset(){this.idNodeMap=new Map;this.nodeMetaMap=new WeakMap}}function createMirror(){return new Mirror}function shouldMaskInput({maskInputOptions,tagName,type}){if(tagName==="OPTION"){tagName="SELECT"}return Boolean(maskInputOptions[tagName.toLowerCase()]||type&&maskInputOptions[type]||type==="password"||tagName==="INPUT"&&!type&&maskInputOptions["text"])}function maskInputValue({isMasked,element,value,maskInputFn}){let text=value||"";if(!isMasked){return text}if(maskInputFn){text=maskInputFn(text,element)}return"*".repeat(text.length)}function toLowerCase(str){return str.toLowerCase()}function toUpperCase(str){return str.toUpperCase()}const ORIGINAL_ATTRIBUTE_NAME="__rrweb_original__";function is2DCanvasBlank(canvas){const ctx=canvas.getContext("2d");if(!ctx)return true;const chunkSize=50;for(let x=0;x<canvas.width;x+=chunkSize){for(let y=0;y<canvas.height;y+=chunkSize){const getImageData=ctx.getImageData;const originalGetImageData=ORIGINAL_ATTRIBUTE_NAME in getImageData?getImageData[ORIGINAL_ATTRIBUTE_NAME]:getImageData;const pixelBuffer=new Uint32Array(originalGetImageData.call(ctx,x,y,Math.min(chunkSize,canvas.width-x),Math.min(chunkSize,canvas.height-y)).data.buffer);if(pixelBuffer.some(pixel=>pixel!==0))return false}}return true}function getInputType(element){const type=element.type;return element.hasAttribute("data-rr-is-password")?"password":type?toLowerCase(type):null}function getInputValue(el,tagName,type){if(tagName==="INPUT"&&(type==="radio"||type==="checkbox")){return el.getAttribute("value")||""}return el.value}function extractFileExtension(path,baseURL){let url;try{url=new URL(path,_nullishCoalesce$1(baseURL,()=>window.location.href))}catch(err){return null}const regex=/\.([0-9a-z]+)(?:$)/i;const match=url.pathname.match(regex);return _nullishCoalesce$1(_optionalChain$5([match,"optionalAccess",_6=>_6[1]]),()=>null)}const cachedImplementations$1={};function getImplementation$1(name){const cached=cachedImplementations$1[name];if(cached){return cached}const document=window.document;let impl=window[name];if(document&&typeof document.createElement==="function"){try{const sandbox=document.createElement("iframe");sandbox.hidden=true;document.head.appendChild(sandbox);const contentWindow=sandbox.contentWindow;if(contentWindow&&contentWindow[name]){impl=contentWindow[name]}document.head.removeChild(sandbox)}catch(e){}}return cachedImplementations$1[name]=impl.bind(window)}function setTimeout$2(...rest){return getImplementation$1("setTimeout")(...rest)}function clearTimeout$2(...rest){return getImplementation$1("clearTimeout")(...rest)}function getIframeContentDocument(iframe){try{return iframe.contentDocument}catch(e){}}let _id=1;const tagNameRegex=new RegExp("[^a-z0-9-_:]");const IGNORED_NODE=-2;function genId(){return _id++}function getValidTagName(element){if(element instanceof HTMLFormElement){return"form"}const processedTagName=toLowerCase(element.tagName);if(tagNameRegex.test(processedTagName)){return"div"}return processedTagName}function extractOrigin(url){let origin="";if(url.indexOf("//")>-1){origin=url.split("/").slice(0,3).join("/")}else{origin=url.split("/")[0]}origin=origin.split("?")[0];return origin}let canvasService;let canvasCtx;const URL_IN_CSS_REF=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm;const URL_PROTOCOL_MATCH=/^(?:[a-z+]+:)?\/\//i;const URL_WWW_MATCH=/^www\..*/i;const DATA_URI=/^(data:)([^,]*),(.*)/i;function absoluteToStylesheet(cssText,href){return(cssText||"").replace(URL_IN_CSS_REF,(origin,quote1,path1,quote2,path2,path3)=>{const filePath=path1||path2||path3;const maybeQuote=quote1||quote2||"";if(!filePath){return origin}if(URL_PROTOCOL_MATCH.test(filePath)||URL_WWW_MATCH.test(filePath)){return`url(${maybeQuote}${filePath}${maybeQuote})`}if(DATA_URI.test(filePath)){return`url(${maybeQuote}${filePath}${maybeQuote})`}if(filePath[0]==="/"){return`url(${maybeQuote}${extractOrigin(href)+filePath}${maybeQuote})`}const stack=href.split("/");const parts=filePath.split("/");stack.pop();for(const part of parts){if(part==="."){continue}else if(part===".."){stack.pop()}else{stack.push(part)}}return`url(${maybeQuote}${stack.join("/")}${maybeQuote})`})}const SRCSET_NOT_SPACES=/^[^ \t\n\r\u000c]+/;const SRCSET_COMMAS_OR_SPACES=/^[, \t\n\r\u000c]+/;function getAbsoluteSrcsetString(doc,attributeValue){if(attributeValue.trim()===""){return attributeValue}let pos=0;function collectCharacters(regEx){let chars;const match=regEx.exec(attributeValue.substring(pos));if(match){chars=match[0];pos+=chars.length;return chars}return""}const output=[];while(true){collectCharacters(SRCSET_COMMAS_OR_SPACES);if(pos>=attributeValue.length){break}let url=collectCharacters(SRCSET_NOT_SPACES);if(url.slice(-1)===","){url=absoluteToDoc(doc,url.substring(0,url.length-1));output.push(url)}else{let descriptorsStr="";url=absoluteToDoc(doc,url);let inParens=false;while(true){const c=attributeValue.charAt(pos);if(c===""){output.push((url+descriptorsStr).trim());break}else if(!inParens){if(c===","){pos+=1;output.push((url+descriptorsStr).trim());break}else if(c==="("){inParens=true}}else{if(c===")"){inParens=false}}descriptorsStr+=c;pos+=1}}}return output.join(", ")}const cachedDocument=new WeakMap;function absoluteToDoc(doc,attributeValue){if(!attributeValue||attributeValue.trim()===""){return attributeValue}return getHref(doc,attributeValue)}function isSVGElement(el){return Boolean(el.tagName==="svg"||el.ownerSVGElement)}function getHref(doc,customHref){let a=cachedDocument.get(doc);if(!a){a=doc.createElement("a");cachedDocument.set(doc,a)}if(!customHref){customHref=""}else if(customHref.startsWith("blob:")||customHref.startsWith("data:")){return customHref}a.setAttribute("href",customHref);return a.href}function transformAttribute(doc,tagName,name,value,element,maskAttributeFn){if(!value){return value}if(name==="src"||name==="href"&&!(tagName==="use"&&value[0]==="#")){return absoluteToDoc(doc,value)}else if(name==="xlink:href"&&value[0]!=="#"){return absoluteToDoc(doc,value)}else if(name==="background"&&(tagName==="table"||tagName==="td"||tagName==="th")){return absoluteToDoc(doc,value)}else if(name==="srcset"){return getAbsoluteSrcsetString(doc,value)}else if(name==="style"){return absoluteToStylesheet(value,getHref(doc))}else if(tagName==="object"&&name==="data"){return absoluteToDoc(doc,value)}if(typeof maskAttributeFn==="function"){return maskAttributeFn(name,value,element)}return value}function ignoreAttribute(tagName,name,_value){return(tagName==="video"||tagName==="audio")&&name==="autoplay"}function _isBlockedElement(element,blockClass,blockSelector,unblockSelector){try{if(unblockSelector&&element.matches(unblockSelector)){return false}if(typeof blockClass==="string"){if(element.classList.contains(blockClass)){return true}}else{for(let eIndex=element.classList.length;eIndex--;){const className=element.classList[eIndex];if(blockClass.test(className)){return true}}}if(blockSelector){return element.matches(blockSelector)}}catch(e){}return false}function elementClassMatchesRegex(el,regex){for(let eIndex=el.classList.length;eIndex--;){const className=el.classList[eIndex];if(regex.test(className)){return true}}return false}function distanceToMatch(node,matchPredicate,limit=Infinity,distance=0){if(!node)return-1;if(node.nodeType!==node.ELEMENT_NODE)return-1;if(distance>limit)return-1;if(matchPredicate(node))return distance;return distanceToMatch(node.parentNode,matchPredicate,limit,distance+1)}function createMatchPredicate(className,selector){return node=>{const el=node;if(el===null)return false;try{if(className){if(typeof className==="string"){if(el.matches(`.${className}`))return true}else if(elementClassMatchesRegex(el,className)){return true}}if(selector&&el.matches(selector))return true;return false}catch(e2){return false}}}function needMaskingText(node,maskTextClass,maskTextSelector,unmaskTextClass,unmaskTextSelector,maskAllText){try{const el=node.nodeType===node.ELEMENT_NODE?node:node.parentElement;if(el===null)return false;if(el.tagName==="INPUT"){const autocomplete=el.getAttribute("autocomplete");const disallowedAutocompleteValues=["current-password","new-password","cc-number","cc-exp","cc-exp-month","cc-exp-year","cc-csc"];if(disallowedAutocompleteValues.includes(autocomplete)){return true}}let maskDistance=-1;let unmaskDistance=-1;if(maskAllText){unmaskDistance=distanceToMatch(el,createMatchPredicate(unmaskTextClass,unmaskTextSelector));if(unmaskDistance<0){return true}maskDistance=distanceToMatch(el,createMatchPredicate(maskTextClass,maskTextSelector),unmaskDistance>=0?unmaskDistance:Infinity)}else{maskDistance=distanceToMatch(el,createMatchPredicate(maskTextClass,maskTextSelector));if(maskDistance<0){return false}unmaskDistance=distanceToMatch(el,createMatchPredicate(unmaskTextClass,unmaskTextSelector),maskDistance>=0?maskDistance:Infinity)}return maskDistance>=0?unmaskDistance>=0?maskDistance<=unmaskDistance:true:unmaskDistance>=0?false:!!maskAllText}catch(e){}return!!maskAllText}function onceIframeLoaded(iframeEl,listener,iframeLoadTimeout){const win=iframeEl.contentWindow;if(!win){return}let fired=false;let readyState;try{readyState=win.document.readyState}catch(error){return}if(readyState!=="complete"){const timer=setTimeout$2(()=>{if(!fired){listener();fired=true}},iframeLoadTimeout);iframeEl.addEventListener("load",()=>{clearTimeout$2(timer);fired=true;listener()});return}const blankUrl="about:blank";if(win.location.href!==blankUrl||iframeEl.src===blankUrl||iframeEl.src===""){setTimeout$2(listener,0);return iframeEl.addEventListener("load",listener)}iframeEl.addEventListener("load",listener)}function onceStylesheetLoaded(link,listener,styleSheetLoadTimeout){let fired=false;let styleSheetLoaded;try{styleSheetLoaded=link.sheet}catch(error){return}if(styleSheetLoaded)return;const timer=setTimeout$2(()=>{if(!fired){listener();fired=true}},styleSheetLoadTimeout);link.addEventListener("load",()=>{clearTimeout$2(timer);fired=true;listener()})}function serializeNode(n,options){const{doc,mirror,blockClass,blockSelector,unblockSelector,maskAllText,maskAttributeFn,maskTextClass,unmaskTextClass,maskTextSelector,unmaskTextSelector,inlineStylesheet,maskInputOptions={},maskTextFn,maskInputFn,dataURLOptions={},inlineImages,recordCanvas,keepIframeSrcFn,newlyAddedElement=false}=options;const rootId=getRootId(doc,mirror);switch(n.nodeType){case n.DOCUMENT_NODE:if(n.compatMode!=="CSS1Compat"){return{type:NodeType$3.Document,childNodes:[],compatMode:n.compatMode}}else{return{type:NodeType$3.Document,childNodes:[]}}case n.DOCUMENT_TYPE_NODE:return{type:NodeType$3.DocumentType,name:n.name,publicId:n.publicId,systemId:n.systemId,rootId:rootId};case n.ELEMENT_NODE:return serializeElementNode(n,{doc:doc,blockClass:blockClass,blockSelector:blockSelector,unblockSelector:unblockSelector,inlineStylesheet:inlineStylesheet,maskAttributeFn:maskAttributeFn,maskInputOptions:maskInputOptions,maskInputFn:maskInputFn,dataURLOptions:dataURLOptions,inlineImages:inlineImages,recordCanvas:recordCanvas,keepIframeSrcFn:keepIframeSrcFn,newlyAddedElement:newlyAddedElement,rootId:rootId,maskAllText:maskAllText,maskTextClass:maskTextClass,unmaskTextClass:unmaskTextClass,maskTextSelector:maskTextSelector,unmaskTextSelector:unmaskTextSelector});case n.TEXT_NODE:return serializeTextNode(n,{doc:doc,maskAllText:maskAllText,maskTextClass:maskTextClass,unmaskTextClass:unmaskTextClass,maskTextSelector:maskTextSelector,unmaskTextSelector:unmaskTextSelector,maskTextFn:maskTextFn,maskInputOptions:maskInputOptions,maskInputFn:maskInputFn,rootId:rootId});case n.CDATA_SECTION_NODE:return{type:NodeType$3.CDATA,textContent:"",rootId:rootId};case n.COMMENT_NODE:return{type:NodeType$3.Comment,textContent:n.textContent||"",rootId:rootId};default:return false}}function getRootId(doc,mirror){if(!mirror.hasNode(doc))return undefined;const docId=mirror.getId(doc);return docId===1?undefined:docId}function serializeTextNode(n,options){const{maskAllText,maskTextClass,unmaskTextClass,maskTextSelector,unmaskTextSelector,maskTextFn,maskInputOptions,maskInputFn,rootId}=options;const parentTagName=n.parentNode&&n.parentNode.tagName;let textContent=n.textContent;const isStyle=parentTagName==="STYLE"?true:undefined;const isScript=parentTagName==="SCRIPT"?true:undefined;const isTextarea=parentTagName==="TEXTAREA"?true:undefined;if(isStyle&&textContent){try{if(n.nextSibling||n.previousSibling){}else if(_optionalChain$5([n,"access",_7=>_7.parentNode,"access",_8=>_8.sheet,"optionalAccess",_9=>_9.cssRules])){textContent=stringifyStylesheet(n.parentNode.sheet)}}catch(err){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${err}`,n)}textContent=absoluteToStylesheet(textContent,getHref(options.doc))}if(isScript){textContent="SCRIPT_PLACEHOLDER"}const forceMask=needMaskingText(n,maskTextClass,maskTextSelector,unmaskTextClass,unmaskTextSelector,maskAllText);if(!isStyle&&!isScript&&!isTextarea&&textContent&&forceMask){textContent=maskTextFn?maskTextFn(textContent,n.parentElement):textContent.replace(/[\S]/g,"*")}if(isTextarea&&textContent&&(maskInputOptions.textarea||forceMask)){textContent=maskInputFn?maskInputFn(textContent,n.parentNode):textContent.replace(/[\S]/g,"*")}if(parentTagName==="OPTION"&&textContent){const isInputMasked=shouldMaskInput({type:null,tagName:parentTagName,maskInputOptions:maskInputOptions});textContent=maskInputValue({isMasked:needMaskingText(n,maskTextClass,maskTextSelector,unmaskTextClass,unmaskTextSelector,isInputMasked),element:n,value:textContent,maskInputFn:maskInputFn})}return{type:NodeType$3.Text,textContent:textContent||"",isStyle:isStyle,rootId:rootId}}function serializeElementNode(n,options){const{doc,blockClass,blockSelector,unblockSelector,inlineStylesheet,maskInputOptions={},maskAttributeFn,maskInputFn,dataURLOptions={},inlineImages,recordCanvas,keepIframeSrcFn,newlyAddedElement=false,rootId,maskAllText,maskTextClass,unmaskTextClass,maskTextSelector,unmaskTextSelector}=options;const needBlock=_isBlockedElement(n,blockClass,blockSelector,unblockSelector);const tagName=getValidTagName(n);let attributes={};const len=n.attributes.length;for(let i=0;i<len;i++){const attr=n.attributes[i];if(attr.name&&!ignoreAttribute(tagName,attr.name,attr.value)){attributes[attr.name]=transformAttribute(doc,tagName,toLowerCase(attr.name),attr.value,n,maskAttributeFn)}}if(tagName==="link"&&inlineStylesheet){const stylesheet=Array.from(doc.styleSheets).find(s=>{return s.href===n.href});let cssText=null;if(stylesheet){cssText=stringifyStylesheet(stylesheet)}if(cssText){attributes.rel=null;attributes.href=null;attributes.crossorigin=null;attributes._cssText=absoluteToStylesheet(cssText,stylesheet.href)}}if(tagName==="style"&&n.sheet&&!(n.innerText||n.textContent||"").trim().length){const cssText=stringifyStylesheet(n.sheet);if(cssText){attributes._cssText=absoluteToStylesheet(cssText,getHref(doc))}}if(tagName==="input"||tagName==="textarea"||tagName==="select"||tagName==="option"){const el=n;const type=getInputType(el);const value=getInputValue(el,toUpperCase(tagName),type);const checked=el.checked;if(type!=="submit"&&type!=="button"&&value){const forceMask=needMaskingText(el,maskTextClass,maskTextSelector,unmaskTextClass,unmaskTextSelector,shouldMaskInput({type:type,tagName:toUpperCase(tagName),maskInputOptions:maskInputOptions}));attributes.value=maskInputValue({isMasked:forceMask,element:el,value:value,maskInputFn:maskInputFn})}if(checked){attributes.checked=checked}}if(tagName==="option"){if(n.selected&&!maskInputOptions["select"]){attributes.selected=true}else{delete attributes.selected}}if(tagName==="canvas"&&recordCanvas){if(n.__context==="2d"){if(!is2DCanvasBlank(n)){attributes.rr_dataURL=n.toDataURL(dataURLOptions.type,dataURLOptions.quality)}}else if(!("__context"in n)){const canvasDataURL=n.toDataURL(dataURLOptions.type,dataURLOptions.quality);const blankCanvas=doc.createElement("canvas");blankCanvas.width=n.width;blankCanvas.height=n.height;const blankCanvasDataURL=blankCanvas.toDataURL(dataURLOptions.type,dataURLOptions.quality);if(canvasDataURL!==blankCanvasDataURL){attributes.rr_dataURL=canvasDataURL}}}if(tagName==="img"&&inlineImages){if(!canvasService){canvasService=doc.createElement("canvas");canvasCtx=canvasService.getContext("2d")}const image=n;const imageSrc=image.currentSrc||image.getAttribute("src")||"<unknown-src>";const priorCrossOrigin=image.crossOrigin;const recordInlineImage=()=>{image.removeEventListener("load",recordInlineImage);try{canvasService.width=image.naturalWidth;canvasService.height=image.naturalHeight;canvasCtx.drawImage(image,0,0);attributes.rr_dataURL=canvasService.toDataURL(dataURLOptions.type,dataURLOptions.quality)}catch(err){if(image.crossOrigin!=="anonymous"){image.crossOrigin="anonymous";if(image.complete&&image.naturalWidth!==0)recordInlineImage();else image.addEventListener("load",recordInlineImage);return}else{console.warn(`Cannot inline img src=${imageSrc}! Error: ${err}`)}}if(image.crossOrigin==="anonymous"){priorCrossOrigin?attributes.crossOrigin=priorCrossOrigin:image.removeAttribute("crossorigin")}};if(image.complete&&image.naturalWidth!==0)recordInlineImage();else image.addEventListener("load",recordInlineImage)}if(tagName==="audio"||tagName==="video"){attributes.rr_mediaState=n.paused?"paused":"played";attributes.rr_mediaCurrentTime=n.currentTime}if(!newlyAddedElement){if(n.scrollLeft){attributes.rr_scrollLeft=n.scrollLeft}if(n.scrollTop){attributes.rr_scrollTop=n.scrollTop}}if(needBlock){const{width,height}=n.getBoundingClientRect();attributes={class:attributes.class,rr_width:`${width}px`,rr_height:`${height}px`}}if(tagName==="iframe"&&!keepIframeSrcFn(attributes.src)){if(!needBlock&&!getIframeContentDocument(n)){attributes.rr_src=attributes.src}delete attributes.src}let isCustomElement;try{if(customElements.get(tagName))isCustomElement=true}catch(e){}return{type:NodeType$3.Element,tagName:tagName,attributes:attributes,childNodes:[],isSVG:isSVGElement(n)||undefined,needBlock:needBlock,rootId:rootId,isCustom:isCustomElement}}function lowerIfExists(maybeAttr){if(maybeAttr===undefined||maybeAttr===null){return""}else{return maybeAttr.toLowerCase()}}function slimDOMExcluded(sn,slimDOMOptions){if(slimDOMOptions.comment&&sn.type===NodeType$3.Comment){return true}else if(sn.type===NodeType$3.Element){if(slimDOMOptions.script&&(sn.tagName==="script"||sn.tagName==="link"&&(sn.attributes.rel==="preload"||sn.attributes.rel==="modulepreload")||sn.tagName==="link"&&sn.attributes.rel==="prefetch"&&typeof sn.attributes.href==="string"&&extractFileExtension(sn.attributes.href)==="js")){return true}else if(slimDOMOptions.headFavicon&&(sn.tagName==="link"&&sn.attributes.rel==="shortcut icon"||sn.tagName==="meta"&&(lowerIfExists(sn.attributes.name).match(/^msapplication-tile(image|color)$/)||lowerIfExists(sn.attributes.name)==="application-name"||lowerIfExists(sn.attributes.rel)==="icon"||lowerIfExists(sn.attributes.rel)==="apple-touch-icon"||lowerIfExists(sn.attributes.rel)==="shortcut icon"))){return true}else if(sn.tagName==="meta"){if(slimDOMOptions.headMetaDescKeywords&&lowerIfExists(sn.attributes.name).match(/^description|keywords$/)){return true}else if(slimDOMOptions.headMetaSocial&&(lowerIfExists(sn.attributes.property).match(/^(og|twitter|fb):/)||lowerIfExists(sn.attributes.name).match(/^(og|twitter):/)||lowerIfExists(sn.attributes.name)==="pinterest")){return true}else if(slimDOMOptions.headMetaRobots&&(lowerIfExists(sn.attributes.name)==="robots"||lowerIfExists(sn.attributes.name)==="googlebot"||lowerIfExists(sn.attributes.name)==="bingbot")){return true}else if(slimDOMOptions.headMetaHttpEquiv&&sn.attributes["http-equiv"]!==undefined){return true}else if(slimDOMOptions.headMetaAuthorship&&(lowerIfExists(sn.attributes.name)==="author"||lowerIfExists(sn.attributes.name)==="generator"||lowerIfExists(sn.attributes.name)==="framework"||lowerIfExists(sn.attributes.name)==="publisher"||lowerIfExists(sn.attributes.name)==="progid"||lowerIfExists(sn.attributes.property).match(/^article:/)||lowerIfExists(sn.attributes.property).match(/^product:/))){return true}else if(slimDOMOptions.headMetaVerification&&(lowerIfExists(sn.attributes.name)==="google-site-verification"||lowerIfExists(sn.attributes.name)==="yandex-verification"||lowerIfExists(sn.attributes.name)==="csrf-token"||lowerIfExists(sn.attributes.name)==="p:domain_verify"||lowerIfExists(sn.attributes.name)==="verify-v1"||lowerIfExists(sn.attributes.name)==="verification"||lowerIfExists(sn.attributes.name)==="shopify-checkout-api-token")){return true}}}return false}function serializeNodeWithId(n,options){const{doc,mirror,blockClass,blockSelector,unblockSelector,maskAllText,maskTextClass,unmaskTextClass,maskTextSelector,unmaskTextSelector,skipChild=false,inlineStylesheet=true,maskInputOptions={},maskAttributeFn,maskTextFn,maskInputFn,slimDOMOptions,dataURLOptions={},inlineImages=false,recordCanvas=false,onSerialize,onIframeLoad,iframeLoadTimeout=5e3,onStylesheetLoad,stylesheetLoadTimeout=5e3,keepIframeSrcFn=()=>false,newlyAddedElement=false}=options;let{preserveWhiteSpace=true}=options;const _serializedNode=serializeNode(n,{doc:doc,mirror:mirror,blockClass:blockClass,blockSelector:blockSelector,maskAllText:maskAllText,unblockSelector:unblockSelector,maskTextClass:maskTextClass,unmaskTextClass:unmaskTextClass,maskTextSelector:maskTextSelector,unmaskTextSelector:unmaskTextSelector,inlineStylesheet:inlineStylesheet,maskInputOptions:maskInputOptions,maskAttributeFn:maskAttributeFn,maskTextFn:maskTextFn,maskInputFn:maskInputFn,dataURLOptions:dataURLOptions,inlineImages:inlineImages,recordCanvas:recordCanvas,keepIframeSrcFn:keepIframeSrcFn,newlyAddedElement:newlyAddedElement});if(!_serializedNode){console.warn(n,"not serialized");return null}let id;if(mirror.hasNode(n)){id=mirror.getId(n)}else if(slimDOMExcluded(_serializedNode,slimDOMOptions)||!preserveWhiteSpace&&_serializedNode.type===NodeType$3.Text&&!_serializedNode.isStyle&&!_serializedNode.textContent.replace(/^\s+|\s+$/gm,"").length){id=IGNORED_NODE}else{id=genId()}const serializedNode=Object.assign(_serializedNode,{id:id});mirror.add(n,serializedNode);if(id===IGNORED_NODE){return null}if(onSerialize){onSerialize(n)}let recordChild=!skipChild;if(serializedNode.type===NodeType$3.Element){recordChild=recordChild&&!serializedNode.needBlock;delete serializedNode.needBlock;const shadowRoot=n.shadowRoot;if(shadowRoot&&isNativeShadowDom(shadowRoot))serializedNode.isShadowHost=true}if((serializedNode.type===NodeType$3.Document||serializedNode.type===NodeType$3.Element)&&recordChild){if(slimDOMOptions.headWhitespace&&serializedNode.type===NodeType$3.Element&&serializedNode.tagName==="head"){preserveWhiteSpace=false}const bypassOptions={doc:doc,mirror:mirror,blockClass:blockClass,blockSelector:blockSelector,maskAllText:maskAllText,unblockSelector:unblockSelector,maskTextClass:maskTextClass,unmaskTextClass:unmaskTextClass,maskTextSelector:maskTextSelector,unmaskTextSelector:unmaskTextSelector,skipChild:skipChild,inlineStylesheet:inlineStylesheet,maskInputOptions:maskInputOptions,maskAttributeFn:maskAttributeFn,maskTextFn:maskTextFn,maskInputFn:maskInputFn,slimDOMOptions:slimDOMOptions,dataURLOptions:dataURLOptions,inlineImages:inlineImages,recordCanvas:recordCanvas,preserveWhiteSpace:preserveWhiteSpace,onSerialize:onSerialize,onIframeLoad:onIframeLoad,iframeLoadTimeout:iframeLoadTimeout,onStylesheetLoad:onStylesheetLoad,stylesheetLoadTimeout:stylesheetLoadTimeout,keepIframeSrcFn:keepIframeSrcFn};for(const childN of Array.from(n.childNodes)){const serializedChildNode=serializeNodeWithId(childN,bypassOptions);if(serializedChildNode){serializedNode.childNodes.push(serializedChildNode)}}if(isElement$1(n)&&n.shadowRoot){for(const childN of Array.from(n.shadowRoot.childNodes)){const serializedChildNode=serializeNodeWithId(childN,bypassOptions);if(serializedChildNode){isNativeShadowDom(n.shadowRoot)&&(serializedChildNode.isShadow=true);serializedNode.childNodes.push(serializedChildNode)}}}}if(n.parentNode&&isShadowRoot(n.parentNode)&&isNativeShadowDom(n.parentNode)){serializedNode.isShadow=true}if(serializedNode.type===NodeType$3.Element&&serializedNode.tagName==="iframe"){onceIframeLoaded(n,()=>{const iframeDoc=getIframeContentDocument(n);if(iframeDoc&&onIframeLoad){const serializedIframeNode=serializeNodeWithId(iframeDoc,{doc:iframeDoc,mirror:mirror,blockClass:blockClass,blockSelector:blockSelector,unblockSelector:unblockSelector,maskAllText:maskAllText,maskTextClass:maskTextClass,unmaskTextClass:unmaskTextClass,maskTextSelector:maskTextSelector,unmaskTextSelector:unmaskTextSelector,skipChild:false,inlineStylesheet:inlineStylesheet,maskInputOptions:maskInputOptions,maskAttributeFn:maskAttributeFn,maskTextFn:maskTextFn,maskInputFn:maskInputFn,slimDOMOptions:slimDOMOptions,dataURLOptions:dataURLOptions,inlineImages:inlineImages,recordCanvas:recordCanvas,preserveWhiteSpace:preserveWhiteSpace,onSerialize:onSerialize,onIframeLoad:onIframeLoad,iframeLoadTimeout:iframeLoadTimeout,onStylesheetLoad:onStylesheetLoad,stylesheetLoadTimeout:stylesheetLoadTimeout,keepIframeSrcFn:keepIframeSrcFn});if(serializedIframeNode){onIframeLoad(n,serializedIframeNode)}}},iframeLoadTimeout)}if(serializedNode.type===NodeType$3.Element&&serializedNode.tagName==="link"&&typeof serializedNode.attributes.rel==="string"&&(serializedNode.attributes.rel==="stylesheet"||serializedNode.attributes.rel==="preload"&&typeof serializedNode.attributes.href==="string"&&extractFileExtension(serializedNode.attributes.href)==="css")){onceStylesheetLoaded(n,()=>{if(onStylesheetLoad){const serializedLinkNode=serializeNodeWithId(n,{doc:doc,mirror:mirror,blockClass:blockClass,blockSelector:blockSelector,unblockSelector:unblockSelector,maskAllText:maskAllText,maskTextClass:maskTextClass,unmaskTextClass:unmaskTextClass,maskTextSelector:maskTextSelector,unmaskTextSelector:unmaskTextSelector,skipChild:false,inlineStylesheet:inlineStylesheet,maskInputOptions:maskInputOptions,maskAttributeFn:maskAttributeFn,maskTextFn:maskTextFn,maskInputFn:maskInputFn,slimDOMOptions:slimDOMOptions,dataURLOptions:dataURLOptions,inlineImages:inlineImages,recordCanvas:recordCanvas,preserveWhiteSpace:preserveWhiteSpace,onSerialize:onSerialize,onIframeLoad:onIframeLoad,iframeLoadTimeout:iframeLoadTimeout,onStylesheetLoad:onStylesheetLoad,stylesheetLoadTimeout:stylesheetLoadTimeout,keepIframeSrcFn:keepIframeSrcFn});if(serializedLinkNode){onStylesheetLoad(n,serializedLinkNode)}}},stylesheetLoadTimeout)}return serializedNode}function snapshot(n,options){const{mirror=new Mirror,blockClass="rr-block",blockSelector=null,unblockSelector=null,maskAllText=false,maskTextClass="rr-mask",unmaskTextClass=null,maskTextSelector=null,unmaskTextSelector=null,inlineStylesheet=true,inlineImages=false,recordCanvas=false,maskAllInputs=false,maskAttributeFn,maskTextFn,maskInputFn,slimDOM=false,dataURLOptions,preserveWhiteSpace,onSerialize,onIframeLoad,iframeLoadTimeout,onStylesheetLoad,stylesheetLoadTimeout,keepIframeSrcFn=()=>false}=options||{};const maskInputOptions=maskAllInputs===true?{color:true,date:true,"datetime-local":true,email:true,month:true,number:true,range:true,search:true,tel:true,text:true,time:true,url:true,week:true,textarea:true,select:true}:maskAllInputs===false?{}:maskAllInputs;const slimDOMOptions=slimDOM===true||slimDOM==="all"?{script:true,comment:true,headFavicon:true,headWhitespace:true,headMetaDescKeywords:slimDOM==="all",headMetaSocial:true,headMetaRobots:true,headMetaHttpEquiv:true,headMetaAuthorship:true,headMetaVerification:true}:slimDOM===false?{}:slimDOM;return serializeNodeWithId(n,{doc:n,mirror:mirror,blockClass:blockClass,blockSelector:blockSelector,unblockSelector:unblockSelector,maskAllText:maskAllText,maskTextClass:maskTextClass,unmaskTextClass:unmaskTextClass,maskTextSelector:maskTextSelector,unmaskTextSelector:unmaskTextSelector,skipChild:false,inlineStylesheet:inlineStylesheet,maskInputOptions:maskInputOptions,maskAttributeFn:maskAttributeFn,maskTextFn:maskTextFn,maskInputFn:maskInputFn,slimDOMOptions:slimDOMOptions,dataURLOptions:dataURLOptions,inlineImages:inlineImages,recordCanvas:recordCanvas,preserveWhiteSpace:preserveWhiteSpace,onSerialize:onSerialize,onIframeLoad:onIframeLoad,iframeLoadTimeout:iframeLoadTimeout,onStylesheetLoad:onStylesheetLoad,stylesheetLoadTimeout:stylesheetLoadTimeout,keepIframeSrcFn:keepIframeSrcFn,newlyAddedElement:false})}function _optionalChain$4(ops){let lastAccessLHS=undefined;let value=ops[0];let i=1;while(i<ops.length){const op=ops[i];const fn=ops[i+1];i+=2;if((op==="optionalAccess"||op==="optionalCall")&&value==null){return undefined}if(op==="access"||op==="optionalAccess"){lastAccessLHS=value;value=fn(value)}else if(op==="call"||op==="optionalCall"){value=fn((...args)=>value.call(lastAccessLHS,...args));lastAccessLHS=undefined}}return value}function on(type,fn,target=document){const options={capture:true,passive:true};target.addEventListener(type,fn,options);return()=>target.removeEventListener(type,fn,options)}const DEPARTED_MIRROR_ACCESS_WARNING="Please stop import mirror directly. Instead of that,"+"\r\n"+"now you can use replayer.getMirror() to access the mirror instance of a replayer,"+"\r\n"+"or you can use record.mirror to access the mirror instance during recording.";let _mirror={map:{},getId(){console.error(DEPARTED_MIRROR_ACCESS_WARNING);return-1},getNode(){console.error(DEPARTED_MIRROR_ACCESS_WARNING);return null},removeNodeFromMap(){console.error(DEPARTED_MIRROR_ACCESS_WARNING)},has(){console.error(DEPARTED_MIRROR_ACCESS_WARNING);return false},reset(){console.error(DEPARTED_MIRROR_ACCESS_WARNING)}};if(typeof window!=="undefined"&&window.Proxy&&window.Reflect){_mirror=new Proxy(_mirror,{get(target,prop,receiver){if(prop==="map"){console.error(DEPARTED_MIRROR_ACCESS_WARNING)}return Reflect.get(target,prop,receiver)}})}function throttle$1(func,wait,options={}){let timeout=null;let previous=0;return function(...args){const now=Date.now();if(!previous&&options.leading===false){previous=now}const remaining=wait-(now-previous);const context=this;if(remaining<=0||remaining>wait){if(timeout){clearTimeout$1(timeout);timeout=null}previous=now;func.apply(context,args)}else if(!timeout&&options.trailing!==false){timeout=setTimeout$1(()=>{previous=options.leading===false?0:Date.now();timeout=null;func.apply(context,args)},remaining)}}}function hookSetter(target,key,d,isRevoked,win=window){const original=win.Object.getOwnPropertyDescriptor(target,key);win.Object.defineProperty(target,key,isRevoked?d:{set(value){setTimeout$1(()=>{d.set.call(this,value)},0);if(original&&original.set){original.set.call(this,value)}}});return()=>hookSetter(target,key,original||{},true)}function patch(source,name,replacement){try{if(!(name in source)){return()=>{}}const original=source[name];const wrapped=replacement(original);if(typeof wrapped==="function"){wrapped.prototype=wrapped.prototype||{};Object.defineProperties(wrapped,{__rrweb_original__:{enumerable:false,value:original}})}source[name]=wrapped;return()=>{source[name]=original}}catch(e2){return()=>{}}}let nowTimestamp=Date.now;if(!/[1-9][0-9]{12}/.test(Date.now().toString())){nowTimestamp=()=>(new Date).getTime()}function getWindowScroll(win){const doc=win.document;return{left:doc.scrollingElement?doc.scrollingElement.scrollLeft:win.pageXOffset!==undefined?win.pageXOffset:_optionalChain$4([doc,"optionalAccess",_=>_.documentElement,"access",_2=>_2.scrollLeft])||_optionalChain$4([doc,"optionalAccess",_3=>_3.body,"optionalAccess",_4=>_4.parentElement,"optionalAccess",_5=>_5.scrollLeft])||_optionalChain$4([doc,"optionalAccess",_6=>_6.body,"optionalAccess",_7=>_7.scrollLeft])||0,top:doc.scrollingElement?doc.scrollingElement.scrollTop:win.pageYOffset!==undefined?win.pageYOffset:_optionalChain$4([doc,"optionalAccess",_8=>_8.documentElement,"access",_9=>_9.scrollTop])||_optionalChain$4([doc,"optionalAccess",_10=>_10.body,"optionalAccess",_11=>_11.parentElement,"optionalAccess",_12=>_12.scrollTop])||_optionalChain$4([doc,"optionalAccess",_13=>_13.body,"optionalAccess",_14=>_14.scrollTop])||0}}function getWindowHeight(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function getWindowWidth(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function closestElementOfNode(node){if(!node){return null}const el=node.nodeType===node.ELEMENT_NODE?node:node.parentElement;return el}function isBlocked(node,blockClass,blockSelector,unblockSelector,checkAncestors){if(!node){return false}const el=closestElementOfNode(node);if(!el){return false}const blockedPredicate=createMatchPredicate(blockClass,blockSelector);if(!checkAncestors){const isUnblocked=unblockSelector&&el.matches(unblockSelector);return blockedPredicate(el)&&!isUnblocked}const blockDistance=distanceToMatch(el,blockedPredicate);let unblockDistance=-1;if(blockDistance<0){return false}if(unblockSelector){unblockDistance=distanceToMatch(el,createMatchPredicate(null,unblockSelector))}if(blockDistance>-1&&unblockDistance<0){return true}return blockDistance<unblockDistance}function isSerialized(n,mirror){return mirror.getId(n)!==-1}function isIgnored(n,mirror){return mirror.getId(n)===IGNORED_NODE}function isAncestorRemoved(target,mirror){if(isShadowRoot(target)){return false}const id=mirror.getId(target);if(!mirror.has(id)){return true}if(target.parentNode&&target.parentNode.nodeType===target.DOCUMENT_NODE){return false}if(!target.parentNode){return true}return isAncestorRemoved(target.parentNode,mirror)}function legacy_isTouchEvent(event){return Boolean(event.changedTouches)}function polyfill(win=window){if("NodeList"in win&&!win.NodeList.prototype.forEach){win.NodeList.prototype.forEach=Array.prototype.forEach}if("DOMTokenList"in win&&!win.DOMTokenList.prototype.forEach){win.DOMTokenList.prototype.forEach=Array.prototype.forEach}if(!Node.prototype.contains){Node.prototype.contains=(...args)=>{let node=args[0];if(!(0 in args)){throw new TypeError("1 argument is required")}do{if(this===node){return true}}while(node=node&&node.parentNode);return false}}}function isSerializedIframe(n,mirror){return Boolean(n.nodeName==="IFRAME"&&mirror.getMeta(n))}function isSerializedStylesheet(n,mirror){return Boolean(n.nodeName==="LINK"&&n.nodeType===n.ELEMENT_NODE&&n.getAttribute&&n.getAttribute("rel")==="stylesheet"&&mirror.getMeta(n))}function hasShadowRoot(n){return Boolean(_optionalChain$4([n,"optionalAccess",_18=>_18.shadowRoot]))}class StyleSheetMirror{constructor(){this.id=1;this.styleIDMap=new WeakMap;this.idStyleMap=new Map}getId(stylesheet){return _nullishCoalesce(this.styleIDMap.get(stylesheet),()=>-1)}has(stylesheet){return this.styleIDMap.has(stylesheet)}add(stylesheet,id){if(this.has(stylesheet))return this.getId(stylesheet);let newId;if(id===undefined){newId=this.id++}else newId=id;this.styleIDMap.set(stylesheet,newId);this.idStyleMap.set(newId,stylesheet);return newId}getStyle(id){return this.idStyleMap.get(id)||null}reset(){this.styleIDMap=new WeakMap;this.idStyleMap=new Map;this.id=1}generateId(){return this.id++}}function getShadowHost(n){let shadowHost=null;if(_optionalChain$4([n,"access",_19=>_19.getRootNode,"optionalCall",_20=>_20(),"optionalAccess",_21=>_21.nodeType])===Node.DOCUMENT_FRAGMENT_NODE&&n.getRootNode().host)shadowHost=n.getRootNode().host;return shadowHost}function getRootShadowHost(n){let rootShadowHost=n;let shadowHost;while(shadowHost=getShadowHost(rootShadowHost))rootShadowHost=shadowHost;return rootShadowHost}function shadowHostInDom(n){const doc=n.ownerDocument;if(!doc)return false;const shadowHost=getRootShadowHost(n);return doc.contains(shadowHost)}function inDom(n){const doc=n.ownerDocument;if(!doc)return false;return doc.contains(n)||shadowHostInDom(n)}const cachedImplementations={};function getImplementation(name){const cached=cachedImplementations[name];if(cached){return cached}const document=window.document;let impl=window[name];if(document&&typeof document.createElement==="function"){try{const sandbox=document.createElement("iframe");sandbox.hidden=true;document.head.appendChild(sandbox);const contentWindow=sandbox.contentWindow;if(contentWindow&&contentWindow[name]){impl=contentWindow[name]}document.head.removeChild(sandbox)}catch(e){}}return cachedImplementations[name]=impl.bind(window)}function onRequestAnimationFrame(...rest){return getImplementation("requestAnimationFrame")(...rest)}function setTimeout$1(...rest){return getImplementation("setTimeout")(...rest)}function clearTimeout$1(...rest){return getImplementation("clearTimeout")(...rest)}var EventType=(EventType2=>{EventType2[EventType2["DomContentLoaded"]=0]="DomContentLoaded";EventType2[EventType2["Load"]=1]="Load";EventType2[EventType2["FullSnapshot"]=2]="FullSnapshot";EventType2[EventType2["IncrementalSnapshot"]=3]="IncrementalSnapshot";EventType2[EventType2["Meta"]=4]="Meta";EventType2[EventType2["Custom"]=5]="Custom";EventType2[EventType2["Plugin"]=6]="Plugin";return EventType2})(EventType||{});var IncrementalSource=(IncrementalSource2=>{IncrementalSource2[IncrementalSource2["Mutation"]=0]="Mutation";IncrementalSource2[IncrementalSource2["MouseMove"]=1]="MouseMove";IncrementalSource2[IncrementalSource2["MouseInteraction"]=2]="MouseInteraction";IncrementalSource2[IncrementalSource2["Scroll"]=3]="Scroll";IncrementalSource2[IncrementalSource2["ViewportResize"]=4]="ViewportResize";IncrementalSource2[IncrementalSource2["Input"]=5]="Input";IncrementalSource2[IncrementalSource2["TouchMove"]=6]="TouchMove";IncrementalSource2[IncrementalSource2["MediaInteraction"]=7]="MediaInteraction";IncrementalSource2[IncrementalSource2["StyleSheetRule"]=8]="StyleSheetRule";IncrementalSource2[IncrementalSource2["CanvasMutation"]=9]="CanvasMutation";IncrementalSource2[IncrementalSource2["Font"]=10]="Font";IncrementalSource2[IncrementalSource2["Log"]=11]="Log";IncrementalSource2[IncrementalSource2["Drag"]=12]="Drag";IncrementalSource2[IncrementalSource2["StyleDeclaration"]=13]="StyleDeclaration";IncrementalSource2[IncrementalSource2["Selection"]=14]="Selection";IncrementalSource2[IncrementalSource2["AdoptedStyleSheet"]=15]="AdoptedStyleSheet";IncrementalSource2[IncrementalSource2["CustomElement"]=16]="CustomElement";return IncrementalSource2})(IncrementalSource||{});var MouseInteractions=(MouseInteractions2=>{MouseInteractions2[MouseInteractions2["MouseUp"]=0]="MouseUp";MouseInteractions2[MouseInteractions2["MouseDown"]=1]="MouseDown";MouseInteractions2[MouseInteractions2["Click"]=2]="Click";MouseInteractions2[MouseInteractions2["ContextMenu"]=3]="ContextMenu";MouseInteractions2[MouseInteractions2["DblClick"]=4]="DblClick";MouseInteractions2[MouseInteractions2["Focus"]=5]="Focus";MouseInteractions2[MouseInteractions2["Blur"]=6]="Blur";MouseInteractions2[MouseInteractions2["TouchStart"]=7]="TouchStart";MouseInteractions2[MouseInteractions2["TouchMove_Departed"]=8]="TouchMove_Departed";MouseInteractions2[MouseInteractions2["TouchEnd"]=9]="TouchEnd";MouseInteractions2[MouseInteractions2["TouchCancel"]=10]="TouchCancel";return MouseInteractions2})(MouseInteractions||{});var PointerTypes=(PointerTypes2=>{PointerTypes2[PointerTypes2["Mouse"]=0]="Mouse";PointerTypes2[PointerTypes2["Pen"]=1]="Pen";PointerTypes2[PointerTypes2["Touch"]=2]="Touch";return PointerTypes2})(PointerTypes||{});var NodeType$1;(function(NodeType){NodeType[NodeType["Document"]=0]="Document";NodeType[NodeType["DocumentType"]=1]="DocumentType";NodeType[NodeType["Element"]=2]="Element";NodeType[NodeType["Text"]=3]="Text";NodeType[NodeType["CDATA"]=4]="CDATA";NodeType[NodeType["Comment"]=5]="Comment"})(NodeType$1||(NodeType$1={}));var NodeType$2;(function(NodeType){NodeType[NodeType["PLACEHOLDER"]=0]="PLACEHOLDER";NodeType[NodeType["ELEMENT_NODE"]=1]="ELEMENT_NODE";NodeType[NodeType["ATTRIBUTE_NODE"]=2]="ATTRIBUTE_NODE";NodeType[NodeType["TEXT_NODE"]=3]="TEXT_NODE";NodeType[NodeType["CDATA_SECTION_NODE"]=4]="CDATA_SECTION_NODE";NodeType[NodeType["ENTITY_REFERENCE_NODE"]=5]="ENTITY_REFERENCE_NODE";NodeType[NodeType["ENTITY_NODE"]=6]="ENTITY_NODE";NodeType[NodeType["PROCESSING_INSTRUCTION_NODE"]=7]="PROCESSING_INSTRUCTION_NODE";NodeType[NodeType["COMMENT_NODE"]=8]="COMMENT_NODE";NodeType[NodeType["DOCUMENT_NODE"]=9]="DOCUMENT_NODE";NodeType[NodeType["DOCUMENT_TYPE_NODE"]=10]="DOCUMENT_TYPE_NODE";NodeType[NodeType["DOCUMENT_FRAGMENT_NODE"]=11]="DOCUMENT_FRAGMENT_NODE"})(NodeType$2||(NodeType$2={}));function getIFrameContentDocument(iframe){try{return iframe.contentDocument}catch(e){}}function getIFrameContentWindow(iframe){try{return iframe.contentWindow}catch(e){}}function _optionalChain$3(ops){let lastAccessLHS=undefined;let value=ops[0];let i=1;while(i<ops.length){const op=ops[i];const fn=ops[i+1];i+=2;if((op==="optionalAccess"||op==="optionalCall")&&value==null){return undefined}if(op==="access"||op==="optionalAccess"){lastAccessLHS=value;value=fn(value)}else if(op==="call"||op==="optionalCall"){value=fn((...args)=>value.call(lastAccessLHS,...args));lastAccessLHS=undefined}}return value}function isNodeInLinkedList(n){return"__ln"in n}class DoubleLinkedList{constructor(){this.length=0;this.head=null;this.tail=null}get(position){if(position>=this.length){throw new Error("Position outside of list range")}let current=this.head;for(let index=0;index<position;index++){current=_optionalChain$3([current,"optionalAccess",_=>_.next])||null}return current}addNode(n){const node={value:n,previous:null,next:null};n.__ln=node;if(n.previousSibling&&isNodeInLinkedList(n.previousSibling)){const current=n.previousSibling.__ln.next;node.next=current;node.previous=n.previousSibling.__ln;n.previousSibling.__ln.next=node;if(current){current.previous=node}}else if(n.nextSibling&&isNodeInLinkedList(n.nextSibling)&&n.nextSibling.__ln.previous){const current=n.nextSibling.__ln.previous;node.previous=current;node.next=n.nextSibling.__ln;n.nextSibling.__ln.previous=node;if(current){current.next=node}}else{if(this.head){this.head.previous=node}node.next=this.head;this.head=node}if(node.next===null){this.tail=node}this.length++}removeNode(n){const current=n.__ln;if(!this.head){return}if(!current.previous){this.head=current.next;if(this.head){this.head.previous=null}else{this.tail=null}}else{current.previous.next=current.next;if(current.next){current.next.previous=current.previous}else{this.tail=current.previous}}if(n.__ln){delete n.__ln}this.length--}}const moveKey=(id,parentId)=>`${id}@${parentId}`;class MutationBuffer{constructor(){this.frozen=false;this.locked=false;this.texts=[];this.attributes=[];this.attributeMap=new WeakMap;this.removes=[];this.mapRemoves=[];this.movedMap={};this.addedSet=new Set;this.movedSet=new Set;this.droppedSet=new Set;this.processMutations=mutations=>{mutations.forEach(this.processMutation);this.emit()};this.emit=()=>{if(this.frozen||this.locked){return}const adds=[];const addedIds=new Set;const addList=new DoubleLinkedList;const getNextId=n=>{let ns=n;let nextId=IGNORED_NODE;while(nextId===IGNORED_NODE){ns=ns&&ns.nextSibling;nextId=ns&&this.mirror.getId(ns)}return nextId};const pushAdd=n=>{if(!n.parentNode||!inDom(n)){return}const parentId=isShadowRoot(n.parentNode)?this.mirror.getId(getShadowHost(n)):this.mirror.getId(n.parentNode);const nextId=getNextId(n);if(parentId===-1||nextId===-1){return addList.addNode(n)}const sn=serializeNodeWithId(n,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskAllText:this.maskAllText,unblockSelector:this.unblockSelector,maskTextClass:this.maskTextClass,unmaskTextClass:this.unmaskTextClass,maskTextSelector:this.maskTextSelector,unmaskTextSelector:this.unmaskTextSelector,skipChild:true,newlyAddedElement:true,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskAttributeFn:this.maskAttributeFn,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:currentN=>{if(isSerializedIframe(currentN,this.mirror)&&!isBlocked(currentN,this.blockClass,this.blockSelector,this.unblockSelector,false)){this.iframeManager.addIframe(currentN)}if(isSerializedStylesheet(currentN,this.mirror)){this.stylesheetManager.trackLinkElement(currentN)}if(hasShadowRoot(n)){this.shadowDomManager.addShadowRoot(n.shadowRoot,this.doc)}},onIframeLoad:(iframe,childSn)=>{if(isBlocked(iframe,this.blockClass,this.blockSelector,this.unblockSelector,false)){return}this.iframeManager.attachIframe(iframe,childSn);if(iframe.contentWindow){this.canvasManager.addWindow(iframe.contentWindow)}this.shadowDomManager.observeAttachShadow(iframe)},onStylesheetLoad:(link,childSn)=>{this.stylesheetManager.attachLinkElement(link,childSn)}});if(sn){adds.push({parentId:parentId,nextId:nextId,node:sn});addedIds.add(sn.id)}};while(this.mapRemoves.length){this.mirror.removeNodeFromMap(this.mapRemoves.shift())}for(const n of this.movedSet){if(isParentRemoved(this.removes,n,this.mirror)&&!this.movedSet.has(n.parentNode)){continue}pushAdd(n)}for(const n of this.addedSet){if(!isAncestorInSet(this.droppedSet,n)&&!isParentRemoved(this.removes,n,this.mirror)){pushAdd(n)}else if(isAncestorInSet(this.movedSet,n)){pushAdd(n)}else{this.droppedSet.add(n)}}let candidate=null;while(addList.length){let node=null;if(candidate){const parentId=this.mirror.getId(candidate.value.parentNode);const nextId=getNextId(candidate.value);if(parentId!==-1&&nextId!==-1){node=candidate}}if(!node){let tailNode=addList.tail;while(tailNode){const _node=tailNode;tailNode=tailNode.previous;if(_node){const parentId=this.mirror.getId(_node.value.parentNode);const nextId=getNextId(_node.value);if(nextId===-1)continue;else if(parentId!==-1){node=_node;break}else{const unhandledNode=_node.value;if(unhandledNode.parentNode&&unhandledNode.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const shadowHost=unhandledNode.parentNode.host;const parentId=this.mirror.getId(shadowHost);if(parentId!==-1){node=_node;break}}}}}}if(!node){while(addList.head){addList.removeNode(addList.head.value)}break}candidate=node.previous;addList.removeNode(node.value);pushAdd(node.value)}const payload={texts:this.texts.map(text=>({id:this.mirror.getId(text.node),value:text.value})).filter(text=>!addedIds.has(text.id)).filter(text=>this.mirror.has(text.id)),attributes:this.attributes.map(attribute=>{const{attributes}=attribute;if(typeof attributes.style==="string"){const diffAsStr=JSON.stringify(attribute.styleDiff);const unchangedAsStr=JSON.stringify(attribute._unchangedStyles);if(diffAsStr.length<attributes.style.length){if((diffAsStr+unchangedAsStr).split("var(").length===attributes.style.split("var(").length){attributes.style=attribute.styleDiff}}}return{id:this.mirror.getId(attribute.node),attributes:attributes}}).filter(attribute=>!addedIds.has(attribute.id)).filter(attribute=>this.mirror.has(attribute.id)),removes:this.removes,adds:adds};if(!payload.texts.length&&!payload.attributes.length&&!payload.removes.length&&!payload.adds.length){return}this.texts=[];this.attributes=[];this.attributeMap=new WeakMap;this.removes=[];this.addedSet=new Set;this.movedSet=new Set;this.droppedSet=new Set;this.movedMap={};this.mutationCb(payload)};this.processMutation=m=>{if(isIgnored(m.target,this.mirror)){return}switch(m.type){case"characterData":{const value=m.target.textContent;if(!isBlocked(m.target,this.blockClass,this.blockSelector,this.unblockSelector,false)&&value!==m.oldValue){this.texts.push({value:needMaskingText(m.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,this.maskAllText)&&value?this.maskTextFn?this.maskTextFn(value,closestElementOfNode(m.target)):value.replace(/[\S]/g,"*"):value,node:m.target})}break}case"attributes":{const target=m.target;let attributeName=m.attributeName;let value=m.target.getAttribute(attributeName);if(attributeName==="value"){const type=getInputType(target);const tagName=target.tagName;value=getInputValue(target,tagName,type);const isInputMasked=shouldMaskInput({maskInputOptions:this.maskInputOptions,tagName:tagName,type:type});const forceMask=needMaskingText(m.target,this.maskTextClass,this.maskTextSelector,this.unmaskTextClass,this.unmaskTextSelector,isInputMasked);value=maskInputValue({isMasked:forceMask,element:target,value:value,maskInputFn:this.maskInputFn})}if(isBlocked(m.target,this.blockClass,this.blockSelector,this.unblockSelector,false)||value===m.oldValue){return}let item=this.attributeMap.get(m.target);if(target.tagName==="IFRAME"&&attributeName==="src"&&!this.keepIframeSrcFn(value)){const iframeDoc=getIFrameContentDocument(target);if(!iframeDoc){attributeName="rr_src"}else{return}}if(!item){item={node:m.target,attributes:{},styleDiff:{},_unchangedStyles:{}};this.attributes.push(item);this.attributeMap.set(m.target,item)}if(attributeName==="type"&&target.tagName==="INPUT"&&(m.oldValue||"").toLowerCase()==="password"){target.setAttribute("data-rr-is-password","true")}if(!ignoreAttribute(target.tagName,attributeName)){item.attributes[attributeName]=transformAttribute(this.doc,toLowerCase(target.tagName),toLowerCase(attributeName),value,target,this.maskAttributeFn);if(attributeName==="style"){if(!this.unattachedDoc){try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(e){this.unattachedDoc=this.doc}}const old=this.unattachedDoc.createElement("span");if(m.oldValue){old.setAttribute("style",m.oldValue)}for(const pname of Array.from(target.style)){const newValue=target.style.getPropertyValue(pname);const newPriority=target.style.getPropertyPriority(pname);if(newValue!==old.style.getPropertyValue(pname)||newPriority!==old.style.getPropertyPriority(pname)){if(newPriority===""){item.styleDiff[pname]=newValue}else{item.styleDiff[pname]=[newValue,newPriority]}}else{item._unchangedStyles[pname]=[newValue,newPriority]}}for(const pname of Array.from(old.style)){if(target.style.getPropertyValue(pname)===""){item.styleDiff[pname]=false}}}}break}case"childList":{if(isBlocked(m.target,this.blockClass,this.blockSelector,this.unblockSelector,true)){return}m.addedNodes.forEach(n=>this.genAdds(n,m.target));m.removedNodes.forEach(n=>{const nodeId=this.mirror.getId(n);const parentId=isShadowRoot(m.target)?this.mirror.getId(m.target.host):this.mirror.getId(m.target);if(isBlocked(m.target,this.blockClass,this.blockSelector,this.unblockSelector,false)||isIgnored(n,this.mirror)||!isSerialized(n,this.mirror)){return}if(this.addedSet.has(n)){deepDelete(this.addedSet,n);this.droppedSet.add(n)}else if(this.addedSet.has(m.target)&&nodeId===-1);else if(isAncestorRemoved(m.target,this.mirror));else if(this.movedSet.has(n)&&this.movedMap[moveKey(nodeId,parentId)]){deepDelete(this.movedSet,n)}else{this.removes.push({parentId:parentId,id:nodeId,isShadow:isShadowRoot(m.target)&&isNativeShadowDom(m.target)?true:undefined})}this.mapRemoves.push(n)});break}}};this.genAdds=(n,target)=>{if(this.processedNodeManager.inOtherBuffer(n,this))return;if(this.addedSet.has(n)||this.movedSet.has(n))return;if(this.mirror.hasNode(n)){if(isIgnored(n,this.mirror)){return}this.movedSet.add(n);let targetId=null;if(target&&this.mirror.hasNode(target)){targetId=this.mirror.getId(target)}if(targetId&&targetId!==-1){this.movedMap[moveKey(this.mirror.getId(n),targetId)]=true}}else{this.addedSet.add(n);this.droppedSet.delete(n)}if(!isBlocked(n,this.blockClass,this.blockSelector,this.unblockSelector,false)){n.childNodes.forEach(childN=>this.genAdds(childN));if(hasShadowRoot(n)){n.shadowRoot.childNodes.forEach(childN=>{this.processedNodeManager.add(childN,this);this.genAdds(childN,n)})}}}}init(options){["mutationCb","blockClass","blockSelector","unblockSelector","maskAllText","maskTextClass","unmaskTextClass","maskTextSelector","unmaskTextSelector","inlineStylesheet","maskInputOptions","maskAttributeFn","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(key=>{this[key]=options[key]})}freeze(){this.frozen=true;this.canvasManager.freeze()}unfreeze(){this.frozen=false;this.canvasManager.unfreeze();this.emit()}isFrozen(){return this.frozen}lock(){this.locked=true;this.canvasManager.lock()}unlock(){this.locked=false;this.canvasManager.unlock();this.emit()}reset(){this.shadowDomManager.reset();this.canvasManager.reset()}}function deepDelete(addsSet,n){addsSet.delete(n);n.childNodes.forEach(childN=>deepDelete(addsSet,childN))}function isParentRemoved(removes,n,mirror){if(removes.length===0)return false;return _isParentRemoved(removes,n,mirror)}function _isParentRemoved(removes,n,mirror){let node=n.parentNode;while(node){const parentId=mirror.getId(node);if(removes.some(r=>r.id===parentId)){return true}node=node.parentNode}return false}function isAncestorInSet(set,n){if(set.size===0)return false;return _isAncestorInSet(set,n)}function _isAncestorInSet(set,n){const{parentNode}=n;if(!parentNode){return false}if(set.has(parentNode)){return true}return _isAncestorInSet(set,parentNode)}let errorHandler;function registerErrorHandler(handler){errorHandler=handler}function unregisterErrorHandler(){errorHandler=undefined}const callbackWrapper=cb=>{if(!errorHandler){return cb}const rrwebWrapped=(...rest)=>{try{return cb(...rest)}catch(error){if(errorHandler&&errorHandler(error)===true){return()=>{}}throw error}};return rrwebWrapped};function _optionalChain$2(ops){let lastAccessLHS=undefined;let value=ops[0];let i=1;while(i<ops.length){const op=ops[i];const fn=ops[i+1];i+=2;if((op==="optionalAccess"||op==="optionalCall")&&value==null){return undefined}if(op==="access"||op==="optionalAccess"){lastAccessLHS=value;value=fn(value)}else if(op==="call"||op==="optionalCall"){value=fn((...args)=>value.call(lastAccessLHS,...args));lastAccessLHS=undefined}}return value}const mutationBuffers=[];function getEventTarget(event){try{if("composedPath"in event){const path=event.composedPath();if(path.length){return path[0]}}else if("path"in event&&event.path.length){return event.path[0]}}catch(e2){}return event&&event.target}function initMutationObserver(options,rootEl){const mutationBuffer=new MutationBuffer;mutationBuffers.push(mutationBuffer);mutationBuffer.init(options);let mutationObserverCtor=window.MutationObserver||window.__rrMutationObserver;const angularZoneSymbol=_optionalChain$2([window,"optionalAccess",_=>_.Zone,"optionalAccess",_2=>_2.__symbol__,"optionalCall",_3=>_3("MutationObserver")]);if(angularZoneSymbol&&window[angularZoneSymbol]){mutationObserverCtor=window[angularZoneSymbol]}const observer=new mutationObserverCtor(callbackWrapper(mutations=>{if(options.onMutation&&options.onMutation(mutations)===false){return}mutationBuffer.processMutations.bind(mutationBuffer)(mutations)}));observer.observe(rootEl,{attributes:true,attributeOldValue:true,characterData:true,characterDataOldValue:true,childList:true,subtree:true});return observer}function initMoveObserver({mousemoveCb,sampling,doc,mirror}){if(sampling.mousemove===false){return()=>{}}const threshold=typeof sampling.mousemove==="number"?sampling.mousemove:50;const callbackThreshold=typeof sampling.mousemoveCallback==="number"?sampling.mousemoveCallback:500;let positions=[];let timeBaseline;const wrappedCb=throttle$1(callbackWrapper(source=>{const totalOffset=Date.now()-timeBaseline;mousemoveCb(positions.map(p=>{p.timeOffset-=totalOffset;return p}),source);positions=[];timeBaseline=null}),callbackThreshold);const updatePosition=callbackWrapper(throttle$1(callbackWrapper(evt=>{const target=getEventTarget(evt);const{clientX,clientY}=legacy_isTouchEvent(evt)?evt.changedTouches[0]:evt;if(!timeBaseline){timeBaseline=nowTimestamp()}positions.push({x:clientX,y:clientY,id:mirror.getId(target),timeOffset:nowTimestamp()-timeBaseline});wrappedCb(typeof DragEvent!=="undefined"&&evt instanceof DragEvent?IncrementalSource.Drag:evt instanceof MouseEvent?IncrementalSource.MouseMove:IncrementalSource.TouchMove)}),threshold,{trailing:false}));const handlers=[on("mousemove",updatePosition,doc),on("touchmove",updatePosition,doc),on("drag",updatePosition,doc)];return callbackWrapper(()=>{handlers.forEach(h=>h())})}function initMouseInteractionObserver({mouseInteractionCb,doc,mirror,blockClass,blockSelector,unblockSelector,sampling}){if(sampling.mouseInteraction===false){return()=>{}}const disableMap=sampling.mouseInteraction===true||sampling.mouseInteraction===undefined?{}:sampling.mouseInteraction;const handlers=[];let currentPointerType=null;const getHandler=eventKey=>{return event=>{const target=getEventTarget(event);if(isBlocked(target,blockClass,blockSelector,unblockSelector,true)){return}let pointerType=null;let thisEventKey=eventKey;if("pointerType"in event){switch(event.pointerType){case"mouse":pointerType=PointerTypes.Mouse;break;case"touch":pointerType=PointerTypes.Touch;break;case"pen":pointerType=PointerTypes.Pen;break}if(pointerType===PointerTypes.Touch){if(MouseInteractions[eventKey]===MouseInteractions.MouseDown){thisEventKey="TouchStart"}else if(MouseInteractions[eventKey]===MouseInteractions.MouseUp){thisEventKey="TouchEnd"}}else if(pointerType===PointerTypes.Pen);}else if(legacy_isTouchEvent(event)){pointerType=PointerTypes.Touch}if(pointerType!==null){currentPointerType=pointerType;if(thisEventKey.startsWith("Touch")&&pointerType===PointerTypes.Touch||thisEventKey.startsWith("Mouse")&&pointerType===PointerTypes.Mouse){pointerType=null}}else if(MouseInteractions[eventKey]===MouseInteractions.Click){pointerType=currentPointerType;currentPointerType=null}const e=legacy_isTouchEvent(event)?event.changedTouches[0]:event;if(!e){return}const id=mirror.getId(target);const{clientX,clientY}=e;callbackWrapper(mouseInteractionCb)({type:MouseInteractions[thisEventKey],id:id,x:clientX,y:clientY,...pointerType!==null&&{pointerType:pointerType}})}};Object.keys(MouseInteractions).filter(key=>Number.isNaN(Number(key))&&!key.endsWith("_Departed")&&disableMap[key]!==false).forEach(eventKey=>{let eventName=toLowerCase(eventKey);const handler=getHandler(eventKey);if(window.PointerEvent){switch(MouseInteractions[eventKey]){case MouseInteractions.MouseDown:case MouseInteractions.MouseUp:eventName=eventName.replace("mouse","pointer");break;case MouseInteractions.TouchStart:case MouseInteractions.TouchEnd:return}}handlers.push(on(eventName,handler,doc))});return callbackWrapper(()=>{handlers.forEach(h=>h())})}function initScrollObserver({scrollCb,doc,mirror,blockClass,blockSelector,unblockSelector,sampling}){const updatePosition=callbackWrapper(throttle$1(callbackWrapper(evt=>{const target=getEventTarget(evt);if(!target||isBlocked(target,blockClass,blockSelector,unblockSelector,true)){return}const id=mirror.getId(target);if(target===doc&&doc.defaultView){const scrollLeftTop=getWindowScroll(doc.defaultView);scrollCb({id:id,x:scrollLeftTop.left,y:scrollLeftTop.top})}else{scrollCb({id:id,x:target.scrollLeft,y:target.scrollTop})}}),sampling.scroll||100));return on("scroll",updatePosition,doc)}function initViewportResizeObserver({viewportResizeCb},{win}){let lastH=-1;let lastW=-1;const updateDimension=callbackWrapper(throttle$1(callbackWrapper(()=>{const height=getWindowHeight();const width=getWindowWidth();if(lastH!==height||lastW!==width){viewportResizeCb({width:Number(width),height:Number(height)});lastH=height;lastW=width}}),200));return on("resize",updateDimension,win)}const INPUT_TAGS=["INPUT","TEXTAREA","SELECT"];const lastInputValueMap=new WeakMap;function initInputObserver({inputCb,doc,mirror,blockClass,blockSelector,unblockSelector,ignoreClass,ignoreSelector,maskInputOptions,maskInputFn,sampling,userTriggeredOnInput,maskTextClass,unmaskTextClass,maskTextSelector,unmaskTextSelector}){function eventHandler(event){let target=getEventTarget(event);const userTriggered=event.isTrusted;const tagName=target&&toUpperCase(target.tagName);if(tagName==="OPTION")target=target.parentElement;if(!target||!tagName||INPUT_TAGS.indexOf(tagName)<0||isBlocked(target,blockClass,blockSelector,unblockSelector,true)){return}const el=target;if(el.classList.contains(ignoreClass)||ignoreSelector&&el.matches(ignoreSelector)){return}const type=getInputType(target);let text=getInputValue(el,tagName,type);let isChecked=false;const isInputMasked=shouldMaskInput({maskInputOptions:maskInputOptions,tagName:tagName,type:type});const forceMask=needMaskingText(target,maskTextClass,maskTextSelector,unmaskTextClass,unmaskTextSelector,isInputMasked);if(type==="radio"||type==="checkbox"){isChecked=target.checked}text=maskInputValue({isMasked:forceMask,element:target,value:text,maskInputFn:maskInputFn});cbWithDedup(target,userTriggeredOnInput?{text:text,isChecked:isChecked,userTriggered:userTriggered}:{text:text,isChecked:isChecked});const name=target.name;if(type==="radio"&&name&&isChecked){doc.querySelectorAll(`input[type="radio"][name="${name}"]`).forEach(el=>{if(el!==target){const text=maskInputValue({isMasked:forceMask,element:el,value:getInputValue(el,tagName,type),maskInputFn:maskInputFn});cbWithDedup(el,userTriggeredOnInput?{text:text,isChecked:!isChecked,userTriggered:false}:{text:text,isChecked:!isChecked})}})}}function cbWithDedup(target,v){const lastInputValue=lastInputValueMap.get(target);if(!lastInputValue||lastInputValue.text!==v.text||lastInputValue.isChecked!==v.isChecked){lastInputValueMap.set(target,v);const id=mirror.getId(target);callbackWrapper(inputCb)({...v,id:id})}}const events=sampling.input==="last"?["change"]:["input","change"];const handlers=events.map(eventName=>on(eventName,callbackWrapper(eventHandler),doc));const currentWindow=doc.defaultView;if(!currentWindow){return()=>{handlers.forEach(h=>h())}}const propertyDescriptor=currentWindow.Object.getOwnPropertyDescriptor(currentWindow.HTMLInputElement.prototype,"value");const hookProperties=[[currentWindow.HTMLInputElement.prototype,"value"],[currentWindow.HTMLInputElement.prototype,"checked"],[currentWindow.HTMLSelectElement.prototype,"value"],[currentWindow.HTMLTextAreaElement.prototype,"value"],[currentWindow.HTMLSelectElement.prototype,"selectedIndex"],[currentWindow.HTMLOptionElement.prototype,"selected"]];if(propertyDescriptor&&propertyDescriptor.set){handlers.push(...hookProperties.map(p=>hookSetter(p[0],p[1],{set(){callbackWrapper(eventHandler)({target:this,isTrusted:false})}},false,currentWindow)))}return callbackWrapper(()=>{handlers.forEach(h=>h())})}function getNestedCSSRulePositions(rule){const positions=[];function recurse(childRule,pos){if(hasNestedCSSRule("CSSGroupingRule")&&childRule.parentRule instanceof CSSGroupingRule||hasNestedCSSRule("CSSMediaRule")&&childRule.parentRule instanceof CSSMediaRule||hasNestedCSSRule("CSSSupportsRule")&&childRule.parentRule instanceof CSSSupportsRule||hasNestedCSSRule("CSSConditionRule")&&childRule.parentRule instanceof CSSConditionRule){const rules=Array.from(childRule.parentRule.cssRules);const index=rules.indexOf(childRule);pos.unshift(index)}else if(childRule.parentStyleSheet){const rules=Array.from(childRule.parentStyleSheet.cssRules);const index=rules.indexOf(childRule);pos.unshift(index)}return pos}return recurse(rule,positions)}function getIdAndStyleId(sheet,mirror,styleMirror){let id,styleId;if(!sheet)return{};if(sheet.ownerNode)id=mirror.getId(sheet.ownerNode);else styleId=styleMirror.getId(sheet);return{styleId:styleId,id:id}}function initStyleSheetObserver({styleSheetRuleCb,mirror,stylesheetManager},{win}){if(!win.CSSStyleSheet||!win.CSSStyleSheet.prototype){return()=>{}}const insertRule=win.CSSStyleSheet.prototype.insertRule;win.CSSStyleSheet.prototype.insertRule=new Proxy(insertRule,{apply:callbackWrapper((target,thisArg,argumentsList)=>{const[rule,index]=argumentsList;const{id,styleId}=getIdAndStyleId(thisArg,mirror,stylesheetManager.styleMirror);if(id&&id!==-1||styleId&&styleId!==-1){styleSheetRuleCb({id:id,styleId:styleId,adds:[{rule:rule,index:index}]})}return target.apply(thisArg,argumentsList)})});const deleteRule=win.CSSStyleSheet.prototype.deleteRule;win.CSSStyleSheet.prototype.deleteRule=new Proxy(deleteRule,{apply:callbackWrapper((target,thisArg,argumentsList)=>{const[index]=argumentsList;const{id,styleId}=getIdAndStyleId(thisArg,mirror,stylesheetManager.styleMirror);if(id&&id!==-1||styleId&&styleId!==-1){styleSheetRuleCb({id:id,styleId:styleId,removes:[{index:index}]})}return target.apply(thisArg,argumentsList)})});let replace;if(win.CSSStyleSheet.prototype.replace){replace=win.CSSStyleSheet.prototype.replace;win.CSSStyleSheet.prototype.replace=new Proxy(replace,{apply:callbackWrapper((target,thisArg,argumentsList)=>{const[text]=argumentsList;const{id,styleId}=getIdAndStyleId(thisArg,mirror,stylesheetManager.styleMirror);if(id&&id!==-1||styleId&&styleId!==-1){styleSheetRuleCb({id:id,styleId:styleId,replace:text})}return target.apply(thisArg,argumentsList)})})}let replaceSync;if(win.CSSStyleSheet.prototype.replaceSync){replaceSync=win.CSSStyleSheet.prototype.replaceSync;win.CSSStyleSheet.prototype.replaceSync=new Proxy(replaceSync,{apply:callbackWrapper((target,thisArg,argumentsList)=>{const[text]=argumentsList;const{id,styleId}=getIdAndStyleId(thisArg,mirror,stylesheetManager.styleMirror);if(id&&id!==-1||styleId&&styleId!==-1){styleSheetRuleCb({id:id,styleId:styleId,replaceSync:text})}return target.apply(thisArg,argumentsList)})})}const supportedNestedCSSRuleTypes={};if(canMonkeyPatchNestedCSSRule("CSSGroupingRule")){supportedNestedCSSRuleTypes.CSSGroupingRule=win.CSSGroupingRule}else{if(canMonkeyPatchNestedCSSRule("CSSMediaRule")){supportedNestedCSSRuleTypes.CSSMediaRule=win.CSSMediaRule}if(canMonkeyPatchNestedCSSRule("CSSConditionRule")){supportedNestedCSSRuleTypes.CSSConditionRule=win.CSSConditionRule}if(canMonkeyPatchNestedCSSRule("CSSSupportsRule")){supportedNestedCSSRuleTypes.CSSSupportsRule=win.CSSSupportsRule}}const unmodifiedFunctions={};Object.entries(supportedNestedCSSRuleTypes).forEach(([typeKey,type])=>{unmodifiedFunctions[typeKey]={insertRule:type.prototype.insertRule,deleteRule:type.prototype.deleteRule};type.prototype.insertRule=new Proxy(unmodifiedFunctions[typeKey].insertRule,{apply:callbackWrapper((target,thisArg,argumentsList)=>{const[rule,index]=argumentsList;const{id,styleId}=getIdAndStyleId(thisArg.parentStyleSheet,mirror,stylesheetManager.styleMirror);if(id&&id!==-1||styleId&&styleId!==-1){styleSheetRuleCb({id:id,styleId:styleId,adds:[{rule:rule,index:[...getNestedCSSRulePositions(thisArg),index||0]}]})}return target.apply(thisArg,argumentsList)})});type.prototype.deleteRule=new Proxy(unmodifiedFunctions[typeKey].deleteRule,{apply:callbackWrapper((target,thisArg,argumentsList)=>{const[index]=argumentsList;const{id,styleId}=getIdAndStyleId(thisArg.parentStyleSheet,mirror,stylesheetManager.styleMirror);if(id&&id!==-1||styleId&&styleId!==-1){styleSheetRuleCb({id:id,styleId:styleId,removes:[{index:[...getNestedCSSRulePositions(thisArg),index]}]})}return target.apply(thisArg,argumentsList)})})});return callbackWrapper(()=>{win.CSSStyleSheet.prototype.insertRule=insertRule;win.CSSStyleSheet.prototype.deleteRule=deleteRule;replace&&(win.CSSStyleSheet.prototype.replace=replace);replaceSync&&(win.CSSStyleSheet.prototype.replaceSync=replaceSync);Object.entries(supportedNestedCSSRuleTypes).forEach(([typeKey,type])=>{type.prototype.insertRule=unmodifiedFunctions[typeKey].insertRule;type.prototype.deleteRule=unmodifiedFunctions[typeKey].deleteRule})})}function initAdoptedStyleSheetObserver({mirror,stylesheetManager},host){let hostId=null;if(host.nodeName==="#document")hostId=mirror.getId(host);else hostId=mirror.getId(host.host);const patchTarget=host.nodeName==="#document"?_optionalChain$2([host,"access",_4=>_4.defaultView,"optionalAccess",_5=>_5.Document]):_optionalChain$2([host,"access",_6=>_6.ownerDocument,"optionalAccess",_7=>_7.defaultView,"optionalAccess",_8=>_8.ShadowRoot]);const originalPropertyDescriptor=_optionalChain$2([patchTarget,"optionalAccess",_9=>_9.prototype])?Object.getOwnPropertyDescriptor(_optionalChain$2([patchTarget,"optionalAccess",_10=>_10.prototype]),"adoptedStyleSheets"):undefined;if(hostId===null||hostId===-1||!patchTarget||!originalPropertyDescriptor)return()=>{};Object.defineProperty(host,"adoptedStyleSheets",{configurable:originalPropertyDescriptor.configurable,enumerable:originalPropertyDescriptor.enumerable,get(){return _optionalChain$2([originalPropertyDescriptor,"access",_11=>_11.get,"optionalAccess",_12=>_12.call,"call",_13=>_13(this)])},set(sheets){const result=_optionalChain$2([originalPropertyDescriptor,"access",_14=>_14.set,"optionalAccess",_15=>_15.call,"call",_16=>_16(this,sheets)]);if(hostId!==null&&hostId!==-1){try{stylesheetManager.adoptStyleSheets(sheets,hostId)}catch(e){}}return result}});return callbackWrapper(()=>{Object.defineProperty(host,"adoptedStyleSheets",{configurable:originalPropertyDescriptor.configurable,enumerable:originalPropertyDescriptor.enumerable,get:originalPropertyDescriptor.get,set:originalPropertyDescriptor.set})})}function initStyleDeclarationObserver({styleDeclarationCb,mirror,ignoreCSSAttributes,stylesheetManager},{win}){const setProperty=win.CSSStyleDeclaration.prototype.setProperty;win.CSSStyleDeclaration.prototype.setProperty=new Proxy(setProperty,{apply:callbackWrapper((target,thisArg,argumentsList)=>{const[property,value,priority]=argumentsList;if(ignoreCSSAttributes.has(property)){return setProperty.apply(thisArg,[property,value,priority])}const{id,styleId}=getIdAndStyleId(_optionalChain$2([thisArg,"access",_17=>_17.parentRule,"optionalAccess",_18=>_18.parentStyleSheet]),mirror,stylesheetManager.styleMirror);if(id&&id!==-1||styleId&&styleId!==-1){styleDeclarationCb({id:id,styleId:styleId,set:{property:property,value:value,priority:priority},index:getNestedCSSRulePositions(thisArg.parentRule)})}return target.apply(thisArg,argumentsList)})});const removeProperty=win.CSSStyleDeclaration.prototype.removeProperty;win.CSSStyleDeclaration.prototype.removeProperty=new Proxy(removeProperty,{apply:callbackWrapper((target,thisArg,argumentsList)=>{const[property]=argumentsList;if(ignoreCSSAttributes.has(property)){return removeProperty.apply(thisArg,[property])}const{id,styleId}=getIdAndStyleId(_optionalChain$2([thisArg,"access",_19=>_19.parentRule,"optionalAccess",_20=>_20.parentStyleSheet]),mirror,stylesheetManager.styleMirror);if(id&&id!==-1||styleId&&styleId!==-1){styleDeclarationCb({id:id,styleId:styleId,remove:{property:property},index:getNestedCSSRulePositions(thisArg.parentRule)})}return target.apply(thisArg,argumentsList)})});return callbackWrapper(()=>{win.CSSStyleDeclaration.prototype.setProperty=setProperty;win.CSSStyleDeclaration.prototype.removeProperty=removeProperty})}function initMediaInteractionObserver({mediaInteractionCb,blockClass,blockSelector,unblockSelector,mirror,sampling,doc}){const handler=callbackWrapper(type=>throttle$1(callbackWrapper(event=>{const target=getEventTarget(event);if(!target||isBlocked(target,blockClass,blockSelector,unblockSelector,true)){return}const{currentTime,volume,muted,playbackRate}=target;mediaInteractionCb({type:type,id:mirror.getId(target),currentTime:currentTime,volume:volume,muted:muted,playbackRate:playbackRate})}),sampling.media||500));const handlers=[on("play",handler(0),doc),on("pause",handler(1),doc),on("seeked",handler(2),doc),on("volumechange",handler(3),doc),on("ratechange",handler(4),doc)];return callbackWrapper(()=>{handlers.forEach(h=>h())})}function initFontObserver({fontCb,doc}){const win=doc.defaultView;if(!win){return()=>{}}const handlers=[];const fontMap=new WeakMap;const originalFontFace=win.FontFace;win.FontFace=function FontFace(family,source,descriptors){const fontFace=new originalFontFace(family,source,descriptors);fontMap.set(fontFace,{family:family,buffer:typeof source!=="string",descriptors:descriptors,fontSource:typeof source==="string"?source:JSON.stringify(Array.from(new Uint8Array(source)))});return fontFace};const restoreHandler=patch(doc.fonts,"add",function(original){return function(fontFace){setTimeout$1(callbackWrapper(()=>{const p=fontMap.get(fontFace);if(p){fontCb(p);fontMap.delete(fontFace)}}),0);return original.apply(this,[fontFace])}});handlers.push(()=>{win.FontFace=originalFontFace});handlers.push(restoreHandler);return callbackWrapper(()=>{handlers.forEach(h=>h())})}function initSelectionObserver(param){const{doc,mirror,blockClass,blockSelector,unblockSelector,selectionCb}=param;let collapsed=true;const updateSelection=callbackWrapper(()=>{const selection=doc.getSelection();if(!selection||collapsed&&_optionalChain$2([selection,"optionalAccess",_21=>_21.isCollapsed]))return;collapsed=selection.isCollapsed||false;const ranges=[];const count=selection.rangeCount||0;for(let i=0;i<count;i++){const range=selection.getRangeAt(i);const{startContainer,startOffset,endContainer,endOffset}=range;const blocked=isBlocked(startContainer,blockClass,blockSelector,unblockSelector,true)||isBlocked(endContainer,blockClass,blockSelector,unblockSelector,true);if(blocked)continue;ranges.push({start:mirror.getId(startContainer),startOffset:startOffset,end:mirror.getId(endContainer),endOffset:endOffset})}selectionCb({ranges:ranges})});updateSelection();return on("selectionchange",updateSelection)}function initCustomElementObserver({doc,customElementCb}){const win=doc.defaultView;if(!win||!win.customElements)return()=>{};const restoreHandler=patch(win.customElements,"define",function(original){return function(name,constructor,options){try{customElementCb({define:{name:name}})}catch(e){}return original.apply(this,[name,constructor,options])}});return restoreHandler}function initObservers(o,_hooks={}){const currentWindow=o.doc.defaultView;if(!currentWindow){return()=>{}}let mutationObserver;if(o.recordDOM){mutationObserver=initMutationObserver(o,o.doc)}const mousemoveHandler=initMoveObserver(o);const mouseInteractionHandler=initMouseInteractionObserver(o);const scrollHandler=initScrollObserver(o);const viewportResizeHandler=initViewportResizeObserver(o,{win:currentWindow});const inputHandler=initInputObserver(o);const mediaInteractionHandler=initMediaInteractionObserver(o);let styleSheetObserver=()=>{};let adoptedStyleSheetObserver=()=>{};let styleDeclarationObserver=()=>{};let fontObserver=()=>{};if(o.recordDOM){styleSheetObserver=initStyleSheetObserver(o,{win:currentWindow});adoptedStyleSheetObserver=initAdoptedStyleSheetObserver(o,o.doc);styleDeclarationObserver=initStyleDeclarationObserver(o,{win:currentWindow});if(o.collectFonts){fontObserver=initFontObserver(o)}}const selectionObserver=initSelectionObserver(o);const customElementObserver=initCustomElementObserver(o);const pluginHandlers=[];for(const plugin of o.plugins){pluginHandlers.push(plugin.observer(plugin.callback,currentWindow,plugin.options))}return callbackWrapper(()=>{mutationBuffers.forEach(b=>b.reset());_optionalChain$2([mutationObserver,"optionalAccess",_22=>_22.disconnect,"call",_23=>_23()]);mousemoveHandler();mouseInteractionHandler();scrollHandler();viewportResizeHandler();inputHandler();mediaInteractionHandler();styleSheetObserver();adoptedStyleSheetObserver();styleDeclarationObserver();fontObserver();selectionObserver();customElementObserver();pluginHandlers.forEach(h=>h())})}function hasNestedCSSRule(prop){return typeof window[prop]!=="undefined"}function canMonkeyPatchNestedCSSRule(prop){return Boolean(typeof window[prop]!=="undefined"&&window[prop].prototype&&"insertRule"in window[prop].prototype&&"deleteRule"in window[prop].prototype)}class CrossOriginIframeMirror{constructor(generateIdFn){this.generateIdFn=generateIdFn;this.iframeIdToRemoteIdMap=new WeakMap;this.iframeRemoteIdToIdMap=new WeakMap}getId(iframe,remoteId,idToRemoteMap,remoteToIdMap){const idToRemoteIdMap=idToRemoteMap||this.getIdToRemoteIdMap(iframe);const remoteIdToIdMap=remoteToIdMap||this.getRemoteIdToIdMap(iframe);let id=idToRemoteIdMap.get(remoteId);if(!id){id=this.generateIdFn();idToRemoteIdMap.set(remoteId,id);remoteIdToIdMap.set(id,remoteId)}return id}getIds(iframe,remoteId){const idToRemoteIdMap=this.getIdToRemoteIdMap(iframe);const remoteIdToIdMap=this.getRemoteIdToIdMap(iframe);return remoteId.map(id=>this.getId(iframe,id,idToRemoteIdMap,remoteIdToIdMap))}getRemoteId(iframe,id,map){const remoteIdToIdMap=map||this.getRemoteIdToIdMap(iframe);if(typeof id!=="number")return id;const remoteId=remoteIdToIdMap.get(id);if(!remoteId)return-1;return remoteId}getRemoteIds(iframe,ids){const remoteIdToIdMap=this.getRemoteIdToIdMap(iframe);return ids.map(id=>this.getRemoteId(iframe,id,remoteIdToIdMap))}reset(iframe){if(!iframe){this.iframeIdToRemoteIdMap=new WeakMap;this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(iframe);this.iframeRemoteIdToIdMap.delete(iframe)}getIdToRemoteIdMap(iframe){let idToRemoteIdMap=this.iframeIdToRemoteIdMap.get(iframe);if(!idToRemoteIdMap){idToRemoteIdMap=new Map;this.iframeIdToRemoteIdMap.set(iframe,idToRemoteIdMap)}return idToRemoteIdMap}getRemoteIdToIdMap(iframe){let remoteIdToIdMap=this.iframeRemoteIdToIdMap.get(iframe);if(!remoteIdToIdMap){remoteIdToIdMap=new Map;this.iframeRemoteIdToIdMap.set(iframe,remoteIdToIdMap)}return remoteIdToIdMap}}function _optionalChain$1(ops){let lastAccessLHS=undefined;let value=ops[0];let i=1;while(i<ops.length){const op=ops[i];const fn=ops[i+1];i+=2;if((op==="optionalAccess"||op==="optionalCall")&&value==null){return undefined}if(op==="access"||op==="optionalAccess"){lastAccessLHS=value;value=fn(value)}else if(op==="call"||op==="optionalCall"){value=fn((...args)=>value.call(lastAccessLHS,...args));lastAccessLHS=undefined}}return value}class IframeManagerNoop{constructor(){this.crossOriginIframeMirror=new CrossOriginIframeMirror(genId);this.crossOriginIframeRootIdMap=new WeakMap}addIframe(){}addLoadListener(){}attachIframe(){}}class IframeManager{constructor(options){this.iframes=new WeakMap;this.crossOriginIframeMap=new WeakMap;this.crossOriginIframeMirror=new CrossOriginIframeMirror(genId);this.crossOriginIframeRootIdMap=new WeakMap;this.mutationCb=options.mutationCb;this.wrappedEmit=options.wrappedEmit;this.stylesheetManager=options.stylesheetManager;this.recordCrossOriginIframes=options.recordCrossOriginIframes;this.crossOriginIframeStyleMirror=new CrossOriginIframeMirror(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror));this.mirror=options.mirror;if(this.recordCrossOriginIframes){window.addEventListener("message",this.handleMessage.bind(this))}}addIframe(iframeEl){this.iframes.set(iframeEl,true);if(iframeEl.contentWindow)this.crossOriginIframeMap.set(iframeEl.contentWindow,iframeEl)}addLoadListener(cb){this.loadListener=cb}attachIframe(iframeEl,childSn){this.mutationCb({adds:[{parentId:this.mirror.getId(iframeEl),nextId:null,node:childSn}],removes:[],texts:[],attributes:[],isAttachIframe:true});_optionalChain$1([this,"access",_=>_.loadListener,"optionalCall",_2=>_2(iframeEl)]);const iframeDoc=getIFrameContentDocument(iframeEl);if(iframeDoc&&iframeDoc.adoptedStyleSheets&&iframeDoc.adoptedStyleSheets.length>0)this.stylesheetManager.adoptStyleSheets(iframeDoc.adoptedStyleSheets,this.mirror.getId(iframeDoc))}handleMessage(message){const crossOriginMessageEvent=message;if(crossOriginMessageEvent.data.type!=="rrweb"||crossOriginMessageEvent.origin!==crossOriginMessageEvent.data.origin)return;const iframeSourceWindow=message.source;if(!iframeSourceWindow)return;const iframeEl=this.crossOriginIframeMap.get(message.source);if(!iframeEl)return;const transformedEvent=this.transformCrossOriginEvent(iframeEl,crossOriginMessageEvent.data.event);if(transformedEvent)this.wrappedEmit(transformedEvent,crossOriginMessageEvent.data.isCheckout)}transformCrossOriginEvent(iframeEl,e){switch(e.type){case EventType.FullSnapshot:{this.crossOriginIframeMirror.reset(iframeEl);this.crossOriginIframeStyleMirror.reset(iframeEl);this.replaceIdOnNode(e.data.node,iframeEl);const rootId=e.data.node.id;this.crossOriginIframeRootIdMap.set(iframeEl,rootId);this.patchRootIdOnNode(e.data.node,rootId);return{timestamp:e.timestamp,type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.Mutation,adds:[{parentId:this.mirror.getId(iframeEl),nextId:null,node:e.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:true}}}case EventType.Meta:case EventType.Load:case EventType.DomContentLoaded:{return false}case EventType.Plugin:{return e}case EventType.Custom:{this.replaceIds(e.data.payload,iframeEl,["id","parentId","previousId","nextId"]);return e}case EventType.IncrementalSnapshot:{switch(e.data.source){case IncrementalSource.Mutation:{e.data.adds.forEach(n=>{this.replaceIds(n,iframeEl,["parentId","nextId","previousId"]);this.replaceIdOnNode(n.node,iframeEl);const rootId=this.crossOriginIframeRootIdMap.get(iframeEl);rootId&&this.patchRootIdOnNode(n.node,rootId)});e.data.removes.forEach(n=>{this.replaceIds(n,iframeEl,["parentId","id"])});e.data.attributes.forEach(n=>{this.replaceIds(n,iframeEl,["id"])});e.data.texts.forEach(n=>{this.replaceIds(n,iframeEl,["id"])});return e}case IncrementalSource.Drag:case IncrementalSource.TouchMove:case IncrementalSource.MouseMove:{e.data.positions.forEach(p=>{this.replaceIds(p,iframeEl,["id"])});return e}case IncrementalSource.ViewportResize:{return false}case IncrementalSource.MediaInteraction:case IncrementalSource.MouseInteraction:case IncrementalSource.Scroll:case IncrementalSource.CanvasMutation:case IncrementalSource.Input:{this.replaceIds(e.data,iframeEl,["id"]);return e}case IncrementalSource.StyleSheetRule:case IncrementalSource.StyleDeclaration:{this.replaceIds(e.data,iframeEl,["id"]);this.replaceStyleIds(e.data,iframeEl,["styleId"]);return e}case IncrementalSource.Font:{return e}case IncrementalSource.Selection:{e.data.ranges.forEach(range=>{this.replaceIds(range,iframeEl,["start","end"])});return e}case IncrementalSource.AdoptedStyleSheet:{this.replaceIds(e.data,iframeEl,["id"]);this.replaceStyleIds(e.data,iframeEl,["styleIds"]);_optionalChain$1([e,"access",_3=>_3.data,"access",_4=>_4.styles,"optionalAccess",_5=>_5.forEach,"call",_6=>_6(style=>{this.replaceStyleIds(style,iframeEl,["styleId"])})]);return e}}}}return false}replace(iframeMirror,obj,iframeEl,keys){for(const key of keys){if(!Array.isArray(obj[key])&&typeof obj[key]!=="number")continue;if(Array.isArray(obj[key])){obj[key]=iframeMirror.getIds(iframeEl,obj[key])}else{obj[key]=iframeMirror.getId(iframeEl,obj[key])}}return obj}replaceIds(obj,iframeEl,keys){return this.replace(this.crossOriginIframeMirror,obj,iframeEl,keys)}replaceStyleIds(obj,iframeEl,keys){return this.replace(this.crossOriginIframeStyleMirror,obj,iframeEl,keys)}replaceIdOnNode(node,iframeEl){this.replaceIds(node,iframeEl,["id","rootId"]);if("childNodes"in node){node.childNodes.forEach(child=>{this.replaceIdOnNode(child,iframeEl)})}}patchRootIdOnNode(node,rootId){if(node.type!==NodeType$3.Document&&!node.rootId)node.rootId=rootId;if("childNodes"in node){node.childNodes.forEach(child=>{this.patchRootIdOnNode(child,rootId)})}}}class ShadowDomManagerNoop{init(){}addShadowRoot(){}observeAttachShadow(){}reset(){}}class ShadowDomManager{constructor(options){this.shadowDoms=new WeakSet;this.restoreHandlers=[];this.mutationCb=options.mutationCb;this.scrollCb=options.scrollCb;this.bypassOptions=options.bypassOptions;this.mirror=options.mirror;this.init()}init(){this.reset();this.patchAttachShadow(Element,document)}addShadowRoot(shadowRoot,doc){if(!isNativeShadowDom(shadowRoot))return;if(this.shadowDoms.has(shadowRoot))return;this.shadowDoms.add(shadowRoot);this.bypassOptions.canvasManager.addShadowRoot(shadowRoot);const observer=initMutationObserver({...this.bypassOptions,doc:doc,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},shadowRoot);this.restoreHandlers.push(()=>observer.disconnect());this.restoreHandlers.push(initScrollObserver({...this.bypassOptions,scrollCb:this.scrollCb,doc:shadowRoot,mirror:this.mirror}));setTimeout$1(()=>{if(shadowRoot.adoptedStyleSheets&&shadowRoot.adoptedStyleSheets.length>0)this.bypassOptions.stylesheetManager.adoptStyleSheets(shadowRoot.adoptedStyleSheets,this.mirror.getId(shadowRoot.host));this.restoreHandlers.push(initAdoptedStyleSheetObserver({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},shadowRoot))},0)}observeAttachShadow(iframeElement){const iframeDoc=getIFrameContentDocument(iframeElement);const iframeWindow=getIFrameContentWindow(iframeElement);if(!iframeDoc||!iframeWindow)return;this.patchAttachShadow(iframeWindow.Element,iframeDoc)}patchAttachShadow(element,doc){const manager=this;this.restoreHandlers.push(patch(element.prototype,"attachShadow",function(original){return function(option){const shadowRoot=original.call(this,option);if(this.shadowRoot&&inDom(this))manager.addShadowRoot(this.shadowRoot,doc);return shadowRoot}}))}reset(){this.restoreHandlers.forEach(handler=>{try{handler()}catch(e){}});this.restoreHandlers=[];this.shadowDoms=new WeakSet;this.bypassOptions.canvasManager.resetShadowRoots()}}class CanvasManagerNoop{reset(){}freeze(){}unfreeze(){}lock(){}unlock(){}snapshot(){}addWindow(){}addShadowRoot(){}resetShadowRoots(){}}class StylesheetManager{constructor(options){this.trackedLinkElements=new WeakSet;this.styleMirror=new StyleSheetMirror;this.mutationCb=options.mutationCb;this.adoptedStyleSheetCb=options.adoptedStyleSheetCb}attachLinkElement(linkEl,childSn){if("_cssText"in childSn.attributes)this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:childSn.id,attributes:childSn.attributes}]});this.trackLinkElement(linkEl)}trackLinkElement(linkEl){if(this.trackedLinkElements.has(linkEl))return;this.trackedLinkElements.add(linkEl);this.trackStylesheetInLinkElement(linkEl)}adoptStyleSheets(sheets,hostId){if(sheets.length===0)return;const adoptedStyleSheetData={id:hostId,styleIds:[]};const styles=[];for(const sheet of sheets){let styleId;if(!this.styleMirror.has(sheet)){styleId=this.styleMirror.add(sheet);styles.push({styleId:styleId,rules:Array.from(sheet.rules||CSSRule,(r,index)=>({rule:stringifyRule(r),index:index}))})}else styleId=this.styleMirror.getId(sheet);adoptedStyleSheetData.styleIds.push(styleId)}if(styles.length>0)adoptedStyleSheetData.styles=styles;this.adoptedStyleSheetCb(adoptedStyleSheetData)}reset(){this.styleMirror.reset();this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(linkEl){}}class ProcessedNodeManager{constructor(){this.nodeMap=new WeakMap;this.active=false}inOtherBuffer(node,thisBuffer){const buffers=this.nodeMap.get(node);return buffers&&Array.from(buffers).some(buffer=>buffer!==thisBuffer)}add(node,buffer){if(!this.active){this.active=true;onRequestAnimationFrame(()=>{this.nodeMap=new WeakMap;this.active=false})}this.nodeMap.set(node,(this.nodeMap.get(node)||new Set).add(buffer))}destroy(){}}let wrappedEmit;let _takeFullSnapshot;try{if(Array.from([1],x=>x*2)[0]!==2){const cleanFrame=document.createElement("iframe");document.body.appendChild(cleanFrame);Array.from=_optionalChain([cleanFrame,"access",_=>_.contentWindow,"optionalAccess",_2=>_2.Array,"access",_3=>_3.from])||Array.from;document.body.removeChild(cleanFrame)}}catch(err){console.debug("Unable to override Array.from",err)}const mirror=createMirror();function record(options={}){const{emit,checkoutEveryNms,checkoutEveryNth,blockClass="rr-block",blockSelector=null,unblockSelector=null,ignoreClass="rr-ignore",ignoreSelector=null,maskAllText=false,maskTextClass="rr-mask",unmaskTextClass=null,maskTextSelector=null,unmaskTextSelector=null,inlineStylesheet=true,maskAllInputs,maskInputOptions:_maskInputOptions,slimDOMOptions:_slimDOMOptions,maskAttributeFn,maskInputFn,maskTextFn,maxCanvasSize=null,packFn,sampling={},dataURLOptions={},mousemoveWait,recordDOM=true,recordCanvas=false,recordCrossOriginIframes=false,recordAfter=options.recordAfter==="DOMContentLoaded"?options.recordAfter:"load",userTriggeredOnInput=false,collectFonts=false,inlineImages=false,plugins,keepIframeSrcFn=()=>false,ignoreCSSAttributes=new Set([]),errorHandler,onMutation,getCanvasManager}=options;registerErrorHandler(errorHandler);const inEmittingFrame=recordCrossOriginIframes?window.parent===window:true;let passEmitsToParent=false;if(!inEmittingFrame){try{if(window.parent.document){passEmitsToParent=false}}catch(e){passEmitsToParent=true}}if(inEmittingFrame&&!emit){throw new Error("emit function is required")}if(!inEmittingFrame&&!passEmitsToParent){return()=>{}}if(mousemoveWait!==undefined&&sampling.mousemove===undefined){sampling.mousemove=mousemoveWait}mirror.reset();const maskInputOptions=maskAllInputs===true?{color:true,date:true,"datetime-local":true,email:true,month:true,number:true,range:true,search:true,tel:true,text:true,time:true,url:true,week:true,textarea:true,select:true,radio:true,checkbox:true}:_maskInputOptions!==undefined?_maskInputOptions:{};const slimDOMOptions=_slimDOMOptions===true||_slimDOMOptions==="all"?{script:true,comment:true,headFavicon:true,headWhitespace:true,headMetaSocial:true,headMetaRobots:true,headMetaHttpEquiv:true,headMetaVerification:true,headMetaAuthorship:_slimDOMOptions==="all",headMetaDescKeywords:_slimDOMOptions==="all"}:_slimDOMOptions?_slimDOMOptions:{};polyfill();let lastFullSnapshotEvent;let incrementalSnapshotCount=0;const eventProcessor=e=>{for(const plugin of plugins||[]){if(plugin.eventProcessor){e=plugin.eventProcessor(e)}}if(packFn&&!passEmitsToParent){e=packFn(e)}return e};wrappedEmit=(r,isCheckout)=>{const e=r;e.timestamp=nowTimestamp();if(_optionalChain([mutationBuffers,"access",_4=>_4[0],"optionalAccess",_5=>_5.isFrozen,"call",_6=>_6()])&&e.type!==EventType.FullSnapshot&&!(e.type===EventType.IncrementalSnapshot&&e.data.source===IncrementalSource.Mutation)){mutationBuffers.forEach(buf=>buf.unfreeze())}if(inEmittingFrame){_optionalChain([emit,"optionalCall",_7=>_7(eventProcessor(e),isCheckout)])}else if(passEmitsToParent){const message={type:"rrweb",event:eventProcessor(e),origin:window.location.origin,isCheckout:isCheckout};window.parent.postMessage(message,"*")}if(e.type===EventType.FullSnapshot){lastFullSnapshotEvent=e;incrementalSnapshotCount=0}else if(e.type===EventType.IncrementalSnapshot){if(e.data.source===IncrementalSource.Mutation&&e.data.isAttachIframe){return}incrementalSnapshotCount++;const exceedCount=checkoutEveryNth&&incrementalSnapshotCount>=checkoutEveryNth;const exceedTime=checkoutEveryNms&&lastFullSnapshotEvent&&e.timestamp-lastFullSnapshotEvent.timestamp>checkoutEveryNms;if(exceedCount||exceedTime){takeFullSnapshot(true)}}};const wrappedMutationEmit=m=>{wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.Mutation,...m}})};const wrappedScrollEmit=p=>wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.Scroll,...p}});const wrappedCanvasMutationEmit=p=>wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.CanvasMutation,...p}});const wrappedAdoptedStyleSheetEmit=a=>wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.AdoptedStyleSheet,...a}});const stylesheetManager=new StylesheetManager({mutationCb:wrappedMutationEmit,adoptedStyleSheetCb:wrappedAdoptedStyleSheetEmit});const iframeManager=typeof __RRWEB_EXCLUDE_IFRAME__==="boolean"&&__RRWEB_EXCLUDE_IFRAME__?new IframeManagerNoop:new IframeManager({mirror:mirror,mutationCb:wrappedMutationEmit,stylesheetManager:stylesheetManager,recordCrossOriginIframes:recordCrossOriginIframes,wrappedEmit:wrappedEmit});for(const plugin of plugins||[]){if(plugin.getMirror)plugin.getMirror({nodeMirror:mirror,crossOriginIframeMirror:iframeManager.crossOriginIframeMirror,crossOriginIframeStyleMirror:iframeManager.crossOriginIframeStyleMirror})}const processedNodeManager=new ProcessedNodeManager;const canvasManager=_getCanvasManager(getCanvasManager,{mirror:mirror,win:window,mutationCb:p=>wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.CanvasMutation,...p}}),recordCanvas:recordCanvas,blockClass:blockClass,blockSelector:blockSelector,unblockSelector:unblockSelector,maxCanvasSize:maxCanvasSize,sampling:sampling["canvas"],dataURLOptions:dataURLOptions,errorHandler:errorHandler});const shadowDomManager=typeof __RRWEB_EXCLUDE_SHADOW_DOM__==="boolean"&&__RRWEB_EXCLUDE_SHADOW_DOM__?new ShadowDomManagerNoop:new ShadowDomManager({mutationCb:wrappedMutationEmit,scrollCb:wrappedScrollEmit,bypassOptions:{onMutation:onMutation,blockClass:blockClass,blockSelector:blockSelector,unblockSelector:unblockSelector,maskAllText:maskAllText,maskTextClass:maskTextClass,unmaskTextClass:unmaskTextClass,maskTextSelector:maskTextSelector,unmaskTextSelector:unmaskTextSelector,inlineStylesheet:inlineStylesheet,maskInputOptions:maskInputOptions,dataURLOptions:dataURLOptions,maskAttributeFn:maskAttributeFn,maskTextFn:maskTextFn,maskInputFn:maskInputFn,recordCanvas:recordCanvas,inlineImages:inlineImages,sampling:sampling,slimDOMOptions:slimDOMOptions,iframeManager:iframeManager,stylesheetManager:stylesheetManager,canvasManager:canvasManager,keepIframeSrcFn:keepIframeSrcFn,processedNodeManager:processedNodeManager},mirror:mirror});const takeFullSnapshot=(isCheckout=false)=>{if(!recordDOM){return}wrappedEmit({type:EventType.Meta,data:{href:window.location.href,width:getWindowWidth(),height:getWindowHeight()}},isCheckout);stylesheetManager.reset();shadowDomManager.init();mutationBuffers.forEach(buf=>buf.lock());const node=snapshot(document,{mirror:mirror,blockClass:blockClass,blockSelector:blockSelector,unblockSelector:unblockSelector,maskAllText:maskAllText,maskTextClass:maskTextClass,unmaskTextClass:unmaskTextClass,maskTextSelector:maskTextSelector,unmaskTextSelector:unmaskTextSelector,inlineStylesheet:inlineStylesheet,maskAllInputs:maskInputOptions,maskAttributeFn:maskAttributeFn,maskInputFn:maskInputFn,maskTextFn:maskTextFn,slimDOM:slimDOMOptions,dataURLOptions:dataURLOptions,recordCanvas:recordCanvas,inlineImages:inlineImages,onSerialize:n=>{if(isSerializedIframe(n,mirror)){iframeManager.addIframe(n)}if(isSerializedStylesheet(n,mirror)){stylesheetManager.trackLinkElement(n)}if(hasShadowRoot(n)){shadowDomManager.addShadowRoot(n.shadowRoot,document)}},onIframeLoad:(iframe,childSn)=>{iframeManager.attachIframe(iframe,childSn);if(iframe.contentWindow){canvasManager.addWindow(iframe.contentWindow)}shadowDomManager.observeAttachShadow(iframe)},onStylesheetLoad:(linkEl,childSn)=>{stylesheetManager.attachLinkElement(linkEl,childSn)},keepIframeSrcFn:keepIframeSrcFn});if(!node){return console.warn("Failed to snapshot the document")}wrappedEmit({type:EventType.FullSnapshot,data:{node:node,initialOffset:getWindowScroll(window)}});mutationBuffers.forEach(buf=>buf.unlock());if(document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0)stylesheetManager.adoptStyleSheets(document.adoptedStyleSheets,mirror.getId(document))};_takeFullSnapshot=takeFullSnapshot;try{const handlers=[];const observe=doc=>{return callbackWrapper(initObservers)({onMutation:onMutation,mutationCb:wrappedMutationEmit,mousemoveCb:(positions,source)=>wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:source,positions:positions}}),mouseInteractionCb:d=>wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.MouseInteraction,...d}}),scrollCb:wrappedScrollEmit,viewportResizeCb:d=>wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.ViewportResize,...d}}),inputCb:v=>wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.Input,...v}}),mediaInteractionCb:p=>wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.MediaInteraction,...p}}),styleSheetRuleCb:r=>wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.StyleSheetRule,...r}}),styleDeclarationCb:r=>wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.StyleDeclaration,...r}}),canvasMutationCb:wrappedCanvasMutationEmit,fontCb:p=>wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.Font,...p}}),selectionCb:p=>{wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.Selection,...p}})},customElementCb:c=>{wrappedEmit({type:EventType.IncrementalSnapshot,data:{source:IncrementalSource.CustomElement,...c}})},blockClass:blockClass,ignoreClass:ignoreClass,ignoreSelector:ignoreSelector,maskAllText:maskAllText,maskTextClass:maskTextClass,unmaskTextClass:unmaskTextClass,maskTextSelector:maskTextSelector,unmaskTextSelector:unmaskTextSelector,maskInputOptions:maskInputOptions,inlineStylesheet:inlineStylesheet,sampling:sampling,recordDOM:recordDOM,recordCanvas:recordCanvas,inlineImages:inlineImages,userTriggeredOnInput:userTriggeredOnInput,collectFonts:collectFonts,doc:doc,maskAttributeFn:maskAttributeFn,maskInputFn:maskInputFn,maskTextFn:maskTextFn,keepIframeSrcFn:keepIframeSrcFn,blockSelector:blockSelector,unblockSelector:unblockSelector,slimDOMOptions:slimDOMOptions,dataURLOptions:dataURLOptions,mirror:mirror,iframeManager:iframeManager,stylesheetManager:stylesheetManager,shadowDomManager:shadowDomManager,processedNodeManager:processedNodeManager,canvasManager:canvasManager,ignoreCSSAttributes:ignoreCSSAttributes,plugins:_optionalChain([plugins,"optionalAccess",_8=>_8.filter,"call",_9=>_9(p=>p.observer),"optionalAccess",_10=>_10.map,"call",_11=>_11(p=>({observer:p.observer,options:p.options,callback:payload=>wrappedEmit({type:EventType.Plugin,data:{plugin:p.name,payload:payload}})}))])||[]},{})};iframeManager.addLoadListener(iframeEl=>{try{handlers.push(observe(iframeEl.contentDocument))}catch(error){console.warn(error)}});const init=()=>{takeFullSnapshot();handlers.push(observe(document))};if(document.readyState==="interactive"||document.readyState==="complete"){init()}else{handlers.push(on("DOMContentLoaded",()=>{wrappedEmit({type:EventType.DomContentLoaded,data:{}});if(recordAfter==="DOMContentLoaded")init()}));handlers.push(on("load",()=>{wrappedEmit({type:EventType.Load,data:{}});if(recordAfter==="load")init()},window))}return()=>{handlers.forEach(h=>h());processedNodeManager.destroy();_takeFullSnapshot=undefined;unregisterErrorHandler()}}catch(error){console.warn(error)}}function takeFullSnapshot(isCheckout){if(!_takeFullSnapshot){throw new Error("please take full snapshot after start recording")}_takeFullSnapshot(isCheckout)}record.mirror=mirror;record.takeFullSnapshot=takeFullSnapshot;function _getCanvasManager(getCanvasManagerFn,options){try{return getCanvasManagerFn?getCanvasManagerFn(options):new CanvasManagerNoop}catch(e2){console.warn("Unable to initialize CanvasManager");return new CanvasManagerNoop}}const ReplayEventTypeIncrementalSnapshot=3;const ReplayEventTypeCustom=5;function timestampToMs(timestamp){const isMs=timestamp>9999999999;return isMs?timestamp:timestamp*1e3}function timestampToS(timestamp){const isMs=timestamp>9999999999;return isMs?timestamp/1e3:timestamp}function addBreadcrumbEvent(replay,breadcrumb){if(breadcrumb.category==="sentry.transaction"){return}if(["ui.click","ui.input"].includes(breadcrumb.category)){replay.triggerUserActivity()}else{replay.checkAndHandleExpiredSession()}replay.addUpdate(()=>{replay.throttledAddEvent({type:EventType.Custom,timestamp:(breadcrumb.timestamp||0)*1e3,data:{tag:"breadcrumb",payload:core.normalize(breadcrumb,10,1e3)}});return breadcrumb.category==="console"})}const INTERACTIVE_SELECTOR="button,a";function getClosestInteractive(element){const closestInteractive=element.closest(INTERACTIVE_SELECTOR);return closestInteractive||element}function getClickTargetNode(event){const target=getTargetNode(event);if(!target||!(target instanceof Element)){return target}return getClosestInteractive(target)}function getTargetNode(event){if(isEventWithTarget(event)){return event.target}return event}function isEventWithTarget(event){return typeof event==="object"&&!!event&&"target"in event}let handlers;function onWindowOpen(cb){if(!handlers){handlers=[];monkeyPatchWindowOpen()}handlers.push(cb);return()=>{const pos=handlers?handlers.indexOf(cb):-1;if(pos>-1){handlers.splice(pos,1)}}}function monkeyPatchWindowOpen(){core.fill(WINDOW,"open",function(originalWindowOpen){return function(...args){if(handlers){try{handlers.forEach(handler=>handler())}catch(e){}}return originalWindowOpen.apply(WINDOW,args)}})}const IncrementalMutationSources=new Set([IncrementalSource.Mutation,IncrementalSource.StyleSheetRule,IncrementalSource.StyleDeclaration,IncrementalSource.AdoptedStyleSheet,IncrementalSource.CanvasMutation,IncrementalSource.Selection,IncrementalSource.MediaInteraction]);function handleClick(clickDetector,clickBreadcrumb,node){clickDetector.handleClick(clickBreadcrumb,node)}class ClickDetector{constructor(replay,slowClickConfig,_addBreadcrumbEvent=addBreadcrumbEvent){this._lastMutation=0;this._lastScroll=0;this._clicks=[];this._timeout=slowClickConfig.timeout/1e3;this._threshold=slowClickConfig.threshold/1e3;this._scrollTimeout=slowClickConfig.scrollTimeout/1e3;this._replay=replay;this._ignoreSelector=slowClickConfig.ignoreSelector;this._addBreadcrumbEvent=_addBreadcrumbEvent}addListeners(){const cleanupWindowOpen=onWindowOpen(()=>{this._lastMutation=nowInSeconds()});this._teardown=()=>{cleanupWindowOpen();this._clicks=[];this._lastMutation=0;this._lastScroll=0}}removeListeners(){if(this._teardown){this._teardown()}if(this._checkClickTimeout){clearTimeout(this._checkClickTimeout)}}handleClick(breadcrumb,node){if(ignoreElement(node,this._ignoreSelector)||!isClickBreadcrumb(breadcrumb)){return}const newClick={timestamp:timestampToS(breadcrumb.timestamp),clickBreadcrumb:breadcrumb,clickCount:0,node:node};if(this._clicks.some(click=>click.node===newClick.node&&Math.abs(click.timestamp-newClick.timestamp)<1)){return}this._clicks.push(newClick);if(this._clicks.length===1){this._scheduleCheckClicks()}}registerMutation(timestamp=Date.now()){this._lastMutation=timestampToS(timestamp)}registerScroll(timestamp=Date.now()){this._lastScroll=timestampToS(timestamp)}registerClick(element){const node=getClosestInteractive(element);this._handleMultiClick(node)}_handleMultiClick(node){this._getClicks(node).forEach(click=>{click.clickCount++})}_getClicks(node){return this._clicks.filter(click=>click.node===node)}_checkClicks(){const timedOutClicks=[];const now=nowInSeconds();this._clicks.forEach(click=>{if(!click.mutationAfter&&this._lastMutation){click.mutationAfter=click.timestamp<=this._lastMutation?this._lastMutation-click.timestamp:undefined}if(!click.scrollAfter&&this._lastScroll){click.scrollAfter=click.timestamp<=this._lastScroll?this._lastScroll-click.timestamp:undefined}if(click.timestamp+this._timeout<=now){timedOutClicks.push(click)}});for(const click of timedOutClicks){const pos=this._clicks.indexOf(click);if(pos>-1){this._generateBreadcrumbs(click);this._clicks.splice(pos,1)}}if(this._clicks.length){this._scheduleCheckClicks()}}_generateBreadcrumbs(click){const replay=this._replay;const hadScroll=click.scrollAfter&&click.scrollAfter<=this._scrollTimeout;const hadMutation=click.mutationAfter&&click.mutationAfter<=this._threshold;const isSlowClick=!hadScroll&&!hadMutation;const{clickCount,clickBreadcrumb}=click;if(isSlowClick){const timeAfterClickMs=Math.min(click.mutationAfter||this._timeout,this._timeout)*1e3;const endReason=timeAfterClickMs<this._timeout*1e3?"mutation":"timeout";const breadcrumb={type:"default",message:clickBreadcrumb.message,timestamp:clickBreadcrumb.timestamp,category:"ui.slowClickDetected",data:{...clickBreadcrumb.data,url:WINDOW.location.href,route:replay.getCurrentRoute(),timeAfterClickMs:timeAfterClickMs,endReason:endReason,clickCount:clickCount||1}};this._addBreadcrumbEvent(replay,breadcrumb);return}if(clickCount>1){const breadcrumb={type:"default",message:clickBreadcrumb.message,timestamp:clickBreadcrumb.timestamp,category:"ui.multiClick",data:{...clickBreadcrumb.data,url:WINDOW.location.href,route:replay.getCurrentRoute(),clickCount:clickCount,metric:true}};this._addBreadcrumbEvent(replay,breadcrumb)}}_scheduleCheckClicks(){if(this._checkClickTimeout){clearTimeout(this._checkClickTimeout)}this._checkClickTimeout=browserUtils.setTimeout(()=>this._checkClicks(),1e3)}}const SLOW_CLICK_TAGS=["A","BUTTON","INPUT"];function ignoreElement(node,ignoreSelector){if(!SLOW_CLICK_TAGS.includes(node.tagName)){return true}if(node.tagName==="INPUT"&&!["submit","button"].includes(node.getAttribute("type")||"")){return true}if(node.tagName==="A"&&(node.hasAttribute("download")||node.hasAttribute("target")&&node.getAttribute("target")!=="_self")){return true}if(ignoreSelector&&node.matches(ignoreSelector)){return true}return false}function isClickBreadcrumb(breadcrumb){return!!(breadcrumb.data&&typeof breadcrumb.data.nodeId==="number"&&breadcrumb.timestamp)}function nowInSeconds(){return Date.now()/1e3}function updateClickDetectorForRecordingEvent(clickDetector,event){try{if(!isIncrementalEvent(event)){return}const{source}=event.data;if(IncrementalMutationSources.has(source)){clickDetector.registerMutation(event.timestamp)}if(source===IncrementalSource.Scroll){clickDetector.registerScroll(event.timestamp)}if(isIncrementalMouseInteraction(event)){const{type,id}=event.data;const node=record.mirror.getNode(id);if(node instanceof HTMLElement&&type===MouseInteractions.Click){clickDetector.registerClick(node)}}}catch(e){}}function isIncrementalEvent(event){return event.type===ReplayEventTypeIncrementalSnapshot}function isIncrementalMouseInteraction(event){return event.data.source===IncrementalSource.MouseInteraction}function createBreadcrumb(breadcrumb){return{timestamp:Date.now()/1e3,type:"default",...breadcrumb}}var NodeType;(function(NodeType){NodeType[NodeType["Document"]=0]="Document";NodeType[NodeType["DocumentType"]=1]="DocumentType";NodeType[NodeType["Element"]=2]="Element";NodeType[NodeType["Text"]=3]="Text";NodeType[NodeType["CDATA"]=4]="CDATA";NodeType[NodeType["Comment"]=5]="Comment"})(NodeType||(NodeType={}));const ATTRIBUTES_TO_RECORD=new Set(["id","class","aria-label","role","name","alt","title","data-test-id","data-testid","disabled","aria-disabled","data-sentry-component"]);function getAttributesToRecord(attributes){const obj={};if(!attributes["data-sentry-component"]&&attributes["data-sentry-element"]){attributes["data-sentry-component"]=attributes["data-sentry-element"]}for(const key in attributes){if(ATTRIBUTES_TO_RECORD.has(key)){let normalizedKey=key;if(key==="data-testid"||key==="data-test-id"){normalizedKey="testId"}obj[normalizedKey]=attributes[key]}}return obj}const handleDomListener=replay=>{return handlerData=>{if(!replay.isEnabled()){return}const result=handleDom(handlerData);if(!result){return}const isClick=handlerData.name==="click";const event=isClick?handlerData.event:undefined;if(isClick&&replay.clickDetector&&event&&event.target&&!event.altKey&&!event.metaKey&&!event.ctrlKey&&!event.shiftKey){handleClick(replay.clickDetector,result,getClickTargetNode(handlerData.event))}addBreadcrumbEvent(replay,result)}};function getBaseDomBreadcrumb(target,message){const nodeId=record.mirror.getId(target);const node=nodeId&&record.mirror.getNode(nodeId);const meta=node&&record.mirror.getMeta(node);const element=meta&&isElement(meta)?meta:null;return{message:message,data:element?{nodeId:nodeId,node:{id:nodeId,tagName:element.tagName,textContent:Array.from(element.childNodes).map(node=>node.type===NodeType.Text&&node.textContent).filter(Boolean).map(text=>text.trim()).join(""),attributes:getAttributesToRecord(element.attributes)}}:{}}}function handleDom(handlerData){const{target,message}=getDomTarget(handlerData);return createBreadcrumb({category:`ui.${handlerData.name}`,...getBaseDomBreadcrumb(target,message)})}function getDomTarget(handlerData){const isClick=handlerData.name==="click";let message;let target=null;try{target=isClick?getClickTargetNode(handlerData.event):getTargetNode(handlerData.event);message=core.htmlTreeAsString(target,{maxStringLength:200})||"<unknown>"}catch(e){message="<unknown>"}return{target:target,message:message}}function isElement(node){return node.type===NodeType.Element}function handleKeyboardEvent(replay,event){if(!replay.isEnabled()){return}replay.updateUserActivity();const breadcrumb=getKeyboardBreadcrumb(event);if(!breadcrumb){return}addBreadcrumbEvent(replay,breadcrumb)}function getKeyboardBreadcrumb(event){const{metaKey,shiftKey,ctrlKey,altKey,key,target}=event;if(!target||isInputElement(target)||!key){return null}const hasModifierKey=metaKey||ctrlKey||altKey;const isCharacterKey=key.length===1;if(!hasModifierKey&&isCharacterKey){return null}const message=core.htmlTreeAsString(target,{maxStringLength:200})||"<unknown>";const baseBreadcrumb=getBaseDomBreadcrumb(target,message);return createBreadcrumb({category:"ui.keyDown",message:message,data:{...baseBreadcrumb.data,metaKey:metaKey,shiftKey:shiftKey,ctrlKey:ctrlKey,altKey:altKey,key:key}})}function isInputElement(target){return target.tagName==="INPUT"||target.tagName==="TEXTAREA"||target.isContentEditable}const ENTRY_TYPES={resource:createResourceEntry,paint:createPaintEntry,navigation:createNavigationEntry};function webVitalHandler(getter,replay){return({metric})=>void replay.replayPerformanceEntries.push(getter(metric))}function createPerformanceEntries(entries){return entries.map(createPerformanceEntry).filter(Boolean)}function createPerformanceEntry(entry){const entryType=ENTRY_TYPES[entry.entryType];if(!entryType){return null}return entryType(entry)}function getAbsoluteTime(time){return((core.browserPerformanceTimeOrigin||WINDOW.performance.timeOrigin)+time)/1e3}function createPaintEntry(entry){const{duration,entryType,name,startTime}=entry;const start=getAbsoluteTime(startTime);return{type:entryType,name:name,start:start,end:start+duration,data:undefined}}function createNavigationEntry(entry){const{entryType,name,decodedBodySize,duration,domComplete,encodedBodySize,domContentLoadedEventStart,domContentLoadedEventEnd,domInteractive,loadEventStart,loadEventEnd,redirectCount,startTime,transferSize,type}=entry;if(duration===0){return null}return{type:`${entryType}.${type}`,start:getAbsoluteTime(startTime),end:getAbsoluteTime(domComplete),name:name,data:{size:transferSize,decodedBodySize:decodedBodySize,encodedBodySize:encodedBodySize,duration:duration,domInteractive:domInteractive,domContentLoadedEventStart:domContentLoadedEventStart,domContentLoadedEventEnd:domContentLoadedEventEnd,loadEventStart:loadEventStart,loadEventEnd:loadEventEnd,domComplete:domComplete,redirectCount:redirectCount}}}function createResourceEntry(entry){const{entryType,initiatorType,name,responseEnd,startTime,decodedBodySize,encodedBodySize,responseStatus,transferSize}=entry;if(["fetch","xmlhttprequest"].includes(initiatorType)){return null}return{type:`${entryType}.${initiatorType}`,start:getAbsoluteTime(startTime),end:getAbsoluteTime(responseEnd),name:name,data:{size:transferSize,statusCode:responseStatus,decodedBodySize:decodedBodySize,encodedBodySize:encodedBodySize}}}function getLargestContentfulPaint(metric){const lastEntry=metric.entries[metric.entries.length-1];const node=lastEntry&&lastEntry.element?[lastEntry.element]:undefined;return getWebVital(metric,"largest-contentful-paint",node)}function isLayoutShift(entry){return entry.sources!==undefined}function getCumulativeLayoutShift(metric){const layoutShifts=[];const nodes=[];for(const entry of metric.entries){if(isLayoutShift(entry)){const nodeIds=[];for(const source of entry.sources){if(source.node){nodes.push(source.node);const nodeId=record.mirror.getId(source.node);if(nodeId){nodeIds.push(nodeId)}}}layoutShifts.push({value:entry.value,nodeIds:nodeIds.length?nodeIds:undefined})}}return getWebVital(metric,"cumulative-layout-shift",nodes,layoutShifts)}function getFirstInputDelay(metric){const lastEntry=metric.entries[metric.entries.length-1];const node=lastEntry&&lastEntry.target?[lastEntry.target]:undefined;return getWebVital(metric,"first-input-delay",node)}function getInteractionToNextPaint(metric){const lastEntry=metric.entries[metric.entries.length-1];const node=lastEntry&&lastEntry.target?[lastEntry.target]:undefined;return getWebVital(metric,"interaction-to-next-paint",node)}function getWebVital(metric,name,nodes,attributions){const value=metric.value;const rating=metric.rating;const end=getAbsoluteTime(value);return{type:"web-vital",name:name,start:end,end:end,data:{value:value,size:value,rating:rating,nodeIds:nodes?nodes.map(node=>record.mirror.getId(node)):undefined,attributions:attributions}}}function setupPerformanceObserver(replay){function addPerformanceEntry(entry){if(!replay.performanceEntries.includes(entry)){replay.performanceEntries.push(entry)}}function onEntries({entries}){entries.forEach(addPerformanceEntry)}const clearCallbacks=[];["navigation","paint","resource"].forEach(type=>{clearCallbacks.push(browserUtils.addPerformanceInstrumentationHandler(type,onEntries))});clearCallbacks.push(browserUtils.addLcpInstrumentationHandler(webVitalHandler(getLargestContentfulPaint,replay)),browserUtils.addClsInstrumentationHandler(webVitalHandler(getCumulativeLayoutShift,replay)),browserUtils.addFidInstrumentationHandler(webVitalHandler(getFirstInputDelay,replay)),browserUtils.addInpInstrumentationHandler(webVitalHandler(getInteractionToNextPaint,replay)));return()=>{clearCallbacks.forEach(clearCallback=>clearCallback())}}const DEBUG_BUILD=typeof __SENTRY_DEBUG__==="undefined"||__SENTRY_DEBUG__;const r=`var t=Uint8Array,n=Uint16Array,r=Int32Array,e=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(t,e){for(var i=new n(31),a=0;a<31;++a)i[a]=e+=1<<t[a-1];var s=new r(i[30]);for(a=1;a<30;++a)for(var o=i[a];o<i[a+1];++o)s[o]=o-i[a]<<5|a;return{b:i,r:s}},o=s(e,2),f=o.b,h=o.r;f[28]=258,h[258]=28;for(var l=s(i,0).r,u=new n(32768),c=0;c<32768;++c){var v=(43690&c)>>1|(21845&c)<<1;v=(61680&(v=(52428&v)>>2|(13107&v)<<2))>>4|(3855&v)<<4,u[c]=((65280&v)>>8|(255&v)<<8)>>1}var d=function(t,r,e){for(var i=t.length,a=0,s=new n(r);a<i;++a)t[a]&&++s[t[a]-1];var o,f=new n(r);for(a=1;a<r;++a)f[a]=f[a-1]+s[a-1]<<1;if(e){o=new n(1<<r);var h=15-r;for(a=0;a<i;++a)if(t[a])for(var l=a<<4|t[a],c=r-t[a],v=f[t[a]-1]++<<c,d=v|(1<<c)-1;v<=d;++v)o[u[v]>>h]=l}else for(o=new n(i),a=0;a<i;++a)t[a]&&(o[a]=u[f[t[a]-1]++]>>15-t[a]);return o},g=new t(288);for(c=0;c<144;++c)g[c]=8;for(c=144;c<256;++c)g[c]=9;for(c=256;c<280;++c)g[c]=7;for(c=280;c<288;++c)g[c]=8;var w=new t(32);for(c=0;c<32;++c)w[c]=5;var p=d(g,9,0),y=d(w,5,0),m=function(t){return(t+7)/8|0},b=function(n,r,e){return(null==e||e>n.length)&&(e=n.length),new t(n.subarray(r,e))},M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],E=function(t,n,r){var e=new Error(n||M[t]);if(e.code=t,Error.captureStackTrace&&Error.captureStackTrace(e,E),!r)throw e;return e},z=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8},_=function(t,n,r){r<<=7&n;var e=n/8|0;t[e]|=r,t[e+1]|=r>>8,t[e+2]|=r>>16},x=function(r,e){for(var i=[],a=0;a<r.length;++a)r[a]&&i.push({s:a,f:r[a]});var s=i.length,o=i.slice();if(!s)return{t:F,l:0};if(1==s){var f=new t(i[0].s+1);return f[i[0].s]=1,{t:f,l:1}}i.sort((function(t,n){return t.f-n.f})),i.push({s:-1,f:25001});var h=i[0],l=i[1],u=0,c=1,v=2;for(i[0]={s:-1,f:h.f+l.f,l:h,r:l};c!=s-1;)h=i[i[u].f<i[v].f?u++:v++],l=i[u!=c&&i[u].f<i[v].f?u++:v++],i[c++]={s:-1,f:h.f+l.f,l:h,r:l};var d=o[0].s;for(a=1;a<s;++a)o[a].s>d&&(d=o[a].s);var g=new n(d+1),w=A(i[c-1],g,0);if(w>e){a=0;var p=0,y=w-e,m=1<<y;for(o.sort((function(t,n){return g[n.s]-g[t.s]||t.f-n.f}));a<s;++a){var b=o[a].s;if(!(g[b]>e))break;p+=m-(1<<w-g[b]),g[b]=e}for(p>>=y;p>0;){var M=o[a].s;g[M]<e?p-=1<<e-g[M]++-1:++a}for(;a>=0&&p;--a){var E=o[a].s;g[E]==e&&(--g[E],++p)}w=e}return{t:new t(g),l:w}},A=function(t,n,r){return-1==t.s?Math.max(A(t.l,n,r+1),A(t.r,n,r+1)):n[t.s]=r},D=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new n(++r),i=0,a=t[0],s=1,o=function(t){e[i++]=t},f=1;f<=r;++f)if(t[f]==a&&f!=r)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=t[f]}return{c:e.subarray(0,i),n:r}},T=function(t,n){for(var r=0,e=0;e<n.length;++e)r+=t[e]*n[e];return r},k=function(t,n,r){var e=r.length,i=m(n+2);t[i]=255&e,t[i+1]=e>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var a=0;a<e;++a)t[i+a+4]=r[a];return 8*(i+4+e)},U=function(t,r,s,o,f,h,l,u,c,v,m){z(r,m++,s),++f[256];for(var b=x(f,15),M=b.t,E=b.l,A=x(h,15),U=A.t,C=A.l,F=D(M),I=F.c,S=F.n,L=D(U),O=L.c,j=L.n,q=new n(19),B=0;B<I.length;++B)++q[31&I[B]];for(B=0;B<O.length;++B)++q[31&O[B]];for(var G=x(q,7),H=G.t,J=G.l,K=19;K>4&&!H[a[K-1]];--K);var N,P,Q,R,V=v+5<<3,W=T(f,g)+T(h,w)+l,X=T(f,M)+T(h,U)+l+14+3*K+T(q,H)+2*q[16]+3*q[17]+7*q[18];if(c>=0&&V<=W&&V<=X)return k(r,m,t.subarray(c,c+v));if(z(r,m,1+(X<W)),m+=2,X<W){N=d(M,E,0),P=M,Q=d(U,C,0),R=U;var Y=d(H,J,0);z(r,m,S-257),z(r,m+5,j-1),z(r,m+10,K-4),m+=14;for(B=0;B<K;++B)z(r,m+3*B,H[a[B]]);m+=3*K;for(var Z=[I,O],$=0;$<2;++$){var tt=Z[$];for(B=0;B<tt.length;++B){var nt=31&tt[B];z(r,m,Y[nt]),m+=H[nt],nt>15&&(z(r,m,tt[B]>>5&127),m+=tt[B]>>12)}}}else N=p,P=g,Q=y,R=w;for(B=0;B<u;++B){var rt=o[B];if(rt>255){_(r,m,N[(nt=rt>>18&31)+257]),m+=P[nt+257],nt>7&&(z(r,m,rt>>23&31),m+=e[nt]);var et=31&rt;_(r,m,Q[et]),m+=R[et],et>3&&(_(r,m,rt>>5&8191),m+=i[et])}else _(r,m,N[rt]),m+=P[rt]}return _(r,m,N[256]),m+P[256]},C=new r([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),F=new t(0),I=function(){for(var t=new Int32Array(256),n=0;n<256;++n){for(var r=n,e=9;--e;)r=(1&r&&-306674912)^r>>>1;t[n]=r}return t}(),S=function(){var t=-1;return{p:function(n){for(var r=t,e=0;e<n.length;++e)r=I[255&r^n[e]]^r>>>8;t=r},d:function(){return~t}}},L=function(){var t=1,n=0;return{p:function(r){for(var e=t,i=n,a=0|r.length,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=e+=r[s];e=(65535&e)+15*(e>>16),i=(65535&i)+15*(i>>16)}t=e,n=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(n%=65521))<<8|n>>8}}},O=function(a,s,o,f,u){if(!u&&(u={l:1},s.dictionary)){var c=s.dictionary.subarray(-32768),v=new t(c.length+a.length);v.set(c),v.set(a,c.length),a=v,u.w=c.length}return function(a,s,o,f,u,c){var v=c.z||a.length,d=new t(f+v+5*(1+Math.ceil(v/7e3))+u),g=d.subarray(f,d.length-u),w=c.l,p=7&(c.r||0);if(s){p&&(g[0]=c.r>>3);for(var y=C[s-1],M=y>>13,E=8191&y,z=(1<<o)-1,_=c.p||new n(32768),x=c.h||new n(z+1),A=Math.ceil(o/3),D=2*A,T=function(t){return(a[t]^a[t+1]<<A^a[t+2]<<D)&z},F=new r(25e3),I=new n(288),S=new n(32),L=0,O=0,j=c.i||0,q=0,B=c.w||0,G=0;j+2<v;++j){var H=T(j),J=32767&j,K=x[H];if(_[J]=K,x[H]=J,B<=j){var N=v-j;if((L>7e3||q>24576)&&(N>423||!w)){p=U(a,g,0,F,I,S,O,q,G,j-G,p),q=L=O=0,G=j;for(var P=0;P<286;++P)I[P]=0;for(P=0;P<30;++P)S[P]=0}var Q=2,R=0,V=E,W=J-K&32767;if(N>2&&H==T(j-W))for(var X=Math.min(M,N)-1,Y=Math.min(32767,j),Z=Math.min(258,N);W<=Y&&--V&&J!=K;){if(a[j+Q]==a[j+Q-W]){for(var $=0;$<Z&&a[j+$]==a[j+$-W];++$);if($>Q){if(Q=$,R=W,$>X)break;var tt=Math.min(W,$-2),nt=0;for(P=0;P<tt;++P){var rt=j-W+P&32767,et=rt-_[rt]&32767;et>nt&&(nt=et,K=rt)}}}W+=(J=K)-(K=_[J])&32767}if(R){F[q++]=268435456|h[Q]<<18|l[R];var it=31&h[Q],at=31&l[R];O+=e[it]+i[at],++I[257+it],++S[at],B=j+Q,++L}else F[q++]=a[j],++I[a[j]]}}for(j=Math.max(j,B);j<v;++j)F[q++]=a[j],++I[a[j]];p=U(a,g,w,F,I,S,O,q,G,j-G,p),w||(c.r=7&p|g[p/8|0]<<3,p-=7,c.h=x,c.p=_,c.i=j,c.w=B)}else{for(j=c.w||0;j<v+w;j+=65535){var st=j+65535;st>=v&&(g[p/8|0]=w,st=v),p=k(g,p+1,a.subarray(j,st))}c.i=v}return b(d,0,f+m(p)+u)}(a,null==s.level?6:s.level,null==s.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):12+s.mem,o,f,u)},j=function(t,n,r){for(;r;++n)t[n]=r,r>>>=8},q=function(t,n){var r=n.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=n.level<2?4:9==n.level?2:0,t[9]=3,0!=n.mtime&&j(t,4,Math.floor(new Date(n.mtime||Date.now())/1e3)),r){t[3]=8;for(var e=0;e<=r.length;++e)t[e+10]=r.charCodeAt(e)}},B=function(t){return 10+(t.filename?t.filename.length+1:0)},G=function(){function n(n,r){if("function"==typeof n&&(r=n,n={}),this.ondata=r,this.o=n||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new t(98304),this.o.dictionary){var e=this.o.dictionary.subarray(-32768);this.b.set(e,32768-e.length),this.s.i=32768-e.length}}return n.prototype.p=function(t,n){this.ondata(O(t,this.o,0,0,this.s),n)},n.prototype.push=function(n,r){this.ondata||E(5),this.s.l&&E(4);var e=n.length+this.s.z;if(e>this.b.length){if(e>2*this.b.length-32768){var i=new t(-32768&e);i.set(this.b.subarray(0,this.s.z)),this.b=i}var a=this.b.length-this.s.z;a&&(this.b.set(n.subarray(0,a),this.s.z),this.s.z=this.b.length,this.p(this.b,!1)),this.b.set(this.b.subarray(-32768)),this.b.set(n.subarray(a),32768),this.s.z=n.length-a+32768,this.s.i=32766,this.s.w=32768}else this.b.set(n,this.s.z),this.s.z+=n.length;this.s.l=1&r,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},n}();var H=function(){function t(t,n){this.c=L(),this.v=1,G.call(this,t,n)}return t.prototype.push=function(t,n){this.c.p(t),G.prototype.push.call(this,t,n)},t.prototype.p=function(t,n){var r=O(t,this.o,this.v&&(this.o.dictionary?6:2),n&&4,this.s);this.v&&(function(t,n){var r=n.level,e=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=e<<6|(n.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,n.dictionary){var i=L();i.p(n.dictionary),j(t,2,i.d())}}(r,this.o),this.v=0),n&&j(r,r.length-4,this.c.d()),this.ondata(r,n)},t}(),J="undefined"!=typeof TextEncoder&&new TextEncoder,K="undefined"!=typeof TextDecoder&&new TextDecoder;try{K.decode(F,{stream:!0})}catch(t){}var N=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,n){this.ondata||E(5),this.d&&E(4),this.ondata(P(t),this.d=n||!1)},t}();function P(n,r){if(J)return J.encode(n);for(var e=n.length,i=new t(n.length+(n.length>>1)),a=0,s=function(t){i[a++]=t},o=0;o<e;++o){if(a+5>i.length){var f=new t(a+8+(e-o<<1));f.set(i),i=f}var h=n.charCodeAt(o);h<128||r?s(h):h<2048?(s(192|h>>6),s(128|63&h)):h>55295&&h<57344?(s(240|(h=65536+(1047552&h)|1023&n.charCodeAt(++o))>>18),s(128|h>>12&63),s(128|h>>6&63),s(128|63&h)):(s(224|h>>12),s(128|h>>6&63),s(128|63&h))}return b(i,0,a)}function Q(t){return function(t,n){n||(n={});var r=S(),e=t.length;r.p(t);var i=O(t,n,B(n),8),a=i.length;return q(i,n),j(i,a-8,r.d()),j(i,a-4,e),i}(P(t))}const R=new class{constructor(){this._init()}clear(){this._init()}addEvent(t){if(!t)throw new Error("Adding invalid event");const n=this._hasEvents?",":"";this.stream.push(n+t),this._hasEvents=!0}finish(){this.stream.push("]",!0);const t=function(t){let n=0;for(const r of t)n+=r.length;const r=new Uint8Array(n);for(let n=0,e=0,i=t.length;n<i;n++){const i=t[n];r.set(i,e),e+=i.length}return r}(this._deflatedData);return this._init(),t}_init(){this._hasEvents=!1,this._deflatedData=[],this.deflate=new H,this.deflate.ondata=(t,n)=>{this._deflatedData.push(t)},this.stream=new N(((t,n)=>{this.deflate.push(t,n)})),this.stream.push("[")}},V={clear:()=>{R.clear()},addEvent:t=>R.addEvent(t),finish:()=>R.finish(),compress:t=>Q(t)};addEventListener("message",(function(t){const n=t.data.method,r=t.data.id,e=t.data.arg;if(n in V&&"function"==typeof V[n])try{const t=V[n](e);postMessage({id:r,method:n,success:!0,response:t})}catch(t){postMessage({id:r,method:n,success:!1,response:t.message}),console.error(t)}})),postMessage({id:void 0,method:"init",success:!0,response:void 0});`;function e(){const e=new Blob([r]);return URL.createObjectURL(e)}const CONSOLE_LEVELS=["info","warn","error","log"];const PREFIX="[Replay] ";function _addBreadcrumb(message,level="info"){core.addBreadcrumb({category:"console",data:{logger:"replay"},level:level,message:`${PREFIX}${message}`},{level:level})}function makeReplayLogger(){let _capture=false;let _trace=false;const _logger={exception:()=>undefined,infoTick:()=>undefined,setConfig:opts=>{_capture=opts.captureExceptions;_trace=opts.traceInternals}};if(DEBUG_BUILD){CONSOLE_LEVELS.forEach(name=>{_logger[name]=(...args)=>{core.logger[name](PREFIX,...args);if(_trace){_addBreadcrumb(args.join(""),core.severityLevelFromString(name))}}});_logger.exception=(error,...message)=>{if(message.length&&_logger.error){_logger.error(...message)}core.logger.error(PREFIX,error);if(_capture){core.captureException(error)}else if(_trace){_addBreadcrumb(error,"error")}};_logger.infoTick=(...args)=>{core.logger.info(PREFIX,...args);if(_trace){setTimeout(()=>_addBreadcrumb(args[0]),0)}}}else{CONSOLE_LEVELS.forEach(name=>{_logger[name]=()=>undefined})}return _logger}const logger=makeReplayLogger();class EventBufferSizeExceededError extends Error{constructor(){super(`Event buffer exceeded maximum size of ${REPLAY_MAX_EVENT_BUFFER_SIZE}.`)}}class EventBufferArray{constructor(){this.events=[];this._totalSize=0;this.hasCheckout=false;this.waitForCheckout=false}get hasEvents(){return this.events.length>0}get type(){return"sync"}destroy(){this.events=[]}async addEvent(event){const eventSize=JSON.stringify(event).length;this._totalSize+=eventSize;if(this._totalSize>REPLAY_MAX_EVENT_BUFFER_SIZE){throw new EventBufferSizeExceededError}this.events.push(event)}finish(){return new Promise(resolve=>{const eventsRet=this.events;this.clear();resolve(JSON.stringify(eventsRet))})}clear(){this.events=[];this._totalSize=0;this.hasCheckout=false}getEarliestTimestamp(){const timestamp=this.events.map(event=>event.timestamp).sort()[0];if(!timestamp){return null}return timestampToMs(timestamp)}}class WorkerHandler{constructor(worker){this._worker=worker;this._id=0}ensureReady(){if(this._ensureReadyPromise){return this._ensureReadyPromise}this._ensureReadyPromise=new Promise((resolve,reject)=>{this._worker.addEventListener("message",({data})=>{if(data.success){resolve()}else{reject()}},{once:true});this._worker.addEventListener("error",error=>{reject(error)},{once:true})});return this._ensureReadyPromise}destroy(){DEBUG_BUILD&&logger.info("Destroying compression worker");this._worker.terminate()}postMessage(method,arg){const id=this._getAndIncrementId();return new Promise((resolve,reject)=>{const listener=({data})=>{const response=data;if(response.method!==method){return}if(response.id!==id){return}this._worker.removeEventListener("message",listener);if(!response.success){DEBUG_BUILD&&logger.error("Error in compression worker: ",response.response);reject(new Error("Error in compression worker"));return}resolve(response.response)};this._worker.addEventListener("message",listener);this._worker.postMessage({id:id,method:method,arg:arg})})}_getAndIncrementId(){return this._id++}}class EventBufferCompressionWorker{constructor(worker){this._worker=new WorkerHandler(worker);this._earliestTimestamp=null;this._totalSize=0;this.hasCheckout=false;this.waitForCheckout=false}get hasEvents(){return!!this._earliestTimestamp}get type(){return"worker"}ensureReady(){return this._worker.ensureReady()}destroy(){this._worker.destroy()}addEvent(event){const timestamp=timestampToMs(event.timestamp);if(!this._earliestTimestamp||timestamp<this._earliestTimestamp){this._earliestTimestamp=timestamp}const data=JSON.stringify(event);this._totalSize+=data.length;if(this._totalSize>REPLAY_MAX_EVENT_BUFFER_SIZE){return Promise.reject(new EventBufferSizeExceededError)}return this._sendEventToWorker(data)}finish(){return this._finishRequest()}clear(){this._earliestTimestamp=null;this._totalSize=0;this.hasCheckout=false;this._worker.postMessage("clear").then(null,e=>{DEBUG_BUILD&&logger.exception(e,'Sending "clear" message to worker failed',e)})}getEarliestTimestamp(){return this._earliestTimestamp}_sendEventToWorker(data){return this._worker.postMessage("addEvent",data)}async _finishRequest(){const response=await this._worker.postMessage("finish");this._earliestTimestamp=null;this._totalSize=0;return response}}class EventBufferProxy{constructor(worker){this._fallback=new EventBufferArray;this._compression=new EventBufferCompressionWorker(worker);this._used=this._fallback;this._ensureWorkerIsLoadedPromise=this._ensureWorkerIsLoaded()}get waitForCheckout(){return this._used.waitForCheckout}get type(){return this._used.type}get hasEvents(){return this._used.hasEvents}get hasCheckout(){return this._used.hasCheckout}set hasCheckout(value){this._used.hasCheckout=value}set waitForCheckout(value){this._used.waitForCheckout=value}destroy(){this._fallback.destroy();this._compression.destroy()}clear(){return this._used.clear()}getEarliestTimestamp(){return this._used.getEarliestTimestamp()}addEvent(event){return this._used.addEvent(event)}async finish(){await this.ensureWorkerIsLoaded();return this._used.finish()}ensureWorkerIsLoaded(){return this._ensureWorkerIsLoadedPromise}async _ensureWorkerIsLoaded(){try{await this._compression.ensureReady()}catch(error){DEBUG_BUILD&&logger.exception(error,"Failed to load the compression worker, falling back to simple buffer");return}await this._switchToCompressionWorker()}async _switchToCompressionWorker(){const{events,hasCheckout,waitForCheckout}=this._fallback;const addEventPromises=[];for(const event of events){addEventPromises.push(this._compression.addEvent(event))}this._compression.hasCheckout=hasCheckout;this._compression.waitForCheckout=waitForCheckout;this._used=this._compression;try{await Promise.all(addEventPromises);this._fallback.clear()}catch(error){DEBUG_BUILD&&logger.exception(error,"Failed to add events when switching buffers.")}}}function createEventBuffer({useCompression,workerUrl:customWorkerUrl}){if(useCompression&&window.Worker){const worker=_loadWorker(customWorkerUrl);if(worker){return worker}}DEBUG_BUILD&&logger.info("Using simple buffer");return new EventBufferArray}function _loadWorker(customWorkerUrl){try{const workerUrl=customWorkerUrl||_getWorkerUrl();if(!workerUrl){return}DEBUG_BUILD&&logger.info(`Using compression worker${customWorkerUrl?` from ${customWorkerUrl}`:""}`);const worker=new Worker(workerUrl);return new EventBufferProxy(worker)}catch(error){DEBUG_BUILD&&logger.exception(error,"Failed to create compression worker")}}function _getWorkerUrl(){if(typeof __SENTRY_EXCLUDE_REPLAY_WORKER__==="undefined"||!__SENTRY_EXCLUDE_REPLAY_WORKER__){return e()}return""}function hasSessionStorage(){try{return"sessionStorage"in WINDOW&&!!WINDOW.sessionStorage}catch(e){return false}}function clearSession(replay){deleteSession();replay.session=undefined}function deleteSession(){if(!hasSessionStorage()){return}try{WINDOW.sessionStorage.removeItem(REPLAY_SESSION_KEY)}catch(e){}}function isSampled(sampleRate){if(sampleRate===undefined){return false}return Math.random()<sampleRate}function makeSession(session){const now=Date.now();const id=session.id||core.uuid4();const started=session.started||now;const lastActivity=session.lastActivity||now;const segmentId=session.segmentId||0;const sampled=session.sampled;const previousSessionId=session.previousSessionId;return{id:id,started:started,lastActivity:lastActivity,segmentId:segmentId,sampled:sampled,previousSessionId:previousSessionId}}function saveSession(session){if(!hasSessionStorage()){return}try{WINDOW.sessionStorage.setItem(REPLAY_SESSION_KEY,JSON.stringify(session))}catch(e){}}function getSessionSampleType(sessionSampleRate,allowBuffering){return isSampled(sessionSampleRate)?"session":allowBuffering?"buffer":false}function createSession({sessionSampleRate,allowBuffering,stickySession=false},{previousSessionId}={}){const sampled=getSessionSampleType(sessionSampleRate,allowBuffering);const session=makeSession({sampled:sampled,previousSessionId:previousSessionId});if(stickySession){saveSession(session)}return session}function fetchSession(){if(!hasSessionStorage()){return null}try{const sessionStringFromStorage=WINDOW.sessionStorage.getItem(REPLAY_SESSION_KEY);if(!sessionStringFromStorage){return null}const sessionObj=JSON.parse(sessionStringFromStorage);DEBUG_BUILD&&logger.infoTick("Loading existing session");return makeSession(sessionObj)}catch(e){return null}}function isExpired(initialTime,expiry,targetTime=+new Date){if(initialTime===null||expiry===undefined||expiry<0){return true}if(expiry===0){return false}return initialTime+expiry<=targetTime}function isSessionExpired(session,{maxReplayDuration,sessionIdleExpire,targetTime=Date.now()}){return isExpired(session.started,maxReplayDuration,targetTime)||isExpired(session.lastActivity,sessionIdleExpire,targetTime)}function shouldRefreshSession(session,{sessionIdleExpire,maxReplayDuration}){if(!isSessionExpired(session,{sessionIdleExpire:sessionIdleExpire,maxReplayDuration:maxReplayDuration})){return false}if(session.sampled==="buffer"&&session.segmentId===0){return false}return true}function loadOrCreateSession({sessionIdleExpire,maxReplayDuration,previousSessionId},sessionOptions){const existingSession=sessionOptions.stickySession&&fetchSession();if(!existingSession){DEBUG_BUILD&&logger.infoTick("Creating new session");return createSession(sessionOptions,{previousSessionId:previousSessionId})}if(!shouldRefreshSession(existingSession,{sessionIdleExpire:sessionIdleExpire,maxReplayDuration:maxReplayDuration})){return existingSession}DEBUG_BUILD&&logger.infoTick("Session in sessionStorage is expired, creating new one...");return createSession(sessionOptions,{previousSessionId:existingSession.id})}function isCustomEvent(event){return event.type===EventType.Custom}function addEventSync(replay,event,isCheckout){if(!shouldAddEvent(replay,event)){return false}_addEvent(replay,event,isCheckout);return true}function addEvent(replay,event,isCheckout){if(!shouldAddEvent(replay,event)){return Promise.resolve(null)}return _addEvent(replay,event,isCheckout)}async function _addEvent(replay,event,isCheckout){const{eventBuffer}=replay;if(!eventBuffer||eventBuffer.waitForCheckout&&!isCheckout){return null}const isBufferMode=replay.recordingMode==="buffer";try{if(isCheckout&&isBufferMode){eventBuffer.clear()}if(isCheckout){eventBuffer.hasCheckout=true;eventBuffer.waitForCheckout=false}const replayOptions=replay.getOptions();const eventAfterPossibleCallback=maybeApplyCallback(event,replayOptions.beforeAddRecordingEvent);if(!eventAfterPossibleCallback){return}return await eventBuffer.addEvent(eventAfterPossibleCallback)}catch(error){const isExceeded=error&&error instanceof EventBufferSizeExceededError;const reason=isExceeded?"addEventSizeExceeded":"addEvent";if(isExceeded&&isBufferMode){eventBuffer.clear();eventBuffer.waitForCheckout=true;return null}replay.handleException(error);await replay.stop({reason:reason});const client=core.getClient();if(client){client.recordDroppedEvent("internal_sdk_error","replay")}}}function shouldAddEvent(replay,event){if(!replay.eventBuffer||replay.isPaused()||!replay.isEnabled()){return false}const timestampInMs=timestampToMs(event.timestamp);if(timestampInMs+replay.timeouts.sessionIdlePause<Date.now()){return false}if(timestampInMs>replay.getContext().initialTimestamp+replay.getOptions().maxReplayDuration){DEBUG_BUILD&&logger.infoTick(`Skipping event with timestamp ${timestampInMs} because it is after maxReplayDuration`);return false}return true}function maybeApplyCallback(event,callback){try{if(typeof callback==="function"&&isCustomEvent(event)){return callback(event)}}catch(error){DEBUG_BUILD&&logger.exception(error,"An error occurred in the `beforeAddRecordingEvent` callback, skipping the event...");return null}return event}function isErrorEvent(event){return!event.type}function isTransactionEvent(event){return event.type==="transaction"}function isReplayEvent(event){return event.type==="replay_event"}function isFeedbackEvent(event){return event.type==="feedback"}function handleAfterSendEvent(replay){return(event,sendResponse)=>{if(!replay.isEnabled()||!isErrorEvent(event)&&!isTransactionEvent(event)){return}const statusCode=sendResponse&&sendResponse.statusCode;if(!statusCode||statusCode<200||statusCode>=300){return}if(isTransactionEvent(event)){handleTransactionEvent(replay,event);return}handleErrorEvent(replay,event)}}function handleTransactionEvent(replay,event){const replayContext=replay.getContext();if(event.contexts&&event.contexts.trace&&event.contexts.trace.trace_id&&replayContext.traceIds.size<100){replayContext.traceIds.add(event.contexts.trace.trace_id)}}function handleErrorEvent(replay,event){const replayContext=replay.getContext();if(event.event_id&&replayContext.errorIds.size<100){replayContext.errorIds.add(event.event_id)}if(replay.recordingMode!=="buffer"||!event.tags||!event.tags.replayId){return}const{beforeErrorSampling}=replay.getOptions();if(typeof beforeErrorSampling==="function"&&!beforeErrorSampling(event)){return}browserUtils.setTimeout(async()=>{try{await replay.sendBufferedReplayOrFlush()}catch(err){replay.handleException(err)}})}function handleBeforeSendEvent(replay){return event=>{if(!replay.isEnabled()||!isErrorEvent(event)){return}handleHydrationError(replay,event)}}function handleHydrationError(replay,event){const exceptionValue=event.exception&&event.exception.values&&event.exception.values[0]&&event.exception.values[0].value;if(typeof exceptionValue!=="string"){return}if(exceptionValue.match(/(reactjs\.org\/docs\/error-decoder\.html\?invariant=|react\.dev\/errors\/)(418|419|422|423|425)/)||exceptionValue.match(/(does not match server-rendered HTML|Hydration failed because)/i)){const breadcrumb=createBreadcrumb({category:"replay.hydrate-error",data:{url:core.getLocationHref()}});addBreadcrumbEvent(replay,breadcrumb)}}function handleBreadcrumbs(replay){const client=core.getClient();if(!client){return}client.on("beforeAddBreadcrumb",breadcrumb=>beforeAddBreadcrumb(replay,breadcrumb))}function beforeAddBreadcrumb(replay,breadcrumb){if(!replay.isEnabled()||!isBreadcrumbWithCategory(breadcrumb)){return}const result=normalizeBreadcrumb(breadcrumb);if(result){addBreadcrumbEvent(replay,result)}}function normalizeBreadcrumb(breadcrumb){if(!isBreadcrumbWithCategory(breadcrumb)||["fetch","xhr","sentry.event","sentry.transaction"].includes(breadcrumb.category)||breadcrumb.category.startsWith("ui.")){return null}if(breadcrumb.category==="console"){return normalizeConsoleBreadcrumb(breadcrumb)}return createBreadcrumb(breadcrumb)}function normalizeConsoleBreadcrumb(breadcrumb){const args=breadcrumb.data&&breadcrumb.data.arguments;if(!Array.isArray(args)||args.length===0){return createBreadcrumb(breadcrumb)}let isTruncated=false;const normalizedArgs=args.map(arg=>{if(!arg){return arg}if(typeof arg==="string"){if(arg.length>CONSOLE_ARG_MAX_SIZE){isTruncated=true;return`${arg.slice(0,CONSOLE_ARG_MAX_SIZE)}…`}return arg}if(typeof arg==="object"){try{const normalizedArg=core.normalize(arg,7);const stringified=JSON.stringify(normalizedArg);if(stringified.length>CONSOLE_ARG_MAX_SIZE){isTruncated=true;return`${JSON.stringify(normalizedArg,null,2).slice(0,CONSOLE_ARG_MAX_SIZE)}…`}return normalizedArg}catch(e){}}return arg});return createBreadcrumb({...breadcrumb,data:{...breadcrumb.data,arguments:normalizedArgs,...isTruncated?{_meta:{warnings:["CONSOLE_ARG_TRUNCATED"]}}:{}}})}function isBreadcrumbWithCategory(breadcrumb){return!!breadcrumb.category}function isRrwebError(event,hint){if(event.type||!event.exception||!event.exception.values||!event.exception.values.length){return false}if(hint.originalException&&hint.originalException.__rrweb__){return true}return false}function resetReplayIdOnDynamicSamplingContext(){const dsc=core.getCurrentScope().getPropagationContext().dsc;if(dsc){delete dsc.replay_id}const activeSpan=core.getActiveSpan();if(activeSpan){const dsc=core.getDynamicSamplingContextFromSpan(activeSpan);delete dsc.replay_id}}function addFeedbackBreadcrumb(replay,event){replay.triggerUserActivity();replay.addUpdate(()=>{if(!event.timestamp){return true}replay.throttledAddEvent({type:EventType.Custom,timestamp:event.timestamp*1e3,data:{tag:"breadcrumb",payload:{timestamp:event.timestamp,type:"default",category:"sentry.feedback",data:{feedbackId:event.event_id}}}});return false})}function shouldSampleForBufferEvent(replay,event){if(replay.recordingMode!=="buffer"){return false}if(event.message===UNABLE_TO_SEND_REPLAY){return false}if(!event.exception||event.type){return false}return isSampled(replay.getOptions().errorSampleRate)}function handleGlobalEventListener(replay){return Object.assign((event,hint)=>{if(!replay.isEnabled()||replay.isPaused()){return event}if(isReplayEvent(event)){delete event.breadcrumbs;return event}if(!isErrorEvent(event)&&!isTransactionEvent(event)&&!isFeedbackEvent(event)){return event}const isSessionActive=replay.checkAndHandleExpiredSession();if(!isSessionActive){resetReplayIdOnDynamicSamplingContext();return event}if(isFeedbackEvent(event)){replay.flush();event.contexts.feedback.replay_id=replay.getSessionId();addFeedbackBreadcrumb(replay,event);return event}if(isRrwebError(event,hint)&&!replay.getOptions()._experiments.captureExceptions){DEBUG_BUILD&&logger.log("Ignoring error from rrweb internals",event);return null}const isErrorEventSampled=shouldSampleForBufferEvent(replay,event);const shouldTagReplayId=isErrorEventSampled||replay.recordingMode==="session";if(shouldTagReplayId){event.tags={...event.tags,replayId:replay.getSessionId()}}return event},{id:"Replay"})}function createPerformanceSpans(replay,entries){return entries.map(({type,start,end,name,data})=>{const response=replay.throttledAddEvent({type:EventType.Custom,timestamp:start,data:{tag:"performanceSpan",payload:{op:type,description:name,startTimestamp:start,endTimestamp:end,data:data}}});return typeof response==="string"?Promise.resolve(null):response})}function handleHistory(handlerData){const{from,to}=handlerData;const now=Date.now()/1e3;return{type:"navigation.push",start:now,end:now,name:to,data:{previous:from}}}function handleHistorySpanListener(replay){return handlerData=>{if(!replay.isEnabled()){return}const result=handleHistory(handlerData);if(result===null){return}replay.getContext().urls.push(result.name);replay.triggerUserActivity();replay.addUpdate(()=>{createPerformanceSpans(replay,[result]);return false})}}function shouldFilterRequest(replay,url){if(DEBUG_BUILD&&replay.getOptions()._experiments.traceInternals){return false}return core.isSentryRequestUrl(url,core.getClient())}function addNetworkBreadcrumb(replay,result){if(!replay.isEnabled()){return}if(result===null){return}if(shouldFilterRequest(replay,result.name)){return}replay.addUpdate(()=>{createPerformanceSpans(replay,[result]);return true})}function getBodySize(body){if(!body){return undefined}const textEncoder=new TextEncoder;try{if(typeof body==="string"){return textEncoder.encode(body).length}if(body instanceof URLSearchParams){return textEncoder.encode(body.toString()).length}if(body instanceof FormData){const formDataStr=_serializeFormData(body);return textEncoder.encode(formDataStr).length}if(body instanceof Blob){return body.size}if(body instanceof ArrayBuffer){return body.byteLength}}catch(e){}return undefined}function parseContentLengthHeader(header){if(!header){return undefined}const size=parseInt(header,10);return isNaN(size)?undefined:size}function getBodyString(body){try{if(typeof body==="string"){return[body]}if(body instanceof URLSearchParams){return[body.toString()]}if(body instanceof FormData){return[_serializeFormData(body)]}if(!body){return[undefined]}}catch(error){DEBUG_BUILD&&logger.exception(error,"Failed to serialize body",body);return[undefined,"BODY_PARSE_ERROR"]}DEBUG_BUILD&&logger.info("Skipping network body because of body type",body);return[undefined,"UNPARSEABLE_BODY_TYPE"]}function mergeWarning(info,warning){if(!info){return{headers:{},size:undefined,_meta:{warnings:[warning]}}}const newMeta={...info._meta};const existingWarnings=newMeta.warnings||[];newMeta.warnings=[...existingWarnings,warning];info._meta=newMeta;return info}function makeNetworkReplayBreadcrumb(type,data){if(!data){return null}const{startTimestamp,endTimestamp,url,method,statusCode,request,response}=data;const result={type:type,start:startTimestamp/1e3,end:endTimestamp/1e3,name:url,data:core.dropUndefinedKeys({method:method,statusCode:statusCode,request:request,response:response})};return result}function buildSkippedNetworkRequestOrResponse(bodySize){return{headers:{},size:bodySize,_meta:{warnings:["URL_SKIPPED"]}}}function buildNetworkRequestOrResponse(headers,bodySize,body){if(!bodySize&&Object.keys(headers).length===0){return undefined}if(!bodySize){return{headers:headers}}if(!body){return{headers:headers,size:bodySize}}const info={headers:headers,size:bodySize};const{body:normalizedBody,warnings}=normalizeNetworkBody(body);info.body=normalizedBody;if(warnings&&warnings.length>0){info._meta={warnings:warnings}}return info}function getAllowedHeaders(headers,allowedHeaders){return Object.entries(headers).reduce((filteredHeaders,[key,value])=>{const normalizedKey=key.toLowerCase();if(allowedHeaders.includes(normalizedKey)&&headers[key]){filteredHeaders[normalizedKey]=value}return filteredHeaders},{})}function _serializeFormData(formData){return new URLSearchParams(formData).toString()}function normalizeNetworkBody(body){if(!body||typeof body!=="string"){return{body:body}}const exceedsSizeLimit=body.length>NETWORK_BODY_MAX_SIZE;const isProbablyJson=_strIsProbablyJson(body);if(exceedsSizeLimit){const truncatedBody=body.slice(0,NETWORK_BODY_MAX_SIZE);if(isProbablyJson){return{body:truncatedBody,warnings:["MAYBE_JSON_TRUNCATED"]}}return{body:`${truncatedBody}…`,warnings:["TEXT_TRUNCATED"]}}if(isProbablyJson){try{const jsonBody=JSON.parse(body);return{body:jsonBody}}catch(e2){}}return{body:body}}function _strIsProbablyJson(str){const first=str[0];const last=str[str.length-1];return first==="["&&last==="]"||first==="{"&&last==="}"}function urlMatches(url,urls){const fullUrl=getFullUrl(url);return core.stringMatchesSomePattern(fullUrl,urls)}function getFullUrl(url,baseURI=WINDOW.document.baseURI){if(url.startsWith("http://")||url.startsWith("https://")||url.startsWith(WINDOW.location.origin)){return url}const fixedUrl=new URL(url,baseURI);if(fixedUrl.origin!==new URL(baseURI).origin){return url}const fullUrl=fixedUrl.href;if(!url.endsWith("/")&&fullUrl.endsWith("/")){return fullUrl.slice(0,-1)}return fullUrl}async function captureFetchBreadcrumbToReplay(breadcrumb,hint,options){try{const data=await _prepareFetchData(breadcrumb,hint,options);const result=makeNetworkReplayBreadcrumb("resource.fetch",data);addNetworkBreadcrumb(options.replay,result)}catch(error){DEBUG_BUILD&&logger.exception(error,"Failed to capture fetch breadcrumb")}}function enrichFetchBreadcrumb(breadcrumb,hint){const{input,response}=hint;const body=input?_getFetchRequestArgBody(input):undefined;const reqSize=getBodySize(body);const resSize=response?parseContentLengthHeader(response.headers.get("content-length")):undefined;if(reqSize!==undefined){breadcrumb.data.request_body_size=reqSize}if(resSize!==undefined){breadcrumb.data.response_body_size=resSize}}async function _prepareFetchData(breadcrumb,hint,options){const now=Date.now();const{startTimestamp=now,endTimestamp=now}=hint;const{url,method,status_code:statusCode=0,request_body_size:requestBodySize,response_body_size:responseBodySize}=breadcrumb.data;const captureDetails=urlMatches(url,options.networkDetailAllowUrls)&&!urlMatches(url,options.networkDetailDenyUrls);const request=captureDetails?_getRequestInfo(options,hint.input,requestBodySize):buildSkippedNetworkRequestOrResponse(requestBodySize);const response=await _getResponseInfo(captureDetails,options,hint.response,responseBodySize);return{startTimestamp:startTimestamp,endTimestamp:endTimestamp,url:url,method:method,statusCode:statusCode,request:request,response:response}}function _getRequestInfo({networkCaptureBodies,networkRequestHeaders},input,requestBodySize){const headers=input?getRequestHeaders(input,networkRequestHeaders):{};if(!networkCaptureBodies){return buildNetworkRequestOrResponse(headers,requestBodySize,undefined)}const requestBody=_getFetchRequestArgBody(input);const[bodyStr,warning]=getBodyString(requestBody);const data=buildNetworkRequestOrResponse(headers,requestBodySize,bodyStr);if(warning){return mergeWarning(data,warning)}return data}async function _getResponseInfo(captureDetails,{networkCaptureBodies,networkResponseHeaders},response,responseBodySize){if(!captureDetails&&responseBodySize!==undefined){return buildSkippedNetworkRequestOrResponse(responseBodySize)}const headers=response?getAllHeaders(response.headers,networkResponseHeaders):{};if(!response||!networkCaptureBodies&&responseBodySize!==undefined){return buildNetworkRequestOrResponse(headers,responseBodySize,undefined)}const[bodyText,warning]=await _parseFetchResponseBody(response);const result=getResponseData(bodyText,{networkCaptureBodies:networkCaptureBodies,responseBodySize:responseBodySize,captureDetails:captureDetails,headers:headers});if(warning){return mergeWarning(result,warning)}return result}function getResponseData(bodyText,{networkCaptureBodies,responseBodySize,captureDetails,headers}){try{const size=bodyText&&bodyText.length&&responseBodySize===undefined?getBodySize(bodyText):responseBodySize;if(!captureDetails){return buildSkippedNetworkRequestOrResponse(size)}if(networkCaptureBodies){return buildNetworkRequestOrResponse(headers,size,bodyText)}return buildNetworkRequestOrResponse(headers,size,undefined)}catch(error){DEBUG_BUILD&&logger.exception(error,"Failed to serialize response body");return buildNetworkRequestOrResponse(headers,responseBodySize,undefined)}}async function _parseFetchResponseBody(response){const res=_tryCloneResponse(response);if(!res){return[undefined,"BODY_PARSE_ERROR"]}try{const text=await _tryGetResponseText(res);return[text]}catch(error){if(error instanceof Error&&error.message.indexOf("Timeout")>-1){DEBUG_BUILD&&logger.warn("Parsing text body from response timed out");return[undefined,"BODY_PARSE_TIMEOUT"]}DEBUG_BUILD&&logger.exception(error,"Failed to get text body from response");return[undefined,"BODY_PARSE_ERROR"]}}function _getFetchRequestArgBody(fetchArgs=[]){if(fetchArgs.length!==2||typeof fetchArgs[1]!=="object"){return undefined}return fetchArgs[1].body}function getAllHeaders(headers,allowedHeaders){const allHeaders={};allowedHeaders.forEach(header=>{if(headers.get(header)){allHeaders[header]=headers.get(header)}});return allHeaders}function getRequestHeaders(fetchArgs,allowedHeaders){if(fetchArgs.length===1&&typeof fetchArgs[0]!=="string"){return getHeadersFromOptions(fetchArgs[0],allowedHeaders)}if(fetchArgs.length===2){return getHeadersFromOptions(fetchArgs[1],allowedHeaders)}return{}}function getHeadersFromOptions(input,allowedHeaders){if(!input){return{}}const headers=input.headers;if(!headers){return{}}if(headers instanceof Headers){return getAllHeaders(headers,allowedHeaders)}if(Array.isArray(headers)){return{}}return getAllowedHeaders(headers,allowedHeaders)}function _tryCloneResponse(response){try{return response.clone()}catch(error){DEBUG_BUILD&&logger.exception(error,"Failed to clone response body")}}function _tryGetResponseText(response){return new Promise((resolve,reject)=>{const timeout=browserUtils.setTimeout(()=>reject(new Error("Timeout while trying to read response body")),500);_getResponseText(response).then(txt=>resolve(txt),reason=>reject(reason)).finally(()=>clearTimeout(timeout))})}async function _getResponseText(response){return await response.text()}async function captureXhrBreadcrumbToReplay(breadcrumb,hint,options){try{const data=_prepareXhrData(breadcrumb,hint,options);const result=makeNetworkReplayBreadcrumb("resource.xhr",data);addNetworkBreadcrumb(options.replay,result)}catch(error){DEBUG_BUILD&&logger.exception(error,"Failed to capture xhr breadcrumb")}}function enrichXhrBreadcrumb(breadcrumb,hint){const{xhr,input}=hint;if(!xhr){return}const reqSize=getBodySize(input);const resSize=xhr.getResponseHeader("content-length")?parseContentLengthHeader(xhr.getResponseHeader("content-length")):_getBodySize(xhr.response,xhr.responseType);if(reqSize!==undefined){breadcrumb.data.request_body_size=reqSize}if(resSize!==undefined){breadcrumb.data.response_body_size=resSize}}function _prepareXhrData(breadcrumb,hint,options){const now=Date.now();const{startTimestamp=now,endTimestamp=now,input,xhr}=hint;const{url,method,status_code:statusCode=0,request_body_size:requestBodySize,response_body_size:responseBodySize}=breadcrumb.data;if(!url){return null}if(!xhr||!urlMatches(url,options.networkDetailAllowUrls)||urlMatches(url,options.networkDetailDenyUrls)){const request=buildSkippedNetworkRequestOrResponse(requestBodySize);const response=buildSkippedNetworkRequestOrResponse(responseBodySize);return{startTimestamp:startTimestamp,endTimestamp:endTimestamp,url:url,method:method,statusCode:statusCode,request:request,response:response}}const xhrInfo=xhr[browserUtils.SENTRY_XHR_DATA_KEY];const networkRequestHeaders=xhrInfo?getAllowedHeaders(xhrInfo.request_headers,options.networkRequestHeaders):{};const networkResponseHeaders=getAllowedHeaders(getResponseHeaders(xhr),options.networkResponseHeaders);const[requestBody,requestWarning]=options.networkCaptureBodies?getBodyString(input):[undefined];const[responseBody,responseWarning]=options.networkCaptureBodies?_getXhrResponseBody(xhr):[undefined];const request=buildNetworkRequestOrResponse(networkRequestHeaders,requestBodySize,requestBody);const response=buildNetworkRequestOrResponse(networkResponseHeaders,responseBodySize,responseBody);return{startTimestamp:startTimestamp,endTimestamp:endTimestamp,url:url,method:method,statusCode:statusCode,request:requestWarning?mergeWarning(request,requestWarning):request,response:responseWarning?mergeWarning(response,responseWarning):response}}function getResponseHeaders(xhr){const headers=xhr.getAllResponseHeaders();if(!headers){return{}}return headers.split("\r\n").reduce((acc,line)=>{const[key,value]=line.split(": ");if(value){acc[key.toLowerCase()]=value}return acc},{})}function _getXhrResponseBody(xhr){const errors=[];try{return[xhr.responseText]}catch(e){errors.push(e)}try{return _parseXhrResponse(xhr.response,xhr.responseType)}catch(e){errors.push(e)}DEBUG_BUILD&&logger.warn("Failed to get xhr response body",...errors);return[undefined]}function _parseXhrResponse(body,responseType){try{if(typeof body==="string"){return[body]}if(body instanceof Document){return[body.body.outerHTML]}if(responseType==="json"&&body&&typeof body==="object"){return[JSON.stringify(body)]}if(!body){return[undefined]}}catch(error){DEBUG_BUILD&&logger.exception(error,"Failed to serialize body",body);return[undefined,"BODY_PARSE_ERROR"]}DEBUG_BUILD&&logger.info("Skipping network body because of body type",body);return[undefined,"UNPARSEABLE_BODY_TYPE"]}function _getBodySize(body,responseType){try{const bodyStr=responseType==="json"&&body&&typeof body==="object"?JSON.stringify(body):body;return getBodySize(bodyStr)}catch(e2){return undefined}}function handleNetworkBreadcrumbs(replay){const client=core.getClient();try{const{networkDetailAllowUrls,networkDetailDenyUrls,networkCaptureBodies,networkRequestHeaders,networkResponseHeaders}=replay.getOptions();const options={replay:replay,networkDetailAllowUrls:networkDetailAllowUrls,networkDetailDenyUrls:networkDetailDenyUrls,networkCaptureBodies:networkCaptureBodies,networkRequestHeaders:networkRequestHeaders,networkResponseHeaders:networkResponseHeaders};if(client){client.on("beforeAddBreadcrumb",(breadcrumb,hint)=>beforeAddNetworkBreadcrumb(options,breadcrumb,hint))}}catch(e2){}}function beforeAddNetworkBreadcrumb(options,breadcrumb,hint){if(!breadcrumb.data){return}try{if(_isXhrBreadcrumb(breadcrumb)&&_isXhrHint(hint)){enrichXhrBreadcrumb(breadcrumb,hint);captureXhrBreadcrumbToReplay(breadcrumb,hint,options)}if(_isFetchBreadcrumb(breadcrumb)&&_isFetchHint(hint)){enrichFetchBreadcrumb(breadcrumb,hint);captureFetchBreadcrumbToReplay(breadcrumb,hint,options)}}catch(e){DEBUG_BUILD&&logger.exception(e,"Error when enriching network breadcrumb")}}function _isXhrBreadcrumb(breadcrumb){return breadcrumb.category==="xhr"}function _isFetchBreadcrumb(breadcrumb){return breadcrumb.category==="fetch"}function _isXhrHint(hint){return hint&&hint.xhr}function _isFetchHint(hint){return hint&&hint.response}function addGlobalListeners(replay){const client=core.getClient();browserUtils.addClickKeypressInstrumentationHandler(handleDomListener(replay));browserUtils.addHistoryInstrumentationHandler(handleHistorySpanListener(replay));handleBreadcrumbs(replay);handleNetworkBreadcrumbs(replay);const eventProcessor=handleGlobalEventListener(replay);core.addEventProcessor(eventProcessor);if(client){client.on("beforeSendEvent",handleBeforeSendEvent(replay));client.on("afterSendEvent",handleAfterSendEvent(replay));client.on("createDsc",dsc=>{const replayId=replay.getSessionId();if(replayId&&replay.isEnabled()&&replay.recordingMode==="session"){const isSessionActive=replay.checkAndHandleExpiredSession();if(isSessionActive){dsc.replay_id=replayId}}});client.on("spanStart",span=>{replay.lastActiveSpan=span});client.on("spanEnd",span=>{replay.lastActiveSpan=span});client.on("beforeSendFeedback",(feedbackEvent,options)=>{const replayId=replay.getSessionId();if(options&&options.includeReplay&&replay.isEnabled()&&replayId){if(feedbackEvent.contexts&&feedbackEvent.contexts.feedback){feedbackEvent.contexts.feedback.replay_id=replayId}}})}}async function addMemoryEntry(replay){try{return Promise.all(createPerformanceSpans(replay,[createMemoryEntry(WINDOW.performance.memory)]))}catch(error){return[]}}function createMemoryEntry(memoryEntry){const{jsHeapSizeLimit,totalJSHeapSize,usedJSHeapSize}=memoryEntry;const time=Date.now()/1e3;return{type:"memory",name:"memory",start:time,end:time,data:{memory:{jsHeapSizeLimit:jsHeapSizeLimit,totalJSHeapSize:totalJSHeapSize,usedJSHeapSize:usedJSHeapSize}}}}function debounce(func,wait,options){let callbackReturnValue;let timerId;let maxTimerId;const maxWait=options&&options.maxWait?Math.max(options.maxWait,wait):0;function invokeFunc(){cancelTimers();callbackReturnValue=func();return callbackReturnValue}function cancelTimers(){timerId!==undefined&&clearTimeout(timerId);maxTimerId!==undefined&&clearTimeout(maxTimerId);timerId=maxTimerId=undefined}function flush(){if(timerId!==undefined||maxTimerId!==undefined){return invokeFunc()}return callbackReturnValue}function debounced(){if(timerId){clearTimeout(timerId)}timerId=browserUtils.setTimeout(invokeFunc,wait);if(maxWait&&maxTimerId===undefined){maxTimerId=browserUtils.setTimeout(invokeFunc,maxWait)}return callbackReturnValue}debounced.cancel=cancelTimers;debounced.flush=flush;return debounced}function getHandleRecordingEmit(replay){let hadFirstEvent=false;return(event,_isCheckout)=>{if(!replay.checkAndHandleExpiredSession()){DEBUG_BUILD&&logger.warn("Received replay event after session expired.");return}const isCheckout=_isCheckout||!hadFirstEvent;hadFirstEvent=true;if(replay.clickDetector){updateClickDetectorForRecordingEvent(replay.clickDetector,event)}replay.addUpdate(()=>{if(replay.recordingMode==="buffer"&&isCheckout){replay.setInitialState()}if(!addEventSync(replay,event,isCheckout)){return true}if(!isCheckout){return false}const session=replay.session;addSettingsEvent(replay,isCheckout);if(replay.recordingMode==="buffer"&&session&&replay.eventBuffer){const earliestEvent=replay.eventBuffer.getEarliestTimestamp();if(earliestEvent){DEBUG_BUILD&&logger.info(`Updating session start time to earliest event in buffer to ${new Date(earliestEvent)}`);session.started=earliestEvent;if(replay.getOptions().stickySession){saveSession(session)}}}if(session&&session.previousSessionId){return true}if(replay.recordingMode==="session"){void replay.flush()}return true})}}function createOptionsEvent(replay){const options=replay.getOptions();return{type:EventType.Custom,timestamp:Date.now(),data:{tag:"options",payload:{shouldRecordCanvas:replay.isRecordingCanvas(),sessionSampleRate:options.sessionSampleRate,errorSampleRate:options.errorSampleRate,useCompressionOption:options.useCompression,blockAllMedia:options.blockAllMedia,maskAllText:options.maskAllText,maskAllInputs:options.maskAllInputs,useCompression:replay.eventBuffer?replay.eventBuffer.type==="worker":false,networkDetailHasUrls:options.networkDetailAllowUrls.length>0,networkCaptureBodies:options.networkCaptureBodies,networkRequestHasHeaders:options.networkRequestHeaders.length>0,networkResponseHasHeaders:options.networkResponseHeaders.length>0}}}}function addSettingsEvent(replay,isCheckout){if(!isCheckout||!replay.session||replay.session.segmentId!==0){return}addEventSync(replay,createOptionsEvent(replay),false)}function createReplayEnvelope(replayEvent,recordingData,dsn,tunnel){return core.createEnvelope(core.createEventEnvelopeHeaders(replayEvent,core.getSdkMetadataForEnvelopeHeader(replayEvent),tunnel,dsn),[[{type:"replay_event"},replayEvent],[{type:"replay_recording",length:typeof recordingData==="string"?(new TextEncoder).encode(recordingData).length:recordingData.length},recordingData]])}function prepareRecordingData({recordingData,headers}){let payloadWithSequence;const replayHeaders=`${JSON.stringify(headers)}
`;if(typeof recordingData==="string"){payloadWithSequence=`${replayHeaders}${recordingData}`}else{const enc=new TextEncoder;const sequence=enc.encode(replayHeaders);payloadWithSequence=new Uint8Array(sequence.length+recordingData.length);payloadWithSequence.set(sequence);payloadWithSequence.set(recordingData,sequence.length)}return payloadWithSequence}async function prepareReplayEvent({client,scope,replayId:event_id,event}){const integrations=typeof client._integrations==="object"&&client._integrations!==null&&!Array.isArray(client._integrations)?Object.keys(client._integrations):undefined;const eventHint={event_id:event_id,integrations:integrations};client.emit("preprocessEvent",event,eventHint);const preparedEvent=await core.prepareEvent(client.getOptions(),event,eventHint,scope,client,core.getIsolationScope());if(!preparedEvent){return null}preparedEvent.platform=preparedEvent.platform||"javascript";const metadata=client.getSdkMetadata();const{name,version}=metadata&&metadata.sdk||{};preparedEvent.sdk={...preparedEvent.sdk,name:name||"sentry.javascript.unknown",version:version||"0.0.0"};return preparedEvent}async function sendReplayRequest({recordingData,replayId,segmentId:segment_id,eventContext,timestamp,session}){const preparedRecordingData=prepareRecordingData({recordingData:recordingData,headers:{segment_id:segment_id}});const{urls,errorIds,traceIds,initialTimestamp}=eventContext;const client=core.getClient();const scope=core.getCurrentScope();const transport=client&&client.getTransport();const dsn=client&&client.getDsn();if(!client||!transport||!dsn||!session.sampled){return core.resolvedSyncPromise({})}const baseEvent={type:REPLAY_EVENT_NAME,replay_start_timestamp:initialTimestamp/1e3,timestamp:timestamp/1e3,error_ids:errorIds,trace_ids:traceIds,urls:urls,replay_id:replayId,segment_id:segment_id,replay_type:session.sampled};const replayEvent=await prepareReplayEvent({scope:scope,client:client,replayId:replayId,event:baseEvent});if(!replayEvent){client.recordDroppedEvent("event_processor","replay",baseEvent);DEBUG_BUILD&&logger.info("An event processor returned `null`, will not send event.");return core.resolvedSyncPromise({})}delete replayEvent.sdkProcessingMetadata;const envelope=createReplayEnvelope(replayEvent,preparedRecordingData,dsn,client.getOptions().tunnel);let response;try{response=await transport.send(envelope)}catch(err){const error=new Error(UNABLE_TO_SEND_REPLAY);try{error.cause=err}catch(e){}throw error}if(typeof response.statusCode==="number"&&(response.statusCode<200||response.statusCode>=300)){throw new TransportStatusCodeError(response.statusCode)}const rateLimits=core.updateRateLimits({},response);if(core.isRateLimited(rateLimits,"replay")){throw new RateLimitError(rateLimits)}return response}class TransportStatusCodeError extends Error{constructor(statusCode){super(`Transport returned status code ${statusCode}`)}}class RateLimitError extends Error{constructor(rateLimits){super("Rate limit hit");this.rateLimits=rateLimits}}async function sendReplay(replayData,retryConfig={count:0,interval:RETRY_BASE_INTERVAL}){const{recordingData,onError}=replayData;if(!recordingData.length){return}try{await sendReplayRequest(replayData);return true}catch(err){if(err instanceof TransportStatusCodeError||err instanceof RateLimitError){throw err}core.setContext("Replays",{_retryCount:retryConfig.count});if(onError){onError(err)}if(retryConfig.count>=RETRY_MAX_COUNT){const error=new Error(`${UNABLE_TO_SEND_REPLAY} - max retries exceeded`);try{error.cause=err}catch(e){}throw error}retryConfig.interval*=++retryConfig.count;return new Promise((resolve,reject)=>{browserUtils.setTimeout(async()=>{try{await sendReplay(replayData,retryConfig);resolve(true)}catch(err){reject(err)}},retryConfig.interval)})}}const THROTTLED="__THROTTLED";const SKIPPED="__SKIPPED";function throttle(fn,maxCount,durationSeconds){const counter=new Map;const _cleanup=now=>{const threshold=now-durationSeconds;counter.forEach((_value,key)=>{if(key<threshold){counter.delete(key)}})};const _getTotalCount=()=>{return[...counter.values()].reduce((a,b)=>a+b,0)};let isThrottled=false;return(...rest)=>{const now=Math.floor(Date.now()/1e3);_cleanup(now);if(_getTotalCount()>=maxCount){const wasThrottled=isThrottled;isThrottled=true;return wasThrottled?SKIPPED:THROTTLED}isThrottled=false;const count=counter.get(now)||0;counter.set(now,count+1);return fn(...rest)}}class ReplayContainer{constructor({options,recordingOptions}){ReplayContainer.prototype.__init.call(this);ReplayContainer.prototype.__init2.call(this);ReplayContainer.prototype.__init3.call(this);ReplayContainer.prototype.__init4.call(this);ReplayContainer.prototype.__init5.call(this);ReplayContainer.prototype.__init6.call(this);this.eventBuffer=null;this.performanceEntries=[];this.replayPerformanceEntries=[];this.recordingMode="session";this.timeouts={sessionIdlePause:SESSION_IDLE_PAUSE_DURATION,sessionIdleExpire:SESSION_IDLE_EXPIRE_DURATION};this._lastActivity=Date.now();this._isEnabled=false;this._isPaused=false;this._requiresManualStart=false;this._hasInitializedCoreListeners=false;this._context={errorIds:new Set,traceIds:new Set,urls:[],initialTimestamp:Date.now(),initialUrl:""};this._recordingOptions=recordingOptions;this._options=options;this._debouncedFlush=debounce(()=>this._flush(),this._options.flushMinDelay,{maxWait:this._options.flushMaxDelay});this._throttledAddEvent=throttle((event,isCheckout)=>addEvent(this,event,isCheckout),300,5);const{slowClickTimeout,slowClickIgnoreSelectors}=this.getOptions();const slowClickConfig=slowClickTimeout?{threshold:Math.min(SLOW_CLICK_THRESHOLD,slowClickTimeout),timeout:slowClickTimeout,scrollTimeout:SLOW_CLICK_SCROLL_TIMEOUT,ignoreSelector:slowClickIgnoreSelectors?slowClickIgnoreSelectors.join(","):""}:undefined;if(slowClickConfig){this.clickDetector=new ClickDetector(this,slowClickConfig)}if(DEBUG_BUILD){const experiments=options._experiments;logger.setConfig({captureExceptions:!!experiments.captureExceptions,traceInternals:!!experiments.traceInternals})}}getContext(){return this._context}isEnabled(){return this._isEnabled}isPaused(){return this._isPaused}isRecordingCanvas(){return Boolean(this._canvas)}getOptions(){return this._options}handleException(error){DEBUG_BUILD&&logger.exception(error);if(this._options.onError){this._options.onError(error)}}initializeSampling(previousSessionId){const{errorSampleRate,sessionSampleRate}=this._options;const requiresManualStart=errorSampleRate<=0&&sessionSampleRate<=0;this._requiresManualStart=requiresManualStart;if(requiresManualStart){return}this._initializeSessionForSampling(previousSessionId);if(!this.session){DEBUG_BUILD&&logger.exception(new Error("Unable to initialize and create session"));return}if(this.session.sampled===false){return}this.recordingMode=this.session.sampled==="buffer"&&this.session.segmentId===0?"buffer":"session";DEBUG_BUILD&&logger.infoTick(`Starting replay in ${this.recordingMode} mode`);this._initializeRecording()}start(){if(this._isEnabled&&this.recordingMode==="session"){DEBUG_BUILD&&logger.info("Recording is already in progress");return}if(this._isEnabled&&this.recordingMode==="buffer"){DEBUG_BUILD&&logger.info("Buffering is in progress, call `flush()` to save the replay");return}DEBUG_BUILD&&logger.infoTick("Starting replay in session mode");this._updateUserActivity();const session=loadOrCreateSession({maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire},{stickySession:this._options.stickySession,sessionSampleRate:1,allowBuffering:false});this.session=session;this._initializeRecording()}startBuffering(){if(this._isEnabled){DEBUG_BUILD&&logger.info("Buffering is in progress, call `flush()` to save the replay");return}DEBUG_BUILD&&logger.infoTick("Starting replay in buffer mode");const session=loadOrCreateSession({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration},{stickySession:this._options.stickySession,sessionSampleRate:0,allowBuffering:true});this.session=session;this.recordingMode="buffer";this._initializeRecording()}startRecording(){try{const canvasOptions=this._canvas;this._stopRecording=record({...this._recordingOptions,...this.recordingMode==="buffer"?{checkoutEveryNms:BUFFER_CHECKOUT_TIME}:this._options._experiments.continuousCheckout&&{checkoutEveryNms:Math.max(36e4,this._options._experiments.continuousCheckout)},emit:getHandleRecordingEmit(this),onMutation:this._onMutationHandler,...canvasOptions?{recordCanvas:canvasOptions.recordCanvas,getCanvasManager:canvasOptions.getCanvasManager,sampling:canvasOptions.sampling,dataURLOptions:canvasOptions.dataURLOptions}:{}})}catch(err){this.handleException(err)}}stopRecording(){try{if(this._stopRecording){this._stopRecording();this._stopRecording=undefined}return true}catch(err){this.handleException(err);return false}}async stop({forceFlush=false,reason}={}){if(!this._isEnabled){return}this._isEnabled=false;try{DEBUG_BUILD&&logger.info(`Stopping Replay${reason?` triggered by ${reason}`:""}`);resetReplayIdOnDynamicSamplingContext();this._removeListeners();this.stopRecording();this._debouncedFlush.cancel();if(forceFlush){await this._flush({force:true})}this.eventBuffer&&this.eventBuffer.destroy();this.eventBuffer=null;clearSession(this)}catch(err){this.handleException(err)}}pause(){if(this._isPaused){return}this._isPaused=true;this.stopRecording();DEBUG_BUILD&&logger.info("Pausing replay")}resume(){if(!this._isPaused||!this._checkSession()){return}this._isPaused=false;this.startRecording();DEBUG_BUILD&&logger.info("Resuming replay")}async sendBufferedReplayOrFlush({continueRecording=true}={}){if(this.recordingMode==="session"){return this.flushImmediate()}const activityTime=Date.now();DEBUG_BUILD&&logger.info("Converting buffer to session");await this.flushImmediate();const hasStoppedRecording=this.stopRecording();if(!continueRecording||!hasStoppedRecording){return}if(this.recordingMode==="session"){return}this.recordingMode="session";if(this.session){this._updateUserActivity(activityTime);this._updateSessionActivity(activityTime);this._maybeSaveSession()}this.startRecording()}addUpdate(cb){const cbResult=cb();if(this.recordingMode==="buffer"){return}if(cbResult===true){return}this._debouncedFlush()}triggerUserActivity(){this._updateUserActivity();if(!this._stopRecording){if(!this._checkSession()){return}this.resume();return}this.checkAndHandleExpiredSession();this._updateSessionActivity()}updateUserActivity(){this._updateUserActivity();this._updateSessionActivity()}conditionalFlush(){if(this.recordingMode==="buffer"){return Promise.resolve()}return this.flushImmediate()}flush(){return this._debouncedFlush()}flushImmediate(){this._debouncedFlush();return this._debouncedFlush.flush()}cancelFlush(){this._debouncedFlush.cancel()}getSessionId(){return this.session&&this.session.id}checkAndHandleExpiredSession(){if(this._lastActivity&&isExpired(this._lastActivity,this.timeouts.sessionIdlePause)&&this.session&&this.session.sampled==="session"){this.pause();return}if(!this._checkSession()){return false}return true}setInitialState(){const urlPath=`${WINDOW.location.pathname}${WINDOW.location.hash}${WINDOW.location.search}`;const url=`${WINDOW.location.origin}${urlPath}`;this.performanceEntries=[];this.replayPerformanceEntries=[];this._clearContext();this._context.initialUrl=url;this._context.initialTimestamp=Date.now();this._context.urls.push(url)}throttledAddEvent(event,isCheckout){const res=this._throttledAddEvent(event,isCheckout);if(res===THROTTLED){const breadcrumb=createBreadcrumb({category:"replay.throttled"});this.addUpdate(()=>{return!addEventSync(this,{type:ReplayEventTypeCustom,timestamp:breadcrumb.timestamp||0,data:{tag:"breadcrumb",payload:breadcrumb,metric:true}})})}return res}getCurrentRoute(){const lastActiveSpan=this.lastActiveSpan||core.getActiveSpan();const lastRootSpan=lastActiveSpan&&core.getRootSpan(lastActiveSpan);const attributes=lastRootSpan&&core.spanToJSON(lastRootSpan).data||{};const source=attributes[core.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE];if(!lastRootSpan||!source||!["route","custom"].includes(source)){return undefined}return core.spanToJSON(lastRootSpan).description}_initializeRecording(){this.setInitialState();this._updateSessionActivity();this.eventBuffer=createEventBuffer({useCompression:this._options.useCompression,workerUrl:this._options.workerUrl});this._removeListeners();this._addListeners();this._isEnabled=true;this._isPaused=false;this.startRecording()}_initializeSessionForSampling(previousSessionId){const allowBuffering=this._options.errorSampleRate>0;const session=loadOrCreateSession({sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration,previousSessionId:previousSessionId},{stickySession:this._options.stickySession,sessionSampleRate:this._options.sessionSampleRate,allowBuffering:allowBuffering});this.session=session}_checkSession(){if(!this.session){return false}const currentSession=this.session;if(shouldRefreshSession(currentSession,{sessionIdleExpire:this.timeouts.sessionIdleExpire,maxReplayDuration:this._options.maxReplayDuration})){this._refreshSession(currentSession);return false}return true}async _refreshSession(session){if(!this._isEnabled){return}await this.stop({reason:"refresh session"});this.initializeSampling(session.id)}_addListeners(){try{WINDOW.document.addEventListener("visibilitychange",this._handleVisibilityChange);WINDOW.addEventListener("blur",this._handleWindowBlur);WINDOW.addEventListener("focus",this._handleWindowFocus);WINDOW.addEventListener("keydown",this._handleKeyboardEvent);if(this.clickDetector){this.clickDetector.addListeners()}if(!this._hasInitializedCoreListeners){addGlobalListeners(this);this._hasInitializedCoreListeners=true}}catch(err){this.handleException(err)}this._performanceCleanupCallback=setupPerformanceObserver(this)}_removeListeners(){try{WINDOW.document.removeEventListener("visibilitychange",this._handleVisibilityChange);WINDOW.removeEventListener("blur",this._handleWindowBlur);WINDOW.removeEventListener("focus",this._handleWindowFocus);WINDOW.removeEventListener("keydown",this._handleKeyboardEvent);if(this.clickDetector){this.clickDetector.removeListeners()}if(this._performanceCleanupCallback){this._performanceCleanupCallback()}}catch(err){this.handleException(err)}}__init(){this._handleVisibilityChange=()=>{if(WINDOW.document.visibilityState==="visible"){this._doChangeToForegroundTasks()}else{this._doChangeToBackgroundTasks()}}}__init2(){this._handleWindowBlur=()=>{const breadcrumb=createBreadcrumb({category:"ui.blur"});this._doChangeToBackgroundTasks(breadcrumb)}}__init3(){this._handleWindowFocus=()=>{const breadcrumb=createBreadcrumb({category:"ui.focus"});this._doChangeToForegroundTasks(breadcrumb)}}__init4(){this._handleKeyboardEvent=event=>{handleKeyboardEvent(this,event)}}_doChangeToBackgroundTasks(breadcrumb){if(!this.session){return}const expired=isSessionExpired(this.session,{maxReplayDuration:this._options.maxReplayDuration,sessionIdleExpire:this.timeouts.sessionIdleExpire});if(expired){return}if(breadcrumb){this._createCustomBreadcrumb(breadcrumb)}void this.conditionalFlush()}_doChangeToForegroundTasks(breadcrumb){if(!this.session){return}const isSessionActive=this.checkAndHandleExpiredSession();if(!isSessionActive){DEBUG_BUILD&&logger.info("Document has become active, but session has expired");return}if(breadcrumb){this._createCustomBreadcrumb(breadcrumb)}}_updateUserActivity(_lastActivity=Date.now()){this._lastActivity=_lastActivity}_updateSessionActivity(_lastActivity=Date.now()){if(this.session){this.session.lastActivity=_lastActivity;this._maybeSaveSession()}}_createCustomBreadcrumb(breadcrumb){this.addUpdate(()=>{this.throttledAddEvent({type:EventType.Custom,timestamp:breadcrumb.timestamp||0,data:{tag:"breadcrumb",payload:breadcrumb}})})}_addPerformanceEntries(){let performanceEntries=createPerformanceEntries(this.performanceEntries).concat(this.replayPerformanceEntries);this.performanceEntries=[];this.replayPerformanceEntries=[];if(this._requiresManualStart){const initialTimestampInSeconds=this._context.initialTimestamp/1e3;performanceEntries=performanceEntries.filter(entry=>entry.start>=initialTimestampInSeconds)}return Promise.all(createPerformanceSpans(this,performanceEntries))}_clearContext(){this._context.errorIds.clear();this._context.traceIds.clear();this._context.urls=[]}_updateInitialTimestampFromEventBuffer(){const{session,eventBuffer}=this;if(!session||!eventBuffer||this._requiresManualStart){return}if(session.segmentId){return}const earliestEvent=eventBuffer.getEarliestTimestamp();if(earliestEvent&&earliestEvent<this._context.initialTimestamp){this._context.initialTimestamp=earliestEvent}}_popEventContext(){const _context={initialTimestamp:this._context.initialTimestamp,initialUrl:this._context.initialUrl,errorIds:Array.from(this._context.errorIds),traceIds:Array.from(this._context.traceIds),urls:this._context.urls};this._clearContext();return _context}async _runFlush(){const replayId=this.getSessionId();if(!this.session||!this.eventBuffer||!replayId){DEBUG_BUILD&&logger.error("No session or eventBuffer found to flush.");return}await this._addPerformanceEntries();if(!this.eventBuffer||!this.eventBuffer.hasEvents){return}await addMemoryEntry(this);if(!this.eventBuffer){return}if(replayId!==this.getSessionId()){return}try{this._updateInitialTimestampFromEventBuffer();const timestamp=Date.now();if(timestamp-this._context.initialTimestamp>this._options.maxReplayDuration+3e4){throw new Error("Session is too long, not sending replay")}const eventContext=this._popEventContext();const segmentId=this.session.segmentId++;this._maybeSaveSession();const recordingData=await this.eventBuffer.finish();await sendReplay({replayId:replayId,recordingData:recordingData,segmentId:segmentId,eventContext:eventContext,session:this.session,timestamp:timestamp,onError:err=>this.handleException(err)})}catch(err){this.handleException(err);this.stop({reason:"sendReplay"});const client=core.getClient();if(client){const dropReason=err instanceof RateLimitError?"ratelimit_backoff":"send_error";client.recordDroppedEvent(dropReason,"replay")}}}__init5(){this._flush=async({force=false}={})=>{if(!this._isEnabled&&!force){return}if(!this.checkAndHandleExpiredSession()){DEBUG_BUILD&&logger.error("Attempting to finish replay event after session expired.");return}if(!this.session){return}const start=this.session.started;const now=Date.now();const duration=now-start;this._debouncedFlush.cancel();const tooShort=duration<this._options.minReplayDuration;const tooLong=duration>this._options.maxReplayDuration+5e3;if(tooShort||tooLong){DEBUG_BUILD&&logger.info(`Session duration (${Math.floor(duration/1e3)}s) is too ${tooShort?"short":"long"}, not sending replay.`);if(tooShort){this._debouncedFlush()}return}const eventBuffer=this.eventBuffer;if(eventBuffer&&this.session.segmentId===0&&!eventBuffer.hasCheckout){DEBUG_BUILD&&logger.info("Flushing initial segment without checkout.")}const _flushInProgress=!!this._flushLock;if(!this._flushLock){this._flushLock=this._runFlush()}try{await this._flushLock}catch(err){this.handleException(err)}finally{this._flushLock=undefined;if(_flushInProgress){this._debouncedFlush()}}}}_maybeSaveSession(){if(this.session&&this._options.stickySession){saveSession(this.session)}}__init6(){this._onMutationHandler=mutations=>{const count=mutations.length;const mutationLimit=this._options.mutationLimit;const mutationBreadcrumbLimit=this._options.mutationBreadcrumbLimit;const overMutationLimit=mutationLimit&&count>mutationLimit;if(count>mutationBreadcrumbLimit||overMutationLimit){const breadcrumb=createBreadcrumb({category:"replay.mutations",data:{count:count,limit:overMutationLimit}});this._createCustomBreadcrumb(breadcrumb)}if(overMutationLimit){this.stop({reason:"mutationLimit",forceFlush:this.recordingMode==="session"});return false}return true}}}function getOption(selectors,defaultSelectors){return[...selectors,...defaultSelectors].join(",")}function getPrivacyOptions({mask,unmask,block,unblock,ignore}){const defaultBlockedElements=["base","iframe[srcdoc]:not([src])"];const maskSelector=getOption(mask,[".sentry-mask","[data-sentry-mask]"]);const unmaskSelector=getOption(unmask,[]);const options={maskTextSelector:maskSelector,unmaskTextSelector:unmaskSelector,blockSelector:getOption(block,[".sentry-block","[data-sentry-block]",...defaultBlockedElements]),unblockSelector:getOption(unblock,[]),ignoreSelector:getOption(ignore,[".sentry-ignore","[data-sentry-ignore]",'input[type="file"]'])};return options}function maskAttribute({el,key,maskAttributes,maskAllText,privacyOptions,value}){if(!maskAllText){return value}if(privacyOptions.unmaskTextSelector&&el.matches(privacyOptions.unmaskTextSelector)){return value}if(maskAttributes.includes(key)||key==="value"&&el.tagName==="INPUT"&&["submit","button"].includes(el.getAttribute("type")||"")){return value.replace(/[\S]/g,"*")}return value}const MEDIA_SELECTORS='img,image,svg,video,object,picture,embed,map,audio,link[rel="icon"],link[rel="apple-touch-icon"]';const DEFAULT_NETWORK_HEADERS=["content-length","content-type","accept"];let _initialized=false;const replayIntegration=options=>{return new Replay(options)};class Replay{static __initStatic(){this.id="Replay"}constructor({flushMinDelay=DEFAULT_FLUSH_MIN_DELAY,flushMaxDelay=DEFAULT_FLUSH_MAX_DELAY,minReplayDuration=MIN_REPLAY_DURATION,maxReplayDuration=MAX_REPLAY_DURATION,stickySession=true,useCompression=true,workerUrl,_experiments={},maskAllText=true,maskAllInputs=true,blockAllMedia=true,mutationBreadcrumbLimit=750,mutationLimit=1e4,slowClickTimeout=7e3,slowClickIgnoreSelectors=[],networkDetailAllowUrls=[],networkDetailDenyUrls=[],networkCaptureBodies=true,networkRequestHeaders=[],networkResponseHeaders=[],mask=[],maskAttributes=["title","placeholder"],unmask=[],block=[],unblock=[],ignore=[],maskFn,beforeAddRecordingEvent,beforeErrorSampling,onError}={}){this.name=Replay.id;const privacyOptions=getPrivacyOptions({mask:mask,unmask:unmask,block:block,unblock:unblock,ignore:ignore});this._recordingOptions={maskAllInputs:maskAllInputs,maskAllText:maskAllText,maskInputOptions:{password:true},maskTextFn:maskFn,maskInputFn:maskFn,maskAttributeFn:(key,value,el)=>maskAttribute({maskAttributes:maskAttributes,maskAllText:maskAllText,privacyOptions:privacyOptions,key:key,value:value,el:el}),...privacyOptions,slimDOMOptions:"all",inlineStylesheet:true,inlineImages:false,collectFonts:true,errorHandler:err=>{try{err.__rrweb__=true}catch(error){}}};this._initialOptions={flushMinDelay:flushMinDelay,flushMaxDelay:flushMaxDelay,minReplayDuration:Math.min(minReplayDuration,MIN_REPLAY_DURATION_LIMIT),maxReplayDuration:Math.min(maxReplayDuration,MAX_REPLAY_DURATION),stickySession:stickySession,useCompression:useCompression,workerUrl:workerUrl,blockAllMedia:blockAllMedia,maskAllInputs:maskAllInputs,maskAllText:maskAllText,mutationBreadcrumbLimit:mutationBreadcrumbLimit,mutationLimit:mutationLimit,slowClickTimeout:slowClickTimeout,slowClickIgnoreSelectors:slowClickIgnoreSelectors,networkDetailAllowUrls:networkDetailAllowUrls,networkDetailDenyUrls:networkDetailDenyUrls,networkCaptureBodies:networkCaptureBodies,networkRequestHeaders:_getMergedNetworkHeaders(networkRequestHeaders),networkResponseHeaders:_getMergedNetworkHeaders(networkResponseHeaders),beforeAddRecordingEvent:beforeAddRecordingEvent,beforeErrorSampling:beforeErrorSampling,onError:onError,_experiments:_experiments};if(this._initialOptions.blockAllMedia){this._recordingOptions.blockSelector=!this._recordingOptions.blockSelector?MEDIA_SELECTORS:`${this._recordingOptions.blockSelector},${MEDIA_SELECTORS}`}if(this._isInitialized&&core.isBrowser()){throw new Error("Multiple Sentry Session Replay instances are not supported")}this._isInitialized=true}get _isInitialized(){return _initialized}set _isInitialized(value){_initialized=value}afterAllSetup(client){if(!core.isBrowser()||this._replay){return}this._setup(client);this._initialize(client)}start(){if(!this._replay){return}this._replay.start()}startBuffering(){if(!this._replay){return}this._replay.startBuffering()}stop(){if(!this._replay){return Promise.resolve()}return this._replay.stop({forceFlush:this._replay.recordingMode==="session"})}flush(options){if(!this._replay){return Promise.resolve()}if(!this._replay.isEnabled()){this._replay.start();return Promise.resolve()}return this._replay.sendBufferedReplayOrFlush(options)}getReplayId(){if(!this._replay||!this._replay.isEnabled()){return}return this._replay.getSessionId()}getRecordingMode(){if(!this._replay||!this._replay.isEnabled()){return}return this._replay.recordingMode}_initialize(client){if(!this._replay){return}this._maybeLoadFromReplayCanvasIntegration(client);this._replay.initializeSampling()}_setup(client){const finalOptions=loadReplayOptionsFromClient(this._initialOptions,client);this._replay=new ReplayContainer({options:finalOptions,recordingOptions:this._recordingOptions})}_maybeLoadFromReplayCanvasIntegration(client){try{const canvasIntegration=client.getIntegrationByName("ReplayCanvas");if(!canvasIntegration){return}this._replay["_canvas"]=canvasIntegration.getOptions()}catch(e){}}}Replay.__initStatic();function loadReplayOptionsFromClient(initialOptions,client){const opt=client.getOptions();const finalOptions={sessionSampleRate:0,errorSampleRate:0,...core.dropUndefinedKeys(initialOptions)};const replaysSessionSampleRate=core.parseSampleRate(opt.replaysSessionSampleRate);const replaysOnErrorSampleRate=core.parseSampleRate(opt.replaysOnErrorSampleRate);if(replaysSessionSampleRate==null&&replaysOnErrorSampleRate==null){core.consoleSandbox(()=>{console.warn("Replay is disabled because neither `replaysSessionSampleRate` nor `replaysOnErrorSampleRate` are set.")})}if(replaysSessionSampleRate!=null){finalOptions.sessionSampleRate=replaysSessionSampleRate}if(replaysOnErrorSampleRate!=null){finalOptions.errorSampleRate=replaysOnErrorSampleRate}return finalOptions}function _getMergedNetworkHeaders(headers){return[...DEFAULT_NETWORK_HEADERS,...headers.map(header=>header.toLowerCase())]}function getReplay(){const client=core.getClient();return client&&client.getIntegrationByName("Replay")}exports.getReplay=getReplay;exports.replayIntegration=replayIntegration},{"@sentry-internal/browser-utils":4,"@sentry/core":87}],36:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const debugBuild=require("./debug-build.js");const eventbuilder=require("./eventbuilder.js");const helpers=require("./helpers.js");const userfeedback=require("./userfeedback.js");class BrowserClient extends core.BaseClient{constructor(options){const opts={parentSpanIsAlwaysRootSpan:true,...options};const sdkSource=helpers.WINDOW.SENTRY_SDK_SOURCE||core.getSDKSource();core.applySdkMetadata(opts,"browser",["browser"],sdkSource);super(opts);if(opts.sendClientReports&&helpers.WINDOW.document){helpers.WINDOW.document.addEventListener("visibilitychange",()=>{if(helpers.WINDOW.document.visibilityState==="hidden"){this._flushOutcomes()}})}}eventFromException(exception,hint){return eventbuilder.eventFromException(this._options.stackParser,exception,hint,this._options.attachStacktrace)}eventFromMessage(message,level="info",hint){return eventbuilder.eventFromMessage(this._options.stackParser,message,level,hint,this._options.attachStacktrace)}captureUserFeedback(feedback){if(!this._isEnabled()){debugBuild.DEBUG_BUILD&&core.logger.warn("SDK not enabled, will not capture user feedback.");return}const envelope=userfeedback.createUserFeedbackEnvelope(feedback,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(envelope)}_prepareEvent(event,hint,scope){event.platform=event.platform||"javascript";return super._prepareEvent(event,hint,scope)}}exports.BrowserClient=BrowserClient},{"./debug-build.js":37,"./eventbuilder.js":38,"./helpers.js":41,"./userfeedback.js":67,"@sentry/core":87}],37:[function(require,module,exports){arguments[4][2][0].apply(exports,arguments)},{dup:2}],38:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");function exceptionFromError(stackParser,ex){const frames=parseStackFrames(stackParser,ex);const exception={type:extractType(ex),value:extractMessage(ex)};if(frames.length){exception.stacktrace={frames:frames}}if(exception.type===undefined&&exception.value===""){exception.value="Unrecoverable error caught"}return exception}function eventFromPlainObject(stackParser,exception,syntheticException,isUnhandledRejection){const client=core.getClient();const normalizeDepth=client&&client.getOptions().normalizeDepth;const errorFromProp=getErrorPropertyFromObject(exception);const extra={__serialized__:core.normalizeToSize(exception,normalizeDepth)};if(errorFromProp){return{exception:{values:[exceptionFromError(stackParser,errorFromProp)]},extra:extra}}const event={exception:{values:[{type:core.isEvent(exception)?exception.constructor.name:isUnhandledRejection?"UnhandledRejection":"Error",value:getNonErrorObjectExceptionValue(exception,{isUnhandledRejection:isUnhandledRejection})}]},extra:extra};if(syntheticException){const frames=parseStackFrames(stackParser,syntheticException);if(frames.length){event.exception.values[0].stacktrace={frames:frames}}}return event}function eventFromError(stackParser,ex){return{exception:{values:[exceptionFromError(stackParser,ex)]}}}function parseStackFrames(stackParser,ex){const stacktrace=ex.stacktrace||ex.stack||"";const skipLines=getSkipFirstStackStringLines(ex);const framesToPop=getPopFirstTopFrames(ex);try{return stackParser(stacktrace,skipLines,framesToPop)}catch(e){}return[]}const reactMinifiedRegexp=/Minified React error #\d+;/i;function getSkipFirstStackStringLines(ex){if(ex&&reactMinifiedRegexp.test(ex.message)){return 1}return 0}function getPopFirstTopFrames(ex){if(typeof ex.framesToPop==="number"){return ex.framesToPop}return 0}function isWebAssemblyException(exception){if(typeof WebAssembly!=="undefined"&&typeof WebAssembly.Exception!=="undefined"){return exception instanceof WebAssembly.Exception}else{return false}}function extractType(ex){const name=ex&&ex.name;if(!name&&isWebAssemblyException(ex)){const hasTypeInMessage=ex.message&&Array.isArray(ex.message)&&ex.message.length==2;return hasTypeInMessage?ex.message[0]:"WebAssembly.Exception"}return name}function extractMessage(ex){const message=ex&&ex.message;if(!message){return"No error message"}if(message.error&&typeof message.error.message==="string"){return message.error.message}if(isWebAssemblyException(ex)&&Array.isArray(ex.message)&&ex.message.length==2){return ex.message[1]}return message}function eventFromException(stackParser,exception,hint,attachStacktrace){const syntheticException=hint&&hint.syntheticException||undefined;const event=eventFromUnknownInput(stackParser,exception,syntheticException,attachStacktrace);core.addExceptionMechanism(event);event.level="error";if(hint&&hint.event_id){event.event_id=hint.event_id}return core.resolvedSyncPromise(event)}function eventFromMessage(stackParser,message,level="info",hint,attachStacktrace){const syntheticException=hint&&hint.syntheticException||undefined;const event=eventFromString(stackParser,message,syntheticException,attachStacktrace);event.level=level;if(hint&&hint.event_id){event.event_id=hint.event_id}return core.resolvedSyncPromise(event)}function eventFromUnknownInput(stackParser,exception,syntheticException,attachStacktrace,isUnhandledRejection){let event;if(core.isErrorEvent(exception)&&exception.error){const errorEvent=exception;return eventFromError(stackParser,errorEvent.error)}if(core.isDOMError(exception)||core.isDOMException(exception)){const domException=exception;if("stack"in exception){event=eventFromError(stackParser,exception)}else{const name=domException.name||(core.isDOMError(domException)?"DOMError":"DOMException");const message=domException.message?`${name}: ${domException.message}`:name;event=eventFromString(stackParser,message,syntheticException,attachStacktrace);core.addExceptionTypeValue(event,message)}if("code"in domException){event.tags={...event.tags,"DOMException.code":`${domException.code}`}}return event}if(core.isError(exception)){return eventFromError(stackParser,exception)}if(core.isPlainObject(exception)||core.isEvent(exception)){const objectException=exception;event=eventFromPlainObject(stackParser,objectException,syntheticException,isUnhandledRejection);core.addExceptionMechanism(event,{synthetic:true});return event}event=eventFromString(stackParser,exception,syntheticException,attachStacktrace);core.addExceptionTypeValue(event,`${exception}`,undefined);core.addExceptionMechanism(event,{synthetic:true});return event}function eventFromString(stackParser,message,syntheticException,attachStacktrace){const event={};if(attachStacktrace&&syntheticException){const frames=parseStackFrames(stackParser,syntheticException);if(frames.length){event.exception={values:[{value:message,stacktrace:{frames:frames}}]}}core.addExceptionMechanism(event,{synthetic:true})}if(core.isParameterizedString(message)){const{__sentry_template_string__,__sentry_template_values__}=message;event.logentry={message:__sentry_template_string__,params:__sentry_template_values__};return event}event.message=message;return event}function getNonErrorObjectExceptionValue(exception,{isUnhandledRejection}){const keys=core.extractExceptionKeysForMessage(exception);const captureType=isUnhandledRejection?"promise rejection":"exception";if(core.isErrorEvent(exception)){return`Event \`ErrorEvent\` captured as ${captureType} with message \`${exception.message}\``}if(core.isEvent(exception)){const className=getObjectClassName(exception);return`Event \`${className}\` (type=${exception.type}) captured as ${captureType}`}return`Object captured as ${captureType} with keys: ${keys}`}function getObjectClassName(obj){try{const prototype=Object.getPrototypeOf(obj);return prototype?prototype.constructor.name:undefined}catch(e){}}function getErrorPropertyFromObject(obj){for(const prop in obj){if(Object.prototype.hasOwnProperty.call(obj,prop)){const value=obj[prop];if(value instanceof Error){return value}}}return undefined}exports.eventFromException=eventFromException;exports.eventFromMessage=eventFromMessage;exports.eventFromUnknownInput=eventFromUnknownInput;exports.exceptionFromError=exceptionFromError;exports.extractMessage=extractMessage;exports.extractType=extractType},{"@sentry/core":87}],39:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const feedback=require("@sentry-internal/feedback");const lazyLoadIntegration=require("./utils/lazyLoadIntegration.js");const feedbackAsyncIntegration=feedback.buildFeedbackIntegration({lazyLoadIntegration:lazyLoadIntegration.lazyLoadIntegration});exports.feedbackAsyncIntegration=feedbackAsyncIntegration},{"./utils/lazyLoadIntegration.js":69,"@sentry-internal/feedback":33}],40:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const feedback=require("@sentry-internal/feedback");const feedbackSyncIntegration=feedback.buildFeedbackIntegration({getModalIntegration:()=>feedback.feedbackModalIntegration,getScreenshotIntegration:()=>feedback.feedbackScreenshotIntegration});exports.feedbackSyncIntegration=feedbackSyncIntegration},{"@sentry-internal/feedback":33}],41:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const WINDOW=core.GLOBAL_OBJ;let ignoreOnError=0;function shouldIgnoreOnError(){return ignoreOnError>0}function ignoreNextOnError(){ignoreOnError++;setTimeout(()=>{ignoreOnError--})}function wrap(fn,options={}){function isFunction(fn){return typeof fn==="function"}if(!isFunction(fn)){return fn}try{const wrapper=fn.__sentry_wrapped__;if(wrapper){if(typeof wrapper==="function"){return wrapper}else{return fn}}if(core.getOriginalFunction(fn)){return fn}}catch(e){return fn}const sentryWrapped=function(...args){try{const wrappedArguments=args.map(arg=>wrap(arg,options));return fn.apply(this,wrappedArguments)}catch(ex){ignoreNextOnError();core.withScope(scope=>{scope.addEventProcessor(event=>{if(options.mechanism){core.addExceptionTypeValue(event,undefined,undefined);core.addExceptionMechanism(event,options.mechanism)}event.extra={...event.extra,arguments:args};return event});core.captureException(ex)});throw ex}};try{for(const property in fn){if(Object.prototype.hasOwnProperty.call(fn,property)){sentryWrapped[property]=fn[property]}}}catch(e2){}core.markFunctionWrapped(sentryWrapped,fn);core.addNonEnumerableProperty(fn,"__sentry_wrapped__",sentryWrapped);try{const descriptor=Object.getOwnPropertyDescriptor(sentryWrapped,"name");if(descriptor.configurable){Object.defineProperty(sentryWrapped,"name",{get(){return fn.name}})}}catch(e3){}return sentryWrapped}exports.WINDOW=WINDOW;exports.ignoreNextOnError=ignoreNextOnError;exports.shouldIgnoreOnError=shouldIgnoreOnError;exports.wrap=wrap},{"@sentry/core":87}],42:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const helpers=require("./helpers.js");const client=require("./client.js");const fetch=require("./transports/fetch.js");const stackParsers=require("./stack-parsers.js");const eventbuilder=require("./eventbuilder.js");const userfeedback=require("./userfeedback.js");const sdk=require("./sdk.js");const breadcrumbs=require("./integrations/breadcrumbs.js");const globalhandlers=require("./integrations/globalhandlers.js");const httpcontext=require("./integrations/httpcontext.js");const linkederrors=require("./integrations/linkederrors.js");const browserapierrors=require("./integrations/browserapierrors.js");const lazyLoadIntegration=require("./utils/lazyLoadIntegration.js");const reportingobserver=require("./integrations/reportingobserver.js");const httpclient=require("./integrations/httpclient.js");const contextlines=require("./integrations/contextlines.js");const replay=require("@sentry-internal/replay");const replayCanvas=require("@sentry-internal/replay-canvas");const feedbackAsync=require("./feedbackAsync.js");const feedbackSync=require("./feedbackSync.js");const feedback=require("@sentry-internal/feedback");const metrics=require("./metrics.js");const request=require("./tracing/request.js");const browserTracingIntegration=require("./tracing/browserTracingIntegration.js");const offline=require("./transports/offline.js");const integration=require("./profiling/integration.js");const spotlight=require("./integrations/spotlight.js");const browsersession=require("./integrations/browsersession.js");const featureFlagsIntegration=require("./integrations/featureFlags/featureFlagsIntegration.js");const integration$1=require("./integrations/featureFlags/launchdarkly/integration.js");const integration$2=require("./integrations/featureFlags/openfeature/integration.js");exports.SDK_VERSION=core.SDK_VERSION;exports.SEMANTIC_ATTRIBUTE_SENTRY_OP=core.SEMANTIC_ATTRIBUTE_SENTRY_OP;exports.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN=core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN;exports.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=core.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE;exports.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=core.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE;exports.Scope=core.Scope;exports.addBreadcrumb=core.addBreadcrumb;exports.addEventProcessor=core.addEventProcessor;exports.addIntegration=core.addIntegration;exports.addTracingExtensions=core.addTracingExtensions;exports.captureConsoleIntegration=core.captureConsoleIntegration;exports.captureEvent=core.captureEvent;exports.captureException=core.captureException;exports.captureFeedback=core.captureFeedback;exports.captureMessage=core.captureMessage;exports.captureSession=core.captureSession;exports.close=core.close;exports.continueTrace=core.continueTrace;exports.createTransport=core.createTransport;exports.debugIntegration=core.debugIntegration;exports.dedupeIntegration=core.dedupeIntegration;exports.endSession=core.endSession;exports.extraErrorDataIntegration=core.extraErrorDataIntegration;exports.flush=core.flush;exports.functionToStringIntegration=core.functionToStringIntegration;exports.getActiveSpan=core.getActiveSpan;exports.getClient=core.getClient;exports.getCurrentHub=core.getCurrentHub;exports.getCurrentScope=core.getCurrentScope;exports.getGlobalScope=core.getGlobalScope;exports.getIsolationScope=core.getIsolationScope;exports.getRootSpan=core.getRootSpan;exports.getSpanDescendants=core.getSpanDescendants;exports.getSpanStatusFromHttpCode=core.getSpanStatusFromHttpCode;exports.inboundFiltersIntegration=core.inboundFiltersIntegration;exports.isInitialized=core.isInitialized;exports.lastEventId=core.lastEventId;exports.makeMultiplexedTransport=core.makeMultiplexedTransport;exports.moduleMetadataIntegration=core.moduleMetadataIntegration;exports.parameterize=core.parameterize;exports.registerSpanErrorInstrumentation=core.registerSpanErrorInstrumentation;exports.rewriteFramesIntegration=core.rewriteFramesIntegration;exports.sessionTimingIntegration=core.sessionTimingIntegration;exports.setContext=core.setContext;exports.setCurrentClient=core.setCurrentClient;exports.setExtra=core.setExtra;exports.setExtras=core.setExtras;exports.setHttpStatus=core.setHttpStatus;exports.setMeasurement=core.setMeasurement;exports.setTag=core.setTag;exports.setTags=core.setTags;exports.setUser=core.setUser;exports.spanToBaggageHeader=core.spanToBaggageHeader;exports.spanToJSON=core.spanToJSON;exports.spanToTraceHeader=core.spanToTraceHeader;exports.startInactiveSpan=core.startInactiveSpan;exports.startNewTrace=core.startNewTrace;exports.startSession=core.startSession;exports.startSpan=core.startSpan;exports.startSpanManual=core.startSpanManual;exports.suppressTracing=core.suppressTracing;exports.thirdPartyErrorFilterIntegration=core.thirdPartyErrorFilterIntegration;exports.updateSpanName=core.updateSpanName;exports.withActiveSpan=core.withActiveSpan;exports.withIsolationScope=core.withIsolationScope;exports.withScope=core.withScope;exports.zodErrorsIntegration=core.zodErrorsIntegration;exports.WINDOW=helpers.WINDOW;exports.BrowserClient=client.BrowserClient;exports.makeFetchTransport=fetch.makeFetchTransport;exports.chromeStackLineParser=stackParsers.chromeStackLineParser;exports.defaultStackLineParsers=stackParsers.defaultStackLineParsers;exports.defaultStackParser=stackParsers.defaultStackParser;exports.geckoStackLineParser=stackParsers.geckoStackLineParser;exports.opera10StackLineParser=stackParsers.opera10StackLineParser;exports.opera11StackLineParser=stackParsers.opera11StackLineParser;exports.winjsStackLineParser=stackParsers.winjsStackLineParser;exports.eventFromException=eventbuilder.eventFromException;exports.eventFromMessage=eventbuilder.eventFromMessage;exports.exceptionFromError=eventbuilder.exceptionFromError;exports.createUserFeedbackEnvelope=userfeedback.createUserFeedbackEnvelope;exports.captureUserFeedback=sdk.captureUserFeedback;exports.forceLoad=sdk.forceLoad;exports.getDefaultIntegrations=sdk.getDefaultIntegrations;exports.init=sdk.init;exports.onLoad=sdk.onLoad;exports.showReportDialog=sdk.showReportDialog;exports.breadcrumbsIntegration=breadcrumbs.breadcrumbsIntegration;exports.globalHandlersIntegration=globalhandlers.globalHandlersIntegration;exports.httpContextIntegration=httpcontext.httpContextIntegration;exports.linkedErrorsIntegration=linkederrors.linkedErrorsIntegration;exports.browserApiErrorsIntegration=browserapierrors.browserApiErrorsIntegration;exports.lazyLoadIntegration=lazyLoadIntegration.lazyLoadIntegration;exports.reportingObserverIntegration=reportingobserver.reportingObserverIntegration;exports.httpClientIntegration=httpclient.httpClientIntegration;exports.contextLinesIntegration=contextlines.contextLinesIntegration;exports.getReplay=replay.getReplay;exports.replayIntegration=replay.replayIntegration;exports.replayCanvasIntegration=replayCanvas.replayCanvasIntegration;exports.feedbackAsyncIntegration=feedbackAsync.feedbackAsyncIntegration;exports.feedbackIntegration=feedbackSync.feedbackSyncIntegration;exports.feedbackSyncIntegration=feedbackSync.feedbackSyncIntegration;exports.getFeedback=feedback.getFeedback;exports.sendFeedback=feedback.sendFeedback;exports.metrics=metrics.metrics;exports.defaultRequestInstrumentationOptions=request.defaultRequestInstrumentationOptions;exports.instrumentOutgoingRequests=request.instrumentOutgoingRequests;exports.browserTracingIntegration=browserTracingIntegration.browserTracingIntegration;exports.startBrowserTracingNavigationSpan=browserTracingIntegration.startBrowserTracingNavigationSpan;exports.startBrowserTracingPageLoadSpan=browserTracingIntegration.startBrowserTracingPageLoadSpan;exports.makeBrowserOfflineTransport=offline.makeBrowserOfflineTransport;exports.browserProfilingIntegration=integration.browserProfilingIntegration;exports.spotlightBrowserIntegration=spotlight.spotlightBrowserIntegration;exports.browserSessionIntegration=browsersession.browserSessionIntegration;exports.featureFlagsIntegration=featureFlagsIntegration.featureFlagsIntegration;exports.buildLaunchDarklyFlagUsedHandler=integration$1.buildLaunchDarklyFlagUsedHandler;exports.launchDarklyIntegration=integration$1.launchDarklyIntegration;exports.OpenFeatureIntegrationHook=integration$2.OpenFeatureIntegrationHook;exports.openFeatureIntegration=integration$2.openFeatureIntegration},{"./client.js":36,"./eventbuilder.js":38,"./feedbackAsync.js":39,"./feedbackSync.js":40,"./helpers.js":41,"./integrations/breadcrumbs.js":43,"./integrations/browserapierrors.js":44,"./integrations/browsersession.js":45,"./integrations/contextlines.js":46,"./integrations/featureFlags/featureFlagsIntegration.js":47,"./integrations/featureFlags/launchdarkly/integration.js":48,"./integrations/featureFlags/openfeature/integration.js":49,"./integrations/globalhandlers.js":50,"./integrations/httpclient.js":51,"./integrations/httpcontext.js":52,"./integrations/linkederrors.js":53,"./integrations/reportingobserver.js":54,"./integrations/spotlight.js":55,"./metrics.js":56,"./profiling/integration.js":57,"./sdk.js":60,"./stack-parsers.js":61,"./tracing/browserTracingIntegration.js":63,"./tracing/request.js":64,"./transports/fetch.js":65,"./transports/offline.js":66,"./userfeedback.js":67,"./utils/lazyLoadIntegration.js":69,"@sentry-internal/feedback":33,"@sentry-internal/replay":35,"@sentry-internal/replay-canvas":34,"@sentry/core":87}],43:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const browserUtils=require("@sentry-internal/browser-utils");const core=require("@sentry/core");const debugBuild=require("../debug-build.js");const helpers=require("../helpers.js");const MAX_ALLOWED_STRING_LENGTH=1024;const INTEGRATION_NAME="Breadcrumbs";const _breadcrumbsIntegration=(options={})=>{const _options={console:true,dom:true,fetch:true,history:true,sentry:true,xhr:true,...options};return{name:INTEGRATION_NAME,setup(client){if(_options.console){core.addConsoleInstrumentationHandler(_getConsoleBreadcrumbHandler(client))}if(_options.dom){browserUtils.addClickKeypressInstrumentationHandler(_getDomBreadcrumbHandler(client,_options.dom))}if(_options.xhr){browserUtils.addXhrInstrumentationHandler(_getXhrBreadcrumbHandler(client))}if(_options.fetch){core.addFetchInstrumentationHandler(_getFetchBreadcrumbHandler(client))}if(_options.history){browserUtils.addHistoryInstrumentationHandler(_getHistoryBreadcrumbHandler(client))}if(_options.sentry){client.on("beforeSendEvent",_getSentryBreadcrumbHandler(client))}}}};const breadcrumbsIntegration=core.defineIntegration(_breadcrumbsIntegration);function _getSentryBreadcrumbHandler(client){return function addSentryBreadcrumb(event){if(core.getClient()!==client){return}core.addBreadcrumb({category:`sentry.${event.type==="transaction"?"transaction":"event"}`,event_id:event.event_id,level:event.level,message:core.getEventDescription(event)},{event:event})}}function _getDomBreadcrumbHandler(client,dom){return function _innerDomBreadcrumb(handlerData){if(core.getClient()!==client){return}let target;let componentName;let keyAttrs=typeof dom==="object"?dom.serializeAttribute:undefined;let maxStringLength=typeof dom==="object"&&typeof dom.maxStringLength==="number"?dom.maxStringLength:undefined;if(maxStringLength&&maxStringLength>MAX_ALLOWED_STRING_LENGTH){debugBuild.DEBUG_BUILD&&core.logger.warn(`\`dom.maxStringLength\` cannot exceed ${MAX_ALLOWED_STRING_LENGTH}, but a value of ${maxStringLength} was configured. Sentry will use ${MAX_ALLOWED_STRING_LENGTH} instead.`);maxStringLength=MAX_ALLOWED_STRING_LENGTH}if(typeof keyAttrs==="string"){keyAttrs=[keyAttrs]}try{const event=handlerData.event;const element=_isEvent(event)?event.target:event;target=core.htmlTreeAsString(element,{keyAttrs:keyAttrs,maxStringLength:maxStringLength});componentName=core.getComponentName(element)}catch(e){target="<unknown>"}if(target.length===0){return}const breadcrumb={category:`ui.${handlerData.name}`,message:target};if(componentName){breadcrumb.data={"ui.component_name":componentName}}core.addBreadcrumb(breadcrumb,{event:handlerData.event,name:handlerData.name,global:handlerData.global})}}function _getConsoleBreadcrumbHandler(client){return function _consoleBreadcrumb(handlerData){if(core.getClient()!==client){return}const breadcrumb={category:"console",data:{arguments:handlerData.args,logger:"console"},level:core.severityLevelFromString(handlerData.level),message:core.safeJoin(handlerData.args," ")};if(handlerData.level==="assert"){if(handlerData.args[0]===false){breadcrumb.message=`Assertion failed: ${core.safeJoin(handlerData.args.slice(1)," ")||"console.assert"}`;breadcrumb.data.arguments=handlerData.args.slice(1)}else{return}}core.addBreadcrumb(breadcrumb,{input:handlerData.args,level:handlerData.level})}}function _getXhrBreadcrumbHandler(client){return function _xhrBreadcrumb(handlerData){if(core.getClient()!==client){return}const{startTimestamp,endTimestamp}=handlerData;const sentryXhrData=handlerData.xhr[browserUtils.SENTRY_XHR_DATA_KEY];if(!startTimestamp||!endTimestamp||!sentryXhrData){return}const{method,url,status_code,body}=sentryXhrData;const data={method:method,url:url,status_code:status_code};const hint={xhr:handlerData.xhr,input:body,startTimestamp:startTimestamp,endTimestamp:endTimestamp};const level=core.getBreadcrumbLogLevelFromHttpStatusCode(status_code);core.addBreadcrumb({category:"xhr",data:data,type:"http",level:level},hint)}}function _getFetchBreadcrumbHandler(client){return function _fetchBreadcrumb(handlerData){if(core.getClient()!==client){return}const{startTimestamp,endTimestamp}=handlerData;if(!endTimestamp){return}if(handlerData.fetchData.url.match(/sentry_key/)&&handlerData.fetchData.method==="POST"){return}if(handlerData.error){const data=handlerData.fetchData;const hint={data:handlerData.error,input:handlerData.args,startTimestamp:startTimestamp,endTimestamp:endTimestamp};core.addBreadcrumb({category:"fetch",data:data,level:"error",type:"http"},hint)}else{const response=handlerData.response;const data={...handlerData.fetchData,status_code:response&&response.status};const hint={input:handlerData.args,response:response,startTimestamp:startTimestamp,endTimestamp:endTimestamp};const level=core.getBreadcrumbLogLevelFromHttpStatusCode(data.status_code);core.addBreadcrumb({category:"fetch",data:data,type:"http",level:level},hint)}}}function _getHistoryBreadcrumbHandler(client){return function _historyBreadcrumb(handlerData){if(core.getClient()!==client){return}let from=handlerData.from;let to=handlerData.to;const parsedLoc=core.parseUrl(helpers.WINDOW.location.href);let parsedFrom=from?core.parseUrl(from):undefined;const parsedTo=core.parseUrl(to);if(!parsedFrom||!parsedFrom.path){parsedFrom=parsedLoc}if(parsedLoc.protocol===parsedTo.protocol&&parsedLoc.host===parsedTo.host){to=parsedTo.relative}if(parsedLoc.protocol===parsedFrom.protocol&&parsedLoc.host===parsedFrom.host){from=parsedFrom.relative}core.addBreadcrumb({category:"navigation",data:{from:from,to:to}})}}function _isEvent(event){return!!event&&!!event.target}exports.breadcrumbsIntegration=breadcrumbsIntegration},{"../debug-build.js":37,"../helpers.js":41,"@sentry-internal/browser-utils":4,"@sentry/core":87}],44:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const helpers=require("../helpers.js");const DEFAULT_EVENT_TARGET=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"];const INTEGRATION_NAME="BrowserApiErrors";const _browserApiErrorsIntegration=(options={})=>{const _options={XMLHttpRequest:true,eventTarget:true,requestAnimationFrame:true,setInterval:true,setTimeout:true,...options};return{name:INTEGRATION_NAME,setupOnce(){if(_options.setTimeout){core.fill(helpers.WINDOW,"setTimeout",_wrapTimeFunction)}if(_options.setInterval){core.fill(helpers.WINDOW,"setInterval",_wrapTimeFunction)}if(_options.requestAnimationFrame){core.fill(helpers.WINDOW,"requestAnimationFrame",_wrapRAF)}if(_options.XMLHttpRequest&&"XMLHttpRequest"in helpers.WINDOW){core.fill(XMLHttpRequest.prototype,"send",_wrapXHR)}const eventTargetOption=_options.eventTarget;if(eventTargetOption){const eventTarget=Array.isArray(eventTargetOption)?eventTargetOption:DEFAULT_EVENT_TARGET;eventTarget.forEach(_wrapEventTarget)}}}};const browserApiErrorsIntegration=core.defineIntegration(_browserApiErrorsIntegration);function _wrapTimeFunction(original){return function(...args){const originalCallback=args[0];args[0]=helpers.wrap(originalCallback,{mechanism:{data:{function:core.getFunctionName(original)},handled:false,type:"instrument"}});return original.apply(this,args)}}function _wrapRAF(original){return function(callback){return original.apply(this,[helpers.wrap(callback,{mechanism:{data:{function:"requestAnimationFrame",handler:core.getFunctionName(original)},handled:false,type:"instrument"}})])}}function _wrapXHR(originalSend){return function(...args){const xhr=this;const xmlHttpRequestProps=["onload","onerror","onprogress","onreadystatechange"];xmlHttpRequestProps.forEach(prop=>{if(prop in xhr&&typeof xhr[prop]==="function"){core.fill(xhr,prop,function(original){const wrapOptions={mechanism:{data:{function:prop,handler:core.getFunctionName(original)},handled:false,type:"instrument"}};const originalFunction=core.getOriginalFunction(original);if(originalFunction){wrapOptions.mechanism.data.handler=core.getFunctionName(originalFunction)}return helpers.wrap(original,wrapOptions)})}});return originalSend.apply(this,args)}}function _wrapEventTarget(target){const globalObject=helpers.WINDOW;const targetObj=globalObject[target];const proto=targetObj&&targetObj.prototype;if(!proto||!proto.hasOwnProperty||!proto.hasOwnProperty("addEventListener")){return}core.fill(proto,"addEventListener",function(original){return function(eventName,fn,options){try{if(isEventListenerObject(fn)){fn.handleEvent=helpers.wrap(fn.handleEvent,{mechanism:{data:{function:"handleEvent",handler:core.getFunctionName(fn),target:target},handled:false,type:"instrument"}})}}catch(e2){}return original.apply(this,[eventName,helpers.wrap(fn,{mechanism:{data:{function:"addEventListener",handler:core.getFunctionName(fn),target:target},handled:false,type:"instrument"}}),options])}});core.fill(proto,"removeEventListener",function(originalRemoveEventListener){return function(eventName,fn,options){try{const originalEventHandler=fn.__sentry_wrapped__;if(originalEventHandler){originalRemoveEventListener.call(this,eventName,originalEventHandler,options)}}catch(e){}return originalRemoveEventListener.call(this,eventName,fn,options)}})}function isEventListenerObject(obj){return typeof obj.handleEvent==="function"}exports.browserApiErrorsIntegration=browserApiErrorsIntegration},{"../helpers.js":41,"@sentry/core":87}],45:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const browserUtils=require("@sentry-internal/browser-utils");const core=require("@sentry/core");const debugBuild=require("../debug-build.js");const helpers=require("../helpers.js");const browserSessionIntegration=core.defineIntegration(()=>{return{name:"BrowserSession",setupOnce(){if(typeof helpers.WINDOW.document==="undefined"){debugBuild.DEBUG_BUILD&&core.logger.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.");return}core.startSession({ignoreDuration:true});core.captureSession();browserUtils.addHistoryInstrumentationHandler(({from,to})=>{if(from!==undefined&&from!==to){core.startSession({ignoreDuration:true});core.captureSession()}})}}});exports.browserSessionIntegration=browserSessionIntegration},{"../debug-build.js":37,"../helpers.js":41,"@sentry-internal/browser-utils":4,"@sentry/core":87}],46:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const WINDOW=core.GLOBAL_OBJ;const DEFAULT_LINES_OF_CONTEXT=7;const INTEGRATION_NAME="ContextLines";const _contextLinesIntegration=(options={})=>{const contextLines=options.frameContextLines!=null?options.frameContextLines:DEFAULT_LINES_OF_CONTEXT;return{name:INTEGRATION_NAME,processEvent(event){return addSourceContext(event,contextLines)}}};const contextLinesIntegration=core.defineIntegration(_contextLinesIntegration);function addSourceContext(event,contextLines){const doc=WINDOW.document;const htmlFilename=WINDOW.location&&core.stripUrlQueryAndFragment(WINDOW.location.href);if(!doc||!htmlFilename){return event}const exceptions=event.exception&&event.exception.values;if(!exceptions||!exceptions.length){return event}const html=doc.documentElement.innerHTML;if(!html){return event}const htmlLines=["<!DOCTYPE html>","<html>",...html.split("\n"),"</html>"];exceptions.forEach(exception=>{const stacktrace=exception.stacktrace;if(stacktrace&&stacktrace.frames){stacktrace.frames=stacktrace.frames.map(frame=>applySourceContextToFrame(frame,htmlLines,htmlFilename,contextLines))}});return event}function applySourceContextToFrame(frame,htmlLines,htmlFilename,linesOfContext){if(frame.filename!==htmlFilename||!frame.lineno||!htmlLines.length){return frame}core.addContextToFrame(htmlLines,frame,linesOfContext);return frame}exports.applySourceContextToFrame=applySourceContextToFrame;exports.contextLinesIntegration=contextLinesIntegration},{"@sentry/core":87}],47:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const featureFlags=require("../../utils/featureFlags.js");const featureFlagsIntegration=core.defineIntegration(()=>{return{name:"FeatureFlags",processEvent(event,_hint,_client){return featureFlags.copyFlagsFromScopeToEvent(event)},addFeatureFlag(name,value){featureFlags.insertFlagToScope(name,value)}}});exports.featureFlagsIntegration=featureFlagsIntegration},{"../../utils/featureFlags.js":68,"@sentry/core":87}],48:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const featureFlags=require("../../../utils/featureFlags.js");const launchDarklyIntegration=core.defineIntegration(()=>{return{name:"LaunchDarkly",processEvent(event,_hint,_client){return featureFlags.copyFlagsFromScopeToEvent(event)}}});function buildLaunchDarklyFlagUsedHandler(){return{name:"sentry-flag-auditor",type:"flag-used",synchronous:true,method:(flagKey,flagDetail,_context)=>{featureFlags.insertFlagToScope(flagKey,flagDetail.value)}}}exports.buildLaunchDarklyFlagUsedHandler=buildLaunchDarklyFlagUsedHandler;exports.launchDarklyIntegration=launchDarklyIntegration},{"../../../utils/featureFlags.js":68,"@sentry/core":87}],49:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const featureFlags=require("../../../utils/featureFlags.js");const openFeatureIntegration=core.defineIntegration(()=>{return{name:"OpenFeature",processEvent(event,_hint,_client){return featureFlags.copyFlagsFromScopeToEvent(event)}}});class OpenFeatureIntegrationHook{after(_hookContext,evaluationDetails){featureFlags.insertFlagToScope(evaluationDetails.flagKey,evaluationDetails.value)}error(hookContext,_error,_hookHints){featureFlags.insertFlagToScope(hookContext.flagKey,hookContext.defaultValue)}}exports.OpenFeatureIntegrationHook=OpenFeatureIntegrationHook;exports.openFeatureIntegration=openFeatureIntegration},{"../../../utils/featureFlags.js":68,"@sentry/core":87}],50:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const debugBuild=require("../debug-build.js");const eventbuilder=require("../eventbuilder.js");const helpers=require("../helpers.js");const INTEGRATION_NAME="GlobalHandlers";const _globalHandlersIntegration=(options={})=>{const _options={onerror:true,onunhandledrejection:true,...options};return{name:INTEGRATION_NAME,setupOnce(){Error.stackTraceLimit=50},setup(client){if(_options.onerror){_installGlobalOnErrorHandler(client);globalHandlerLog("onerror")}if(_options.onunhandledrejection){_installGlobalOnUnhandledRejectionHandler(client);globalHandlerLog("onunhandledrejection")}}}};const globalHandlersIntegration=core.defineIntegration(_globalHandlersIntegration);function _installGlobalOnErrorHandler(client){core.addGlobalErrorInstrumentationHandler(data=>{const{stackParser,attachStacktrace}=getOptions();if(core.getClient()!==client||helpers.shouldIgnoreOnError()){return}const{msg,url,line,column,error}=data;const event=_enhanceEventWithInitialFrame(eventbuilder.eventFromUnknownInput(stackParser,error||msg,undefined,attachStacktrace,false),url,line,column);event.level="error";core.captureEvent(event,{originalException:error,mechanism:{handled:false,type:"onerror"}})})}function _installGlobalOnUnhandledRejectionHandler(client){core.addGlobalUnhandledRejectionInstrumentationHandler(e=>{const{stackParser,attachStacktrace}=getOptions();if(core.getClient()!==client||helpers.shouldIgnoreOnError()){return}const error=_getUnhandledRejectionError(e);const event=core.isPrimitive(error)?_eventFromRejectionWithPrimitive(error):eventbuilder.eventFromUnknownInput(stackParser,error,undefined,attachStacktrace,true);event.level="error";core.captureEvent(event,{originalException:error,mechanism:{handled:false,type:"onunhandledrejection"}})})}function _getUnhandledRejectionError(error){if(core.isPrimitive(error)){return error}try{if("reason"in error){return error.reason}if("detail"in error&&"reason"in error.detail){return error.detail.reason}}catch(e2){}return error}function _eventFromRejectionWithPrimitive(reason){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(reason)}`}]}}}function _enhanceEventWithInitialFrame(event,url,line,column){const e=event.exception=event.exception||{};const ev=e.values=e.values||[];const ev0=ev[0]=ev[0]||{};const ev0s=ev0.stacktrace=ev0.stacktrace||{};const ev0sf=ev0s.frames=ev0s.frames||[];const colno=column;const lineno=line;const filename=core.isString(url)&&url.length>0?url:core.getLocationHref();if(ev0sf.length===0){ev0sf.push({colno:colno,filename:filename,function:core.UNKNOWN_FUNCTION,in_app:true,lineno:lineno})}return event}function globalHandlerLog(type){debugBuild.DEBUG_BUILD&&core.logger.log(`Global Handler attached: ${type}`)}function getOptions(){const client=core.getClient();const options=client&&client.getOptions()||{stackParser:()=>[],attachStacktrace:false};return options}exports.globalHandlersIntegration=globalHandlersIntegration},{"../debug-build.js":37,"../eventbuilder.js":38,"../helpers.js":41,"@sentry/core":87}],51:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const browserUtils=require("@sentry-internal/browser-utils");const core=require("@sentry/core");const debugBuild=require("../debug-build.js");const INTEGRATION_NAME="HttpClient";const _httpClientIntegration=(options={})=>{const _options={failedRequestStatusCodes:[[500,599]],failedRequestTargets:[/.*/],...options};return{name:INTEGRATION_NAME,setup(client){_wrapFetch(client,_options);_wrapXHR(client,_options)}}};const httpClientIntegration=core.defineIntegration(_httpClientIntegration);function _fetchResponseHandler(options,requestInfo,response,requestInit,error){if(_shouldCaptureResponse(options,response.status,response.url)){const request=_getRequest(requestInfo,requestInit);let requestHeaders,responseHeaders,requestCookies,responseCookies;if(_shouldSendDefaultPii()){[requestHeaders,requestCookies]=_parseCookieHeaders("Cookie",request);[responseHeaders,responseCookies]=_parseCookieHeaders("Set-Cookie",response)}const event=_createEvent({url:request.url,method:request.method,status:response.status,requestHeaders:requestHeaders,responseHeaders:responseHeaders,requestCookies:requestCookies,responseCookies:responseCookies,error:error});core.captureEvent(event)}}function _parseCookieHeaders(cookieHeader,obj){const headers=_extractFetchHeaders(obj.headers);let cookies;try{const cookieString=headers[cookieHeader]||headers[cookieHeader.toLowerCase()]||undefined;if(cookieString){cookies=_parseCookieString(cookieString)}}catch(e2){}return[headers,cookies]}function _xhrResponseHandler(options,xhr,method,headers,error){if(_shouldCaptureResponse(options,xhr.status,xhr.responseURL)){let requestHeaders,responseCookies,responseHeaders;if(_shouldSendDefaultPii()){try{const cookieString=xhr.getResponseHeader("Set-Cookie")||xhr.getResponseHeader("set-cookie")||undefined;if(cookieString){responseCookies=_parseCookieString(cookieString)}}catch(e3){}try{responseHeaders=_getXHRResponseHeaders(xhr)}catch(e4){}requestHeaders=headers}const event=_createEvent({url:xhr.responseURL,method:method,status:xhr.status,requestHeaders:requestHeaders,responseHeaders:responseHeaders,responseCookies:responseCookies,error:error});core.captureEvent(event)}}function _getResponseSizeFromHeaders(headers){if(headers){const contentLength=headers["Content-Length"]||headers["content-length"];if(contentLength){return parseInt(contentLength,10)}}return undefined}function _parseCookieString(cookieString){return cookieString.split("; ").reduce((acc,cookie)=>{const[key,value]=cookie.split("=");if(key&&value){acc[key]=value}return acc},{})}function _extractFetchHeaders(headers){const result={};headers.forEach((value,key)=>{result[key]=value});return result}function _getXHRResponseHeaders(xhr){const headers=xhr.getAllResponseHeaders();if(!headers){return{}}return headers.split("\r\n").reduce((acc,line)=>{const[key,value]=line.split(": ");if(key&&value){acc[key]=value}return acc},{})}function _isInGivenRequestTargets(failedRequestTargets,target){return failedRequestTargets.some(givenRequestTarget=>{if(typeof givenRequestTarget==="string"){return target.includes(givenRequestTarget)}return givenRequestTarget.test(target)})}function _isInGivenStatusRanges(failedRequestStatusCodes,status){return failedRequestStatusCodes.some(range=>{if(typeof range==="number"){return range===status}return status>=range[0]&&status<=range[1]})}function _wrapFetch(client,options){if(!core.supportsNativeFetch()){return}core.addFetchInstrumentationHandler(handlerData=>{if(core.getClient()!==client){return}const{response,args,error,virtualError}=handlerData;const[requestInfo,requestInit]=args;if(!response){return}_fetchResponseHandler(options,requestInfo,response,requestInit,error||virtualError)},false)}function _wrapXHR(client,options){if(!("XMLHttpRequest"in core.GLOBAL_OBJ)){return}browserUtils.addXhrInstrumentationHandler(handlerData=>{if(core.getClient()!==client){return}const{error,virtualError}=handlerData;const xhr=handlerData.xhr;const sentryXhrData=xhr[browserUtils.SENTRY_XHR_DATA_KEY];if(!sentryXhrData){return}const{method,request_headers:headers}=sentryXhrData;try{_xhrResponseHandler(options,xhr,method,headers,error||virtualError)}catch(e){debugBuild.DEBUG_BUILD&&core.logger.warn("Error while extracting response event form XHR response",e)}})}function _shouldCaptureResponse(options,status,url){return _isInGivenStatusRanges(options.failedRequestStatusCodes,status)&&_isInGivenRequestTargets(options.failedRequestTargets,url)&&!core.isSentryRequestUrl(url,core.getClient())}function _createEvent(data){const client=core.getClient();const virtualStackTrace=client&&data.error&&data.error instanceof Error?data.error.stack:undefined;const stack=virtualStackTrace&&client?client.getOptions().stackParser(virtualStackTrace,0,1):undefined;const message=`HTTP Client Error with status code: ${data.status}`;const event={message:message,exception:{values:[{type:"Error",value:message,stacktrace:stack?{frames:stack}:undefined}]},request:{url:data.url,method:data.method,headers:data.requestHeaders,cookies:data.requestCookies},contexts:{response:{status_code:data.status,headers:data.responseHeaders,cookies:data.responseCookies,body_size:_getResponseSizeFromHeaders(data.responseHeaders)}}};core.addExceptionMechanism(event,{type:"http.client",handled:false});return event}function _getRequest(requestInfo,requestInit){if(!requestInit&&requestInfo instanceof Request){return requestInfo}if(requestInfo instanceof Request&&requestInfo.bodyUsed){return requestInfo}return new Request(requestInfo,requestInit)}function _shouldSendDefaultPii(){const client=core.getClient();return client?Boolean(client.getOptions().sendDefaultPii):false}exports.httpClientIntegration=httpClientIntegration},{"../debug-build.js":37,"@sentry-internal/browser-utils":4,"@sentry/core":87}],52:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const helpers=require("../helpers.js");const httpContextIntegration=core.defineIntegration(()=>{return{name:"HttpContext",preprocessEvent(event){if(!helpers.WINDOW.navigator&&!helpers.WINDOW.location&&!helpers.WINDOW.document){return}const url=event.request&&event.request.url||helpers.WINDOW.location&&helpers.WINDOW.location.href;const{referrer}=helpers.WINDOW.document||{};const{userAgent}=helpers.WINDOW.navigator||{};const headers={...event.request&&event.request.headers,...referrer&&{Referer:referrer},...userAgent&&{"User-Agent":userAgent}};const request={...event.request,...url&&{url:url},headers:headers};event.request=request}}});exports.httpContextIntegration=httpContextIntegration},{"../helpers.js":41,"@sentry/core":87}],53:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const eventbuilder=require("../eventbuilder.js");const DEFAULT_KEY="cause";const DEFAULT_LIMIT=5;const INTEGRATION_NAME="LinkedErrors";const _linkedErrorsIntegration=(options={})=>{const limit=options.limit||DEFAULT_LIMIT;const key=options.key||DEFAULT_KEY;return{name:INTEGRATION_NAME,preprocessEvent(event,hint,client){const options=client.getOptions();core.applyAggregateErrorsToEvent(eventbuilder.exceptionFromError,options.stackParser,options.maxValueLength,key,limit,event,hint)}}};const linkedErrorsIntegration=core.defineIntegration(_linkedErrorsIntegration);exports.linkedErrorsIntegration=linkedErrorsIntegration},{"../eventbuilder.js":38,"@sentry/core":87}],54:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const WINDOW=core.GLOBAL_OBJ;const INTEGRATION_NAME="ReportingObserver";const SETUP_CLIENTS=new WeakMap;const _reportingObserverIntegration=(options={})=>{const types=options.types||["crash","deprecation","intervention"];function handler(reports){if(!SETUP_CLIENTS.has(core.getClient())){return}for(const report of reports){core.withScope(scope=>{scope.setExtra("url",report.url);const label=`ReportingObserver [${report.type}]`;let details="No details available";if(report.body){const plainBody={};for(const prop in report.body){plainBody[prop]=report.body[prop]}scope.setExtra("body",plainBody);if(report.type==="crash"){const body=report.body;details=[body.crashId||"",body.reason||""].join(" ").trim()||details}else{const body=report.body;details=body.message||details}}core.captureMessage(`${label}: ${details}`)})}}return{name:INTEGRATION_NAME,setupOnce(){if(!core.supportsReportingObserver()){return}const observer=new WINDOW.ReportingObserver(handler,{buffered:true,types:types});observer.observe()},setup(client){SETUP_CLIENTS.set(client,true)}}};const reportingObserverIntegration=core.defineIntegration(_reportingObserverIntegration);exports.reportingObserverIntegration=reportingObserverIntegration},{"@sentry/core":87}],55:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const browserUtils=require("@sentry-internal/browser-utils");const core=require("@sentry/core");const debugBuild=require("../debug-build.js");const INTEGRATION_NAME="SpotlightBrowser";const _spotlightIntegration=(options={})=>{const sidecarUrl=options.sidecarUrl||"http://localhost:8969/stream";return{name:INTEGRATION_NAME,setup:()=>{debugBuild.DEBUG_BUILD&&core.logger.log("Using Sidecar URL",sidecarUrl)},processEvent:event=>isSpotlightInteraction(event)?null:event,afterAllSetup:client=>{setupSidecarForwarding(client,sidecarUrl)}}};function setupSidecarForwarding(client,sidecarUrl){const makeFetch=browserUtils.getNativeImplementation("fetch");let failCount=0;client.on("beforeEnvelope",envelope=>{if(failCount>3){core.logger.warn("[Spotlight] Disabled Sentry -> Spotlight integration due to too many failed requests:",failCount);return}makeFetch(sidecarUrl,{method:"POST",body:core.serializeEnvelope(envelope),headers:{"Content-Type":"application/x-sentry-envelope"},mode:"cors"}).then(res=>{if(res.status>=200&&res.status<400){failCount=0}},err=>{failCount++;core.logger.error("Sentry SDK can't connect to Sidecar is it running? See: https://spotlightjs.com/sidecar/npx/",err)})})}const spotlightBrowserIntegration=core.defineIntegration(_spotlightIntegration);function isSpotlightInteraction(event){return Boolean(event.type==="transaction"&&event.spans&&event.contexts&&event.contexts.trace&&event.contexts.trace.op==="ui.action.click"&&event.spans.some(({description})=>description&&description.includes("#sentry-spotlight")))}exports.INTEGRATION_NAME=INTEGRATION_NAME;exports.isSpotlightInteraction=isSpotlightInteraction;exports.spotlightBrowserIntegration=spotlightBrowserIntegration},{"../debug-build.js":37,"@sentry-internal/browser-utils":4,"@sentry/core":87}],56:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");function increment(name,value=1,data){core.metrics.increment(core.BrowserMetricsAggregator,name,value,data)}function distribution(name,value,data){core.metrics.distribution(core.BrowserMetricsAggregator,name,value,data)}function set(name,value,data){core.metrics.set(core.BrowserMetricsAggregator,name,value,data)}function gauge(name,value,data){core.metrics.gauge(core.BrowserMetricsAggregator,name,value,data)}function timing(name,value,unit="second",data){return core.metrics.timing(core.BrowserMetricsAggregator,name,value,unit,data)}const metrics={increment:increment,distribution:distribution,set:set,gauge:gauge,timing:timing};exports.metrics=metrics},{"@sentry/core":87}],57:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const debugBuild=require("../debug-build.js");const startProfileForSpan=require("./startProfileForSpan.js");const utils=require("./utils.js");const INTEGRATION_NAME="BrowserProfiling";const _browserProfilingIntegration=()=>{return{name:INTEGRATION_NAME,setup(client){const activeSpan=core.getActiveSpan();const rootSpan=activeSpan&&core.getRootSpan(activeSpan);if(rootSpan&&utils.isAutomatedPageLoadSpan(rootSpan)){if(utils.shouldProfileSpan(rootSpan)){startProfileForSpan.startProfileForSpan(rootSpan)}}client.on("spanStart",span=>{if(span===core.getRootSpan(span)&&utils.shouldProfileSpan(span)){startProfileForSpan.startProfileForSpan(span)}});client.on("beforeEnvelope",envelope=>{if(!utils.getActiveProfilesCount()){return}const profiledTransactionEvents=utils.findProfiledTransactionsFromEnvelope(envelope);if(!profiledTransactionEvents.length){return}const profilesToAddToEnvelope=[];for(const profiledTransaction of profiledTransactionEvents){const context=profiledTransaction&&profiledTransaction.contexts;const profile_id=context&&context["profile"]&&context["profile"]["profile_id"];const start_timestamp=context&&context["profile"]&&context["profile"]["start_timestamp"];if(typeof profile_id!=="string"){debugBuild.DEBUG_BUILD&&core.logger.log("[Profiling] cannot find profile for a span without a profile context");continue}if(!profile_id){debugBuild.DEBUG_BUILD&&core.logger.log("[Profiling] cannot find profile for a span without a profile context");continue}if(context&&context["profile"]){delete context.profile}const profile=utils.takeProfileFromGlobalCache(profile_id);if(!profile){debugBuild.DEBUG_BUILD&&core.logger.log(`[Profiling] Could not retrieve profile for span: ${profile_id}`);continue}const profileEvent=utils.createProfilingEvent(profile_id,start_timestamp,profile,profiledTransaction);if(profileEvent){profilesToAddToEnvelope.push(profileEvent)}}utils.addProfilesToEnvelope(envelope,profilesToAddToEnvelope)})}}};const browserProfilingIntegration=core.defineIntegration(_browserProfilingIntegration);exports.browserProfilingIntegration=browserProfilingIntegration},{"../debug-build.js":37,"./startProfileForSpan.js":58,"./utils.js":59,"@sentry/core":87}],58:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const debugBuild=require("../debug-build.js");const helpers=require("../helpers.js");const utils=require("./utils.js");function startProfileForSpan(span){let startTimestamp;if(utils.isAutomatedPageLoadSpan(span)){startTimestamp=core.timestampInSeconds()*1e3}const profiler=utils.startJSSelfProfile();if(!profiler){return}if(debugBuild.DEBUG_BUILD){core.logger.log(`[Profiling] started profiling span: ${core.spanToJSON(span).description}`)}const profileId=core.uuid4();core.getCurrentScope().setContext("profile",{profile_id:profileId,start_timestamp:startTimestamp});async function onProfileHandler(){if(!span){return}if(!profiler){return}return profiler.stop().then(profile=>{if(maxDurationTimeoutID){helpers.WINDOW.clearTimeout(maxDurationTimeoutID);maxDurationTimeoutID=undefined}if(debugBuild.DEBUG_BUILD){core.logger.log(`[Profiling] stopped profiling of span: ${core.spanToJSON(span).description}`)}if(!profile){if(debugBuild.DEBUG_BUILD){core.logger.log(`[Profiling] profiler returned null profile for: ${core.spanToJSON(span).description}`,"this may indicate an overlapping span or a call to stopProfiling with a profile title that was never started")}return}utils.addProfileToGlobalCache(profileId,profile)}).catch(error=>{if(debugBuild.DEBUG_BUILD){core.logger.log("[Profiling] error while stopping profiler:",error)}})}let maxDurationTimeoutID=helpers.WINDOW.setTimeout(()=>{if(debugBuild.DEBUG_BUILD){core.logger.log("[Profiling] max profile duration elapsed, stopping profiling for:",core.spanToJSON(span).description)}onProfileHandler()},utils.MAX_PROFILE_DURATION_MS);const originalEnd=span.end.bind(span);function profilingWrappedSpanEnd(){if(!span){return originalEnd()}void onProfileHandler().then(()=>{originalEnd()},()=>{originalEnd()});return span}span.end=profilingWrappedSpanEnd}exports.startProfileForSpan=startProfileForSpan},{"../debug-build.js":37,"../helpers.js":41,"./utils.js":59,"@sentry/core":87}],59:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const debugBuild=require("../debug-build.js");const helpers=require("../helpers.js");const MS_TO_NS=1e6;const THREAD_ID_STRING=String(0);const THREAD_NAME="main";let OS_PLATFORM="";let OS_PLATFORM_VERSION="";let OS_ARCH="";let OS_BROWSER=helpers.WINDOW.navigator&&helpers.WINDOW.navigator.userAgent||"";let OS_MODEL="";const OS_LOCALE=helpers.WINDOW.navigator&&helpers.WINDOW.navigator.language||helpers.WINDOW.navigator&&helpers.WINDOW.navigator.languages&&helpers.WINDOW.navigator.languages[0]||"";function isUserAgentData(data){return typeof data==="object"&&data!==null&&"getHighEntropyValues"in data}const userAgentData=helpers.WINDOW.navigator&&helpers.WINDOW.navigator.userAgentData;if(isUserAgentData(userAgentData)){userAgentData.getHighEntropyValues(["architecture","model","platform","platformVersion","fullVersionList"]).then(ua=>{OS_PLATFORM=ua.platform||"";OS_ARCH=ua.architecture||"";OS_MODEL=ua.model||"";OS_PLATFORM_VERSION=ua.platformVersion||"";if(ua.fullVersionList&&ua.fullVersionList.length>0){const firstUa=ua.fullVersionList[ua.fullVersionList.length-1];OS_BROWSER=`${firstUa.brand} ${firstUa.version}`}}).catch(e=>void e)}function isProcessedJSSelfProfile(profile){return!("thread_metadata"in profile)}function enrichWithThreadInformation(profile){if(!isProcessedJSSelfProfile(profile)){return profile}return convertJSSelfProfileToSampledFormat(profile)}function getTraceId(event){const traceId=event&&event.contexts&&event.contexts["trace"]&&event.contexts["trace"]["trace_id"];if(typeof traceId==="string"&&traceId.length!==32){if(debugBuild.DEBUG_BUILD){core.logger.log(`[Profiling] Invalid traceId: ${traceId} on profiled event`)}}if(typeof traceId!=="string"){return""}return traceId}function createProfilePayload(profile_id,start_timestamp,processed_profile,event){if(event.type!=="transaction"){throw new TypeError("Profiling events may only be attached to transactions, this should never occur.")}if(processed_profile===undefined||processed_profile===null){throw new TypeError(`Cannot construct profiling event envelope without a valid profile. Got ${processed_profile} instead.`)}const traceId=getTraceId(event);const enrichedThreadProfile=enrichWithThreadInformation(processed_profile);const transactionStartMs=start_timestamp?start_timestamp:typeof event.start_timestamp==="number"?event.start_timestamp*1e3:core.timestampInSeconds()*1e3;const transactionEndMs=typeof event.timestamp==="number"?event.timestamp*1e3:core.timestampInSeconds()*1e3;const profile={event_id:profile_id,timestamp:new Date(transactionStartMs).toISOString(),platform:"javascript",version:"1",release:event.release||"",environment:event.environment||core.DEFAULT_ENVIRONMENT,runtime:{name:"javascript",version:helpers.WINDOW.navigator.userAgent},os:{name:OS_PLATFORM,version:OS_PLATFORM_VERSION,build_number:OS_BROWSER},device:{locale:OS_LOCALE,model:OS_MODEL,manufacturer:OS_BROWSER,architecture:OS_ARCH,is_emulator:false},debug_meta:{images:applyDebugMetadata(processed_profile.resources)},profile:enrichedThreadProfile,transactions:[{name:event.transaction||"",id:event.event_id||core.uuid4(),trace_id:traceId,active_thread_id:THREAD_ID_STRING,relative_start_ns:"0",relative_end_ns:((transactionEndMs-transactionStartMs)*1e6).toFixed(0)}]};return profile}function isAutomatedPageLoadSpan(span){return core.spanToJSON(span).op==="pageload"}function convertJSSelfProfileToSampledFormat(input){let EMPTY_STACK_ID=undefined;let STACK_ID=0;const profile={samples:[],stacks:[],frames:[],thread_metadata:{[THREAD_ID_STRING]:{name:THREAD_NAME}}};const firstSample=input.samples[0];if(!firstSample){return profile}const start=firstSample.timestamp;const origin=typeof performance.timeOrigin==="number"?performance.timeOrigin:core.browserPerformanceTimeOrigin||0;const adjustForOriginChange=origin-(core.browserPerformanceTimeOrigin||origin);input.samples.forEach((jsSample,i)=>{if(jsSample.stackId===undefined){if(EMPTY_STACK_ID===undefined){EMPTY_STACK_ID=STACK_ID;profile.stacks[EMPTY_STACK_ID]=[];STACK_ID++}profile["samples"][i]={elapsed_since_start_ns:((jsSample.timestamp+adjustForOriginChange-start)*MS_TO_NS).toFixed(0),stack_id:EMPTY_STACK_ID,thread_id:THREAD_ID_STRING};return}let stackTop=input.stacks[jsSample.stackId];const stack=[];while(stackTop){stack.push(stackTop.frameId);const frame=input.frames[stackTop.frameId];if(frame&&profile.frames[stackTop.frameId]===undefined){profile.frames[stackTop.frameId]={function:frame.name,abs_path:typeof frame.resourceId==="number"?input.resources[frame.resourceId]:undefined,lineno:frame.line,colno:frame.column}}stackTop=stackTop.parentId===undefined?undefined:input.stacks[stackTop.parentId]}const sample={elapsed_since_start_ns:((jsSample.timestamp+adjustForOriginChange-start)*MS_TO_NS).toFixed(0),stack_id:STACK_ID,thread_id:THREAD_ID_STRING};profile["stacks"][STACK_ID]=stack;profile["samples"][i]=sample;STACK_ID++});return profile}function addProfilesToEnvelope(envelope,profiles){if(!profiles.length){return envelope}for(const profile of profiles){envelope[1].push([{type:"profile"},profile])}return envelope}function findProfiledTransactionsFromEnvelope(envelope){const events=[];core.forEachEnvelopeItem(envelope,(item,type)=>{if(type!=="transaction"){return}for(let j=1;j<item.length;j++){const event=item[j];if(event&&event.contexts&&event.contexts["profile"]&&event.contexts["profile"]["profile_id"]){events.push(item[j])}}});return events}function applyDebugMetadata(resource_paths){const client=core.getClient();const options=client&&client.getOptions();const stackParser=options&&options.stackParser;if(!stackParser){return[]}return core.getDebugImagesForResources(stackParser,resource_paths)}function isValidSampleRate(rate){if(typeof rate!=="number"&&typeof rate!=="boolean"||typeof rate==="number"&&isNaN(rate)){debugBuild.DEBUG_BUILD&&core.logger.warn(`[Profiling] Invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(rate)} of type ${JSON.stringify(typeof rate)}.`);return false}if(rate===true||rate===false){return true}if(rate<0||rate>1){debugBuild.DEBUG_BUILD&&core.logger.warn(`[Profiling] Invalid sample rate. Sample rate must be between 0 and 1. Got ${rate}.`);return false}return true}function isValidProfile(profile){if(profile.samples.length<2){if(debugBuild.DEBUG_BUILD){core.logger.log("[Profiling] Discarding profile because it contains less than 2 samples")}return false}if(!profile.frames.length){if(debugBuild.DEBUG_BUILD){core.logger.log("[Profiling] Discarding profile because it contains no frames")}return false}return true}let PROFILING_CONSTRUCTOR_FAILED=false;const MAX_PROFILE_DURATION_MS=3e4;function isJSProfilerSupported(maybeProfiler){return typeof maybeProfiler==="function"}function startJSSelfProfile(){const JSProfilerConstructor=helpers.WINDOW.Profiler;if(!isJSProfilerSupported(JSProfilerConstructor)){if(debugBuild.DEBUG_BUILD){core.logger.log("[Profiling] Profiling is not supported by this browser, Profiler interface missing on window object.")}return}const samplingIntervalMS=10;const maxSamples=Math.floor(MAX_PROFILE_DURATION_MS/samplingIntervalMS);try{return new JSProfilerConstructor({sampleInterval:samplingIntervalMS,maxBufferSize:maxSamples})}catch(e){if(debugBuild.DEBUG_BUILD){core.logger.log("[Profiling] Failed to initialize the Profiling constructor, this is likely due to a missing 'Document-Policy': 'js-profiling' header.");core.logger.log("[Profiling] Disabling profiling for current user session.")}PROFILING_CONSTRUCTOR_FAILED=true}return}function shouldProfileSpan(span){if(PROFILING_CONSTRUCTOR_FAILED){if(debugBuild.DEBUG_BUILD){core.logger.log("[Profiling] Profiling has been disabled for the duration of the current user session.")}return false}if(!span.isRecording()){if(debugBuild.DEBUG_BUILD){core.logger.log("[Profiling] Discarding profile because transaction was not sampled.")}return false}const client=core.getClient();const options=client&&client.getOptions();if(!options){debugBuild.DEBUG_BUILD&&core.logger.log("[Profiling] Profiling disabled, no options found.");return false}const profilesSampleRate=options.profilesSampleRate;if(!isValidSampleRate(profilesSampleRate)){debugBuild.DEBUG_BUILD&&core.logger.warn("[Profiling] Discarding profile because of invalid sample rate.");return false}if(!profilesSampleRate){debugBuild.DEBUG_BUILD&&core.logger.log("[Profiling] Discarding profile because a negative sampling decision was inherited or profileSampleRate is set to 0");return false}const sampled=profilesSampleRate===true?true:Math.random()<profilesSampleRate;if(!sampled){debugBuild.DEBUG_BUILD&&core.logger.log(`[Profiling] Discarding profile because it's not included in the random sample (sampling rate = ${Number(profilesSampleRate)})`);return false}return true}function createProfilingEvent(profile_id,start_timestamp,profile,event){if(!isValidProfile(profile)){return null}return createProfilePayload(profile_id,start_timestamp,profile,event)}const PROFILE_MAP=new Map;function getActiveProfilesCount(){return PROFILE_MAP.size}function takeProfileFromGlobalCache(profile_id){const profile=PROFILE_MAP.get(profile_id);if(profile){PROFILE_MAP.delete(profile_id)}return profile}function addProfileToGlobalCache(profile_id,profile){PROFILE_MAP.set(profile_id,profile);if(PROFILE_MAP.size>30){const last=PROFILE_MAP.keys().next().value;PROFILE_MAP.delete(last)}}exports.MAX_PROFILE_DURATION_MS=MAX_PROFILE_DURATION_MS;exports.addProfileToGlobalCache=addProfileToGlobalCache;exports.addProfilesToEnvelope=addProfilesToEnvelope;exports.applyDebugMetadata=applyDebugMetadata;exports.convertJSSelfProfileToSampledFormat=convertJSSelfProfileToSampledFormat;exports.createProfilePayload=createProfilePayload;exports.createProfilingEvent=createProfilingEvent;exports.enrichWithThreadInformation=enrichWithThreadInformation;exports.findProfiledTransactionsFromEnvelope=findProfiledTransactionsFromEnvelope;exports.getActiveProfilesCount=getActiveProfilesCount;exports.isAutomatedPageLoadSpan=isAutomatedPageLoadSpan;exports.isValidSampleRate=isValidSampleRate;exports.shouldProfileSpan=shouldProfileSpan;exports.startJSSelfProfile=startJSSelfProfile;exports.takeProfileFromGlobalCache=takeProfileFromGlobalCache},{"../debug-build.js":37,"../helpers.js":41,"@sentry/core":87}],60:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const client=require("./client.js");const debugBuild=require("./debug-build.js");const helpers=require("./helpers.js");const breadcrumbs=require("./integrations/breadcrumbs.js");const browserapierrors=require("./integrations/browserapierrors.js");const browsersession=require("./integrations/browsersession.js");const globalhandlers=require("./integrations/globalhandlers.js");const httpcontext=require("./integrations/httpcontext.js");const linkederrors=require("./integrations/linkederrors.js");const stackParsers=require("./stack-parsers.js");const fetch=require("./transports/fetch.js");function getDefaultIntegrations(options){const integrations=[core.inboundFiltersIntegration(),core.functionToStringIntegration(),browserapierrors.browserApiErrorsIntegration(),breadcrumbs.breadcrumbsIntegration(),globalhandlers.globalHandlersIntegration(),linkederrors.linkedErrorsIntegration(),core.dedupeIntegration(),httpcontext.httpContextIntegration()];if(options.autoSessionTracking!==false){integrations.push(browsersession.browserSessionIntegration())}return integrations}function applyDefaultOptions(optionsArg={}){const defaultOptions={defaultIntegrations:getDefaultIntegrations(optionsArg),release:typeof __SENTRY_RELEASE__==="string"?__SENTRY_RELEASE__:helpers.WINDOW.SENTRY_RELEASE&&helpers.WINDOW.SENTRY_RELEASE.id?helpers.WINDOW.SENTRY_RELEASE.id:undefined,autoSessionTracking:true,sendClientReports:true};if(optionsArg.defaultIntegrations==null){delete optionsArg.defaultIntegrations}return{...defaultOptions,...optionsArg}}function shouldShowBrowserExtensionError(){const windowWithMaybeExtension=typeof helpers.WINDOW.window!=="undefined"&&helpers.WINDOW;if(!windowWithMaybeExtension){return false}const extensionKey=windowWithMaybeExtension.chrome?"chrome":"browser";const extensionObject=windowWithMaybeExtension[extensionKey];const runtimeId=extensionObject&&extensionObject.runtime&&extensionObject.runtime.id;const href=helpers.WINDOW.location&&helpers.WINDOW.location.href||"";const extensionProtocols=["chrome-extension:","moz-extension:","ms-browser-extension:","safari-web-extension:"];const isDedicatedExtensionPage=!!runtimeId&&helpers.WINDOW===helpers.WINDOW.top&&extensionProtocols.some(protocol=>href.startsWith(`${protocol}//`));const isNWjs=typeof windowWithMaybeExtension.nw!=="undefined";return!!runtimeId&&!isDedicatedExtensionPage&&!isNWjs}function init(browserOptions={}){const options=applyDefaultOptions(browserOptions);if(!options.skipBrowserExtensionCheck&&shouldShowBrowserExtensionError()){core.consoleSandbox(()=>{console.error("[Sentry] You cannot run Sentry this way in a browser extension, check: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")});return}if(debugBuild.DEBUG_BUILD){if(!core.supportsFetch()){core.logger.warn("No Fetch API detected. The Sentry SDK requires a Fetch API compatible environment to send events. Please add a Fetch API polyfill.")}}const clientOptions={...options,stackParser:core.stackParserFromStackParserOptions(options.stackParser||stackParsers.defaultStackParser),integrations:core.getIntegrationsToSetup(options),transport:options.transport||fetch.makeFetchTransport};return core.initAndBind(client.BrowserClient,clientOptions)}function showReportDialog(options={}){if(!helpers.WINDOW.document){debugBuild.DEBUG_BUILD&&core.logger.error("Global document not defined in showReportDialog call");return}const scope=core.getCurrentScope();const client=scope.getClient();const dsn=client&&client.getDsn();if(!dsn){debugBuild.DEBUG_BUILD&&core.logger.error("DSN not configured for showReportDialog call");return}if(scope){options.user={...scope.getUser(),...options.user}}if(!options.eventId){const eventId=core.lastEventId();if(eventId){options.eventId=eventId}}const script=helpers.WINDOW.document.createElement("script");script.async=true;script.crossOrigin="anonymous";script.src=core.getReportDialogEndpoint(dsn,options);if(options.onLoad){script.onload=options.onLoad}const{onClose}=options;if(onClose){const reportDialogClosedMessageHandler=event=>{if(event.data==="__sentry_reportdialog_closed__"){try{onClose()}finally{helpers.WINDOW.removeEventListener("message",reportDialogClosedMessageHandler)}}};helpers.WINDOW.addEventListener("message",reportDialogClosedMessageHandler)}const injectionPoint=helpers.WINDOW.document.head||helpers.WINDOW.document.body;if(injectionPoint){injectionPoint.appendChild(script)}else{debugBuild.DEBUG_BUILD&&core.logger.error("Not injecting report dialog. No injection point found in HTML")}}function forceLoad(){}function onLoad(callback){callback()}function captureUserFeedback(feedback){const client=core.getClient();if(client){client.captureUserFeedback(feedback)}}exports.captureUserFeedback=captureUserFeedback;exports.forceLoad=forceLoad;exports.getDefaultIntegrations=getDefaultIntegrations;exports.init=init;exports.onLoad=onLoad;exports.showReportDialog=showReportDialog},{"./client.js":36,"./debug-build.js":37,"./helpers.js":41,"./integrations/breadcrumbs.js":43,"./integrations/browserapierrors.js":44,"./integrations/browsersession.js":45,"./integrations/globalhandlers.js":50,"./integrations/httpcontext.js":52,"./integrations/linkederrors.js":53,"./stack-parsers.js":61,"./transports/fetch.js":65,"@sentry/core":87}],61:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const OPERA10_PRIORITY=10;const OPERA11_PRIORITY=20;const CHROME_PRIORITY=30;const WINJS_PRIORITY=40;const GECKO_PRIORITY=50;function createFrame(filename,func,lineno,colno){const frame={filename:filename,function:func==="<anonymous>"?core.UNKNOWN_FUNCTION:func,in_app:true};if(lineno!==undefined){frame.lineno=lineno}if(colno!==undefined){frame.colno=colno}return frame}const chromeRegexNoFnName=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i;const chromeRegex=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i;const chromeEvalRegex=/\((\S*)(?::(\d+))(?::(\d+))\)/;const chromeStackParserFn=line=>{const noFnParts=chromeRegexNoFnName.exec(line);if(noFnParts){const[,filename,line,col]=noFnParts;return createFrame(filename,core.UNKNOWN_FUNCTION,+line,+col)}const parts=chromeRegex.exec(line);if(parts){const isEval=parts[2]&&parts[2].indexOf("eval")===0;if(isEval){const subMatch=chromeEvalRegex.exec(parts[2]);if(subMatch){parts[2]=subMatch[1];parts[3]=subMatch[2];parts[4]=subMatch[3]}}const[func,filename]=extractSafariExtensionDetails(parts[1]||core.UNKNOWN_FUNCTION,parts[2]);return createFrame(filename,func,parts[3]?+parts[3]:undefined,parts[4]?+parts[4]:undefined)}return};const chromeStackLineParser=[CHROME_PRIORITY,chromeStackParserFn];const geckoREgex=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i;const geckoEvalRegex=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i;const gecko=line=>{const parts=geckoREgex.exec(line);if(parts){const isEval=parts[3]&&parts[3].indexOf(" > eval")>-1;if(isEval){const subMatch=geckoEvalRegex.exec(parts[3]);if(subMatch){parts[1]=parts[1]||"eval";parts[3]=subMatch[1];parts[4]=subMatch[2];parts[5]=""}}let filename=parts[3];let func=parts[1]||core.UNKNOWN_FUNCTION;[func,filename]=extractSafariExtensionDetails(func,filename);return createFrame(filename,func,parts[4]?+parts[4]:undefined,parts[5]?+parts[5]:undefined)}return};const geckoStackLineParser=[GECKO_PRIORITY,gecko];const winjsRegex=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i;const winjs=line=>{const parts=winjsRegex.exec(line);return parts?createFrame(parts[2],parts[1]||core.UNKNOWN_FUNCTION,+parts[3],parts[4]?+parts[4]:undefined):undefined};const winjsStackLineParser=[WINJS_PRIORITY,winjs];const opera10Regex=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i;const opera10=line=>{const parts=opera10Regex.exec(line);return parts?createFrame(parts[2],parts[3]||core.UNKNOWN_FUNCTION,+parts[1]):undefined};const opera10StackLineParser=[OPERA10_PRIORITY,opera10];const opera11Regex=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\(.*\))? in (.*):\s*$/i;const opera11=line=>{const parts=opera11Regex.exec(line);return parts?createFrame(parts[5],parts[3]||parts[4]||core.UNKNOWN_FUNCTION,+parts[1],+parts[2]):undefined};const opera11StackLineParser=[OPERA11_PRIORITY,opera11];const defaultStackLineParsers=[chromeStackLineParser,geckoStackLineParser];const defaultStackParser=core.createStackParser(...defaultStackLineParsers);const extractSafariExtensionDetails=(func,filename)=>{const isSafariExtension=func.indexOf("safari-extension")!==-1;const isSafariWebExtension=func.indexOf("safari-web-extension")!==-1;return isSafariExtension||isSafariWebExtension?[func.indexOf("@")!==-1?func.split("@")[0]:core.UNKNOWN_FUNCTION,isSafariExtension?`safari-extension:${filename}`:`safari-web-extension:${filename}`]:[func,filename]};exports.chromeStackLineParser=chromeStackLineParser;exports.defaultStackLineParsers=defaultStackLineParsers;exports.defaultStackParser=defaultStackParser;exports.geckoStackLineParser=geckoStackLineParser;exports.opera10StackLineParser=opera10StackLineParser;exports.opera11StackLineParser=opera11StackLineParser;exports.winjsStackLineParser=winjsStackLineParser},{"@sentry/core":87}],62:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const debugBuild=require("../debug-build.js");const helpers=require("../helpers.js");function registerBackgroundTabDetection(){if(helpers.WINDOW&&helpers.WINDOW.document){helpers.WINDOW.document.addEventListener("visibilitychange",()=>{const activeSpan=core.getActiveSpan();if(!activeSpan){return}const rootSpan=core.getRootSpan(activeSpan);if(helpers.WINDOW.document.hidden&&rootSpan){const cancelledStatus="cancelled";const{op,status}=core.spanToJSON(rootSpan);if(debugBuild.DEBUG_BUILD){core.logger.log(`[Tracing] Transaction: ${cancelledStatus} -> since tab moved to the background, op: ${op}`)}if(!status){rootSpan.setStatus({code:core.SPAN_STATUS_ERROR,message:cancelledStatus})}rootSpan.setAttribute("sentry.cancellation_reason","document.hidden");rootSpan.end()}})}else{debugBuild.DEBUG_BUILD&&core.logger.warn("[Tracing] Could not set up background tab detection due to lack of global document")}}exports.registerBackgroundTabDetection=registerBackgroundTabDetection},{"../debug-build.js":37,"../helpers.js":41,"@sentry/core":87}],63:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const browserUtils=require("@sentry-internal/browser-utils");const core=require("@sentry/core");const debugBuild=require("../debug-build.js");const helpers=require("../helpers.js");const backgroundtab=require("./backgroundtab.js");const request=require("./request.js");const BROWSER_TRACING_INTEGRATION_ID="BrowserTracing";const DEFAULT_BROWSER_TRACING_OPTIONS={...core.TRACING_DEFAULTS,instrumentNavigation:true,instrumentPageLoad:true,markBackgroundSpan:true,enableLongTask:true,enableLongAnimationFrame:true,enableInp:true,_experiments:{},...request.defaultRequestInstrumentationOptions};const browserTracingIntegration=(_options={})=>{core.registerSpanErrorInstrumentation();const{enableInp,enableLongTask,enableLongAnimationFrame,_experiments:{enableInteractions,enableStandaloneClsSpans},beforeStartSpan,idleTimeout,finalTimeout,childSpanTimeout,markBackgroundSpan,traceFetch,traceXHR,trackFetchStreamPerformance,shouldCreateSpanForRequest,enableHTTPTimings,instrumentPageLoad,instrumentNavigation}={...DEFAULT_BROWSER_TRACING_OPTIONS,..._options};const _collectWebVitals=browserUtils.startTrackingWebVitals({recordClsStandaloneSpans:enableStandaloneClsSpans||false});if(enableInp){browserUtils.startTrackingINP()}if(enableLongAnimationFrame&&core.GLOBAL_OBJ.PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("long-animation-frame")){browserUtils.startTrackingLongAnimationFrames()}else if(enableLongTask){browserUtils.startTrackingLongTasks()}if(enableInteractions){browserUtils.startTrackingInteractions()}const latestRoute={name:undefined,source:undefined};function _createRouteSpan(client,startSpanOptions){const isPageloadTransaction=startSpanOptions.op==="pageload";const finalStartSpanOptions=beforeStartSpan?beforeStartSpan(startSpanOptions):startSpanOptions;const attributes=finalStartSpanOptions.attributes||{};if(startSpanOptions.name!==finalStartSpanOptions.name){attributes[core.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]="custom";finalStartSpanOptions.attributes=attributes}latestRoute.name=finalStartSpanOptions.name;latestRoute.source=attributes[core.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE];const idleSpan=core.startIdleSpan(finalStartSpanOptions,{idleTimeout:idleTimeout,finalTimeout:finalTimeout,childSpanTimeout:childSpanTimeout,disableAutoFinish:isPageloadTransaction,beforeSpanEnd:span=>{_collectWebVitals();browserUtils.addPerformanceEntries(span,{recordClsOnPageloadSpan:!enableStandaloneClsSpans})}});function emitFinish(){if(["interactive","complete"].includes(helpers.WINDOW.document.readyState)){client.emit("idleSpanEnableAutoFinish",idleSpan)}}if(isPageloadTransaction&&helpers.WINDOW.document){helpers.WINDOW.document.addEventListener("readystatechange",()=>{emitFinish()});emitFinish()}return idleSpan}return{name:BROWSER_TRACING_INTEGRATION_ID,afterAllSetup(client){let activeSpan;let startingUrl=helpers.WINDOW.location&&helpers.WINDOW.location.href;function maybeEndActiveSpan(){if(activeSpan&&!core.spanToJSON(activeSpan).timestamp){debugBuild.DEBUG_BUILD&&core.logger.log(`[Tracing] Finishing current active span with op: ${core.spanToJSON(activeSpan).op}`);activeSpan.end()}}client.on("startNavigationSpan",startSpanOptions=>{if(core.getClient()!==client){return}maybeEndActiveSpan();activeSpan=_createRouteSpan(client,{op:"navigation",...startSpanOptions})});client.on("startPageLoadSpan",(startSpanOptions,traceOptions={})=>{if(core.getClient()!==client){return}maybeEndActiveSpan();const sentryTrace=traceOptions.sentryTrace||getMetaContent("sentry-trace");const baggage=traceOptions.baggage||getMetaContent("baggage");const propagationContext=core.propagationContextFromHeaders(sentryTrace,baggage);core.getCurrentScope().setPropagationContext(propagationContext);activeSpan=_createRouteSpan(client,{op:"pageload",...startSpanOptions})});client.on("spanEnd",span=>{const op=core.spanToJSON(span).op;if(span!==core.getRootSpan(span)||op!=="navigation"&&op!=="pageload"){return}const scope=core.getCurrentScope();const oldPropagationContext=scope.getPropagationContext();scope.setPropagationContext({...oldPropagationContext,sampled:oldPropagationContext.sampled!==undefined?oldPropagationContext.sampled:core.spanIsSampled(span),dsc:oldPropagationContext.dsc||core.getDynamicSamplingContextFromSpan(span)})});if(helpers.WINDOW.location){if(instrumentPageLoad){startBrowserTracingPageLoadSpan(client,{name:helpers.WINDOW.location.pathname,startTime:core.browserPerformanceTimeOrigin?core.browserPerformanceTimeOrigin/1e3:undefined,attributes:{[core.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"url",[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.pageload.browser"}})}if(instrumentNavigation){browserUtils.addHistoryInstrumentationHandler(({to,from})=>{if(from===undefined&&startingUrl&&startingUrl.indexOf(to)!==-1){startingUrl=undefined;return}if(from!==to){startingUrl=undefined;startBrowserTracingNavigationSpan(client,{name:helpers.WINDOW.location.pathname,attributes:{[core.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"url",[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.navigation.browser"}})}})}}if(markBackgroundSpan){backgroundtab.registerBackgroundTabDetection()}if(enableInteractions){registerInteractionListener(idleTimeout,finalTimeout,childSpanTimeout,latestRoute)}if(enableInp){browserUtils.registerInpInteractionListener()}request.instrumentOutgoingRequests(client,{traceFetch:traceFetch,traceXHR:traceXHR,trackFetchStreamPerformance:trackFetchStreamPerformance,tracePropagationTargets:client.getOptions().tracePropagationTargets,shouldCreateSpanForRequest:shouldCreateSpanForRequest,enableHTTPTimings:enableHTTPTimings})}}};function startBrowserTracingPageLoadSpan(client,spanOptions,traceOptions){client.emit("startPageLoadSpan",spanOptions,traceOptions);core.getCurrentScope().setTransactionName(spanOptions.name);const span=core.getActiveSpan();const op=span&&core.spanToJSON(span).op;return op==="pageload"?span:undefined}function startBrowserTracingNavigationSpan(client,spanOptions){core.getIsolationScope().setPropagationContext({traceId:core.generateTraceId()});core.getCurrentScope().setPropagationContext({traceId:core.generateTraceId()});client.emit("startNavigationSpan",spanOptions);core.getCurrentScope().setTransactionName(spanOptions.name);const span=core.getActiveSpan();const op=span&&core.spanToJSON(span).op;return op==="navigation"?span:undefined}function getMetaContent(metaName){const metaTag=core.getDomElement(`meta[name=${metaName}]`);return metaTag?metaTag.getAttribute("content"):undefined}function registerInteractionListener(idleTimeout,finalTimeout,childSpanTimeout,latestRoute){let inflightInteractionSpan;const registerInteractionTransaction=()=>{const op="ui.action.click";const activeSpan=core.getActiveSpan();const rootSpan=activeSpan&&core.getRootSpan(activeSpan);if(rootSpan){const currentRootSpanOp=core.spanToJSON(rootSpan).op;if(["navigation","pageload"].includes(currentRootSpanOp)){debugBuild.DEBUG_BUILD&&core.logger.warn(`[Tracing] Did not create ${op} span because a pageload or navigation span is in progress.`);return undefined}}if(inflightInteractionSpan){inflightInteractionSpan.setAttribute(core.SEMANTIC_ATTRIBUTE_SENTRY_IDLE_SPAN_FINISH_REASON,"interactionInterrupted");inflightInteractionSpan.end();inflightInteractionSpan=undefined}if(!latestRoute.name){debugBuild.DEBUG_BUILD&&core.logger.warn(`[Tracing] Did not create ${op} transaction because _latestRouteName is missing.`);return undefined}inflightInteractionSpan=core.startIdleSpan({name:latestRoute.name,op:op,attributes:{[core.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:latestRoute.source||"url"}},{idleTimeout:idleTimeout,finalTimeout:finalTimeout,childSpanTimeout:childSpanTimeout})};if(helpers.WINDOW.document){addEventListener("click",registerInteractionTransaction,{once:false,capture:true})}}exports.BROWSER_TRACING_INTEGRATION_ID=BROWSER_TRACING_INTEGRATION_ID;exports.browserTracingIntegration=browserTracingIntegration;exports.getMetaContent=getMetaContent;exports.startBrowserTracingNavigationSpan=startBrowserTracingNavigationSpan;exports.startBrowserTracingPageLoadSpan=startBrowserTracingPageLoadSpan},{"../debug-build.js":37,"../helpers.js":41,"./backgroundtab.js":62,"./request.js":64,"@sentry-internal/browser-utils":4,"@sentry/core":87}],64:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const browserUtils=require("@sentry-internal/browser-utils");const core=require("@sentry/core");const helpers=require("../helpers.js");const responseToSpanId=new WeakMap;const spanIdToEndTimestamp=new Map;const defaultRequestInstrumentationOptions={traceFetch:true,traceXHR:true,enableHTTPTimings:true,trackFetchStreamPerformance:false};function instrumentOutgoingRequests(client,_options){const{traceFetch,traceXHR,trackFetchStreamPerformance,shouldCreateSpanForRequest,enableHTTPTimings,tracePropagationTargets}={traceFetch:defaultRequestInstrumentationOptions.traceFetch,traceXHR:defaultRequestInstrumentationOptions.traceXHR,trackFetchStreamPerformance:defaultRequestInstrumentationOptions.trackFetchStreamPerformance,..._options};const shouldCreateSpan=typeof shouldCreateSpanForRequest==="function"?shouldCreateSpanForRequest:_=>true;const shouldAttachHeadersWithTargets=url=>shouldAttachHeaders(url,tracePropagationTargets);const spans={};if(traceFetch){client.addEventProcessor(event=>{if(event.type==="transaction"&&event.spans){event.spans.forEach(span=>{if(span.op==="http.client"){const updatedTimestamp=spanIdToEndTimestamp.get(span.span_id);if(updatedTimestamp){span.timestamp=updatedTimestamp/1e3;spanIdToEndTimestamp.delete(span.span_id)}}})}return event});if(trackFetchStreamPerformance){core.addFetchEndInstrumentationHandler(handlerData=>{if(handlerData.response){const span=responseToSpanId.get(handlerData.response);if(span&&handlerData.endTimestamp){spanIdToEndTimestamp.set(span,handlerData.endTimestamp)}}})}core.addFetchInstrumentationHandler(handlerData=>{const createdSpan=core.instrumentFetchRequest(handlerData,shouldCreateSpan,shouldAttachHeadersWithTargets,spans);if(handlerData.response&&handlerData.fetchData.__span){responseToSpanId.set(handlerData.response,handlerData.fetchData.__span)}if(createdSpan){const fullUrl=getFullURL(handlerData.fetchData.url);const host=fullUrl?core.parseUrl(fullUrl).host:undefined;createdSpan.setAttributes({"http.url":fullUrl,"server.address":host})}if(enableHTTPTimings&&createdSpan){addHTTPTimings(createdSpan)}})}if(traceXHR){browserUtils.addXhrInstrumentationHandler(handlerData=>{const createdSpan=xhrCallback(handlerData,shouldCreateSpan,shouldAttachHeadersWithTargets,spans);if(enableHTTPTimings&&createdSpan){addHTTPTimings(createdSpan)}})}}function isPerformanceResourceTiming(entry){return entry.entryType==="resource"&&"initiatorType"in entry&&typeof entry.nextHopProtocol==="string"&&(entry.initiatorType==="fetch"||entry.initiatorType==="xmlhttprequest")}function addHTTPTimings(span){const{url}=core.spanToJSON(span).data||{};if(!url||typeof url!=="string"){return}const cleanup=browserUtils.addPerformanceInstrumentationHandler("resource",({entries})=>{entries.forEach(entry=>{if(isPerformanceResourceTiming(entry)&&entry.name.endsWith(url)){const spanData=resourceTimingEntryToSpanData(entry);spanData.forEach(data=>span.setAttribute(...data));setTimeout(cleanup)}})})}function extractNetworkProtocol(nextHopProtocol){let name="unknown";let version="unknown";let _name="";for(const char of nextHopProtocol){if(char==="/"){[name,version]=nextHopProtocol.split("/");break}if(!isNaN(Number(char))){name=_name==="h"?"http":_name;version=nextHopProtocol.split(_name)[1];break}_name+=char}if(_name===nextHopProtocol){name=_name}return{name:name,version:version}}function getAbsoluteTime(time=0){return((core.browserPerformanceTimeOrigin||performance.timeOrigin)+time)/1e3}function resourceTimingEntryToSpanData(resourceTiming){const{name,version}=extractNetworkProtocol(resourceTiming.nextHopProtocol);const timingSpanData=[];timingSpanData.push(["network.protocol.version",version],["network.protocol.name",name]);if(!core.browserPerformanceTimeOrigin){return timingSpanData}return[...timingSpanData,["http.request.redirect_start",getAbsoluteTime(resourceTiming.redirectStart)],["http.request.fetch_start",getAbsoluteTime(resourceTiming.fetchStart)],["http.request.domain_lookup_start",getAbsoluteTime(resourceTiming.domainLookupStart)],["http.request.domain_lookup_end",getAbsoluteTime(resourceTiming.domainLookupEnd)],["http.request.connect_start",getAbsoluteTime(resourceTiming.connectStart)],["http.request.secure_connection_start",getAbsoluteTime(resourceTiming.secureConnectionStart)],["http.request.connection_end",getAbsoluteTime(resourceTiming.connectEnd)],["http.request.request_start",getAbsoluteTime(resourceTiming.requestStart)],["http.request.response_start",getAbsoluteTime(resourceTiming.responseStart)],["http.request.response_end",getAbsoluteTime(resourceTiming.responseEnd)]]}function shouldAttachHeaders(targetUrl,tracePropagationTargets){const href=helpers.WINDOW.location&&helpers.WINDOW.location.href;if(!href){const isRelativeSameOriginRequest=!!targetUrl.match(/^\/(?!\/)/);if(!tracePropagationTargets){return isRelativeSameOriginRequest}else{return core.stringMatchesSomePattern(targetUrl,tracePropagationTargets)}}else{let resolvedUrl;let currentOrigin;try{resolvedUrl=new URL(targetUrl,href);currentOrigin=new URL(href).origin}catch(e){return false}const isSameOriginRequest=resolvedUrl.origin===currentOrigin;if(!tracePropagationTargets){return isSameOriginRequest}else{return core.stringMatchesSomePattern(resolvedUrl.toString(),tracePropagationTargets)||isSameOriginRequest&&core.stringMatchesSomePattern(resolvedUrl.pathname,tracePropagationTargets)}}}function xhrCallback(handlerData,shouldCreateSpan,shouldAttachHeaders,spans){const xhr=handlerData.xhr;const sentryXhrData=xhr&&xhr[browserUtils.SENTRY_XHR_DATA_KEY];if(!xhr||xhr.__sentry_own_request__||!sentryXhrData){return undefined}const shouldCreateSpanResult=core.hasTracingEnabled()&&shouldCreateSpan(sentryXhrData.url);if(handlerData.endTimestamp&&shouldCreateSpanResult){const spanId=xhr.__sentry_xhr_span_id__;if(!spanId)return;const span=spans[spanId];if(span&&sentryXhrData.status_code!==undefined){core.setHttpStatus(span,sentryXhrData.status_code);span.end();delete spans[spanId]}return undefined}const fullUrl=getFullURL(sentryXhrData.url);const host=fullUrl?core.parseUrl(fullUrl).host:undefined;const hasParent=!!core.getActiveSpan();const span=shouldCreateSpanResult&&hasParent?core.startInactiveSpan({name:`${sentryXhrData.method} ${sentryXhrData.url}`,attributes:{type:"xhr","http.method":sentryXhrData.method,"http.url":fullUrl,url:sentryXhrData.url,"server.address":host,[core.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.http.browser",[core.SEMANTIC_ATTRIBUTE_SENTRY_OP]:"http.client"}}):new core.SentryNonRecordingSpan;xhr.__sentry_xhr_span_id__=span.spanContext().spanId;spans[xhr.__sentry_xhr_span_id__]=span;if(shouldAttachHeaders(sentryXhrData.url)){addTracingHeadersToXhrRequest(xhr,core.hasTracingEnabled()&&hasParent?span:undefined)}return span}function addTracingHeadersToXhrRequest(xhr,span){const{"sentry-trace":sentryTrace,baggage}=core.getTraceData({span:span});if(sentryTrace){setHeaderOnXhr(xhr,sentryTrace,baggage)}}function setHeaderOnXhr(xhr,sentryTraceHeader,sentryBaggageHeader){try{xhr.setRequestHeader("sentry-trace",sentryTraceHeader);if(sentryBaggageHeader){xhr.setRequestHeader("baggage",sentryBaggageHeader)}}catch(_){}}function getFullURL(url){try{const parsed=new URL(url,helpers.WINDOW.location.origin);return parsed.href}catch(e2){return undefined}}exports.defaultRequestInstrumentationOptions=defaultRequestInstrumentationOptions;exports.extractNetworkProtocol=extractNetworkProtocol;exports.instrumentOutgoingRequests=instrumentOutgoingRequests;exports.shouldAttachHeaders=shouldAttachHeaders;exports.xhrCallback=xhrCallback},{"../helpers.js":41,"@sentry-internal/browser-utils":4,"@sentry/core":87}],65:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const browserUtils=require("@sentry-internal/browser-utils");const core=require("@sentry/core");function makeFetchTransport(options,nativeFetch=browserUtils.getNativeImplementation("fetch")){let pendingBodySize=0;let pendingCount=0;function makeRequest(request){const requestSize=request.body.length;pendingBodySize+=requestSize;pendingCount++;const requestOptions={body:request.body,method:"POST",referrerPolicy:"origin",headers:options.headers,keepalive:pendingBodySize<=6e4&&pendingCount<15,...options.fetchOptions};if(!nativeFetch){browserUtils.clearCachedImplementation("fetch");return core.rejectedSyncPromise("No fetch implementation available")}try{return nativeFetch(options.url,requestOptions).then(response=>{pendingBodySize-=requestSize;pendingCount--;return{statusCode:response.status,headers:{"x-sentry-rate-limits":response.headers.get("X-Sentry-Rate-Limits"),"retry-after":response.headers.get("Retry-After")}}})}catch(e){browserUtils.clearCachedImplementation("fetch");pendingBodySize-=requestSize;pendingCount--;return core.rejectedSyncPromise(e)}}return core.createTransport(options,makeRequest)}exports.makeFetchTransport=makeFetchTransport},{"@sentry-internal/browser-utils":4,"@sentry/core":87}],66:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const fetch=require("./fetch.js");function promisifyRequest(request){return new Promise((resolve,reject)=>{request.oncomplete=request.onsuccess=()=>resolve(request.result);request.onabort=request.onerror=()=>reject(request.error)})}function createStore(dbName,storeName){const request=indexedDB.open(dbName);request.onupgradeneeded=()=>request.result.createObjectStore(storeName);const dbp=promisifyRequest(request);return callback=>dbp.then(db=>callback(db.transaction(storeName,"readwrite").objectStore(storeName)))}function keys(store){return promisifyRequest(store.getAllKeys())}function push(store,value,maxQueueSize){return store(store=>{return keys(store).then(keys=>{if(keys.length>=maxQueueSize){return}store.put(value,Math.max(...keys,0)+1);return promisifyRequest(store.transaction)})})}function unshift(store,value,maxQueueSize){return store(store=>{return keys(store).then(keys=>{if(keys.length>=maxQueueSize){return}store.put(value,Math.min(...keys,0)-1);return promisifyRequest(store.transaction)})})}function shift(store){return store(store=>{return keys(store).then(keys=>{const firstKey=keys[0];if(firstKey==null){return undefined}return promisifyRequest(store.get(firstKey)).then(value=>{store.delete(firstKey);return promisifyRequest(store.transaction).then(()=>value)})})})}function createIndexedDbStore(options){let store;function getStore(){if(store==undefined){store=createStore(options.dbName||"sentry-offline",options.storeName||"queue")}return store}return{push:async env=>{try{const serialized=await core.serializeEnvelope(env);await push(getStore(),serialized,options.maxQueueSize||30)}catch(_){}},unshift:async env=>{try{const serialized=await core.serializeEnvelope(env);await unshift(getStore(),serialized,options.maxQueueSize||30)}catch(_){}},shift:async()=>{try{const deserialized=await shift(getStore());if(deserialized){return core.parseEnvelope(deserialized)}}catch(_){}return undefined}}}function makeIndexedDbOfflineTransport(createTransport){return options=>createTransport({...options,createStore:createIndexedDbStore})}function makeBrowserOfflineTransport(createTransport=fetch.makeFetchTransport){return makeIndexedDbOfflineTransport(core.makeOfflineTransport(createTransport))}exports.createStore=createStore;exports.makeBrowserOfflineTransport=makeBrowserOfflineTransport;exports.push=push;exports.shift=shift;exports.unshift=unshift},{"./fetch.js":65,"@sentry/core":87}],67:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");function createUserFeedbackEnvelope(feedback,{metadata,tunnel,dsn}){const headers={event_id:feedback.event_id,sent_at:(new Date).toISOString(),...metadata&&metadata.sdk&&{sdk:{name:metadata.sdk.name,version:metadata.sdk.version}},...!!tunnel&&!!dsn&&{dsn:core.dsnToString(dsn)}};const item=createUserFeedbackEnvelopeItem(feedback);return core.createEnvelope(headers,[item])}function createUserFeedbackEnvelopeItem(feedback){const feedbackHeaders={type:"user_report"};return[feedbackHeaders,feedback]}exports.createUserFeedbackEnvelope=createUserFeedbackEnvelope},{"@sentry/core":87}],68:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const debugBuild=require("../debug-build.js");const FLAG_BUFFER_SIZE=100;function copyFlagsFromScopeToEvent(event){const scope=core.getCurrentScope();const flagContext=scope.getScopeData().contexts.flags;const flagBuffer=flagContext?flagContext.values:[];if(!flagBuffer.length){return event}if(event.contexts===undefined){event.contexts={}}event.contexts.flags={values:[...flagBuffer]};return event}function insertFlagToScope(name,value,maxSize=FLAG_BUFFER_SIZE){const scopeContexts=core.getCurrentScope().getScopeData().contexts;if(!scopeContexts.flags){scopeContexts.flags={values:[]}}const flags=scopeContexts.flags.values;insertToFlagBuffer(flags,name,value,maxSize)}function insertToFlagBuffer(flags,name,value,maxSize){if(typeof value!=="boolean"){return}if(flags.length>maxSize){debugBuild.DEBUG_BUILD&&core.logger.error(`[Feature Flags] insertToFlagBuffer called on a buffer larger than maxSize=${maxSize}`);return}const index=flags.findIndex(f=>f.flag===name);if(index!==-1){flags.splice(index,1)}if(flags.length===maxSize){flags.shift()}flags.push({flag:name,result:value})}exports.FLAG_BUFFER_SIZE=FLAG_BUFFER_SIZE;exports.copyFlagsFromScopeToEvent=copyFlagsFromScopeToEvent;exports.insertFlagToScope=insertFlagToScope;exports.insertToFlagBuffer=insertToFlagBuffer},{"../debug-build.js":37,"@sentry/core":87}],69:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const core=require("@sentry/core");const helpers=require("../helpers.js");const LazyLoadableIntegrations={replayIntegration:"replay",replayCanvasIntegration:"replay-canvas",feedbackIntegration:"feedback",feedbackModalIntegration:"feedback-modal",feedbackScreenshotIntegration:"feedback-screenshot",captureConsoleIntegration:"captureconsole",contextLinesIntegration:"contextlines",linkedErrorsIntegration:"linkederrors",debugIntegration:"debug",dedupeIntegration:"dedupe",extraErrorDataIntegration:"extraerrordata",httpClientIntegration:"httpclient",reportingObserverIntegration:"reportingobserver",rewriteFramesIntegration:"rewriteframes",sessionTimingIntegration:"sessiontiming",browserProfilingIntegration:"browserprofiling",moduleMetadataIntegration:"modulemetadata"};const WindowWithMaybeIntegration=helpers.WINDOW;async function lazyLoadIntegration(name,scriptNonce){const bundle=LazyLoadableIntegrations[name];const sentryOnWindow=WindowWithMaybeIntegration.Sentry=WindowWithMaybeIntegration.Sentry||{};if(!bundle){throw new Error(`Cannot lazy load integration: ${name}`)}const existing=sentryOnWindow[name];if(typeof existing==="function"&&!("_isShim"in existing)){return existing}const url=getScriptURL(bundle);const script=helpers.WINDOW.document.createElement("script");script.src=url;script.crossOrigin="anonymous";script.referrerPolicy="origin";if(scriptNonce){script.setAttribute("nonce",scriptNonce)}const waitForLoad=new Promise((resolve,reject)=>{script.addEventListener("load",()=>resolve());script.addEventListener("error",reject)});const currentScript=helpers.WINDOW.document.currentScript;const parent=helpers.WINDOW.document.body||helpers.WINDOW.document.head||currentScript&&currentScript.parentElement;if(parent){parent.appendChild(script)}else{throw new Error(`Could not find parent element to insert lazy-loaded ${name} script`)}try{await waitForLoad}catch(e){throw new Error(`Error when loading integration: ${name}`)}const integrationFn=sentryOnWindow[name];if(typeof integrationFn!=="function"){throw new Error(`Could not load integration: ${name}`)}return integrationFn}function getScriptURL(bundle){const client=core.getClient();const options=client&&client.getOptions();const baseURL=options&&options.cdnBaseUrl||"https://browser.sentry-cdn.com";return new URL(`/${core.SDK_VERSION}/${bundle}.min.js`,baseURL).toString()}exports.lazyLoadIntegration=lazyLoadIntegration},{"../helpers.js":41,"@sentry/core":87}],70:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const dsn=require("./utils-hoist/dsn.js");const SENTRY_API_VERSION="7";function getBaseApiEndpoint(dsn){const protocol=dsn.protocol?`${dsn.protocol}:`:"";const port=dsn.port?`:${dsn.port}`:"";return`${protocol}//${dsn.host}${port}${dsn.path?`/${dsn.path}`:""}/api/`}function _getIngestEndpoint(dsn){return`${getBaseApiEndpoint(dsn)}${dsn.projectId}/envelope/`}function _encodedAuth(dsn,sdkInfo){const params={sentry_version:SENTRY_API_VERSION};if(dsn.publicKey){params.sentry_key=dsn.publicKey}if(sdkInfo){params.sentry_client=`${sdkInfo.name}/${sdkInfo.version}`}return new URLSearchParams(params).toString()}function getEnvelopeEndpointWithUrlEncodedAuth(dsn,tunnel,sdkInfo){return tunnel?tunnel:`${_getIngestEndpoint(dsn)}?${_encodedAuth(dsn,sdkInfo)}`}function getReportDialogEndpoint(dsnLike,dialogOptions){const dsn$1=dsn.makeDsn(dsnLike);if(!dsn$1){return""}const endpoint=`${getBaseApiEndpoint(dsn$1)}embed/error-page/`;let encodedOptions=`dsn=${dsn.dsnToString(dsn$1)}`;for(const key in dialogOptions){if(key==="dsn"){continue}if(key==="onClose"){continue}if(key==="user"){const user=dialogOptions.user;if(!user){continue}if(user.name){encodedOptions+=`&name=${encodeURIComponent(user.name)}`}if(user.email){encodedOptions+=`&email=${encodeURIComponent(user.email)}`}}else{encodedOptions+=`&${encodeURIComponent(key)}=${encodeURIComponent(dialogOptions[key])}`}}return`${endpoint}?${encodedOptions}`}exports.getEnvelopeEndpointWithUrlEncodedAuth=getEnvelopeEndpointWithUrlEncodedAuth;exports.getReportDialogEndpoint=getReportDialogEndpoint},{"./utils-hoist/dsn.js":152}],71:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const carrier=require("../carrier.js");const stackStrategy=require("./stackStrategy.js");function setAsyncContextStrategy(strategy){const registry=carrier.getMainCarrier();const sentry=carrier.getSentryCarrier(registry);sentry.acs=strategy}function getAsyncContextStrategy(carrier$1){const sentry=carrier.getSentryCarrier(carrier$1);if(sentry.acs){return sentry.acs}return stackStrategy.getStackAsyncContextStrategy()}exports.getAsyncContextStrategy=getAsyncContextStrategy;exports.setAsyncContextStrategy=setAsyncContextStrategy},{"../carrier.js":75,"./stackStrategy.js":72}],72:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const defaultScopes=require("../defaultScopes.js");const scope=require("../scope.js");const is=require("../utils-hoist/is.js");const carrier=require("../carrier.js");class AsyncContextStack{constructor(scope$1,isolationScope){let assignedScope;if(!scope$1){assignedScope=new scope.Scope}else{assignedScope=scope$1}let assignedIsolationScope;if(!isolationScope){assignedIsolationScope=new scope.Scope}else{assignedIsolationScope=isolationScope}this._stack=[{scope:assignedScope}];this._isolationScope=assignedIsolationScope}withScope(callback){const scope=this._pushScope();let maybePromiseResult;try{maybePromiseResult=callback(scope)}catch(e){this._popScope();throw e}if(is.isThenable(maybePromiseResult)){return maybePromiseResult.then(res=>{this._popScope();return res},e=>{this._popScope();throw e})}this._popScope();return maybePromiseResult}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const scope=this.getScope().clone();this._stack.push({client:this.getClient(),scope:scope});return scope}_popScope(){if(this._stack.length<=1)return false;return!!this._stack.pop()}}function getAsyncContextStack(){const registry=carrier.getMainCarrier();const sentry=carrier.getSentryCarrier(registry);return sentry.stack=sentry.stack||new AsyncContextStack(defaultScopes.getDefaultCurrentScope(),defaultScopes.getDefaultIsolationScope())}function withScope(callback){return getAsyncContextStack().withScope(callback)}function withSetScope(scope,callback){const stack=getAsyncContextStack();return stack.withScope(()=>{stack.getStackTop().scope=scope;return callback(scope)})}function withIsolationScope(callback){return getAsyncContextStack().withScope(()=>{return callback(getAsyncContextStack().getIsolationScope())})}function getStackAsyncContextStrategy(){return{withIsolationScope:withIsolationScope,withScope:withScope,withSetScope:withSetScope,withSetIsolationScope:(_isolationScope,callback)=>{return withIsolationScope(callback)},getCurrentScope:()=>getAsyncContextStack().getScope(),getIsolationScope:()=>getAsyncContextStack().getIsolationScope()}}exports.AsyncContextStack=AsyncContextStack;exports.getStackAsyncContextStrategy=getStackAsyncContextStrategy},{"../carrier.js":75,"../defaultScopes.js":80,"../scope.js":113,"../utils-hoist/is.js":162}],73:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const api=require("./api.js");const currentScopes=require("./currentScopes.js");const debugBuild=require("./debug-build.js");const envelope=require("./envelope.js");const integration=require("./integration.js");const session=require("./session.js");const dynamicSamplingContext=require("./tracing/dynamicSamplingContext.js");const clientreport=require("./utils-hoist/clientreport.js");const dsn=require("./utils-hoist/dsn.js");const envelope$1=require("./utils-hoist/envelope.js");const error=require("./utils-hoist/error.js");const is=require("./utils-hoist/is.js");const logger=require("./utils-hoist/logger.js");const misc=require("./utils-hoist/misc.js");const syncpromise=require("./utils-hoist/syncpromise.js");const parseSampleRate=require("./utils/parseSampleRate.js");const prepareEvent=require("./utils/prepareEvent.js");const spanUtils=require("./utils/spanUtils.js");const ALREADY_SEEN_ERROR="Not capturing exception because it's already been captured.";class BaseClient{constructor(options){this._options=options;this._integrations={};this._numProcessing=0;this._outcomes={};this._hooks={};this._eventProcessors=[];if(options.dsn){this._dsn=dsn.makeDsn(options.dsn)}else{debugBuild.DEBUG_BUILD&&logger.logger.warn("No DSN provided, client will not send events.")}if(this._dsn){const url=api.getEnvelopeEndpointWithUrlEncodedAuth(this._dsn,options.tunnel,options._metadata?options._metadata.sdk:undefined);this._transport=options.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...options.transportOptions,url:url})}const tracingOptions=["enableTracing","tracesSampleRate","tracesSampler"];const undefinedOption=tracingOptions.find(option=>option in options&&options[option]==undefined);if(undefinedOption){logger.consoleSandbox(()=>{console.warn(`[Sentry] Deprecation warning: \`${undefinedOption}\` is set to undefined, which leads to tracing being enabled. In v9, a value of \`undefined\` will result in tracing being disabled.`)})}}captureException(exception,hint,scope){const eventId=misc.uuid4();if(misc.checkOrSetAlreadyCaught(exception)){debugBuild.DEBUG_BUILD&&logger.logger.log(ALREADY_SEEN_ERROR);return eventId}const hintWithEventId={event_id:eventId,...hint};this._process(this.eventFromException(exception,hintWithEventId).then(event=>this._captureEvent(event,hintWithEventId,scope)));return hintWithEventId.event_id}captureMessage(message,level,hint,currentScope){const hintWithEventId={event_id:misc.uuid4(),...hint};const eventMessage=is.isParameterizedString(message)?message:String(message);const promisedEvent=is.isPrimitive(message)?this.eventFromMessage(eventMessage,level,hintWithEventId):this.eventFromException(message,hintWithEventId);this._process(promisedEvent.then(event=>this._captureEvent(event,hintWithEventId,currentScope)));return hintWithEventId.event_id}captureEvent(event,hint,currentScope){const eventId=misc.uuid4();if(hint&&hint.originalException&&misc.checkOrSetAlreadyCaught(hint.originalException)){debugBuild.DEBUG_BUILD&&logger.logger.log(ALREADY_SEEN_ERROR);return eventId}const hintWithEventId={event_id:eventId,...hint};const sdkProcessingMetadata=event.sdkProcessingMetadata||{};const capturedSpanScope=sdkProcessingMetadata.capturedSpanScope;this._process(this._captureEvent(event,hintWithEventId,capturedSpanScope||currentScope));return hintWithEventId.event_id}captureSession(session$1){if(!(typeof session$1.release==="string")){debugBuild.DEBUG_BUILD&&logger.logger.warn("Discarded session because of missing or non-string release")}else{this.sendSession(session$1);session.updateSession(session$1,{init:false})}}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(timeout){const transport=this._transport;if(transport){this.emit("flush");return this._isClientDoneProcessing(timeout).then(clientFinished=>{return transport.flush(timeout).then(transportFlushed=>clientFinished&&transportFlushed)})}else{return syncpromise.resolvedSyncPromise(true)}}close(timeout){return this.flush(timeout).then(result=>{this.getOptions().enabled=false;this.emit("close");return result})}getEventProcessors(){return this._eventProcessors}addEventProcessor(eventProcessor){this._eventProcessors.push(eventProcessor)}init(){if(this._isEnabled()||this._options.integrations.some(({name})=>name.startsWith("Spotlight"))){this._setupIntegrations()}}getIntegrationByName(integrationName){return this._integrations[integrationName]}addIntegration(integration$1){const isAlreadyInstalled=this._integrations[integration$1.name];integration.setupIntegration(this,integration$1,this._integrations);if(!isAlreadyInstalled){integration.afterSetupIntegrations(this,[integration$1])}}sendEvent(event,hint={}){this.emit("beforeSendEvent",event,hint);let env=envelope.createEventEnvelope(event,this._dsn,this._options._metadata,this._options.tunnel);for(const attachment of hint.attachments||[]){env=envelope$1.addItemToEnvelope(env,envelope$1.createAttachmentEnvelopeItem(attachment))}const promise=this.sendEnvelope(env);if(promise){promise.then(sendResponse=>this.emit("afterSendEvent",event,sendResponse),null)}}sendSession(session){const env=envelope.createSessionEnvelope(session,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(env)}recordDroppedEvent(reason,category,eventOrCount){if(this._options.sendClientReports){const count=typeof eventOrCount==="number"?eventOrCount:1;const key=`${reason}:${category}`;debugBuild.DEBUG_BUILD&&logger.logger.log(`Recording outcome: "${key}"${count>1?` (${count} times)`:""}`);this._outcomes[key]=(this._outcomes[key]||0)+count}}on(hook,callback){const hooks=this._hooks[hook]=this._hooks[hook]||[];hooks.push(callback);return()=>{const cbIndex=hooks.indexOf(callback);if(cbIndex>-1){hooks.splice(cbIndex,1)}}}emit(hook,...rest){const callbacks=this._hooks[hook];if(callbacks){callbacks.forEach(callback=>callback(...rest))}}sendEnvelope(envelope){this.emit("beforeEnvelope",envelope);if(this._isEnabled()&&this._transport){return this._transport.send(envelope).then(null,reason=>{debugBuild.DEBUG_BUILD&&logger.logger.error("Error while sending envelope:",reason);return reason})}debugBuild.DEBUG_BUILD&&logger.logger.error("Transport disabled");return syncpromise.resolvedSyncPromise({})}_setupIntegrations(){const{integrations}=this._options;this._integrations=integration.setupIntegrations(this,integrations);integration.afterSetupIntegrations(this,integrations)}_updateSessionFromEvent(session$1,event){let crashed=false;let errored=false;const exceptions=event.exception&&event.exception.values;if(exceptions){errored=true;for(const ex of exceptions){const mechanism=ex.mechanism;if(mechanism&&mechanism.handled===false){crashed=true;break}}}const sessionNonTerminal=session$1.status==="ok";const shouldUpdateAndSend=sessionNonTerminal&&session$1.errors===0||sessionNonTerminal&&crashed;if(shouldUpdateAndSend){session.updateSession(session$1,{...crashed&&{status:"crashed"},errors:session$1.errors||Number(errored||crashed)});this.captureSession(session$1)}}_isClientDoneProcessing(timeout){return new syncpromise.SyncPromise(resolve=>{let ticked=0;const tick=1;const interval=setInterval(()=>{if(this._numProcessing==0){clearInterval(interval);resolve(true)}else{ticked+=tick;if(timeout&&ticked>=timeout){clearInterval(interval);resolve(false)}}},tick)})}_isEnabled(){return this.getOptions().enabled!==false&&this._transport!==undefined}_prepareEvent(event,hint,currentScope=currentScopes.getCurrentScope(),isolationScope=currentScopes.getIsolationScope()){const options=this.getOptions();const integrations=Object.keys(this._integrations);if(!hint.integrations&&integrations.length>0){hint.integrations=integrations}this.emit("preprocessEvent",event,hint);if(!event.type){isolationScope.setLastEventId(event.event_id||hint.event_id)}return prepareEvent.prepareEvent(options,event,hint,currentScope,this,isolationScope).then(evt=>{if(evt===null){return evt}evt.contexts={trace:currentScopes.getTraceContextFromScope(currentScope),...evt.contexts};const dynamicSamplingContext$1=dynamicSamplingContext.getDynamicSamplingContextFromScope(this,currentScope);evt.sdkProcessingMetadata={dynamicSamplingContext:dynamicSamplingContext$1,...evt.sdkProcessingMetadata};return evt})}_captureEvent(event,hint={},scope){return this._processEvent(event,hint,scope).then(finalEvent=>{return finalEvent.event_id},reason=>{if(debugBuild.DEBUG_BUILD){const sentryError=reason;if(sentryError.logLevel==="log"){logger.logger.log(sentryError.message)}else{logger.logger.warn(sentryError)}}return undefined})}_processEvent(event,hint,currentScope){const options=this.getOptions();const{sampleRate}=options;const isTransaction=isTransactionEvent(event);const isError=isErrorEvent(event);const eventType=event.type||"error";const beforeSendLabel=`before send for type \`${eventType}\``;const parsedSampleRate=typeof sampleRate==="undefined"?undefined:parseSampleRate.parseSampleRate(sampleRate);if(isError&&typeof parsedSampleRate==="number"&&Math.random()>parsedSampleRate){this.recordDroppedEvent("sample_rate","error",event);return syncpromise.rejectedSyncPromise(new error.SentryError(`Discarding event because it's not included in the random sample (sampling rate = ${sampleRate})`,"log"))}const dataCategory=eventType==="replay_event"?"replay":eventType;const sdkProcessingMetadata=event.sdkProcessingMetadata||{};const capturedSpanIsolationScope=sdkProcessingMetadata.capturedSpanIsolationScope;return this._prepareEvent(event,hint,currentScope,capturedSpanIsolationScope).then(prepared=>{if(prepared===null){this.recordDroppedEvent("event_processor",dataCategory,event);throw new error.SentryError("An event processor returned `null`, will not send event.","log")}const isInternalException=hint.data&&hint.data.__sentry__===true;if(isInternalException){return prepared}const result=processBeforeSend(this,options,prepared,hint);return _validateBeforeSendResult(result,beforeSendLabel)}).then(processedEvent=>{if(processedEvent===null){this.recordDroppedEvent("before_send",dataCategory,event);if(isTransaction){const spans=event.spans||[];const spanCount=1+spans.length;this.recordDroppedEvent("before_send","span",spanCount)}throw new error.SentryError(`${beforeSendLabel} returned \`null\`, will not send event.`,"log")}const session=currentScope&&currentScope.getSession();if(!isTransaction&&session){this._updateSessionFromEvent(session,processedEvent)}if(isTransaction){const spanCountBefore=processedEvent.sdkProcessingMetadata&&processedEvent.sdkProcessingMetadata.spanCountBeforeProcessing||0;const spanCountAfter=processedEvent.spans?processedEvent.spans.length:0;const droppedSpanCount=spanCountBefore-spanCountAfter;if(droppedSpanCount>0){this.recordDroppedEvent("before_send","span",droppedSpanCount)}}const transactionInfo=processedEvent.transaction_info;if(isTransaction&&transactionInfo&&processedEvent.transaction!==event.transaction){const source="custom";processedEvent.transaction_info={...transactionInfo,source:source}}this.sendEvent(processedEvent,hint);return processedEvent}).then(null,reason=>{if(reason instanceof error.SentryError){throw reason}this.captureException(reason,{data:{__sentry__:true},originalException:reason});throw new error.SentryError(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${reason}`)})}_process(promise){this._numProcessing++;void promise.then(value=>{this._numProcessing--;return value},reason=>{this._numProcessing--;return reason})}_clearOutcomes(){const outcomes=this._outcomes;this._outcomes={};return Object.entries(outcomes).map(([key,quantity])=>{const[reason,category]=key.split(":");return{reason:reason,category:category,quantity:quantity}})}_flushOutcomes(){debugBuild.DEBUG_BUILD&&logger.logger.log("Flushing outcomes...");const outcomes=this._clearOutcomes();if(outcomes.length===0){debugBuild.DEBUG_BUILD&&logger.logger.log("No outcomes to send");return}if(!this._dsn){debugBuild.DEBUG_BUILD&&logger.logger.log("No dsn provided, will not send outcomes");return}debugBuild.DEBUG_BUILD&&logger.logger.log("Sending outcomes:",outcomes);const envelope=clientreport.createClientReportEnvelope(outcomes,this._options.tunnel&&dsn.dsnToString(this._dsn));this.sendEnvelope(envelope)}}function _validateBeforeSendResult(beforeSendResult,beforeSendLabel){const invalidValueError=`${beforeSendLabel} must return \`null\` or a valid event.`;if(is.isThenable(beforeSendResult)){return beforeSendResult.then(event=>{if(!is.isPlainObject(event)&&event!==null){throw new error.SentryError(invalidValueError)}return event},e=>{throw new error.SentryError(`${beforeSendLabel} rejected with ${e}`)})}else if(!is.isPlainObject(beforeSendResult)&&beforeSendResult!==null){throw new error.SentryError(invalidValueError)}return beforeSendResult}function processBeforeSend(client,options,event,hint){const{beforeSend,beforeSendTransaction,beforeSendSpan}=options;if(isErrorEvent(event)&&beforeSend){return beforeSend(event,hint)}if(isTransactionEvent(event)){if(event.spans&&beforeSendSpan){const processedSpans=[];for(const span of event.spans){const processedSpan=beforeSendSpan(span);if(processedSpan){processedSpans.push(processedSpan)}else{spanUtils.showSpanDropWarning();client.recordDroppedEvent("before_send","span")}}event.spans=processedSpans}if(beforeSendTransaction){if(event.spans){const spanCountBefore=event.spans.length;event.sdkProcessingMetadata={...event.sdkProcessingMetadata,spanCountBeforeProcessing:spanCountBefore}}return beforeSendTransaction(event,hint)}}return event}function isErrorEvent(event){return event.type===undefined}function isTransactionEvent(event){return event.type==="transaction"}exports.BaseClient=BaseClient},{"./api.js":70,"./currentScopes.js":78,"./debug-build.js":79,"./envelope.js":81,"./integration.js":88,"./session.js":117,"./tracing/dynamicSamplingContext.js":119,"./utils-hoist/clientreport.js":148,"./utils-hoist/dsn.js":152,"./utils-hoist/envelope.js":154,"./utils-hoist/error.js":155,"./utils-hoist/is.js":162,"./utils-hoist/logger.js":164,"./utils-hoist/misc.js":167,"./utils-hoist/syncpromise.js":181,"./utils/parseSampleRate.js":198,"./utils/prepareEvent.js":199,"./utils/spanUtils.js":202}],74:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("./currentScopes.js");const logger=require("./utils-hoist/logger.js");const time=require("./utils-hoist/time.js");const DEFAULT_BREADCRUMBS=100;function addBreadcrumb(breadcrumb,hint){const client=currentScopes.getClient();const isolationScope=currentScopes.getIsolationScope();if(!client)return;const{beforeBreadcrumb=null,maxBreadcrumbs=DEFAULT_BREADCRUMBS}=client.getOptions();if(maxBreadcrumbs<=0)return;const timestamp=time.dateTimestampInSeconds();const mergedBreadcrumb={timestamp:timestamp,...breadcrumb};const finalBreadcrumb=beforeBreadcrumb?logger.consoleSandbox(()=>beforeBreadcrumb(mergedBreadcrumb,hint)):mergedBreadcrumb;if(finalBreadcrumb===null)return;if(client.emit){client.emit("beforeAddBreadcrumb",finalBreadcrumb,hint)}isolationScope.addBreadcrumb(finalBreadcrumb,maxBreadcrumbs)}exports.addBreadcrumb=addBreadcrumb},{"./currentScopes.js":78,"./utils-hoist/logger.js":164,"./utils-hoist/time.js":182}],75:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const version=require("./utils-hoist/version.js");const worldwide=require("./utils-hoist/worldwide.js");function getMainCarrier(){getSentryCarrier(worldwide.GLOBAL_OBJ);return worldwide.GLOBAL_OBJ}function getSentryCarrier(carrier){const __SENTRY__=carrier.__SENTRY__=carrier.__SENTRY__||{};__SENTRY__.version=__SENTRY__.version||version.SDK_VERSION;return __SENTRY__[version.SDK_VERSION]=__SENTRY__[version.SDK_VERSION]||{}}exports.getMainCarrier=getMainCarrier;exports.getSentryCarrier=getSentryCarrier},{"./utils-hoist/version.js":189,"./utils-hoist/worldwide.js":190}],76:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const dsn=require("./utils-hoist/dsn.js");const envelope=require("./utils-hoist/envelope.js");const object=require("./utils-hoist/object.js");function createCheckInEnvelope(checkIn,dynamicSamplingContext,metadata,tunnel,dsn$1){const headers={sent_at:(new Date).toISOString()};if(metadata&&metadata.sdk){headers.sdk={name:metadata.sdk.name,version:metadata.sdk.version}}if(!!tunnel&&!!dsn$1){headers.dsn=dsn.dsnToString(dsn$1)}if(dynamicSamplingContext){headers.trace=object.dropUndefinedKeys(dynamicSamplingContext)}const item=createCheckInEnvelopeItem(checkIn);return envelope.createEnvelope(headers,[item])}function createCheckInEnvelopeItem(checkIn){const checkInHeaders={type:"check_in"};return[checkInHeaders,checkIn]}exports.createCheckInEnvelope=createCheckInEnvelope},{"./utils-hoist/dsn.js":152,"./utils-hoist/envelope.js":154,"./utils-hoist/object.js":171}],77:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const DEFAULT_ENVIRONMENT="production";exports.DEFAULT_ENVIRONMENT=DEFAULT_ENVIRONMENT},{}],78:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const index=require("./asyncContext/index.js");const carrier=require("./carrier.js");const scope=require("./scope.js");const object=require("./utils-hoist/object.js");const worldwide=require("./utils-hoist/worldwide.js");function getCurrentScope(){const carrier$1=carrier.getMainCarrier();const acs=index.getAsyncContextStrategy(carrier$1);return acs.getCurrentScope()}function getIsolationScope(){const carrier$1=carrier.getMainCarrier();const acs=index.getAsyncContextStrategy(carrier$1);return acs.getIsolationScope()}function getGlobalScope(){return worldwide.getGlobalSingleton("globalScope",()=>new scope.Scope)}function withScope(...rest){const carrier$1=carrier.getMainCarrier();const acs=index.getAsyncContextStrategy(carrier$1);if(rest.length===2){const[scope,callback]=rest;if(!scope){return acs.withScope(callback)}return acs.withSetScope(scope,callback)}return acs.withScope(rest[0])}function withIsolationScope(...rest){const carrier$1=carrier.getMainCarrier();const acs=index.getAsyncContextStrategy(carrier$1);if(rest.length===2){const[isolationScope,callback]=rest;if(!isolationScope){return acs.withIsolationScope(callback)}return acs.withSetIsolationScope(isolationScope,callback)}return acs.withIsolationScope(rest[0])}function getClient(){return getCurrentScope().getClient()}function getTraceContextFromScope(scope){const propagationContext=scope.getPropagationContext();const{traceId,spanId,parentSpanId}=propagationContext;const traceContext=object.dropUndefinedKeys({trace_id:traceId,span_id:spanId,parent_span_id:parentSpanId});return traceContext}exports.getClient=getClient;exports.getCurrentScope=getCurrentScope;exports.getGlobalScope=getGlobalScope;exports.getIsolationScope=getIsolationScope;exports.getTraceContextFromScope=getTraceContextFromScope;exports.withIsolationScope=withIsolationScope;exports.withScope=withScope},{"./asyncContext/index.js":71,"./carrier.js":75,"./scope.js":113,"./utils-hoist/object.js":171,"./utils-hoist/worldwide.js":190}],79:[function(require,module,exports){arguments[4][2][0].apply(exports,arguments)},{dup:2}],80:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const scope=require("./scope.js");const worldwide=require("./utils-hoist/worldwide.js");function getDefaultCurrentScope(){return worldwide.getGlobalSingleton("defaultCurrentScope",()=>new scope.Scope)}function getDefaultIsolationScope(){return worldwide.getGlobalSingleton("defaultIsolationScope",()=>new scope.Scope)}exports.getDefaultCurrentScope=getDefaultCurrentScope;exports.getDefaultIsolationScope=getDefaultIsolationScope},{"./scope.js":113,"./utils-hoist/worldwide.js":190}],81:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const dynamicSamplingContext=require("./tracing/dynamicSamplingContext.js");const dsn=require("./utils-hoist/dsn.js");const envelope=require("./utils-hoist/envelope.js");require("./utils-hoist/version.js");require("./utils-hoist/debug-build.js");require("./utils-hoist/logger.js");const spanUtils=require("./utils/spanUtils.js");function enhanceEventWithSdkInfo(event,sdkInfo){if(!sdkInfo){return event}event.sdk=event.sdk||{};event.sdk.name=event.sdk.name||sdkInfo.name;event.sdk.version=event.sdk.version||sdkInfo.version;event.sdk.integrations=[...event.sdk.integrations||[],...sdkInfo.integrations||[]];event.sdk.packages=[...event.sdk.packages||[],...sdkInfo.packages||[]];return event}function createSessionEnvelope(session,dsn$1,metadata,tunnel){const sdkInfo=envelope.getSdkMetadataForEnvelopeHeader(metadata);const envelopeHeaders={sent_at:(new Date).toISOString(),...sdkInfo&&{sdk:sdkInfo},...!!tunnel&&dsn$1&&{dsn:dsn.dsnToString(dsn$1)}};const envelopeItem="aggregates"in session?[{type:"sessions"},session]:[{type:"session"},session.toJSON()];return envelope.createEnvelope(envelopeHeaders,[envelopeItem])}function createEventEnvelope(event,dsn,metadata,tunnel){const sdkInfo=envelope.getSdkMetadataForEnvelopeHeader(metadata);const eventType=event.type&&event.type!=="replay_event"?event.type:"event";enhanceEventWithSdkInfo(event,metadata&&metadata.sdk);const envelopeHeaders=envelope.createEventEnvelopeHeaders(event,sdkInfo,tunnel,dsn);delete event.sdkProcessingMetadata;const eventItem=[{type:eventType},event];return envelope.createEnvelope(envelopeHeaders,[eventItem])}function createSpanEnvelope(spans,client){function dscHasRequiredProps(dsc){return!!dsc.trace_id&&!!dsc.public_key}const dsc=dynamicSamplingContext.getDynamicSamplingContextFromSpan(spans[0]);const dsn$1=client&&client.getDsn();const tunnel=client&&client.getOptions().tunnel;const headers={sent_at:(new Date).toISOString(),...dscHasRequiredProps(dsc)&&{trace:dsc},...!!tunnel&&dsn$1&&{dsn:dsn.dsnToString(dsn$1)}};const beforeSendSpan=client&&client.getOptions().beforeSendSpan;const convertToSpanJSON=beforeSendSpan?span=>{const spanJson=beforeSendSpan(spanUtils.spanToJSON(span));if(!spanJson){spanUtils.showSpanDropWarning()}return spanJson}:span=>spanUtils.spanToJSON(span);const items=[];for(const span of spans){const spanJson=convertToSpanJSON(span);if(spanJson){items.push(envelope.createSpanEnvelopeItem(spanJson))}}return envelope.createEnvelope(headers,items)}exports.createEventEnvelope=createEventEnvelope;exports.createSessionEnvelope=createSessionEnvelope;exports.createSpanEnvelope=createSpanEnvelope},{"./tracing/dynamicSamplingContext.js":119,"./utils-hoist/debug-build.js":150,"./utils-hoist/dsn.js":152,"./utils-hoist/envelope.js":154,"./utils-hoist/logger.js":164,"./utils-hoist/version.js":189,"./utils/spanUtils.js":202}],82:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const debugBuild=require("./debug-build.js");const is=require("./utils-hoist/is.js");const logger=require("./utils-hoist/logger.js");const syncpromise=require("./utils-hoist/syncpromise.js");function notifyEventProcessors(processors,event,hint,index=0){return new syncpromise.SyncPromise((resolve,reject)=>{const processor=processors[index];if(event===null||typeof processor!=="function"){resolve(event)}else{const result=processor({...event},hint);debugBuild.DEBUG_BUILD&&processor.id&&result===null&&logger.logger.log(`Event processor "${processor.id}" dropped event`);if(is.isThenable(result)){void result.then(final=>notifyEventProcessors(processors,final,hint,index+1).then(resolve)).then(null,reject)}else{void notifyEventProcessors(processors,result,hint,index+1).then(resolve).then(null,reject)}}})}exports.notifyEventProcessors=notifyEventProcessors},{"./debug-build.js":79,"./utils-hoist/is.js":162,"./utils-hoist/logger.js":164,"./utils-hoist/syncpromise.js":181}],83:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const constants=require("./constants.js");const currentScopes=require("./currentScopes.js");const debugBuild=require("./debug-build.js");const session=require("./session.js");const is=require("./utils-hoist/is.js");const logger=require("./utils-hoist/logger.js");const misc=require("./utils-hoist/misc.js");const time=require("./utils-hoist/time.js");const worldwide=require("./utils-hoist/worldwide.js");const prepareEvent=require("./utils/prepareEvent.js");function captureException(exception,hint){return currentScopes.getCurrentScope().captureException(exception,prepareEvent.parseEventHintOrCaptureContext(hint))}function captureMessage(message,captureContext){const level=typeof captureContext==="string"?captureContext:undefined;const context=typeof captureContext!=="string"?{captureContext:captureContext}:undefined;return currentScopes.getCurrentScope().captureMessage(message,level,context)}function captureEvent(event,hint){return currentScopes.getCurrentScope().captureEvent(event,hint)}function setContext(name,context){currentScopes.getIsolationScope().setContext(name,context)}function setExtras(extras){currentScopes.getIsolationScope().setExtras(extras)}function setExtra(key,extra){currentScopes.getIsolationScope().setExtra(key,extra)}function setTags(tags){currentScopes.getIsolationScope().setTags(tags)}function setTag(key,value){currentScopes.getIsolationScope().setTag(key,value)}function setUser(user){currentScopes.getIsolationScope().setUser(user)}function lastEventId(){return currentScopes.getIsolationScope().lastEventId()}function captureCheckIn(checkIn,upsertMonitorConfig){const scope=currentScopes.getCurrentScope();const client=currentScopes.getClient();if(!client){debugBuild.DEBUG_BUILD&&logger.logger.warn("Cannot capture check-in. No client defined.")}else if(!client.captureCheckIn){debugBuild.DEBUG_BUILD&&logger.logger.warn("Cannot capture check-in. Client does not support sending check-ins.")}else{return client.captureCheckIn(checkIn,upsertMonitorConfig,scope)}return misc.uuid4()}function withMonitor(monitorSlug,callback,upsertMonitorConfig){const checkInId=captureCheckIn({monitorSlug:monitorSlug,status:"in_progress"},upsertMonitorConfig);const now=time.timestampInSeconds();function finishCheckIn(status){captureCheckIn({monitorSlug:monitorSlug,status:status,checkInId:checkInId,duration:time.timestampInSeconds()-now})}return currentScopes.withIsolationScope(()=>{let maybePromiseResult;try{maybePromiseResult=callback()}catch(e){finishCheckIn("error");throw e}if(is.isThenable(maybePromiseResult)){Promise.resolve(maybePromiseResult).then(()=>{finishCheckIn("ok")},e=>{finishCheckIn("error");throw e})}else{finishCheckIn("ok")}return maybePromiseResult})}async function flush(timeout){const client=currentScopes.getClient();if(client){return client.flush(timeout)}debugBuild.DEBUG_BUILD&&logger.logger.warn("Cannot flush events. No client defined.");return Promise.resolve(false)}async function close(timeout){const client=currentScopes.getClient();if(client){return client.close(timeout)}debugBuild.DEBUG_BUILD&&logger.logger.warn("Cannot flush events and disable SDK. No client defined.");return Promise.resolve(false)}function isInitialized(){return!!currentScopes.getClient()}function isEnabled(){const client=currentScopes.getClient();return!!client&&client.getOptions().enabled!==false&&!!client.getTransport()}function addEventProcessor(callback){currentScopes.getIsolationScope().addEventProcessor(callback)}function startSession(context){const client=currentScopes.getClient();const isolationScope=currentScopes.getIsolationScope();const currentScope=currentScopes.getCurrentScope();const{release,environment=constants.DEFAULT_ENVIRONMENT}=client&&client.getOptions()||{};const{userAgent}=worldwide.GLOBAL_OBJ.navigator||{};const session$1=session.makeSession({release:release,environment:environment,user:currentScope.getUser()||isolationScope.getUser(),...userAgent&&{userAgent:userAgent},...context});const currentSession=isolationScope.getSession();if(currentSession&&currentSession.status==="ok"){session.updateSession(currentSession,{status:"exited"})}endSession();isolationScope.setSession(session$1);currentScope.setSession(session$1);return session$1}function endSession(){const isolationScope=currentScopes.getIsolationScope();const currentScope=currentScopes.getCurrentScope();const session$1=currentScope.getSession()||isolationScope.getSession();if(session$1){session.closeSession(session$1)}_sendSessionUpdate();isolationScope.setSession();currentScope.setSession()}function _sendSessionUpdate(){const isolationScope=currentScopes.getIsolationScope();const currentScope=currentScopes.getCurrentScope();const client=currentScopes.getClient();const session=currentScope.getSession()||isolationScope.getSession();if(session&&client){client.captureSession(session)}}function captureSession(end=false){if(end){endSession();return}_sendSessionUpdate()}exports.addEventProcessor=addEventProcessor;exports.captureCheckIn=captureCheckIn;exports.captureEvent=captureEvent;exports.captureException=captureException;exports.captureMessage=captureMessage;exports.captureSession=captureSession;exports.close=close;exports.endSession=endSession;exports.flush=flush;exports.isEnabled=isEnabled;exports.isInitialized=isInitialized;exports.lastEventId=lastEventId;exports.setContext=setContext;exports.setExtra=setExtra;exports.setExtras=setExtras;exports.setTag=setTag;exports.setTags=setTags;exports.setUser=setUser;exports.startSession=startSession;exports.withMonitor=withMonitor},{"./constants.js":77,"./currentScopes.js":78,"./debug-build.js":79,"./session.js":117,"./utils-hoist/is.js":162,"./utils-hoist/logger.js":164,"./utils-hoist/misc.js":167,"./utils-hoist/time.js":182,"./utils-hoist/worldwide.js":190,"./utils/prepareEvent.js":199}],84:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("./currentScopes.js");const object=require("./utils-hoist/object.js");function captureFeedback(params,hint={},scope=currentScopes.getCurrentScope()){const{message,name,email,url,source,associatedEventId,tags}=params;const feedbackEvent={contexts:{feedback:object.dropUndefinedKeys({contact_email:email,name:name,message:message,url:url,source:source,associated_event_id:associatedEventId})},type:"feedback",level:"info",tags:tags};const client=scope&&scope.getClient()||currentScopes.getClient();if(client){client.emit("beforeSendFeedback",feedbackEvent,hint)}const eventId=scope.captureEvent(feedbackEvent,hint);return eventId}exports.captureFeedback=captureFeedback},{"./currentScopes.js":78,"./utils-hoist/object.js":171}],85:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const semanticAttributes=require("./semanticAttributes.js");require("./tracing/errors.js");const is=require("./utils-hoist/is.js");require("./utils-hoist/version.js");require("./utils-hoist/debug-build.js");require("./utils-hoist/logger.js");require("./utils-hoist/time.js");require("./utils-hoist/syncpromise.js");const url=require("./utils-hoist/url.js");const baggage=require("./utils-hoist/baggage.js");require("./debug-build.js");const hasTracingEnabled=require("./utils/hasTracingEnabled.js");const spanUtils=require("./utils/spanUtils.js");const sentryNonRecordingSpan=require("./tracing/sentryNonRecordingSpan.js");const spanstatus=require("./tracing/spanstatus.js");const trace=require("./tracing/trace.js");const traceData=require("./utils/traceData.js");function instrumentFetchRequest(handlerData,shouldCreateSpan,shouldAttachHeaders,spans,spanOrigin="auto.http.browser"){if(!handlerData.fetchData){return undefined}const shouldCreateSpanResult=hasTracingEnabled.hasTracingEnabled()&&shouldCreateSpan(handlerData.fetchData.url);if(handlerData.endTimestamp&&shouldCreateSpanResult){const spanId=handlerData.fetchData.__span;if(!spanId)return;const span=spans[spanId];if(span){endSpan(span,handlerData);delete spans[spanId]}return undefined}const{method,url:url$1}=handlerData.fetchData;const fullUrl=getFullURL(url$1);const host=fullUrl?url.parseUrl(fullUrl).host:undefined;const hasParent=!!spanUtils.getActiveSpan();const span=shouldCreateSpanResult&&hasParent?trace.startInactiveSpan({name:`${method} ${url$1}`,attributes:{url:url$1,type:"fetch","http.method":method,"http.url":fullUrl,"server.address":host,[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:spanOrigin,[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_OP]:"http.client"}}):new sentryNonRecordingSpan.SentryNonRecordingSpan;handlerData.fetchData.__span=span.spanContext().spanId;spans[span.spanContext().spanId]=span;if(shouldAttachHeaders(handlerData.fetchData.url)){const request=handlerData.args[0];const options=handlerData.args[1]||{};const headers=_addTracingHeadersToFetchRequest(request,options,hasTracingEnabled.hasTracingEnabled()&&hasParent?span:undefined);if(headers){handlerData.args[1]=options;options.headers=headers}}return span}function _addTracingHeadersToFetchRequest(request,fetchOptionsObj,span){const traceHeaders=traceData.getTraceData({span:span});const sentryTrace=traceHeaders["sentry-trace"];const baggage=traceHeaders.baggage;if(!sentryTrace){return undefined}const headers=fetchOptionsObj.headers||(isRequest(request)?request.headers:undefined);if(!headers){return{...traceHeaders}}else if(isHeaders(headers)){const newHeaders=new Headers(headers);newHeaders.set("sentry-trace",sentryTrace);if(baggage){const prevBaggageHeader=newHeaders.get("baggage");if(prevBaggageHeader){const prevHeaderStrippedFromSentryBaggage=stripBaggageHeaderOfSentryBaggageValues(prevBaggageHeader);newHeaders.set("baggage",prevHeaderStrippedFromSentryBaggage?`${prevHeaderStrippedFromSentryBaggage},${baggage}`:baggage)}else{newHeaders.set("baggage",baggage)}}return newHeaders}else if(Array.isArray(headers)){const newHeaders=[...headers.filter(header=>{return!(Array.isArray(header)&&header[0]==="sentry-trace")}).map(header=>{if(Array.isArray(header)&&header[0]==="baggage"&&typeof header[1]==="string"){const[headerName,headerValue,...rest]=header;return[headerName,stripBaggageHeaderOfSentryBaggageValues(headerValue),...rest]}else{return header}}),["sentry-trace",sentryTrace]];if(baggage){newHeaders.push(["baggage",baggage])}return newHeaders}else{const existingBaggageHeader="baggage"in headers?headers.baggage:undefined;let newBaggageHeaders=[];if(Array.isArray(existingBaggageHeader)){newBaggageHeaders=existingBaggageHeader.map(headerItem=>typeof headerItem==="string"?stripBaggageHeaderOfSentryBaggageValues(headerItem):headerItem).filter(headerItem=>headerItem==="")}else if(existingBaggageHeader){newBaggageHeaders.push(stripBaggageHeaderOfSentryBaggageValues(existingBaggageHeader))}if(baggage){newBaggageHeaders.push(baggage)}return{...headers,"sentry-trace":sentryTrace,baggage:newBaggageHeaders.length>0?newBaggageHeaders.join(","):undefined}}}function addTracingHeadersToFetchRequest(request,_client,_scope,fetchOptionsObj,span){return _addTracingHeadersToFetchRequest(request,fetchOptionsObj,span)}function getFullURL(url){try{const parsed=new URL(url);return parsed.href}catch(e){return undefined}}function endSpan(span,handlerData){if(handlerData.response){spanstatus.setHttpStatus(span,handlerData.response.status);const contentLength=handlerData.response&&handlerData.response.headers&&handlerData.response.headers.get("content-length");if(contentLength){const contentLengthNum=parseInt(contentLength);if(contentLengthNum>0){span.setAttribute("http.response_content_length",contentLengthNum)}}}else if(handlerData.error){span.setStatus({code:spanstatus.SPAN_STATUS_ERROR,message:"internal_error"})}span.end()}function stripBaggageHeaderOfSentryBaggageValues(baggageHeader){return baggageHeader.split(",").filter(baggageEntry=>!baggageEntry.split("=")[0].startsWith(baggage.SENTRY_BAGGAGE_KEY_PREFIX)).join(",")}function isRequest(request){return typeof Request!=="undefined"&&is.isInstanceOf(request,Request)}function isHeaders(headers){return typeof Headers!=="undefined"&&is.isInstanceOf(headers,Headers)}exports.addTracingHeadersToFetchRequest=addTracingHeadersToFetchRequest;exports.instrumentFetchRequest=instrumentFetchRequest},{"./debug-build.js":79,"./semanticAttributes.js":115,"./tracing/errors.js":120,"./tracing/sentryNonRecordingSpan.js":126,"./tracing/spanstatus.js":128,"./tracing/trace.js":129,"./utils-hoist/baggage.js":138,"./utils-hoist/debug-build.js":150,"./utils-hoist/is.js":162,"./utils-hoist/logger.js":164,"./utils-hoist/syncpromise.js":181,"./utils-hoist/time.js":182,"./utils-hoist/url.js":184,"./utils-hoist/version.js":189,"./utils/hasTracingEnabled.js":193,"./utils/spanUtils.js":202,"./utils/traceData.js":203}],86:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const breadcrumbs=require("./breadcrumbs.js");const currentScopes=require("./currentScopes.js");const exports$1=require("./exports.js");function getCurrentHubShim(){return{bindClient(client){const scope=currentScopes.getCurrentScope();scope.setClient(client)},withScope:currentScopes.withScope,getClient:()=>currentScopes.getClient(),getScope:currentScopes.getCurrentScope,getIsolationScope:currentScopes.getIsolationScope,captureException:(exception,hint)=>{return currentScopes.getCurrentScope().captureException(exception,hint)},captureMessage:(message,level,hint)=>{return currentScopes.getCurrentScope().captureMessage(message,level,hint)},captureEvent:exports$1.captureEvent,addBreadcrumb:breadcrumbs.addBreadcrumb,setUser:exports$1.setUser,setTags:exports$1.setTags,setTag:exports$1.setTag,setExtra:exports$1.setExtra,setExtras:exports$1.setExtras,setContext:exports$1.setContext,getIntegration(integration){const client=currentScopes.getClient();return client&&client.getIntegrationByName(integration.id)||null},startSession:exports$1.startSession,endSession:exports$1.endSession,captureSession(end){if(end){return exports$1.endSession()}_sendSessionUpdate()}}}const getCurrentHub=getCurrentHubShim;function _sendSessionUpdate(){const scope=currentScopes.getCurrentScope();const client=currentScopes.getClient();const session=scope.getSession();if(client&&session){client.captureSession(session)}}exports.getCurrentHub=getCurrentHub;exports.getCurrentHubShim=getCurrentHubShim},{"./breadcrumbs.js":74,"./currentScopes.js":78,"./exports.js":83}],87:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const errors=require("./tracing/errors.js");const utils=require("./tracing/utils.js");const hubextensions=require("./tracing/hubextensions.js");const idleSpan=require("./tracing/idleSpan.js");const sentrySpan=require("./tracing/sentrySpan.js");const sentryNonRecordingSpan=require("./tracing/sentryNonRecordingSpan.js");const spanstatus=require("./tracing/spanstatus.js");const trace=require("./tracing/trace.js");const dynamicSamplingContext=require("./tracing/dynamicSamplingContext.js");const measurement=require("./tracing/measurement.js");const sampling=require("./tracing/sampling.js");const logSpans=require("./tracing/logSpans.js");const semanticAttributes=require("./semanticAttributes.js");const envelope=require("./envelope.js");const exports$1=require("./exports.js");const currentScopes=require("./currentScopes.js");const defaultScopes=require("./defaultScopes.js");const index=require("./asyncContext/index.js");const carrier=require("./carrier.js");const session=require("./session.js");const sessionflusher=require("./sessionflusher.js");const scope=require("./scope.js");const eventProcessors=require("./eventProcessors.js");const api=require("./api.js");const baseclient=require("./baseclient.js");const serverRuntimeClient=require("./server-runtime-client.js");const sdk=require("./sdk.js");const base=require("./transports/base.js");const offline=require("./transports/offline.js");const multiplexed=require("./transports/multiplexed.js");const integration=require("./integration.js");const applyScopeDataToEvent=require("./utils/applyScopeDataToEvent.js");const prepareEvent=require("./utils/prepareEvent.js");const checkin=require("./checkin.js");const hasTracingEnabled=require("./utils/hasTracingEnabled.js");const isSentryRequestUrl=require("./utils/isSentryRequestUrl.js");const handleCallbackErrors=require("./utils/handleCallbackErrors.js");const parameterize=require("./utils/parameterize.js");const spanUtils=require("./utils/spanUtils.js");const parseSampleRate=require("./utils/parseSampleRate.js");const sdkMetadata=require("./utils/sdkMetadata.js");const traceData=require("./utils/traceData.js");const meta=require("./utils/meta.js");const constants=require("./constants.js");const breadcrumbs=require("./breadcrumbs.js");const functiontostring=require("./integrations/functiontostring.js");const inboundfilters=require("./integrations/inboundfilters.js");const linkederrors=require("./integrations/linkederrors.js");const metadata=require("./integrations/metadata.js");const requestdata=require("./integrations/requestdata.js");const captureconsole=require("./integrations/captureconsole.js");const debug=require("./integrations/debug.js");const dedupe=require("./integrations/dedupe.js");const extraerrordata=require("./integrations/extraerrordata.js");const rewriteframes=require("./integrations/rewriteframes.js");const sessiontiming=require("./integrations/sessiontiming.js");const zoderrors=require("./integrations/zoderrors.js");const thirdPartyErrorsFilter=require("./integrations/third-party-errors-filter.js");const exports$2=require("./metrics/exports.js");const profiling=require("./profiling.js");const exportsDefault=require("./metrics/exports-default.js");const browserAggregator=require("./metrics/browser-aggregator.js");const metricSummary=require("./metrics/metric-summary.js");const fetch=require("./fetch.js");const trpc=require("./trpc.js");const feedback=require("./feedback.js");const getCurrentHubShim=require("./getCurrentHubShim.js");const aggregateErrors=require("./utils-hoist/aggregate-errors.js");const array=require("./utils-hoist/array.js");const breadcrumbLogLevel=require("./utils-hoist/breadcrumb-log-level.js");const browser=require("./utils-hoist/browser.js");const dsn=require("./utils-hoist/dsn.js");const error=require("./utils-hoist/error.js");const worldwide=require("./utils-hoist/worldwide.js");const console=require("./utils-hoist/instrument/console.js");const fetch$1=require("./utils-hoist/instrument/fetch.js");const globalError=require("./utils-hoist/instrument/globalError.js");const globalUnhandledRejection=require("./utils-hoist/instrument/globalUnhandledRejection.js");const handlers=require("./utils-hoist/instrument/handlers.js");const is=require("./utils-hoist/is.js");const isBrowser=require("./utils-hoist/isBrowser.js");const logger=require("./utils-hoist/logger.js");const memo=require("./utils-hoist/memo.js");const misc=require("./utils-hoist/misc.js");const node=require("./utils-hoist/node.js");const normalize=require("./utils-hoist/normalize.js");const object=require("./utils-hoist/object.js");const path=require("./utils-hoist/path.js");const promisebuffer=require("./utils-hoist/promisebuffer.js");const requestdata$1=require("./utils-hoist/requestdata.js");const severity=require("./utils-hoist/severity.js");const stacktrace=require("./utils-hoist/stacktrace.js");const nodeStackTrace=require("./utils-hoist/node-stack-trace.js");const string=require("./utils-hoist/string.js");const supports=require("./utils-hoist/supports.js");const syncpromise=require("./utils-hoist/syncpromise.js");const time=require("./utils-hoist/time.js");const tracing=require("./utils-hoist/tracing.js");const env=require("./utils-hoist/env.js");const envelope$1=require("./utils-hoist/envelope.js");const clientreport=require("./utils-hoist/clientreport.js");const ratelimit=require("./utils-hoist/ratelimit.js");const baggage=require("./utils-hoist/baggage.js");const url=require("./utils-hoist/url.js");const cache=require("./utils-hoist/cache.js");const eventbuilder=require("./utils-hoist/eventbuilder.js");const anr=require("./utils-hoist/anr.js");const lru=require("./utils-hoist/lru.js");const propagationContext=require("./utils-hoist/propagationContext.js");const vercelWaitUntil=require("./utils-hoist/vercelWaitUntil.js");const version=require("./utils-hoist/version.js");const debugIds=require("./utils-hoist/debug-ids.js");const escapeStringForRegex=require("./utils-hoist/vendor/escapeStringForRegex.js");const supportsHistory=require("./utils-hoist/vendor/supportsHistory.js");const _asyncNullishCoalesce=require("./utils-hoist/buildPolyfills/_asyncNullishCoalesce.js");const _asyncOptionalChain=require("./utils-hoist/buildPolyfills/_asyncOptionalChain.js");const _asyncOptionalChainDelete=require("./utils-hoist/buildPolyfills/_asyncOptionalChainDelete.js");const _nullishCoalesce=require("./utils-hoist/buildPolyfills/_nullishCoalesce.js");const _optionalChain=require("./utils-hoist/buildPolyfills/_optionalChain.js");const _optionalChainDelete=require("./utils-hoist/buildPolyfills/_optionalChainDelete.js");exports.registerSpanErrorInstrumentation=errors.registerSpanErrorInstrumentation;exports.getCapturedScopesOnSpan=utils.getCapturedScopesOnSpan;exports.setCapturedScopesOnSpan=utils.setCapturedScopesOnSpan;exports.addTracingExtensions=hubextensions.addTracingExtensions;exports.TRACING_DEFAULTS=idleSpan.TRACING_DEFAULTS;exports.startIdleSpan=idleSpan.startIdleSpan;exports.SentrySpan=sentrySpan.SentrySpan;exports.SentryNonRecordingSpan=sentryNonRecordingSpan.SentryNonRecordingSpan;exports.SPAN_STATUS_ERROR=spanstatus.SPAN_STATUS_ERROR;exports.SPAN_STATUS_OK=spanstatus.SPAN_STATUS_OK;exports.SPAN_STATUS_UNSET=spanstatus.SPAN_STATUS_UNSET;exports.getSpanStatusFromHttpCode=spanstatus.getSpanStatusFromHttpCode;exports.setHttpStatus=spanstatus.setHttpStatus;exports.continueTrace=trace.continueTrace;exports.startInactiveSpan=trace.startInactiveSpan;exports.startNewTrace=trace.startNewTrace;exports.startSpan=trace.startSpan;exports.startSpanManual=trace.startSpanManual;exports.suppressTracing=trace.suppressTracing;exports.withActiveSpan=trace.withActiveSpan;exports.getDynamicSamplingContextFromClient=dynamicSamplingContext.getDynamicSamplingContextFromClient;exports.getDynamicSamplingContextFromScope=dynamicSamplingContext.getDynamicSamplingContextFromScope;exports.getDynamicSamplingContextFromSpan=dynamicSamplingContext.getDynamicSamplingContextFromSpan;exports.spanToBaggageHeader=dynamicSamplingContext.spanToBaggageHeader;exports.setMeasurement=measurement.setMeasurement;exports.timedEventsToMeasurements=measurement.timedEventsToMeasurements;exports.sampleSpan=sampling.sampleSpan;exports.logSpanEnd=logSpans.logSpanEnd;exports.logSpanStart=logSpans.logSpanStart;exports.SEMANTIC_ATTRIBUTE_CACHE_HIT=semanticAttributes.SEMANTIC_ATTRIBUTE_CACHE_HIT;exports.SEMANTIC_ATTRIBUTE_CACHE_ITEM_SIZE=semanticAttributes.SEMANTIC_ATTRIBUTE_CACHE_ITEM_SIZE;exports.SEMANTIC_ATTRIBUTE_CACHE_KEY=semanticAttributes.SEMANTIC_ATTRIBUTE_CACHE_KEY;exports.SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME=semanticAttributes.SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME;exports.SEMANTIC_ATTRIBUTE_HTTP_REQUEST_METHOD=semanticAttributes.SEMANTIC_ATTRIBUTE_HTTP_REQUEST_METHOD;exports.SEMANTIC_ATTRIBUTE_PROFILE_ID=semanticAttributes.SEMANTIC_ATTRIBUTE_PROFILE_ID;exports.SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME=semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME;exports.SEMANTIC_ATTRIBUTE_SENTRY_IDLE_SPAN_FINISH_REASON=semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_IDLE_SPAN_FINISH_REASON;exports.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT=semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT;exports.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE=semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE;exports.SEMANTIC_ATTRIBUTE_SENTRY_OP=semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_OP;exports.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN=semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN;exports.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE;exports.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE;exports.SEMANTIC_ATTRIBUTE_URL_FULL=semanticAttributes.SEMANTIC_ATTRIBUTE_URL_FULL;exports.createEventEnvelope=envelope.createEventEnvelope;exports.createSessionEnvelope=envelope.createSessionEnvelope;exports.createSpanEnvelope=envelope.createSpanEnvelope;exports.addEventProcessor=exports$1.addEventProcessor;exports.captureCheckIn=exports$1.captureCheckIn;exports.captureEvent=exports$1.captureEvent;exports.captureException=exports$1.captureException;exports.captureMessage=exports$1.captureMessage;exports.captureSession=exports$1.captureSession;exports.close=exports$1.close;exports.endSession=exports$1.endSession;exports.flush=exports$1.flush;exports.isEnabled=exports$1.isEnabled;exports.isInitialized=exports$1.isInitialized;exports.lastEventId=exports$1.lastEventId;exports.setContext=exports$1.setContext;exports.setExtra=exports$1.setExtra;exports.setExtras=exports$1.setExtras;exports.setTag=exports$1.setTag;exports.setTags=exports$1.setTags;exports.setUser=exports$1.setUser;exports.startSession=exports$1.startSession;exports.withMonitor=exports$1.withMonitor;exports.getClient=currentScopes.getClient;exports.getCurrentScope=currentScopes.getCurrentScope;exports.getGlobalScope=currentScopes.getGlobalScope;exports.getIsolationScope=currentScopes.getIsolationScope;exports.getTraceContextFromScope=currentScopes.getTraceContextFromScope;exports.withIsolationScope=currentScopes.withIsolationScope;exports.withScope=currentScopes.withScope;exports.getDefaultCurrentScope=defaultScopes.getDefaultCurrentScope;exports.getDefaultIsolationScope=defaultScopes.getDefaultIsolationScope;exports.setAsyncContextStrategy=index.setAsyncContextStrategy;exports.getMainCarrier=carrier.getMainCarrier;exports.closeSession=session.closeSession;exports.makeSession=session.makeSession;exports.updateSession=session.updateSession;exports.SessionFlusher=sessionflusher.SessionFlusher;exports.Scope=scope.Scope;exports.notifyEventProcessors=eventProcessors.notifyEventProcessors;exports.getEnvelopeEndpointWithUrlEncodedAuth=api.getEnvelopeEndpointWithUrlEncodedAuth;exports.getReportDialogEndpoint=api.getReportDialogEndpoint;exports.BaseClient=baseclient.BaseClient;exports.ServerRuntimeClient=serverRuntimeClient.ServerRuntimeClient;exports.initAndBind=sdk.initAndBind;exports.setCurrentClient=sdk.setCurrentClient;exports.createTransport=base.createTransport;exports.makeOfflineTransport=offline.makeOfflineTransport;exports.makeMultiplexedTransport=multiplexed.makeMultiplexedTransport;exports.addIntegration=integration.addIntegration;exports.defineIntegration=integration.defineIntegration;exports.getIntegrationsToSetup=integration.getIntegrationsToSetup;exports.applyScopeDataToEvent=applyScopeDataToEvent.applyScopeDataToEvent;exports.mergeScopeData=applyScopeDataToEvent.mergeScopeData;exports.prepareEvent=prepareEvent.prepareEvent;exports.createCheckInEnvelope=checkin.createCheckInEnvelope;exports.hasTracingEnabled=hasTracingEnabled.hasTracingEnabled;exports.isSentryRequestUrl=isSentryRequestUrl.isSentryRequestUrl;exports.handleCallbackErrors=handleCallbackErrors.handleCallbackErrors;exports.parameterize=parameterize.parameterize;exports.addChildSpanToSpan=spanUtils.addChildSpanToSpan;exports.getActiveSpan=spanUtils.getActiveSpan;exports.getRootSpan=spanUtils.getRootSpan;exports.getSpanDescendants=spanUtils.getSpanDescendants;exports.getStatusMessage=spanUtils.getStatusMessage;exports.spanIsSampled=spanUtils.spanIsSampled;exports.spanTimeInputToSeconds=spanUtils.spanTimeInputToSeconds;exports.spanToJSON=spanUtils.spanToJSON;exports.spanToTraceContext=spanUtils.spanToTraceContext;exports.spanToTraceHeader=spanUtils.spanToTraceHeader;exports.updateSpanName=spanUtils.updateSpanName;exports.parseSampleRate=parseSampleRate.parseSampleRate;exports.applySdkMetadata=sdkMetadata.applySdkMetadata;exports.getTraceData=traceData.getTraceData;exports.getTraceMetaTags=meta.getTraceMetaTags;exports.DEFAULT_ENVIRONMENT=constants.DEFAULT_ENVIRONMENT;exports.addBreadcrumb=breadcrumbs.addBreadcrumb;exports.functionToStringIntegration=functiontostring.functionToStringIntegration;exports.inboundFiltersIntegration=inboundfilters.inboundFiltersIntegration;exports.linkedErrorsIntegration=linkederrors.linkedErrorsIntegration;exports.moduleMetadataIntegration=metadata.moduleMetadataIntegration;exports.requestDataIntegration=requestdata.requestDataIntegration;exports.captureConsoleIntegration=captureconsole.captureConsoleIntegration;exports.debugIntegration=debug.debugIntegration;exports.dedupeIntegration=dedupe.dedupeIntegration;exports.extraErrorDataIntegration=extraerrordata.extraErrorDataIntegration;exports.rewriteFramesIntegration=rewriteframes.rewriteFramesIntegration;exports.sessionTimingIntegration=sessiontiming.sessionTimingIntegration;exports.zodErrorsIntegration=zoderrors.zodErrorsIntegration;exports.thirdPartyErrorFilterIntegration=thirdPartyErrorsFilter.thirdPartyErrorFilterIntegration;exports.metrics=exports$2.metrics;exports.profiler=profiling.profiler;exports.metricsDefault=exportsDefault.metricsDefault;exports.BrowserMetricsAggregator=browserAggregator.BrowserMetricsAggregator;exports.getMetricSummaryJsonForSpan=metricSummary.getMetricSummaryJsonForSpan;exports.addTracingHeadersToFetchRequest=fetch.addTracingHeadersToFetchRequest;exports.instrumentFetchRequest=fetch.instrumentFetchRequest;exports.trpcMiddleware=trpc.trpcMiddleware;exports.captureFeedback=feedback.captureFeedback;exports.getCurrentHub=getCurrentHubShim.getCurrentHub;exports.getCurrentHubShim=getCurrentHubShim.getCurrentHubShim;exports.applyAggregateErrorsToEvent=aggregateErrors.applyAggregateErrorsToEvent;exports.flatten=array.flatten;exports.getBreadcrumbLogLevelFromHttpStatusCode=breadcrumbLogLevel.getBreadcrumbLogLevelFromHttpStatusCode;exports.getComponentName=browser.getComponentName;exports.getDomElement=browser.getDomElement;exports.getLocationHref=browser.getLocationHref;exports.htmlTreeAsString=browser.htmlTreeAsString;exports.dsnFromString=dsn.dsnFromString;exports.dsnToString=dsn.dsnToString;exports.makeDsn=dsn.makeDsn;exports.SentryError=error.SentryError;exports.GLOBAL_OBJ=worldwide.GLOBAL_OBJ;exports.getGlobalSingleton=worldwide.getGlobalSingleton;exports.addConsoleInstrumentationHandler=console.addConsoleInstrumentationHandler;exports.addFetchEndInstrumentationHandler=fetch$1.addFetchEndInstrumentationHandler;exports.addFetchInstrumentationHandler=fetch$1.addFetchInstrumentationHandler;exports.addGlobalErrorInstrumentationHandler=globalError.addGlobalErrorInstrumentationHandler;exports.addGlobalUnhandledRejectionInstrumentationHandler=globalUnhandledRejection.addGlobalUnhandledRejectionInstrumentationHandler;exports.addHandler=handlers.addHandler;exports.maybeInstrument=handlers.maybeInstrument;exports.resetInstrumentationHandlers=handlers.resetInstrumentationHandlers;exports.triggerHandlers=handlers.triggerHandlers;exports.isDOMError=is.isDOMError;exports.isDOMException=is.isDOMException;exports.isElement=is.isElement;exports.isError=is.isError;exports.isErrorEvent=is.isErrorEvent;exports.isEvent=is.isEvent;exports.isInstanceOf=is.isInstanceOf;exports.isParameterizedString=is.isParameterizedString;exports.isPlainObject=is.isPlainObject;exports.isPrimitive=is.isPrimitive;exports.isRegExp=is.isRegExp;exports.isString=is.isString;exports.isSyntheticEvent=is.isSyntheticEvent;exports.isThenable=is.isThenable;exports.isVueViewModel=is.isVueViewModel;exports.isBrowser=isBrowser.isBrowser;exports.CONSOLE_LEVELS=logger.CONSOLE_LEVELS;exports.consoleSandbox=logger.consoleSandbox;exports.logger=logger.logger;exports.originalConsoleMethods=logger.originalConsoleMethods;exports.memoBuilder=memo.memoBuilder;exports.addContextToFrame=misc.addContextToFrame;exports.addExceptionMechanism=misc.addExceptionMechanism;exports.addExceptionTypeValue=misc.addExceptionTypeValue;exports.arrayify=misc.arrayify;exports.checkOrSetAlreadyCaught=misc.checkOrSetAlreadyCaught;exports.getEventDescription=misc.getEventDescription;exports.parseSemver=misc.parseSemver;exports.uuid4=misc.uuid4;exports.dynamicRequire=node.dynamicRequire;exports.isNodeEnv=node.isNodeEnv;exports.loadModule=node.loadModule;exports.normalize=normalize.normalize;exports.normalizeToSize=normalize.normalizeToSize;exports.normalizeUrlToBase=normalize.normalizeUrlToBase;exports.addNonEnumerableProperty=object.addNonEnumerableProperty;exports.convertToPlainObject=object.convertToPlainObject;exports.dropUndefinedKeys=object.dropUndefinedKeys;exports.extractExceptionKeysForMessage=object.extractExceptionKeysForMessage;exports.fill=object.fill;exports.getOriginalFunction=object.getOriginalFunction;exports.markFunctionWrapped=object.markFunctionWrapped;exports.objectify=object.objectify;exports.urlEncode=object.urlEncode;exports.basename=path.basename;exports.dirname=path.dirname;exports.isAbsolute=path.isAbsolute;exports.join=path.join;exports.normalizePath=path.normalizePath;exports.relative=path.relative;exports.resolve=path.resolve;exports.makePromiseBuffer=promisebuffer.makePromiseBuffer;exports.DEFAULT_USER_INCLUDES=requestdata$1.DEFAULT_USER_INCLUDES;exports.addNormalizedRequestDataToEvent=requestdata$1.addNormalizedRequestDataToEvent;exports.addRequestDataToEvent=requestdata$1.addRequestDataToEvent;exports.extractPathForTransaction=requestdata$1.extractPathForTransaction;exports.extractQueryParamsFromUrl=requestdata$1.extractQueryParamsFromUrl;exports.extractRequestData=requestdata$1.extractRequestData;exports.headersToDict=requestdata$1.headersToDict;exports.httpRequestToRequestData=requestdata$1.httpRequestToRequestData;exports.winterCGHeadersToDict=requestdata$1.winterCGHeadersToDict;exports.winterCGRequestToRequestData=requestdata$1.winterCGRequestToRequestData;exports.severityLevelFromString=severity.severityLevelFromString;exports.validSeverityLevels=severity.validSeverityLevels;exports.UNKNOWN_FUNCTION=stacktrace.UNKNOWN_FUNCTION;exports.createStackParser=stacktrace.createStackParser;exports.getFramesFromEvent=stacktrace.getFramesFromEvent;exports.getFunctionName=stacktrace.getFunctionName;exports.stackParserFromStackParserOptions=stacktrace.stackParserFromStackParserOptions;exports.stripSentryFramesAndReverse=stacktrace.stripSentryFramesAndReverse;exports.filenameIsInApp=nodeStackTrace.filenameIsInApp;exports.node=nodeStackTrace.node;exports.nodeStackLineParser=nodeStackTrace.nodeStackLineParser;exports.isMatchingPattern=string.isMatchingPattern;exports.safeJoin=string.safeJoin;exports.snipLine=string.snipLine;exports.stringMatchesSomePattern=string.stringMatchesSomePattern;exports.truncate=string.truncate;exports.isNativeFunction=supports.isNativeFunction;exports.supportsDOMError=supports.supportsDOMError;exports.supportsDOMException=supports.supportsDOMException;exports.supportsErrorEvent=supports.supportsErrorEvent;exports.supportsFetch=supports.supportsFetch;exports.supportsNativeFetch=supports.supportsNativeFetch;exports.supportsReferrerPolicy=supports.supportsReferrerPolicy;exports.supportsReportingObserver=supports.supportsReportingObserver;exports.SyncPromise=syncpromise.SyncPromise;exports.rejectedSyncPromise=syncpromise.rejectedSyncPromise;exports.resolvedSyncPromise=syncpromise.resolvedSyncPromise;Object.defineProperty(exports,"_browserPerformanceTimeOriginMode",{enumerable:true,get:()=>time._browserPerformanceTimeOriginMode});exports.browserPerformanceTimeOrigin=time.browserPerformanceTimeOrigin;exports.dateTimestampInSeconds=time.dateTimestampInSeconds;exports.timestampInSeconds=time.timestampInSeconds;exports.TRACEPARENT_REGEXP=tracing.TRACEPARENT_REGEXP;exports.extractTraceparentData=tracing.extractTraceparentData;exports.generateSentryTraceHeader=tracing.generateSentryTraceHeader;exports.propagationContextFromHeaders=tracing.propagationContextFromHeaders;exports.getSDKSource=env.getSDKSource;exports.isBrowserBundle=env.isBrowserBundle;exports.addItemToEnvelope=envelope$1.addItemToEnvelope;exports.createAttachmentEnvelopeItem=envelope$1.createAttachmentEnvelopeItem;exports.createEnvelope=envelope$1.createEnvelope;exports.createEventEnvelopeHeaders=envelope$1.createEventEnvelopeHeaders;exports.createSpanEnvelopeItem=envelope$1.createSpanEnvelopeItem;exports.envelopeContainsItemType=envelope$1.envelopeContainsItemType;exports.envelopeItemTypeToDataCategory=envelope$1.envelopeItemTypeToDataCategory;exports.forEachEnvelopeItem=envelope$1.forEachEnvelopeItem;exports.getSdkMetadataForEnvelopeHeader=envelope$1.getSdkMetadataForEnvelopeHeader;exports.parseEnvelope=envelope$1.parseEnvelope;exports.serializeEnvelope=envelope$1.serializeEnvelope;exports.createClientReportEnvelope=clientreport.createClientReportEnvelope;exports.DEFAULT_RETRY_AFTER=ratelimit.DEFAULT_RETRY_AFTER;exports.disabledUntil=ratelimit.disabledUntil;exports.isRateLimited=ratelimit.isRateLimited;exports.parseRetryAfterHeader=ratelimit.parseRetryAfterHeader;exports.updateRateLimits=ratelimit.updateRateLimits;exports.BAGGAGE_HEADER_NAME=baggage.BAGGAGE_HEADER_NAME;exports.MAX_BAGGAGE_STRING_LENGTH=baggage.MAX_BAGGAGE_STRING_LENGTH;exports.SENTRY_BAGGAGE_KEY_PREFIX=baggage.SENTRY_BAGGAGE_KEY_PREFIX;exports.SENTRY_BAGGAGE_KEY_PREFIX_REGEX=baggage.SENTRY_BAGGAGE_KEY_PREFIX_REGEX;exports.baggageHeaderToDynamicSamplingContext=baggage.baggageHeaderToDynamicSamplingContext;exports.dynamicSamplingContextToSentryBaggageHeader=baggage.dynamicSamplingContextToSentryBaggageHeader;exports.parseBaggageHeader=baggage.parseBaggageHeader;exports.getNumberOfUrlSegments=url.getNumberOfUrlSegments;exports.getSanitizedUrlString=url.getSanitizedUrlString;exports.parseUrl=url.parseUrl;exports.stripUrlQueryAndFragment=url.stripUrlQueryAndFragment;exports.makeFifoCache=cache.makeFifoCache;exports.eventFromMessage=eventbuilder.eventFromMessage;exports.eventFromUnknownInput=eventbuilder.eventFromUnknownInput;exports.exceptionFromError=eventbuilder.exceptionFromError;exports.parseStackFrames=eventbuilder.parseStackFrames;exports.callFrameToStackFrame=anr.callFrameToStackFrame;exports.watchdogTimer=anr.watchdogTimer;exports.LRUMap=lru.LRUMap;exports.generatePropagationContext=propagationContext.generatePropagationContext;exports.generateSpanId=propagationContext.generateSpanId;exports.generateTraceId=propagationContext.generateTraceId;exports.vercelWaitUntil=vercelWaitUntil.vercelWaitUntil;exports.SDK_VERSION=version.SDK_VERSION;exports.getDebugImagesForResources=debugIds.getDebugImagesForResources;exports.getFilenameToDebugIdMap=debugIds.getFilenameToDebugIdMap;exports.escapeStringForRegex=escapeStringForRegex.escapeStringForRegex;exports.supportsHistory=supportsHistory.supportsHistory;exports._asyncNullishCoalesce=_asyncNullishCoalesce._asyncNullishCoalesce;exports._asyncOptionalChain=_asyncOptionalChain._asyncOptionalChain;exports._asyncOptionalChainDelete=_asyncOptionalChainDelete._asyncOptionalChainDelete;exports._nullishCoalesce=_nullishCoalesce._nullishCoalesce;exports._optionalChain=_optionalChain._optionalChain;exports._optionalChainDelete=_optionalChainDelete._optionalChainDelete},{"./api.js":70,"./asyncContext/index.js":71,"./baseclient.js":73,"./breadcrumbs.js":74,"./carrier.js":75,"./checkin.js":76,"./constants.js":77,"./currentScopes.js":78,"./defaultScopes.js":80,"./envelope.js":81,"./eventProcessors.js":82,"./exports.js":83,"./feedback.js":84,"./fetch.js":85,"./getCurrentHubShim.js":86,"./integration.js":88,"./integrations/captureconsole.js":89,"./integrations/debug.js":90,"./integrations/dedupe.js":91,"./integrations/extraerrordata.js":92,"./integrations/functiontostring.js":93,"./integrations/inboundfilters.js":94,"./integrations/linkederrors.js":95,"./integrations/metadata.js":96,"./integrations/requestdata.js":97,"./integrations/rewriteframes.js":98,"./integrations/sessiontiming.js":99,"./integrations/third-party-errors-filter.js":100,"./integrations/zoderrors.js":101,"./metrics/browser-aggregator.js":104,"./metrics/exports-default.js":107,"./metrics/exports.js":108,"./metrics/metric-summary.js":110,"./profiling.js":112,"./scope.js":113,"./sdk.js":114,"./semanticAttributes.js":115,"./server-runtime-client.js":116,"./session.js":117,"./sessionflusher.js":118,"./tracing/dynamicSamplingContext.js":119,"./tracing/errors.js":120,"./tracing/hubextensions.js":121,"./tracing/idleSpan.js":122,"./tracing/logSpans.js":123,"./tracing/measurement.js":124,"./tracing/sampling.js":125,"./tracing/sentryNonRecordingSpan.js":126,"./tracing/sentrySpan.js":127,"./tracing/spanstatus.js":128,"./tracing/trace.js":129,"./tracing/utils.js":130,"./transports/base.js":131,"./transports/multiplexed.js":132,"./transports/offline.js":133,"./trpc.js":134,"./utils-hoist/aggregate-errors.js":135,"./utils-hoist/anr.js":136,"./utils-hoist/array.js":137,"./utils-hoist/baggage.js":138,"./utils-hoist/breadcrumb-log-level.js":139,"./utils-hoist/browser.js":140,"./utils-hoist/buildPolyfills/_asyncNullishCoalesce.js":141,"./utils-hoist/buildPolyfills/_asyncOptionalChain.js":142,"./utils-hoist/buildPolyfills/_asyncOptionalChainDelete.js":143,"./utils-hoist/buildPolyfills/_nullishCoalesce.js":144,"./utils-hoist/buildPolyfills/_optionalChain.js":145,"./utils-hoist/buildPolyfills/_optionalChainDelete.js":146,"./utils-hoist/cache.js":147,"./utils-hoist/clientreport.js":148,"./utils-hoist/debug-ids.js":151,"./utils-hoist/dsn.js":152,"./utils-hoist/env.js":153,"./utils-hoist/envelope.js":154,"./utils-hoist/error.js":155,"./utils-hoist/eventbuilder.js":156,"./utils-hoist/instrument/console.js":157,"./utils-hoist/instrument/fetch.js":158,"./utils-hoist/instrument/globalError.js":159,"./utils-hoist/instrument/globalUnhandledRejection.js":160,"./utils-hoist/instrument/handlers.js":161,"./utils-hoist/is.js":162,"./utils-hoist/isBrowser.js":163,"./utils-hoist/logger.js":164,"./utils-hoist/lru.js":165,"./utils-hoist/memo.js":166,"./utils-hoist/misc.js":167,"./utils-hoist/node-stack-trace.js":168,"./utils-hoist/node.js":169,"./utils-hoist/normalize.js":170,"./utils-hoist/object.js":171,"./utils-hoist/path.js":172,"./utils-hoist/promisebuffer.js":173,"./utils-hoist/propagationContext.js":174,"./utils-hoist/ratelimit.js":175,"./utils-hoist/requestdata.js":176,"./utils-hoist/severity.js":177,"./utils-hoist/stacktrace.js":178,"./utils-hoist/string.js":179,"./utils-hoist/supports.js":180,"./utils-hoist/syncpromise.js":181,"./utils-hoist/time.js":182,"./utils-hoist/tracing.js":183,"./utils-hoist/url.js":184,"./utils-hoist/vendor/escapeStringForRegex.js":185,"./utils-hoist/vendor/supportsHistory.js":187,"./utils-hoist/vercelWaitUntil.js":188,"./utils-hoist/version.js":189,"./utils-hoist/worldwide.js":190,"./utils/applyScopeDataToEvent.js":191,"./utils/handleCallbackErrors.js":192,"./utils/hasTracingEnabled.js":193,"./utils/isSentryRequestUrl.js":194,"./utils/meta.js":196,"./utils/parameterize.js":197,"./utils/parseSampleRate.js":198,"./utils/prepareEvent.js":199,"./utils/sdkMetadata.js":200,"./utils/spanUtils.js":202,"./utils/traceData.js":203}],88:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("./currentScopes.js");const debugBuild=require("./debug-build.js");const logger=require("./utils-hoist/logger.js");const installedIntegrations=[];function filterDuplicates(integrations){const integrationsByName={};integrations.forEach(currentInstance=>{const{name}=currentInstance;const existingInstance=integrationsByName[name];if(existingInstance&&!existingInstance.isDefaultInstance&&currentInstance.isDefaultInstance){return}integrationsByName[name]=currentInstance});return Object.values(integrationsByName)}function getIntegrationsToSetup(options){const defaultIntegrations=options.defaultIntegrations||[];const userIntegrations=options.integrations;defaultIntegrations.forEach(integration=>{integration.isDefaultInstance=true});let integrations;if(Array.isArray(userIntegrations)){integrations=[...defaultIntegrations,...userIntegrations]}else if(typeof userIntegrations==="function"){const resolvedUserIntegrations=userIntegrations(defaultIntegrations);integrations=Array.isArray(resolvedUserIntegrations)?resolvedUserIntegrations:[resolvedUserIntegrations]}else{integrations=defaultIntegrations}const finalIntegrations=filterDuplicates(integrations);const debugIndex=finalIntegrations.findIndex(integration=>integration.name==="Debug");if(debugIndex>-1){const[debugInstance]=finalIntegrations.splice(debugIndex,1);finalIntegrations.push(debugInstance)}return finalIntegrations}function setupIntegrations(client,integrations){const integrationIndex={};integrations.forEach(integration=>{if(integration){setupIntegration(client,integration,integrationIndex)}});return integrationIndex}function afterSetupIntegrations(client,integrations){for(const integration of integrations){if(integration&&integration.afterAllSetup){integration.afterAllSetup(client)}}}function setupIntegration(client,integration,integrationIndex){if(integrationIndex[integration.name]){debugBuild.DEBUG_BUILD&&logger.logger.log(`Integration skipped because it was already installed: ${integration.name}`);return}integrationIndex[integration.name]=integration;if(installedIntegrations.indexOf(integration.name)===-1&&typeof integration.setupOnce==="function"){integration.setupOnce();installedIntegrations.push(integration.name)}if(integration.setup&&typeof integration.setup==="function"){integration.setup(client)}if(typeof integration.preprocessEvent==="function"){const callback=integration.preprocessEvent.bind(integration);client.on("preprocessEvent",(event,hint)=>callback(event,hint,client))}if(typeof integration.processEvent==="function"){const callback=integration.processEvent.bind(integration);const processor=Object.assign((event,hint)=>callback(event,hint,client),{id:integration.name});client.addEventProcessor(processor)}debugBuild.DEBUG_BUILD&&logger.logger.log(`Integration installed: ${integration.name}`)}function addIntegration(integration){const client=currentScopes.getClient();if(!client){debugBuild.DEBUG_BUILD&&logger.logger.warn(`Cannot add integration "${integration.name}" because no SDK Client is available.`);return}client.addIntegration(integration)}function defineIntegration(fn){return fn}exports.addIntegration=addIntegration;exports.afterSetupIntegrations=afterSetupIntegrations;exports.defineIntegration=defineIntegration;exports.getIntegrationsToSetup=getIntegrationsToSetup;exports.installedIntegrations=installedIntegrations;exports.setupIntegration=setupIntegration;exports.setupIntegrations=setupIntegrations},{"./currentScopes.js":78,"./debug-build.js":79,"./utils-hoist/logger.js":164}],89:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("../currentScopes.js");const exports$1=require("../exports.js");const integration=require("../integration.js");const console=require("../utils-hoist/instrument/console.js");const logger=require("../utils-hoist/logger.js");const misc=require("../utils-hoist/misc.js");const severity=require("../utils-hoist/severity.js");const string=require("../utils-hoist/string.js");const worldwide=require("../utils-hoist/worldwide.js");const INTEGRATION_NAME="CaptureConsole";const _captureConsoleIntegration=(options={})=>{const levels=options.levels||logger.CONSOLE_LEVELS;const handled=!!options.handled;return{name:INTEGRATION_NAME,setup(client){if(!("console"in worldwide.GLOBAL_OBJ)){return}console.addConsoleInstrumentationHandler(({args,level})=>{if(currentScopes.getClient()!==client||!levels.includes(level)){return}consoleHandler(args,level,handled)})}}};const captureConsoleIntegration=integration.defineIntegration(_captureConsoleIntegration);function consoleHandler(args,level,handled){const captureContext={level:severity.severityLevelFromString(level),extra:{arguments:args}};currentScopes.withScope(scope=>{scope.addEventProcessor(event=>{event.logger="console";misc.addExceptionMechanism(event,{handled:handled,type:"console"});return event});if(level==="assert"){if(!args[0]){const message=`Assertion failed: ${string.safeJoin(args.slice(1)," ")||"console.assert"}`;scope.setExtra("arguments",args.slice(1));exports$1.captureMessage(message,captureContext)}return}const error=args.find(arg=>arg instanceof Error);if(error){exports$1.captureException(error,captureContext);return}const message=string.safeJoin(args," ");exports$1.captureMessage(message,captureContext)})}exports.captureConsoleIntegration=captureConsoleIntegration},{"../currentScopes.js":78,"../exports.js":83,"../integration.js":88,"../utils-hoist/instrument/console.js":157,"../utils-hoist/logger.js":164,"../utils-hoist/misc.js":167,"../utils-hoist/severity.js":177,"../utils-hoist/string.js":179,"../utils-hoist/worldwide.js":190}],90:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const integration=require("../integration.js");const logger=require("../utils-hoist/logger.js");const INTEGRATION_NAME="Debug";const _debugIntegration=(options={})=>{const _options={debugger:false,stringify:false,...options};return{name:INTEGRATION_NAME,setup(client){client.on("beforeSendEvent",(event,hint)=>{if(_options.debugger){debugger}logger.consoleSandbox(()=>{if(_options.stringify){console.log(JSON.stringify(event,null,2));if(hint&&Object.keys(hint).length){console.log(JSON.stringify(hint,null,2))}}else{console.log(event);if(hint&&Object.keys(hint).length){console.log(hint)}}})})}}};const debugIntegration=integration.defineIntegration(_debugIntegration);exports.debugIntegration=debugIntegration},{"../integration.js":88,"../utils-hoist/logger.js":164}],91:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const integration=require("../integration.js");const debugBuild=require("../debug-build.js");const logger=require("../utils-hoist/logger.js");const stacktrace=require("../utils-hoist/stacktrace.js");const INTEGRATION_NAME="Dedupe";const _dedupeIntegration=()=>{let previousEvent;return{name:INTEGRATION_NAME,processEvent(currentEvent){if(currentEvent.type){return currentEvent}try{if(_shouldDropEvent(currentEvent,previousEvent)){debugBuild.DEBUG_BUILD&&logger.logger.warn("Event dropped due to being a duplicate of previously captured event.");return null}}catch(_oO){}return previousEvent=currentEvent}}};const dedupeIntegration=integration.defineIntegration(_dedupeIntegration);function _shouldDropEvent(currentEvent,previousEvent){if(!previousEvent){return false}if(_isSameMessageEvent(currentEvent,previousEvent)){return true}if(_isSameExceptionEvent(currentEvent,previousEvent)){return true}return false}function _isSameMessageEvent(currentEvent,previousEvent){const currentMessage=currentEvent.message;const previousMessage=previousEvent.message;if(!currentMessage&&!previousMessage){return false}if(currentMessage&&!previousMessage||!currentMessage&&previousMessage){return false}if(currentMessage!==previousMessage){return false}if(!_isSameFingerprint(currentEvent,previousEvent)){return false}if(!_isSameStacktrace(currentEvent,previousEvent)){return false}return true}function _isSameExceptionEvent(currentEvent,previousEvent){const previousException=_getExceptionFromEvent(previousEvent);const currentException=_getExceptionFromEvent(currentEvent);if(!previousException||!currentException){return false}if(previousException.type!==currentException.type||previousException.value!==currentException.value){return false}if(!_isSameFingerprint(currentEvent,previousEvent)){return false}if(!_isSameStacktrace(currentEvent,previousEvent)){return false}return true}function _isSameStacktrace(currentEvent,previousEvent){let currentFrames=stacktrace.getFramesFromEvent(currentEvent);let previousFrames=stacktrace.getFramesFromEvent(previousEvent);if(!currentFrames&&!previousFrames){return true}if(currentFrames&&!previousFrames||!currentFrames&&previousFrames){return false}currentFrames=currentFrames;previousFrames=previousFrames;if(previousFrames.length!==currentFrames.length){return false}for(let i=0;i<previousFrames.length;i++){const frameA=previousFrames[i];const frameB=currentFrames[i];if(frameA.filename!==frameB.filename||frameA.lineno!==frameB.lineno||frameA.colno!==frameB.colno||frameA.function!==frameB.function){return false}}return true}function _isSameFingerprint(currentEvent,previousEvent){let currentFingerprint=currentEvent.fingerprint;let previousFingerprint=previousEvent.fingerprint;if(!currentFingerprint&&!previousFingerprint){return true}if(currentFingerprint&&!previousFingerprint||!currentFingerprint&&previousFingerprint){return false}currentFingerprint=currentFingerprint;previousFingerprint=previousFingerprint;try{return!!(currentFingerprint.join("")===previousFingerprint.join(""))}catch(_oO){return false}}function _getExceptionFromEvent(event){return event.exception&&event.exception.values&&event.exception.values[0]}exports._shouldDropEvent=_shouldDropEvent;exports.dedupeIntegration=dedupeIntegration},{"../debug-build.js":79,"../integration.js":88,"../utils-hoist/logger.js":164,"../utils-hoist/stacktrace.js":178}],92:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const integration=require("../integration.js");const debugBuild=require("../debug-build.js");const is=require("../utils-hoist/is.js");const logger=require("../utils-hoist/logger.js");const normalize=require("../utils-hoist/normalize.js");const object=require("../utils-hoist/object.js");const string=require("../utils-hoist/string.js");const INTEGRATION_NAME="ExtraErrorData";const _extraErrorDataIntegration=(options={})=>{const{depth=3,captureErrorCause=true}=options;return{name:INTEGRATION_NAME,processEvent(event,hint,client){const{maxValueLength=250}=client.getOptions();return _enhanceEventWithErrorData(event,hint,depth,captureErrorCause,maxValueLength)}}};const extraErrorDataIntegration=integration.defineIntegration(_extraErrorDataIntegration);function _enhanceEventWithErrorData(event,hint={},depth,captureErrorCause,maxValueLength){if(!hint.originalException||!is.isError(hint.originalException)){return event}const exceptionName=hint.originalException.name||hint.originalException.constructor.name;const errorData=_extractErrorData(hint.originalException,captureErrorCause,maxValueLength);if(errorData){const contexts={...event.contexts};const normalizedErrorData=normalize.normalize(errorData,depth);if(is.isPlainObject(normalizedErrorData)){object.addNonEnumerableProperty(normalizedErrorData,"__sentry_skip_normalization__",true);contexts[exceptionName]=normalizedErrorData}return{...event,contexts:contexts}}return event}function _extractErrorData(error,captureErrorCause,maxValueLength){try{const nativeKeys=["name","message","stack","line","column","fileName","lineNumber","columnNumber","toJSON"];const extraErrorInfo={};for(const key of Object.keys(error)){if(nativeKeys.indexOf(key)!==-1){continue}const value=error[key];extraErrorInfo[key]=is.isError(value)||typeof value==="string"?string.truncate(`${value}`,maxValueLength):value}if(captureErrorCause&&error.cause!==undefined){extraErrorInfo.cause=is.isError(error.cause)?error.cause.toString():error.cause}if(typeof error.toJSON==="function"){const serializedError=error.toJSON();for(const key of Object.keys(serializedError)){const value=serializedError[key];extraErrorInfo[key]=is.isError(value)?value.toString():value}}return extraErrorInfo}catch(oO){debugBuild.DEBUG_BUILD&&logger.logger.error("Unable to extract extra data from the Error object:",oO)}return null}exports.extraErrorDataIntegration=extraErrorDataIntegration},{"../debug-build.js":79,"../integration.js":88,"../utils-hoist/is.js":162,"../utils-hoist/logger.js":164,"../utils-hoist/normalize.js":170,"../utils-hoist/object.js":171,"../utils-hoist/string.js":179}],93:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("../currentScopes.js");const integration=require("../integration.js");const object=require("../utils-hoist/object.js");let originalFunctionToString;const INTEGRATION_NAME="FunctionToString";const SETUP_CLIENTS=new WeakMap;const _functionToStringIntegration=()=>{return{name:INTEGRATION_NAME,setupOnce(){originalFunctionToString=Function.prototype.toString;try{Function.prototype.toString=function(...args){const originalFunction=object.getOriginalFunction(this);const context=SETUP_CLIENTS.has(currentScopes.getClient())&&originalFunction!==undefined?originalFunction:this;return originalFunctionToString.apply(context,args)}}catch(e){}},setup(client){SETUP_CLIENTS.set(client,true)}}};const functionToStringIntegration=integration.defineIntegration(_functionToStringIntegration);exports.functionToStringIntegration=functionToStringIntegration},{"../currentScopes.js":78,"../integration.js":88,"../utils-hoist/object.js":171}],94:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const debugBuild=require("../debug-build.js");const integration=require("../integration.js");const logger=require("../utils-hoist/logger.js");const misc=require("../utils-hoist/misc.js");const string=require("../utils-hoist/string.js");const DEFAULT_IGNORE_ERRORS=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",'can\'t redefine non-configurable property "solana"',"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/];const INTEGRATION_NAME="InboundFilters";const _inboundFiltersIntegration=(options={})=>{return{name:INTEGRATION_NAME,processEvent(event,_hint,client){const clientOptions=client.getOptions();const mergedOptions=_mergeOptions(options,clientOptions);return _shouldDropEvent(event,mergedOptions)?null:event}}};const inboundFiltersIntegration=integration.defineIntegration(_inboundFiltersIntegration);function _mergeOptions(internalOptions={},clientOptions={}){return{allowUrls:[...internalOptions.allowUrls||[],...clientOptions.allowUrls||[]],denyUrls:[...internalOptions.denyUrls||[],...clientOptions.denyUrls||[]],ignoreErrors:[...internalOptions.ignoreErrors||[],...clientOptions.ignoreErrors||[],...internalOptions.disableErrorDefaults?[]:DEFAULT_IGNORE_ERRORS],ignoreTransactions:[...internalOptions.ignoreTransactions||[],...clientOptions.ignoreTransactions||[]],ignoreInternal:internalOptions.ignoreInternal!==undefined?internalOptions.ignoreInternal:true}}function _shouldDropEvent(event,options){if(options.ignoreInternal&&_isSentryError(event)){debugBuild.DEBUG_BUILD&&logger.logger.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${misc.getEventDescription(event)}`);return true}if(_isIgnoredError(event,options.ignoreErrors)){debugBuild.DEBUG_BUILD&&logger.logger.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${misc.getEventDescription(event)}`);return true}if(_isUselessError(event)){debugBuild.DEBUG_BUILD&&logger.logger.warn(`Event dropped due to not having an error message, error type or stacktrace.\nEvent: ${misc.getEventDescription(event)}`);return true}if(_isIgnoredTransaction(event,options.ignoreTransactions)){debugBuild.DEBUG_BUILD&&logger.logger.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${misc.getEventDescription(event)}`);return true}if(_isDeniedUrl(event,options.denyUrls)){debugBuild.DEBUG_BUILD&&logger.logger.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${misc.getEventDescription(event)}.\nUrl: ${_getEventFilterUrl(event)}`);return true}if(!_isAllowedUrl(event,options.allowUrls)){debugBuild.DEBUG_BUILD&&logger.logger.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${misc.getEventDescription(event)}.\nUrl: ${_getEventFilterUrl(event)}`);return true}return false}function _isIgnoredError(event,ignoreErrors){if(event.type||!ignoreErrors||!ignoreErrors.length){return false}return _getPossibleEventMessages(event).some(message=>string.stringMatchesSomePattern(message,ignoreErrors))}function _isIgnoredTransaction(event,ignoreTransactions){if(event.type!=="transaction"||!ignoreTransactions||!ignoreTransactions.length){return false}const name=event.transaction;return name?string.stringMatchesSomePattern(name,ignoreTransactions):false}function _isDeniedUrl(event,denyUrls){if(!denyUrls||!denyUrls.length){return false}const url=_getEventFilterUrl(event);return!url?false:string.stringMatchesSomePattern(url,denyUrls)}function _isAllowedUrl(event,allowUrls){if(!allowUrls||!allowUrls.length){return true}const url=_getEventFilterUrl(event);return!url?true:string.stringMatchesSomePattern(url,allowUrls)}function _getPossibleEventMessages(event){const possibleMessages=[];if(event.message){possibleMessages.push(event.message)}let lastException;try{lastException=event.exception.values[event.exception.values.length-1]}catch(e){}if(lastException){if(lastException.value){possibleMessages.push(lastException.value);if(lastException.type){possibleMessages.push(`${lastException.type}: ${lastException.value}`)}}}return possibleMessages}function _isSentryError(event){try{return event.exception.values[0].type==="SentryError"}catch(e){}return false}function _getLastValidUrl(frames=[]){for(let i=frames.length-1;i>=0;i--){const frame=frames[i];if(frame&&frame.filename!=="<anonymous>"&&frame.filename!=="[native code]"){return frame.filename||null}}return null}function _getEventFilterUrl(event){try{let frames;try{frames=event.exception.values[0].stacktrace.frames}catch(e){}return frames?_getLastValidUrl(frames):null}catch(oO){debugBuild.DEBUG_BUILD&&logger.logger.error(`Cannot extract url for event ${misc.getEventDescription(event)}`);return null}}function _isUselessError(event){if(event.type){return false}if(!event.exception||!event.exception.values||event.exception.values.length===0){return false}return!event.message&&!event.exception.values.some(value=>value.stacktrace||value.type&&value.type!=="Error"||value.value)}exports.inboundFiltersIntegration=inboundFiltersIntegration},{"../debug-build.js":79,"../integration.js":88,"../utils-hoist/logger.js":164,"../utils-hoist/misc.js":167,"../utils-hoist/string.js":179}],95:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const integration=require("../integration.js");const aggregateErrors=require("../utils-hoist/aggregate-errors.js");const eventbuilder=require("../utils-hoist/eventbuilder.js");const DEFAULT_KEY="cause";const DEFAULT_LIMIT=5;const INTEGRATION_NAME="LinkedErrors";const _linkedErrorsIntegration=(options={})=>{const limit=options.limit||DEFAULT_LIMIT;const key=options.key||DEFAULT_KEY;return{name:INTEGRATION_NAME,preprocessEvent(event,hint,client){const options=client.getOptions();aggregateErrors.applyAggregateErrorsToEvent(eventbuilder.exceptionFromError,options.stackParser,options.maxValueLength,key,limit,event,hint)}}};const linkedErrorsIntegration=integration.defineIntegration(_linkedErrorsIntegration);exports.linkedErrorsIntegration=linkedErrorsIntegration},{"../integration.js":88,"../utils-hoist/aggregate-errors.js":135,"../utils-hoist/eventbuilder.js":156}],96:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const integration=require("../integration.js");const metadata=require("../metadata.js");const envelope=require("../utils-hoist/envelope.js");const moduleMetadataIntegration=integration.defineIntegration(()=>{return{name:"ModuleMetadata",setup(client){client.on("beforeEnvelope",envelope$1=>{envelope.forEachEnvelopeItem(envelope$1,(item,type)=>{if(type==="event"){const event=Array.isArray(item)?item[1]:undefined;if(event){metadata.stripMetadataFromStackFrames(event);item[1]=event}}})});client.on("applyFrameMetadata",event=>{if(event.type){return}const stackParser=client.getOptions().stackParser;metadata.addMetadataToStackFrames(stackParser,event)})}}});exports.moduleMetadataIntegration=moduleMetadataIntegration},{"../integration.js":88,"../metadata.js":102,"../utils-hoist/envelope.js":154}],97:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const integration=require("../integration.js");const requestdata=require("../utils-hoist/requestdata.js");const DEFAULT_OPTIONS={include:{cookies:true,data:true,headers:true,ip:false,query_string:true,url:true,user:{id:true,username:true,email:true}},transactionNamingScheme:"methodPath"};const INTEGRATION_NAME="RequestData";const _requestDataIntegration=(options={})=>{const _options={...DEFAULT_OPTIONS,...options,include:{...DEFAULT_OPTIONS.include,...options.include,user:options.include&&typeof options.include.user==="boolean"?options.include.user:{...DEFAULT_OPTIONS.include.user,...(options.include||{}).user}}};return{name:INTEGRATION_NAME,processEvent(event){const{sdkProcessingMetadata={}}=event;const{request,normalizedRequest}=sdkProcessingMetadata;const addRequestDataOptions=convertReqDataIntegrationOptsToAddReqDataOpts(_options);if(normalizedRequest){const ipAddress=request?request.ip||request.socket&&request.socket.remoteAddress:undefined;const user=request?request.user:undefined;requestdata.addNormalizedRequestDataToEvent(event,normalizedRequest,{ipAddress:ipAddress,user:user},addRequestDataOptions);return event}if(!request){return event}return requestdata.addRequestDataToEvent(event,request,addRequestDataOptions)}}};const requestDataIntegration=integration.defineIntegration(_requestDataIntegration);function convertReqDataIntegrationOptsToAddReqDataOpts(integrationOptions){const{transactionNamingScheme,include:{ip,user,...requestOptions}}=integrationOptions;const requestIncludeKeys=["method"];for(const[key,value]of Object.entries(requestOptions)){if(value){requestIncludeKeys.push(key)}}let addReqDataUserOpt;if(user===undefined){addReqDataUserOpt=true}else if(typeof user==="boolean"){addReqDataUserOpt=user}else{const userIncludeKeys=[];for(const[key,value]of Object.entries(user)){if(value){userIncludeKeys.push(key)}}addReqDataUserOpt=userIncludeKeys}return{include:{ip:ip,user:addReqDataUserOpt,request:requestIncludeKeys.length!==0?requestIncludeKeys:undefined,transaction:transactionNamingScheme}}}exports.requestDataIntegration=requestDataIntegration},{"../integration.js":88,"../utils-hoist/requestdata.js":176}],98:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const integration=require("../integration.js");const path=require("../utils-hoist/path.js");const worldwide=require("../utils-hoist/worldwide.js");const INTEGRATION_NAME="RewriteFrames";const rewriteFramesIntegration=integration.defineIntegration((options={})=>{const root=options.root;const prefix=options.prefix||"app:///";const isBrowser="window"in worldwide.GLOBAL_OBJ&&worldwide.GLOBAL_OBJ.window!==undefined;const iteratee=options.iteratee||generateIteratee({isBrowser:isBrowser,root:root,prefix:prefix});function _processExceptionsEvent(event){try{return{...event,exception:{...event.exception,values:event.exception.values.map(value=>({...value,...value.stacktrace&&{stacktrace:_processStacktrace(value.stacktrace)}}))}}}catch(_oO){return event}}function _processStacktrace(stacktrace){return{...stacktrace,frames:stacktrace&&stacktrace.frames&&stacktrace.frames.map(f=>iteratee(f))}}return{name:INTEGRATION_NAME,processEvent(originalEvent){let processedEvent=originalEvent;if(originalEvent.exception&&Array.isArray(originalEvent.exception.values)){processedEvent=_processExceptionsEvent(processedEvent)}return processedEvent}}});function generateIteratee({isBrowser,root,prefix}){return frame=>{if(!frame.filename){return frame}const isWindowsFrame=/^[a-zA-Z]:\\/.test(frame.filename)||frame.filename.includes("\\")&&!frame.filename.includes("/");const startsWithSlash=/^\//.test(frame.filename);if(isBrowser){if(root){const oldFilename=frame.filename;if(oldFilename.indexOf(root)===0){frame.filename=oldFilename.replace(root,prefix)}}}else{if(isWindowsFrame||startsWithSlash){const filename=isWindowsFrame?frame.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):frame.filename;const base=root?path.relative(root,filename):path.basename(filename);frame.filename=`${prefix}${base}`}}return frame}}exports.generateIteratee=generateIteratee;exports.rewriteFramesIntegration=rewriteFramesIntegration},{"../integration.js":88,"../utils-hoist/path.js":172,"../utils-hoist/worldwide.js":190}],99:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const integration=require("../integration.js");const time=require("../utils-hoist/time.js");const INTEGRATION_NAME="SessionTiming";const _sessionTimingIntegration=()=>{const startTime=time.timestampInSeconds()*1e3;return{name:INTEGRATION_NAME,processEvent(event){const now=time.timestampInSeconds()*1e3;return{...event,extra:{...event.extra,["session:start"]:startTime,["session:duration"]:now-startTime,["session:end"]:now}}}}};const sessionTimingIntegration=integration.defineIntegration(_sessionTimingIntegration);exports.sessionTimingIntegration=sessionTimingIntegration},{"../integration.js":88,"../utils-hoist/time.js":182}],100:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const integration=require("../integration.js");const metadata=require("../metadata.js");const envelope=require("../utils-hoist/envelope.js");const stacktrace=require("../utils-hoist/stacktrace.js");const thirdPartyErrorFilterIntegration=integration.defineIntegration(options=>{return{name:"ThirdPartyErrorsFilter",setup(client){client.on("beforeEnvelope",envelope$1=>{envelope.forEachEnvelopeItem(envelope$1,(item,type)=>{if(type==="event"){const event=Array.isArray(item)?item[1]:undefined;if(event){metadata.stripMetadataFromStackFrames(event);item[1]=event}}})});client.on("applyFrameMetadata",event=>{if(event.type){return}const stackParser=client.getOptions().stackParser;metadata.addMetadataToStackFrames(stackParser,event)})},processEvent(event){const frameKeys=getBundleKeysForAllFramesWithFilenames(event);if(frameKeys){const arrayMethod=options.behaviour==="drop-error-if-contains-third-party-frames"||options.behaviour==="apply-tag-if-contains-third-party-frames"?"some":"every";const behaviourApplies=frameKeys[arrayMethod](keys=>!keys.some(key=>options.filterKeys.includes(key)));if(behaviourApplies){const shouldDrop=options.behaviour==="drop-error-if-contains-third-party-frames"||options.behaviour==="drop-error-if-exclusively-contains-third-party-frames";if(shouldDrop){return null}else{event.tags={...event.tags,third_party_code:true}}}}return event}}});function getBundleKeysForAllFramesWithFilenames(event){const frames=stacktrace.getFramesFromEvent(event);if(!frames){return undefined}return frames.filter(frame=>!!frame.filename).map(frame=>{if(frame.module_metadata){return Object.keys(frame.module_metadata).filter(key=>key.startsWith(BUNDLER_PLUGIN_APP_KEY_PREFIX)).map(key=>key.slice(BUNDLER_PLUGIN_APP_KEY_PREFIX.length))}return[]})}const BUNDLER_PLUGIN_APP_KEY_PREFIX="_sentryBundlerPluginAppKey:";exports.thirdPartyErrorFilterIntegration=thirdPartyErrorFilterIntegration},{"../integration.js":88,"../metadata.js":102,"../utils-hoist/envelope.js":154,"../utils-hoist/stacktrace.js":178}],101:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const integration=require("../integration.js");const is=require("../utils-hoist/is.js");const string=require("../utils-hoist/string.js");const DEFAULT_LIMIT=10;const INTEGRATION_NAME="ZodErrors";function originalExceptionIsZodError(originalException){return is.isError(originalException)&&originalException.name==="ZodError"&&Array.isArray(originalException.errors)}function formatIssueTitle(issue){return{...issue,path:"path"in issue&&Array.isArray(issue.path)?issue.path.join("."):undefined,keys:"keys"in issue?JSON.stringify(issue.keys):undefined,unionErrors:"unionErrors"in issue?JSON.stringify(issue.unionErrors):undefined}}function formatIssueMessage(zodError){const errorKeyMap=new Set;for(const iss of zodError.issues){if(iss.path&&iss.path[0]){errorKeyMap.add(iss.path[0])}}const errorKeys=Array.from(errorKeyMap);return`Failed to validate keys: ${string.truncate(errorKeys.join(", "),100)}`}function applyZodErrorsToEvent(limit,event,hint){if(!event.exception||!event.exception.values||!hint||!hint.originalException||!originalExceptionIsZodError(hint.originalException)||hint.originalException.issues.length===0){return event}return{...event,exception:{...event.exception,values:[{...event.exception.values[0],value:formatIssueMessage(hint.originalException)},...event.exception.values.slice(1)]},extra:{...event.extra,"zoderror.issues":hint.originalException.errors.slice(0,limit).map(formatIssueTitle)}}}const _zodErrorsIntegration=(options={})=>{const limit=options.limit||DEFAULT_LIMIT;return{name:INTEGRATION_NAME,processEvent(originalEvent,hint){const processedEvent=applyZodErrorsToEvent(limit,originalEvent,hint);return processedEvent}}};const zodErrorsIntegration=integration.defineIntegration(_zodErrorsIntegration);exports.applyZodErrorsToEvent=applyZodErrorsToEvent;exports.zodErrorsIntegration=zodErrorsIntegration},{"../integration.js":88,"../utils-hoist/is.js":162,"../utils-hoist/string.js":179}],102:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const worldwide=require("./utils-hoist/worldwide.js");const filenameMetadataMap=new Map;const parsedStacks=new Set;function ensureMetadataStacksAreParsed(parser){if(!worldwide.GLOBAL_OBJ._sentryModuleMetadata){return}for(const stack of Object.keys(worldwide.GLOBAL_OBJ._sentryModuleMetadata)){const metadata=worldwide.GLOBAL_OBJ._sentryModuleMetadata[stack];if(parsedStacks.has(stack)){continue}parsedStacks.add(stack);const frames=parser(stack);for(const frame of frames.reverse()){if(frame.filename){filenameMetadataMap.set(frame.filename,metadata);break}}}}function getMetadataForUrl(parser,filename){ensureMetadataStacksAreParsed(parser);return filenameMetadataMap.get(filename)}function addMetadataToStackFrames(parser,event){try{event.exception.values.forEach(exception=>{if(!exception.stacktrace){return}for(const frame of exception.stacktrace.frames||[]){if(!frame.filename||frame.module_metadata){continue}const metadata=getMetadataForUrl(parser,frame.filename);if(metadata){frame.module_metadata=metadata}}})}catch(_){}}function stripMetadataFromStackFrames(event){try{event.exception.values.forEach(exception=>{if(!exception.stacktrace){return}for(const frame of exception.stacktrace.frames||[]){delete frame.module_metadata}})}catch(_){}}exports.addMetadataToStackFrames=addMetadataToStackFrames;exports.getMetadataForUrl=getMetadataForUrl;exports.stripMetadataFromStackFrames=stripMetadataFromStackFrames},{"./utils-hoist/worldwide.js":190}],103:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const time=require("../utils-hoist/time.js");const spanUtils=require("../utils/spanUtils.js");const constants=require("./constants.js");const envelope=require("./envelope.js");const instance=require("./instance.js");const utils=require("./utils.js");class MetricsAggregator{constructor(_client){this._client=_client;this._buckets=new Map;this._bucketsTotalWeight=0;this._interval=setInterval(()=>this._flush(),constants.DEFAULT_FLUSH_INTERVAL);if(this._interval.unref){this._interval.unref()}this._flushShift=Math.floor(Math.random()*constants.DEFAULT_FLUSH_INTERVAL/1e3);this._forceFlush=false}add(metricType,unsanitizedName,value,unsanitizedUnit="none",unsanitizedTags={},maybeFloatTimestamp=time.timestampInSeconds()){const timestamp=Math.floor(maybeFloatTimestamp);const name=utils.sanitizeMetricKey(unsanitizedName);const tags=utils.sanitizeTags(unsanitizedTags);const unit=utils.sanitizeUnit(unsanitizedUnit);const bucketKey=utils.getBucketKey(metricType,name,unit,tags);let bucketItem=this._buckets.get(bucketKey);const previousWeight=bucketItem&&metricType===constants.SET_METRIC_TYPE?bucketItem.metric.weight:0;if(bucketItem){bucketItem.metric.add(value);if(bucketItem.timestamp<timestamp){bucketItem.timestamp=timestamp}}else{bucketItem={metric:new instance.METRIC_MAP[metricType](value),timestamp:timestamp,metricType:metricType,name:name,unit:unit,tags:tags};this._buckets.set(bucketKey,bucketItem)}const val=typeof value==="string"?bucketItem.metric.weight-previousWeight:value;spanUtils.updateMetricSummaryOnActiveSpan(metricType,name,val,unit,unsanitizedTags,bucketKey);this._bucketsTotalWeight+=bucketItem.metric.weight;if(this._bucketsTotalWeight>=constants.MAX_WEIGHT){this.flush()}}flush(){this._forceFlush=true;this._flush()}close(){this._forceFlush=true;clearInterval(this._interval);this._flush()}_flush(){if(this._forceFlush){this._forceFlush=false;this._bucketsTotalWeight=0;this._captureMetrics(this._buckets);this._buckets.clear();return}const cutoffSeconds=Math.floor(time.timestampInSeconds())-constants.DEFAULT_FLUSH_INTERVAL/1e3-this._flushShift;const flushedBuckets=new Map;for(const[key,bucket]of this._buckets){if(bucket.timestamp<=cutoffSeconds){flushedBuckets.set(key,bucket);this._bucketsTotalWeight-=bucket.metric.weight}}for(const[key]of flushedBuckets){this._buckets.delete(key)}this._captureMetrics(flushedBuckets)}_captureMetrics(flushedBuckets){if(flushedBuckets.size>0){const buckets=Array.from(flushedBuckets).map(([,bucketItem])=>bucketItem);envelope.captureAggregateMetrics(this._client,buckets)}}}exports.MetricsAggregator=MetricsAggregator},{"../utils-hoist/time.js":182,"../utils/spanUtils.js":202,"./constants.js":105,"./envelope.js":106,"./instance.js":109,"./utils.js":111}],104:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const time=require("../utils-hoist/time.js");const spanUtils=require("../utils/spanUtils.js");const constants=require("./constants.js");const envelope=require("./envelope.js");const instance=require("./instance.js");const utils=require("./utils.js");class BrowserMetricsAggregator{constructor(_client){this._client=_client;this._buckets=new Map;this._interval=setInterval(()=>this.flush(),constants.DEFAULT_BROWSER_FLUSH_INTERVAL)}add(metricType,unsanitizedName,value,unsanitizedUnit="none",unsanitizedTags={},maybeFloatTimestamp=time.timestampInSeconds()){const timestamp=Math.floor(maybeFloatTimestamp);const name=utils.sanitizeMetricKey(unsanitizedName);const tags=utils.sanitizeTags(unsanitizedTags);const unit=utils.sanitizeUnit(unsanitizedUnit);const bucketKey=utils.getBucketKey(metricType,name,unit,tags);let bucketItem=this._buckets.get(bucketKey);const previousWeight=bucketItem&&metricType===constants.SET_METRIC_TYPE?bucketItem.metric.weight:0;if(bucketItem){bucketItem.metric.add(value);if(bucketItem.timestamp<timestamp){bucketItem.timestamp=timestamp}}else{bucketItem={metric:new instance.METRIC_MAP[metricType](value),timestamp:timestamp,metricType:metricType,name:name,unit:unit,tags:tags};this._buckets.set(bucketKey,bucketItem)}const val=typeof value==="string"?bucketItem.metric.weight-previousWeight:value;spanUtils.updateMetricSummaryOnActiveSpan(metricType,name,val,unit,unsanitizedTags,bucketKey)}flush(){if(this._buckets.size===0){return}const metricBuckets=Array.from(this._buckets.values());envelope.captureAggregateMetrics(this._client,metricBuckets);this._buckets.clear()}close(){clearInterval(this._interval);this.flush()}}exports.BrowserMetricsAggregator=BrowserMetricsAggregator},{"../utils-hoist/time.js":182,"../utils/spanUtils.js":202,"./constants.js":105,"./envelope.js":106,"./instance.js":109,"./utils.js":111}],105:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const COUNTER_METRIC_TYPE="c";const GAUGE_METRIC_TYPE="g";const SET_METRIC_TYPE="s";const DISTRIBUTION_METRIC_TYPE="d";const DEFAULT_BROWSER_FLUSH_INTERVAL=5e3;const DEFAULT_FLUSH_INTERVAL=1e4;const MAX_WEIGHT=1e4;exports.COUNTER_METRIC_TYPE=COUNTER_METRIC_TYPE;exports.DEFAULT_BROWSER_FLUSH_INTERVAL=DEFAULT_BROWSER_FLUSH_INTERVAL;exports.DEFAULT_FLUSH_INTERVAL=DEFAULT_FLUSH_INTERVAL;exports.DISTRIBUTION_METRIC_TYPE=DISTRIBUTION_METRIC_TYPE;exports.GAUGE_METRIC_TYPE=GAUGE_METRIC_TYPE;exports.MAX_WEIGHT=MAX_WEIGHT;exports.SET_METRIC_TYPE=SET_METRIC_TYPE},{}],106:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const dsn=require("../utils-hoist/dsn.js");const envelope=require("../utils-hoist/envelope.js");const logger=require("../utils-hoist/logger.js");const utils=require("./utils.js");function captureAggregateMetrics(client,metricBucketItems){logger.logger.log(`Flushing aggregated metrics, number of metrics: ${metricBucketItems.length}`);const dsn=client.getDsn();const metadata=client.getSdkMetadata();const tunnel=client.getOptions().tunnel;const metricsEnvelope=createMetricEnvelope(metricBucketItems,dsn,metadata,tunnel);client.sendEnvelope(metricsEnvelope)}function createMetricEnvelope(metricBucketItems,dsn$1,metadata,tunnel){const headers={sent_at:(new Date).toISOString()};if(metadata&&metadata.sdk){headers.sdk={name:metadata.sdk.name,version:metadata.sdk.version}}if(!!tunnel&&dsn$1){headers.dsn=dsn.dsnToString(dsn$1)}const item=createMetricEnvelopeItem(metricBucketItems);return envelope.createEnvelope(headers,[item])}function createMetricEnvelopeItem(metricBucketItems){const payload=utils.serializeMetricBuckets(metricBucketItems);const metricHeaders={type:"statsd",length:payload.length};return[metricHeaders,payload]}exports.captureAggregateMetrics=captureAggregateMetrics;exports.createMetricEnvelope=createMetricEnvelope},{"../utils-hoist/dsn.js":152,"../utils-hoist/envelope.js":154,"../utils-hoist/logger.js":164,"./utils.js":111}],107:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const aggregator=require("./aggregator.js");const exports$1=require("./exports.js");function increment(name,value=1,data){exports$1.metrics.increment(aggregator.MetricsAggregator,name,value,data)}function distribution(name,value,data){exports$1.metrics.distribution(aggregator.MetricsAggregator,name,value,data)}function set(name,value,data){exports$1.metrics.set(aggregator.MetricsAggregator,name,value,data)}function gauge(name,value,data){exports$1.metrics.gauge(aggregator.MetricsAggregator,name,value,data)}function timing(name,value,unit="second",data){return exports$1.metrics.timing(aggregator.MetricsAggregator,name,value,unit,data)}function getMetricsAggregatorForClient(client){return exports$1.metrics.getMetricsAggregatorForClient(client,aggregator.MetricsAggregator)}const metricsDefault={increment:increment,distribution:distribution,set:set,gauge:gauge,timing:timing,getMetricsAggregatorForClient:getMetricsAggregatorForClient};exports.metricsDefault=metricsDefault},{"./aggregator.js":103,"./exports.js":108}],108:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("../currentScopes.js");const debugBuild=require("../debug-build.js");require("../tracing/errors.js");const worldwide=require("../utils-hoist/worldwide.js");require("../utils-hoist/debug-build.js");const logger=require("../utils-hoist/logger.js");const time=require("../utils-hoist/time.js");const spanUtils=require("../utils/spanUtils.js");const trace=require("../tracing/trace.js");const handleCallbackErrors=require("../utils/handleCallbackErrors.js");const constants=require("./constants.js");function getMetricsAggregatorForClient(client,Aggregator){const globalMetricsAggregators=worldwide.getGlobalSingleton("globalMetricsAggregators",()=>new WeakMap);const aggregator=globalMetricsAggregators.get(client);if(aggregator){return aggregator}const newAggregator=new Aggregator(client);client.on("flush",()=>newAggregator.flush());client.on("close",()=>newAggregator.close());globalMetricsAggregators.set(client,newAggregator);return newAggregator}function addToMetricsAggregator(Aggregator,metricType,name,value,data={}){const client=data.client||currentScopes.getClient();if(!client){return}const span=spanUtils.getActiveSpan();const rootSpan=span?spanUtils.getRootSpan(span):undefined;const transactionName=rootSpan&&spanUtils.spanToJSON(rootSpan).description;const{unit,tags,timestamp}=data;const{release,environment}=client.getOptions();const metricTags={};if(release){metricTags.release=release}if(environment){metricTags.environment=environment}if(transactionName){metricTags.transaction=transactionName}debugBuild.DEBUG_BUILD&&logger.logger.log(`Adding value of ${value} to ${metricType} metric ${name}`);const aggregator=getMetricsAggregatorForClient(client,Aggregator);aggregator.add(metricType,name,value,unit,{...metricTags,...tags},timestamp)}function increment(aggregator,name,value=1,data){addToMetricsAggregator(aggregator,constants.COUNTER_METRIC_TYPE,name,ensureNumber(value),data)}function distribution(aggregator,name,value,data){addToMetricsAggregator(aggregator,constants.DISTRIBUTION_METRIC_TYPE,name,ensureNumber(value),data)}function timing(aggregator,name,value,unit="second",data){if(typeof value==="function"){const startTime=time.timestampInSeconds();return trace.startSpanManual({op:"metrics.timing",name:name,startTime:startTime,onlyIfParent:true},span=>{return handleCallbackErrors.handleCallbackErrors(()=>value(),()=>{},()=>{const endTime=time.timestampInSeconds();const timeDiff=endTime-startTime;distribution(aggregator,name,timeDiff,{...data,unit:"second"});span.end(endTime)})})}distribution(aggregator,name,value,{...data,unit:unit})}function set(aggregator,name,value,data){addToMetricsAggregator(aggregator,constants.SET_METRIC_TYPE,name,value,data)}function gauge(aggregator,name,value,data){addToMetricsAggregator(aggregator,constants.GAUGE_METRIC_TYPE,name,ensureNumber(value),data)}const metrics={increment:increment,distribution:distribution,set:set,gauge:gauge,timing:timing,getMetricsAggregatorForClient:getMetricsAggregatorForClient};function ensureNumber(number){return typeof number==="string"?parseInt(number):number}exports.metrics=metrics},{"../currentScopes.js":78,"../debug-build.js":79,"../tracing/errors.js":120,"../tracing/trace.js":129,"../utils-hoist/debug-build.js":150,"../utils-hoist/logger.js":164,"../utils-hoist/time.js":182,"../utils-hoist/worldwide.js":190,"../utils/handleCallbackErrors.js":192,"../utils/spanUtils.js":202,"./constants.js":105}],109:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const constants=require("./constants.js");const utils=require("./utils.js");class CounterMetric{constructor(_value){this._value=_value}get weight(){return 1}add(value){this._value+=value}toString(){return`${this._value}`}}class GaugeMetric{constructor(value){this._last=value;this._min=value;this._max=value;this._sum=value;this._count=1}get weight(){return 5}add(value){this._last=value;if(value<this._min){this._min=value}if(value>this._max){this._max=value}this._sum+=value;this._count++}toString(){return`${this._last}:${this._min}:${this._max}:${this._sum}:${this._count}`}}class DistributionMetric{constructor(first){this._value=[first]}get weight(){return this._value.length}add(value){this._value.push(value)}toString(){return this._value.join(":")}}class SetMetric{constructor(first){this.first=first;this._value=new Set([first])}get weight(){return this._value.size}add(value){this._value.add(value)}toString(){return Array.from(this._value).map(val=>typeof val==="string"?utils.simpleHash(val):val).join(":")}}const METRIC_MAP={[constants.COUNTER_METRIC_TYPE]:CounterMetric,[constants.GAUGE_METRIC_TYPE]:GaugeMetric,[constants.DISTRIBUTION_METRIC_TYPE]:DistributionMetric,[constants.SET_METRIC_TYPE]:SetMetric};exports.CounterMetric=CounterMetric;exports.DistributionMetric=DistributionMetric;exports.GaugeMetric=GaugeMetric;exports.METRIC_MAP=METRIC_MAP;exports.SetMetric=SetMetric},{"./constants.js":105,"./utils.js":111}],110:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const object=require("../utils-hoist/object.js");const METRICS_SPAN_FIELD="_sentryMetrics";function getMetricSummaryJsonForSpan(span){const storage=span[METRICS_SPAN_FIELD];if(!storage){return undefined}const output={};for(const[,[exportKey,summary]]of storage){const arr=output[exportKey]||(output[exportKey]=[]);arr.push(object.dropUndefinedKeys(summary))}return output}function updateMetricSummaryOnSpan(span,metricType,sanitizedName,value,unit,tags,bucketKey){const existingStorage=span[METRICS_SPAN_FIELD];const storage=existingStorage||(span[METRICS_SPAN_FIELD]=new Map);const exportKey=`${metricType}:${sanitizedName}@${unit}`;const bucketItem=storage.get(bucketKey);if(bucketItem){const[,summary]=bucketItem;storage.set(bucketKey,[exportKey,{min:Math.min(summary.min,value),max:Math.max(summary.max,value),count:summary.count+=1,sum:summary.sum+=value,tags:summary.tags}])}else{storage.set(bucketKey,[exportKey,{min:value,max:value,count:1,sum:value,tags:tags}])}}exports.getMetricSummaryJsonForSpan=getMetricSummaryJsonForSpan;exports.updateMetricSummaryOnSpan=updateMetricSummaryOnSpan},{"../utils-hoist/object.js":171}],111:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const object=require("../utils-hoist/object.js");function getBucketKey(metricType,name,unit,tags){const stringifiedTags=Object.entries(object.dropUndefinedKeys(tags)).sort((a,b)=>a[0].localeCompare(b[0]));return`${metricType}${name}${unit}${stringifiedTags}`}function simpleHash(s){let rv=0;for(let i=0;i<s.length;i++){const c=s.charCodeAt(i);rv=(rv<<5)-rv+c;rv&=rv}return rv>>>0}function serializeMetricBuckets(metricBucketItems){let out="";for(const item of metricBucketItems){const tagEntries=Object.entries(item.tags);const maybeTags=tagEntries.length>0?`|#${tagEntries.map(([key,value])=>`${key}:${value}`).join(",")}`:"";out+=`${item.name}@${item.unit}:${item.metric}|${item.metricType}${maybeTags}|T${item.timestamp}\n`}return out}function sanitizeUnit(unit){return unit.replace(/[^\w]+/gi,"_")}function sanitizeMetricKey(key){return key.replace(/[^\w\-.]+/gi,"_")}function sanitizeTagKey(key){return key.replace(/[^\w\-./]+/gi,"")}const tagValueReplacements=[["\n","\\n"],["\r","\\r"],["\t","\\t"],["\\","\\\\"],["|","\\u{7c}"],[",","\\u{2c}"]];function getCharOrReplacement(input){for(const[search,replacement]of tagValueReplacements){if(input===search){return replacement}}return input}function sanitizeTagValue(value){return[...value].reduce((acc,char)=>acc+getCharOrReplacement(char),"")}function sanitizeTags(unsanitizedTags){const tags={};for(const key in unsanitizedTags){if(Object.prototype.hasOwnProperty.call(unsanitizedTags,key)){const sanitizedKey=sanitizeTagKey(key);tags[sanitizedKey]=sanitizeTagValue(String(unsanitizedTags[key]))}}return tags}exports.getBucketKey=getBucketKey;exports.sanitizeMetricKey=sanitizeMetricKey;exports.sanitizeTags=sanitizeTags;exports.sanitizeUnit=sanitizeUnit;exports.serializeMetricBuckets=serializeMetricBuckets;exports.simpleHash=simpleHash},{"../utils-hoist/object.js":171}],112:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("./currentScopes.js");const debugBuild=require("./debug-build.js");const logger=require("./utils-hoist/logger.js");function isProfilingIntegrationWithProfiler(integration){return!!integration&&typeof integration["_profiler"]!=="undefined"&&typeof integration["_profiler"]["start"]==="function"&&typeof integration["_profiler"]["stop"]==="function"}function startProfiler(){const client=currentScopes.getClient();if(!client){debugBuild.DEBUG_BUILD&&logger.logger.warn("No Sentry client available, profiling is not started");return}const integration=client.getIntegrationByName("ProfilingIntegration");if(!integration){debugBuild.DEBUG_BUILD&&logger.logger.warn("ProfilingIntegration is not available");return}if(!isProfilingIntegrationWithProfiler(integration)){debugBuild.DEBUG_BUILD&&logger.logger.warn("Profiler is not available on profiling integration.");return}integration._profiler.start()}function stopProfiler(){const client=currentScopes.getClient();if(!client){debugBuild.DEBUG_BUILD&&logger.logger.warn("No Sentry client available, profiling is not started");return}const integration=client.getIntegrationByName("ProfilingIntegration");if(!integration){debugBuild.DEBUG_BUILD&&logger.logger.warn("ProfilingIntegration is not available");return}if(!isProfilingIntegrationWithProfiler(integration)){debugBuild.DEBUG_BUILD&&logger.logger.warn("Profiler is not available on profiling integration.");return}integration._profiler.stop()}const profiler={startProfiler:startProfiler,stopProfiler:stopProfiler};exports.profiler=profiler},{"./currentScopes.js":78,"./debug-build.js":79,"./utils-hoist/logger.js":164}],113:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const session=require("./session.js");const is=require("./utils-hoist/is.js");const logger=require("./utils-hoist/logger.js");const misc=require("./utils-hoist/misc.js");const propagationContext=require("./utils-hoist/propagationContext.js");const time=require("./utils-hoist/time.js");const merge=require("./utils/merge.js");const spanOnScope=require("./utils/spanOnScope.js");const DEFAULT_MAX_BREADCRUMBS=100;class ScopeClass{constructor(){this._notifyingListeners=false;this._scopeListeners=[];this._eventProcessors=[];this._breadcrumbs=[];this._attachments=[];this._user={};this._tags={};this._extra={};this._contexts={};this._sdkProcessingMetadata={};this._propagationContext={traceId:propagationContext.generateTraceId(),spanId:propagationContext.generateSpanId()}}clone(){const newScope=new ScopeClass;newScope._breadcrumbs=[...this._breadcrumbs];newScope._tags={...this._tags};newScope._extra={...this._extra};newScope._contexts={...this._contexts};if(this._contexts.flags){newScope._contexts.flags={values:[...this._contexts.flags.values]}}newScope._user=this._user;newScope._level=this._level;newScope._session=this._session;newScope._transactionName=this._transactionName;newScope._fingerprint=this._fingerprint;newScope._eventProcessors=[...this._eventProcessors];newScope._requestSession=this._requestSession;newScope._attachments=[...this._attachments];newScope._sdkProcessingMetadata={...this._sdkProcessingMetadata};newScope._propagationContext={...this._propagationContext};newScope._client=this._client;newScope._lastEventId=this._lastEventId;spanOnScope._setSpanForScope(newScope,spanOnScope._getSpanForScope(this));return newScope}setClient(client){this._client=client}setLastEventId(lastEventId){this._lastEventId=lastEventId}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(callback){this._scopeListeners.push(callback)}addEventProcessor(callback){this._eventProcessors.push(callback);return this}setUser(user){this._user=user||{email:undefined,id:undefined,ip_address:undefined,username:undefined};if(this._session){session.updateSession(this._session,{user:user})}this._notifyScopeListeners();return this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(requestSession){this._requestSession=requestSession;return this}setTags(tags){this._tags={...this._tags,...tags};this._notifyScopeListeners();return this}setTag(key,value){this._tags={...this._tags,[key]:value};this._notifyScopeListeners();return this}setExtras(extras){this._extra={...this._extra,...extras};this._notifyScopeListeners();return this}setExtra(key,extra){this._extra={...this._extra,[key]:extra};this._notifyScopeListeners();return this}setFingerprint(fingerprint){this._fingerprint=fingerprint;this._notifyScopeListeners();return this}setLevel(level){this._level=level;this._notifyScopeListeners();return this}setTransactionName(name){this._transactionName=name;this._notifyScopeListeners();return this}setContext(key,context){if(context===null){delete this._contexts[key]}else{this._contexts[key]=context}this._notifyScopeListeners();return this}setSession(session){if(!session){delete this._session}else{this._session=session}this._notifyScopeListeners();return this}getSession(){return this._session}update(captureContext){if(!captureContext){return this}const scopeToMerge=typeof captureContext==="function"?captureContext(this):captureContext;const[scopeInstance,requestSession]=scopeToMerge instanceof Scope?[scopeToMerge.getScopeData(),scopeToMerge.getRequestSession()]:is.isPlainObject(scopeToMerge)?[captureContext,captureContext.requestSession]:[];const{tags,extra,user,contexts,level,fingerprint=[],propagationContext}=scopeInstance||{};this._tags={...this._tags,...tags};this._extra={...this._extra,...extra};this._contexts={...this._contexts,...contexts};if(user&&Object.keys(user).length){this._user=user}if(level){this._level=level}if(fingerprint.length){this._fingerprint=fingerprint}if(propagationContext){this._propagationContext=propagationContext}if(requestSession){this._requestSession=requestSession}return this}clear(){this._breadcrumbs=[];this._tags={};this._extra={};this._user={};this._contexts={};this._level=undefined;this._transactionName=undefined;this._fingerprint=undefined;this._requestSession=undefined;this._session=undefined;spanOnScope._setSpanForScope(this,undefined);this._attachments=[];this.setPropagationContext({traceId:propagationContext.generateTraceId()});this._notifyScopeListeners();return this}addBreadcrumb(breadcrumb,maxBreadcrumbs){const maxCrumbs=typeof maxBreadcrumbs==="number"?maxBreadcrumbs:DEFAULT_MAX_BREADCRUMBS;if(maxCrumbs<=0){return this}const mergedBreadcrumb={timestamp:time.dateTimestampInSeconds(),...breadcrumb};const breadcrumbs=this._breadcrumbs;breadcrumbs.push(mergedBreadcrumb);this._breadcrumbs=breadcrumbs.length>maxCrumbs?breadcrumbs.slice(-maxCrumbs):breadcrumbs;this._notifyScopeListeners();return this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){this._breadcrumbs=[];this._notifyScopeListeners();return this}addAttachment(attachment){this._attachments.push(attachment);return this}clearAttachments(){this._attachments=[];return this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:spanOnScope._getSpanForScope(this)}}setSDKProcessingMetadata(newData){this._sdkProcessingMetadata=merge.merge(this._sdkProcessingMetadata,newData,2);return this}setPropagationContext(context){this._propagationContext={spanId:propagationContext.generateSpanId(),...context};return this}getPropagationContext(){return this._propagationContext}captureException(exception,hint){const eventId=hint&&hint.event_id?hint.event_id:misc.uuid4();if(!this._client){logger.logger.warn("No client configured on scope - will not capture exception!");return eventId}const syntheticException=new Error("Sentry syntheticException");this._client.captureException(exception,{originalException:exception,syntheticException:syntheticException,...hint,event_id:eventId},this);return eventId}captureMessage(message,level,hint){const eventId=hint&&hint.event_id?hint.event_id:misc.uuid4();if(!this._client){logger.logger.warn("No client configured on scope - will not capture message!");return eventId}const syntheticException=new Error(message);this._client.captureMessage(message,level,{originalException:message,syntheticException:syntheticException,...hint,event_id:eventId},this);return eventId}captureEvent(event,hint){const eventId=hint&&hint.event_id?hint.event_id:misc.uuid4();if(!this._client){logger.logger.warn("No client configured on scope - will not capture event!");return eventId}this._client.captureEvent(event,{...hint,event_id:eventId},this);return eventId}_notifyScopeListeners(){if(!this._notifyingListeners){this._notifyingListeners=true;this._scopeListeners.forEach(callback=>{callback(this)});this._notifyingListeners=false}}}const Scope=ScopeClass;exports.Scope=Scope},{"./session.js":117,"./utils-hoist/is.js":162,"./utils-hoist/logger.js":164,"./utils-hoist/misc.js":167,"./utils-hoist/propagationContext.js":174,"./utils-hoist/time.js":182,"./utils/merge.js":195,"./utils/spanOnScope.js":201}],114:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("./currentScopes.js");const debugBuild=require("./debug-build.js");const logger=require("./utils-hoist/logger.js");function initAndBind(clientClass,options){if(options.debug===true){if(debugBuild.DEBUG_BUILD){logger.logger.enable()}else{logger.consoleSandbox(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})}}const scope=currentScopes.getCurrentScope();scope.update(options.initialScope);const client=new clientClass(options);setCurrentClient(client);client.init();return client}function setCurrentClient(client){currentScopes.getCurrentScope().setClient(client)}exports.initAndBind=initAndBind;exports.setCurrentClient=setCurrentClient},{"./currentScopes.js":78,"./debug-build.js":79,"./utils-hoist/logger.js":164}],115:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const SEMANTIC_ATTRIBUTE_SENTRY_SOURCE="sentry.source";const SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE="sentry.sample_rate";const SEMANTIC_ATTRIBUTE_SENTRY_OP="sentry.op";const SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN="sentry.origin";const SEMANTIC_ATTRIBUTE_SENTRY_IDLE_SPAN_FINISH_REASON="sentry.idle_span_finish_reason";const SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT="sentry.measurement_unit";const SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE="sentry.measurement_value";const SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME="sentry.custom_span_name";const SEMANTIC_ATTRIBUTE_PROFILE_ID="sentry.profile_id";const SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME="sentry.exclusive_time";const SEMANTIC_ATTRIBUTE_CACHE_HIT="cache.hit";const SEMANTIC_ATTRIBUTE_CACHE_KEY="cache.key";const SEMANTIC_ATTRIBUTE_CACHE_ITEM_SIZE="cache.item_size";const SEMANTIC_ATTRIBUTE_HTTP_REQUEST_METHOD="http.request.method";const SEMANTIC_ATTRIBUTE_URL_FULL="url.full";exports.SEMANTIC_ATTRIBUTE_CACHE_HIT=SEMANTIC_ATTRIBUTE_CACHE_HIT;exports.SEMANTIC_ATTRIBUTE_CACHE_ITEM_SIZE=SEMANTIC_ATTRIBUTE_CACHE_ITEM_SIZE;exports.SEMANTIC_ATTRIBUTE_CACHE_KEY=SEMANTIC_ATTRIBUTE_CACHE_KEY;exports.SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME=SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME;exports.SEMANTIC_ATTRIBUTE_HTTP_REQUEST_METHOD=SEMANTIC_ATTRIBUTE_HTTP_REQUEST_METHOD;exports.SEMANTIC_ATTRIBUTE_PROFILE_ID=SEMANTIC_ATTRIBUTE_PROFILE_ID;exports.SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME=SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME;exports.SEMANTIC_ATTRIBUTE_SENTRY_IDLE_SPAN_FINISH_REASON=SEMANTIC_ATTRIBUTE_SENTRY_IDLE_SPAN_FINISH_REASON;exports.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT=SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT;exports.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE=SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE;exports.SEMANTIC_ATTRIBUTE_SENTRY_OP=SEMANTIC_ATTRIBUTE_SENTRY_OP;exports.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN=SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN;exports.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE;exports.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=SEMANTIC_ATTRIBUTE_SENTRY_SOURCE;exports.SEMANTIC_ATTRIBUTE_URL_FULL=SEMANTIC_ATTRIBUTE_URL_FULL},{}],116:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const baseclient=require("./baseclient.js");const checkin=require("./checkin.js");const currentScopes=require("./currentScopes.js");const debugBuild=require("./debug-build.js");const sessionflusher=require("./sessionflusher.js");const errors=require("./tracing/errors.js");require("./utils-hoist/version.js");require("./utils-hoist/debug-build.js");const logger=require("./utils-hoist/logger.js");require("./utils-hoist/time.js");const spanOnScope=require("./utils/spanOnScope.js");const spanUtils=require("./utils/spanUtils.js");const misc=require("./utils-hoist/misc.js");const syncpromise=require("./utils-hoist/syncpromise.js");const eventbuilder=require("./utils-hoist/eventbuilder.js");const dynamicSamplingContext=require("./tracing/dynamicSamplingContext.js");class ServerRuntimeClient extends baseclient.BaseClient{constructor(options){errors.registerSpanErrorInstrumentation();super(options)}eventFromException(exception,hint){const event=eventbuilder.eventFromUnknownInput(this,this._options.stackParser,exception,hint);event.level="error";return syncpromise.resolvedSyncPromise(event)}eventFromMessage(message,level="info",hint){return syncpromise.resolvedSyncPromise(eventbuilder.eventFromMessage(this._options.stackParser,message,level,hint,this._options.attachStacktrace))}captureException(exception,hint,scope){if(this._options.autoSessionTracking&&this._sessionFlusher){const requestSession=currentScopes.getIsolationScope().getRequestSession();if(requestSession&&requestSession.status==="ok"){requestSession.status="errored"}}return super.captureException(exception,hint,scope)}captureEvent(event,hint,scope){if(this._options.autoSessionTracking&&this._sessionFlusher){const eventType=event.type||"exception";const isException=eventType==="exception"&&event.exception&&event.exception.values&&event.exception.values.length>0;if(isException){const requestSession=currentScopes.getIsolationScope().getRequestSession();if(requestSession&&requestSession.status==="ok"){requestSession.status="errored"}}}return super.captureEvent(event,hint,scope)}close(timeout){if(this._sessionFlusher){this._sessionFlusher.close()}return super.close(timeout)}initSessionFlusher(){const{release,environment}=this._options;if(!release){debugBuild.DEBUG_BUILD&&logger.logger.warn("Cannot initialize an instance of SessionFlusher if no release is provided!")}else{this._sessionFlusher=new sessionflusher.SessionFlusher(this,{release:release,environment:environment})}}captureCheckIn(checkIn,monitorConfig,scope){const id="checkInId"in checkIn&&checkIn.checkInId?checkIn.checkInId:misc.uuid4();if(!this._isEnabled()){debugBuild.DEBUG_BUILD&&logger.logger.warn("SDK not enabled, will not capture checkin.");return id}const options=this.getOptions();const{release,environment,tunnel}=options;const serializedCheckIn={check_in_id:id,monitor_slug:checkIn.monitorSlug,status:checkIn.status,release:release,environment:environment};if("duration"in checkIn){serializedCheckIn.duration=checkIn.duration}if(monitorConfig){serializedCheckIn.monitor_config={schedule:monitorConfig.schedule,checkin_margin:monitorConfig.checkinMargin,max_runtime:monitorConfig.maxRuntime,timezone:monitorConfig.timezone,failure_issue_threshold:monitorConfig.failureIssueThreshold,recovery_threshold:monitorConfig.recoveryThreshold}}const[dynamicSamplingContext,traceContext]=this._getTraceInfoFromScope(scope);if(traceContext){serializedCheckIn.contexts={trace:traceContext}}const envelope=checkin.createCheckInEnvelope(serializedCheckIn,dynamicSamplingContext,this.getSdkMetadata(),tunnel,this.getDsn());debugBuild.DEBUG_BUILD&&logger.logger.info("Sending checkin:",checkIn.monitorSlug,checkIn.status);this.sendEnvelope(envelope);return id}_captureRequestSession(){if(!this._sessionFlusher){debugBuild.DEBUG_BUILD&&logger.logger.warn("Discarded request mode session because autoSessionTracking option was disabled")}else{this._sessionFlusher.incrementSessionStatusCount()}}_prepareEvent(event,hint,scope,isolationScope){if(this._options.platform){event.platform=event.platform||this._options.platform}if(this._options.runtime){event.contexts={...event.contexts,runtime:(event.contexts||{}).runtime||this._options.runtime}}if(this._options.serverName){event.server_name=event.server_name||this._options.serverName}return super._prepareEvent(event,hint,scope,isolationScope)}_getTraceInfoFromScope(scope){if(!scope){return[undefined,undefined]}const span=spanOnScope._getSpanForScope(scope);const traceContext=span?spanUtils.spanToTraceContext(span):currentScopes.getTraceContextFromScope(scope);const dynamicSamplingContext$1=span?dynamicSamplingContext.getDynamicSamplingContextFromSpan(span):dynamicSamplingContext.getDynamicSamplingContextFromScope(this,scope);return[dynamicSamplingContext$1,traceContext]}}exports.ServerRuntimeClient=ServerRuntimeClient},{"./baseclient.js":73,"./checkin.js":76,"./currentScopes.js":78,"./debug-build.js":79,"./sessionflusher.js":118,"./tracing/dynamicSamplingContext.js":119,"./tracing/errors.js":120,"./utils-hoist/debug-build.js":150,"./utils-hoist/eventbuilder.js":156,"./utils-hoist/logger.js":164,"./utils-hoist/misc.js":167,"./utils-hoist/syncpromise.js":181,"./utils-hoist/time.js":182,"./utils-hoist/version.js":189,"./utils/spanOnScope.js":201,"./utils/spanUtils.js":202}],117:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});require("./utils-hoist/version.js");require("./utils-hoist/debug-build.js");require("./utils-hoist/logger.js");const object=require("./utils-hoist/object.js");const time=require("./utils-hoist/time.js");const misc=require("./utils-hoist/misc.js");require("./utils-hoist/syncpromise.js");function makeSession(context){const startingTime=time.timestampInSeconds();const session={sid:misc.uuid4(),init:true,timestamp:startingTime,started:startingTime,duration:0,status:"ok",errors:0,ignoreDuration:false,toJSON:()=>sessionToJSON(session)};if(context){updateSession(session,context)}return session}function updateSession(session,context={}){if(context.user){if(!session.ipAddress&&context.user.ip_address){session.ipAddress=context.user.ip_address}if(!session.did&&!context.did){session.did=context.user.id||context.user.email||context.user.username}}session.timestamp=context.timestamp||time.timestampInSeconds();if(context.abnormal_mechanism){session.abnormal_mechanism=context.abnormal_mechanism}if(context.ignoreDuration){session.ignoreDuration=context.ignoreDuration}if(context.sid){session.sid=context.sid.length===32?context.sid:misc.uuid4()}if(context.init!==undefined){session.init=context.init}if(!session.did&&context.did){session.did=`${context.did}`}if(typeof context.started==="number"){session.started=context.started}if(session.ignoreDuration){session.duration=undefined}else if(typeof context.duration==="number"){session.duration=context.duration}else{const duration=session.timestamp-session.started;session.duration=duration>=0?duration:0}if(context.release){session.release=context.release}if(context.environment){session.environment=context.environment}if(!session.ipAddress&&context.ipAddress){session.ipAddress=context.ipAddress}if(!session.userAgent&&context.userAgent){session.userAgent=context.userAgent}if(typeof context.errors==="number"){session.errors=context.errors}if(context.status){session.status=context.status}}function closeSession(session,status){let context={};if(status){context={status:status}}else if(session.status==="ok"){context={status:"exited"}}updateSession(session,context)}function sessionToJSON(session){return object.dropUndefinedKeys({sid:`${session.sid}`,init:session.init,started:new Date(session.started*1e3).toISOString(),timestamp:new Date(session.timestamp*1e3).toISOString(),status:session.status,errors:session.errors,did:typeof session.did==="number"||typeof session.did==="string"?`${session.did}`:undefined,duration:session.duration,abnormal_mechanism:session.abnormal_mechanism,attrs:{release:session.release,environment:session.environment,ip_address:session.ipAddress,user_agent:session.userAgent}})}exports.closeSession=closeSession;exports.makeSession=makeSession;exports.updateSession=updateSession},{"./utils-hoist/debug-build.js":150,"./utils-hoist/logger.js":164,"./utils-hoist/misc.js":167,"./utils-hoist/object.js":171,"./utils-hoist/syncpromise.js":181,"./utils-hoist/time.js":182,"./utils-hoist/version.js":189}],118:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("./currentScopes.js");const object=require("./utils-hoist/object.js");class SessionFlusher{constructor(client,attrs){this._client=client;this.flushTimeout=60;this._pendingAggregates=new Map;this._isEnabled=true;this._intervalId=setInterval(()=>this.flush(),this.flushTimeout*1e3);if(this._intervalId.unref){this._intervalId.unref()}this._sessionAttrs=attrs}flush(){const sessionAggregates=this.getSessionAggregates();if(sessionAggregates.aggregates.length===0){return}this._pendingAggregates=new Map;this._client.sendSession(sessionAggregates)}getSessionAggregates(){const aggregates=Array.from(this._pendingAggregates.values());const sessionAggregates={attrs:this._sessionAttrs,aggregates:aggregates};return object.dropUndefinedKeys(sessionAggregates)}close(){clearInterval(this._intervalId);this._isEnabled=false;this.flush()}incrementSessionStatusCount(){if(!this._isEnabled){return}const isolationScope=currentScopes.getIsolationScope();const requestSession=isolationScope.getRequestSession();if(requestSession&&requestSession.status){this._incrementSessionStatusCount(requestSession.status,new Date);isolationScope.setRequestSession(undefined)}}_incrementSessionStatusCount(status,date){const sessionStartedTrunc=new Date(date).setSeconds(0,0);let aggregationCounts=this._pendingAggregates.get(sessionStartedTrunc);if(!aggregationCounts){aggregationCounts={started:new Date(sessionStartedTrunc).toISOString()};this._pendingAggregates.set(sessionStartedTrunc,aggregationCounts)}switch(status){case"errored":aggregationCounts.errored=(aggregationCounts.errored||0)+1;return aggregationCounts.errored;case"ok":aggregationCounts.exited=(aggregationCounts.exited||0)+1;return aggregationCounts.exited;default:aggregationCounts.crashed=(aggregationCounts.crashed||0)+1;return aggregationCounts.crashed}}}exports.SessionFlusher=SessionFlusher},{"./currentScopes.js":78,"./utils-hoist/object.js":171}],119:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const constants=require("../constants.js");const currentScopes=require("../currentScopes.js");const semanticAttributes=require("../semanticAttributes.js");const baggage=require("../utils-hoist/baggage.js");const object=require("../utils-hoist/object.js");const hasTracingEnabled=require("../utils/hasTracingEnabled.js");const spanUtils=require("../utils/spanUtils.js");const FROZEN_DSC_FIELD="_frozenDsc";function freezeDscOnSpan(span,dsc){const spanWithMaybeDsc=span;object.addNonEnumerableProperty(spanWithMaybeDsc,FROZEN_DSC_FIELD,dsc)}function getDynamicSamplingContextFromClient(trace_id,client){const options=client.getOptions();const{publicKey:public_key}=client.getDsn()||{};const dsc=object.dropUndefinedKeys({environment:options.environment||constants.DEFAULT_ENVIRONMENT,release:options.release,public_key:public_key,trace_id:trace_id});client.emit("createDsc",dsc);return dsc}function getDynamicSamplingContextFromScope(client,scope){const propagationContext=scope.getPropagationContext();return propagationContext.dsc||getDynamicSamplingContextFromClient(propagationContext.traceId,client)}function getDynamicSamplingContextFromSpan(span){const client=currentScopes.getClient();if(!client){return{}}const rootSpan=spanUtils.getRootSpan(span);const frozenDsc=rootSpan[FROZEN_DSC_FIELD];if(frozenDsc){return frozenDsc}const traceState=rootSpan.spanContext().traceState;const traceStateDsc=traceState&&traceState.get("sentry.dsc");const dscOnTraceState=traceStateDsc&&baggage.baggageHeaderToDynamicSamplingContext(traceStateDsc);if(dscOnTraceState){return dscOnTraceState}const dsc=getDynamicSamplingContextFromClient(span.spanContext().traceId,client);const jsonSpan=spanUtils.spanToJSON(rootSpan);const attributes=jsonSpan.data||{};const maybeSampleRate=attributes[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE];if(maybeSampleRate!=null){dsc.sample_rate=`${maybeSampleRate}`}const source=attributes[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE];const name=jsonSpan.description;if(source!=="url"&&name){dsc.transaction=name}if(hasTracingEnabled.hasTracingEnabled()){dsc.sampled=String(spanUtils.spanIsSampled(rootSpan))}client.emit("createDsc",dsc,rootSpan);return dsc}function spanToBaggageHeader(span){const dsc=getDynamicSamplingContextFromSpan(span);return baggage.dynamicSamplingContextToSentryBaggageHeader(dsc)}exports.freezeDscOnSpan=freezeDscOnSpan;exports.getDynamicSamplingContextFromClient=getDynamicSamplingContextFromClient;exports.getDynamicSamplingContextFromScope=getDynamicSamplingContextFromScope;exports.getDynamicSamplingContextFromSpan=getDynamicSamplingContextFromSpan;exports.spanToBaggageHeader=spanToBaggageHeader},{"../constants.js":77,"../currentScopes.js":78,"../semanticAttributes.js":115,"../utils-hoist/baggage.js":138,"../utils-hoist/object.js":171,"../utils/hasTracingEnabled.js":193,"../utils/spanUtils.js":202}],120:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const debugBuild=require("../debug-build.js");const globalError=require("../utils-hoist/instrument/globalError.js");const globalUnhandledRejection=require("../utils-hoist/instrument/globalUnhandledRejection.js");const logger=require("../utils-hoist/logger.js");const spanUtils=require("../utils/spanUtils.js");const spanstatus=require("./spanstatus.js");let errorsInstrumented=false;function registerSpanErrorInstrumentation(){if(errorsInstrumented){return}errorsInstrumented=true;globalError.addGlobalErrorInstrumentationHandler(errorCallback);globalUnhandledRejection.addGlobalUnhandledRejectionInstrumentationHandler(errorCallback)}function errorCallback(){const activeSpan=spanUtils.getActiveSpan();const rootSpan=activeSpan&&spanUtils.getRootSpan(activeSpan);if(rootSpan){const message="internal_error";debugBuild.DEBUG_BUILD&&logger.logger.log(`[Tracing] Root span: ${message} -> Global error occurred`);rootSpan.setStatus({code:spanstatus.SPAN_STATUS_ERROR,message:message})}}errorCallback.tag="sentry_tracingErrorCallback";exports.registerSpanErrorInstrumentation=registerSpanErrorInstrumentation},{"../debug-build.js":79,"../utils-hoist/instrument/globalError.js":159,"../utils-hoist/instrument/globalUnhandledRejection.js":160,"../utils-hoist/logger.js":164,"../utils/spanUtils.js":202,"./spanstatus.js":128}],121:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const errors=require("./errors.js");function addTracingExtensions(){errors.registerSpanErrorInstrumentation()}exports.addTracingExtensions=addTracingExtensions},{"./errors.js":120}],122:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("../currentScopes.js");const debugBuild=require("../debug-build.js");const semanticAttributes=require("../semanticAttributes.js");const logger=require("../utils-hoist/logger.js");const time=require("../utils-hoist/time.js");const hasTracingEnabled=require("../utils/hasTracingEnabled.js");const spanOnScope=require("../utils/spanOnScope.js");const spanUtils=require("../utils/spanUtils.js");const sentryNonRecordingSpan=require("./sentryNonRecordingSpan.js");const spanstatus=require("./spanstatus.js");const trace=require("./trace.js");const TRACING_DEFAULTS={idleTimeout:1e3,finalTimeout:3e4,childSpanTimeout:15e3};const FINISH_REASON_HEARTBEAT_FAILED="heartbeatFailed";const FINISH_REASON_IDLE_TIMEOUT="idleTimeout";const FINISH_REASON_FINAL_TIMEOUT="finalTimeout";const FINISH_REASON_EXTERNAL_FINISH="externalFinish";function startIdleSpan(startSpanOptions,options={}){const activities=new Map;let _finished=false;let _idleTimeoutID;let _finishReason=FINISH_REASON_EXTERNAL_FINISH;let _autoFinishAllowed=!options.disableAutoFinish;const _cleanupHooks=[];const{idleTimeout=TRACING_DEFAULTS.idleTimeout,finalTimeout=TRACING_DEFAULTS.finalTimeout,childSpanTimeout=TRACING_DEFAULTS.childSpanTimeout,beforeSpanEnd}=options;const client=currentScopes.getClient();if(!client||!hasTracingEnabled.hasTracingEnabled()){return new sentryNonRecordingSpan.SentryNonRecordingSpan}const scope=currentScopes.getCurrentScope();const previousActiveSpan=spanUtils.getActiveSpan();const span=_startIdleSpan(startSpanOptions);span.end=new Proxy(span.end,{apply(target,thisArg,args){if(beforeSpanEnd){beforeSpanEnd(span)}const[definedEndTimestamp,...rest]=args;const timestamp=definedEndTimestamp||time.timestampInSeconds();const spanEndTimestamp=spanUtils.spanTimeInputToSeconds(timestamp);const spans=spanUtils.getSpanDescendants(span).filter(child=>child!==span);if(!spans.length){onIdleSpanEnded(spanEndTimestamp);return Reflect.apply(target,thisArg,[spanEndTimestamp,...rest])}const childEndTimestamps=spans.map(span=>spanUtils.spanToJSON(span).timestamp).filter(timestamp=>!!timestamp);const latestSpanEndTimestamp=childEndTimestamps.length?Math.max(...childEndTimestamps):undefined;const spanStartTimestamp=spanUtils.spanToJSON(span).start_timestamp;const endTimestamp=Math.min(spanStartTimestamp?spanStartTimestamp+finalTimeout/1e3:Infinity,Math.max(spanStartTimestamp||-Infinity,Math.min(spanEndTimestamp,latestSpanEndTimestamp||Infinity)));onIdleSpanEnded(endTimestamp);return Reflect.apply(target,thisArg,[endTimestamp,...rest])}});function _cancelIdleTimeout(){if(_idleTimeoutID){clearTimeout(_idleTimeoutID);_idleTimeoutID=undefined}}function _restartIdleTimeout(endTimestamp){_cancelIdleTimeout();_idleTimeoutID=setTimeout(()=>{if(!_finished&&activities.size===0&&_autoFinishAllowed){_finishReason=FINISH_REASON_IDLE_TIMEOUT;span.end(endTimestamp)}},idleTimeout)}function _restartChildSpanTimeout(endTimestamp){_idleTimeoutID=setTimeout(()=>{if(!_finished&&_autoFinishAllowed){_finishReason=FINISH_REASON_HEARTBEAT_FAILED;span.end(endTimestamp)}},childSpanTimeout)}function _pushActivity(spanId){_cancelIdleTimeout();activities.set(spanId,true);const endTimestamp=time.timestampInSeconds();_restartChildSpanTimeout(endTimestamp+childSpanTimeout/1e3)}function _popActivity(spanId){if(activities.has(spanId)){activities.delete(spanId)}if(activities.size===0){const endTimestamp=time.timestampInSeconds();_restartIdleTimeout(endTimestamp+idleTimeout/1e3)}}function onIdleSpanEnded(endTimestamp){_finished=true;activities.clear();_cleanupHooks.forEach(cleanup=>cleanup());spanOnScope._setSpanForScope(scope,previousActiveSpan);const spanJSON=spanUtils.spanToJSON(span);const{start_timestamp:startTimestamp}=spanJSON;if(!startTimestamp){return}const attributes=spanJSON.data||{};if(!attributes[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_IDLE_SPAN_FINISH_REASON]){span.setAttribute(semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_IDLE_SPAN_FINISH_REASON,_finishReason)}logger.logger.log(`[Tracing] Idle span "${spanJSON.op}" finished`);const childSpans=spanUtils.getSpanDescendants(span).filter(child=>child!==span);let discardedSpans=0;childSpans.forEach(childSpan=>{if(childSpan.isRecording()){childSpan.setStatus({code:spanstatus.SPAN_STATUS_ERROR,message:"cancelled"});childSpan.end(endTimestamp);debugBuild.DEBUG_BUILD&&logger.logger.log("[Tracing] Cancelling span since span ended early",JSON.stringify(childSpan,undefined,2))}const childSpanJSON=spanUtils.spanToJSON(childSpan);const{timestamp:childEndTimestamp=0,start_timestamp:childStartTimestamp=0}=childSpanJSON;const spanStartedBeforeIdleSpanEnd=childStartTimestamp<=endTimestamp;const timeoutWithMarginOfError=(finalTimeout+idleTimeout)/1e3;const spanEndedBeforeFinalTimeout=childEndTimestamp-childStartTimestamp<=timeoutWithMarginOfError;if(debugBuild.DEBUG_BUILD){const stringifiedSpan=JSON.stringify(childSpan,undefined,2);if(!spanStartedBeforeIdleSpanEnd){logger.logger.log("[Tracing] Discarding span since it happened after idle span was finished",stringifiedSpan)}else if(!spanEndedBeforeFinalTimeout){logger.logger.log("[Tracing] Discarding span since it finished after idle span final timeout",stringifiedSpan)}}if(!spanEndedBeforeFinalTimeout||!spanStartedBeforeIdleSpanEnd){spanUtils.removeChildSpanFromSpan(span,childSpan);discardedSpans++}});if(discardedSpans>0){span.setAttribute("sentry.idle_span_discarded_spans",discardedSpans)}}_cleanupHooks.push(client.on("spanStart",startedSpan=>{if(_finished||startedSpan===span||!!spanUtils.spanToJSON(startedSpan).timestamp){return}const allSpans=spanUtils.getSpanDescendants(span);if(allSpans.includes(startedSpan)){_pushActivity(startedSpan.spanContext().spanId)}}));_cleanupHooks.push(client.on("spanEnd",endedSpan=>{if(_finished){return}_popActivity(endedSpan.spanContext().spanId)}));_cleanupHooks.push(client.on("idleSpanEnableAutoFinish",spanToAllowAutoFinish=>{if(spanToAllowAutoFinish===span){_autoFinishAllowed=true;_restartIdleTimeout();if(activities.size){_restartChildSpanTimeout()}}}));if(!options.disableAutoFinish){_restartIdleTimeout()}setTimeout(()=>{if(!_finished){span.setStatus({code:spanstatus.SPAN_STATUS_ERROR,message:"deadline_exceeded"});_finishReason=FINISH_REASON_FINAL_TIMEOUT;span.end()}},finalTimeout);return span}function _startIdleSpan(options){const span=trace.startInactiveSpan(options);spanOnScope._setSpanForScope(currentScopes.getCurrentScope(),span);debugBuild.DEBUG_BUILD&&logger.logger.log("[Tracing] Started span is an idle span");return span}exports.TRACING_DEFAULTS=TRACING_DEFAULTS;exports.startIdleSpan=startIdleSpan},{"../currentScopes.js":78,"../debug-build.js":79,"../semanticAttributes.js":115,"../utils-hoist/logger.js":164,"../utils-hoist/time.js":182,"../utils/hasTracingEnabled.js":193,"../utils/spanOnScope.js":201,"../utils/spanUtils.js":202,"./sentryNonRecordingSpan.js":126,"./spanstatus.js":128,"./trace.js":129}],123:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const debugBuild=require("../debug-build.js");const logger=require("../utils-hoist/logger.js");const spanUtils=require("../utils/spanUtils.js");function logSpanStart(span){if(!debugBuild.DEBUG_BUILD)return;const{description="< unknown name >",op="< unknown op >",parent_span_id:parentSpanId}=spanUtils.spanToJSON(span);const{spanId}=span.spanContext();const sampled=spanUtils.spanIsSampled(span);const rootSpan=spanUtils.getRootSpan(span);const isRootSpan=rootSpan===span;const header=`[Tracing] Starting ${sampled?"sampled":"unsampled"} ${isRootSpan?"root ":""}span`;const infoParts=[`op: ${op}`,`name: ${description}`,`ID: ${spanId}`];if(parentSpanId){infoParts.push(`parent ID: ${parentSpanId}`)}if(!isRootSpan){const{op,description}=spanUtils.spanToJSON(rootSpan);infoParts.push(`root ID: ${rootSpan.spanContext().spanId}`);if(op){infoParts.push(`root op: ${op}`)}if(description){infoParts.push(`root description: ${description}`)}}logger.logger.log(`${header}
  ${infoParts.join("\n  ")}`)}function logSpanEnd(span){if(!debugBuild.DEBUG_BUILD)return;const{description="< unknown name >",op="< unknown op >"}=spanUtils.spanToJSON(span);const{spanId}=span.spanContext();const rootSpan=spanUtils.getRootSpan(span);const isRootSpan=rootSpan===span;const msg=`[Tracing] Finishing "${op}" ${isRootSpan?"root ":""}span "${description}" with ID ${spanId}`;logger.logger.log(msg)}exports.logSpanEnd=logSpanEnd;exports.logSpanStart=logSpanStart},{"../debug-build.js":79,"../utils-hoist/logger.js":164,"../utils/spanUtils.js":202}],124:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const debugBuild=require("../debug-build.js");const semanticAttributes=require("../semanticAttributes.js");const logger=require("../utils-hoist/logger.js");const spanUtils=require("../utils/spanUtils.js");function setMeasurement(name,value,unit,activeSpan=spanUtils.getActiveSpan()){const rootSpan=activeSpan&&spanUtils.getRootSpan(activeSpan);if(rootSpan){debugBuild.DEBUG_BUILD&&logger.logger.log(`[Measurement] Setting measurement on root span: ${name} = ${value} ${unit}`);rootSpan.addEvent(name,{[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE]:value,[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT]:unit})}}function timedEventsToMeasurements(events){if(!events||events.length===0){return undefined}const measurements={};events.forEach(event=>{const attributes=event.attributes||{};const unit=attributes[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT];const value=attributes[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE];if(typeof unit==="string"&&typeof value==="number"){measurements[event.name]={value:value,unit:unit}}});return measurements}exports.setMeasurement=setMeasurement;exports.timedEventsToMeasurements=timedEventsToMeasurements},{"../debug-build.js":79,"../semanticAttributes.js":115,"../utils-hoist/logger.js":164,"../utils/spanUtils.js":202}],125:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("../currentScopes.js");const debugBuild=require("../debug-build.js");const logger=require("../utils-hoist/logger.js");const hasTracingEnabled=require("../utils/hasTracingEnabled.js");const parseSampleRate=require("../utils/parseSampleRate.js");function sampleSpan(options,samplingContext){if(!hasTracingEnabled.hasTracingEnabled(options)){return[false]}const normalizedRequest=currentScopes.getIsolationScope().getScopeData().sdkProcessingMetadata.normalizedRequest;const enhancedSamplingContext={...samplingContext,normalizedRequest:samplingContext.normalizedRequest||normalizedRequest};let sampleRate;if(typeof options.tracesSampler==="function"){sampleRate=options.tracesSampler(enhancedSamplingContext)}else if(enhancedSamplingContext.parentSampled!==undefined){sampleRate=enhancedSamplingContext.parentSampled}else if(typeof options.tracesSampleRate!=="undefined"){sampleRate=options.tracesSampleRate}else{sampleRate=1}const parsedSampleRate=parseSampleRate.parseSampleRate(sampleRate);if(parsedSampleRate===undefined){debugBuild.DEBUG_BUILD&&logger.logger.warn("[Tracing] Discarding transaction because of invalid sample rate.");return[false]}if(!parsedSampleRate){debugBuild.DEBUG_BUILD&&logger.logger.log(`[Tracing] Discarding transaction because ${typeof options.tracesSampler==="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`);return[false,parsedSampleRate]}const shouldSample=Math.random()<parsedSampleRate;if(!shouldSample){debugBuild.DEBUG_BUILD&&logger.logger.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(sampleRate)})`);return[false,parsedSampleRate]}return[true,parsedSampleRate]}exports.sampleSpan=sampleSpan},{"../currentScopes.js":78,"../debug-build.js":79,"../utils-hoist/logger.js":164,"../utils/hasTracingEnabled.js":193,"../utils/parseSampleRate.js":198}],126:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const propagationContext=require("../utils-hoist/propagationContext.js");const spanUtils=require("../utils/spanUtils.js");class SentryNonRecordingSpan{constructor(spanContext={}){this._traceId=spanContext.traceId||propagationContext.generateTraceId();this._spanId=spanContext.spanId||propagationContext.generateSpanId()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:spanUtils.TRACE_FLAG_NONE}}end(_timestamp){}setAttribute(_key,_value){return this}setAttributes(_values){return this}setStatus(_status){return this}updateName(_name){return this}isRecording(){return false}addEvent(_name,_attributesOrStartTime,_startTime){return this}addLink(_link){return this}addLinks(_links){return this}recordException(_exception,_time){}}exports.SentryNonRecordingSpan=SentryNonRecordingSpan},{"../utils-hoist/propagationContext.js":174,"../utils/spanUtils.js":202}],127:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("../currentScopes.js");const debugBuild=require("../debug-build.js");const envelope=require("../envelope.js");const metricSummary=require("../metrics/metric-summary.js");const semanticAttributes=require("../semanticAttributes.js");const logger=require("../utils-hoist/logger.js");const object=require("../utils-hoist/object.js");const propagationContext=require("../utils-hoist/propagationContext.js");const time=require("../utils-hoist/time.js");const spanUtils=require("../utils/spanUtils.js");const dynamicSamplingContext=require("./dynamicSamplingContext.js");const logSpans=require("./logSpans.js");const measurement=require("./measurement.js");const utils=require("./utils.js");const MAX_SPAN_COUNT=1e3;class SentrySpan{constructor(spanContext={}){this._traceId=spanContext.traceId||propagationContext.generateTraceId();this._spanId=spanContext.spanId||propagationContext.generateSpanId();this._startTime=spanContext.startTimestamp||time.timestampInSeconds();this._attributes={};this.setAttributes({[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"manual",[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_OP]:spanContext.op,...spanContext.attributes});this._name=spanContext.name;if(spanContext.parentSpanId){this._parentSpanId=spanContext.parentSpanId}if("sampled"in spanContext){this._sampled=spanContext.sampled}if(spanContext.endTimestamp){this._endTime=spanContext.endTimestamp}this._events=[];this._isStandaloneSpan=spanContext.isStandalone;if(this._endTime){this._onSpanEnded()}}addLink(_link){return this}addLinks(_links){return this}recordException(_exception,_time){}spanContext(){const{_spanId:spanId,_traceId:traceId,_sampled:sampled}=this;return{spanId:spanId,traceId:traceId,traceFlags:sampled?spanUtils.TRACE_FLAG_SAMPLED:spanUtils.TRACE_FLAG_NONE}}setAttribute(key,value){if(value===undefined){delete this._attributes[key]}else{this._attributes[key]=value}return this}setAttributes(attributes){Object.keys(attributes).forEach(key=>this.setAttribute(key,attributes[key]));return this}updateStartTime(timeInput){this._startTime=spanUtils.spanTimeInputToSeconds(timeInput)}setStatus(value){this._status=value;return this}updateName(name){this._name=name;this.setAttribute(semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE,"custom");return this}end(endTimestamp){if(this._endTime){return}this._endTime=spanUtils.spanTimeInputToSeconds(endTimestamp);logSpans.logSpanEnd(this);this._onSpanEnded()}getSpanJSON(){return object.dropUndefinedKeys({data:this._attributes,description:this._name,op:this._attributes[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_OP],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:spanUtils.getStatusMessage(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN],_metrics_summary:metricSummary.getMetricSummaryJsonForSpan(this),profile_id:this._attributes[semanticAttributes.SEMANTIC_ATTRIBUTE_PROFILE_ID],exclusive_time:this._attributes[semanticAttributes.SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME],measurements:measurement.timedEventsToMeasurements(this._events),is_segment:this._isStandaloneSpan&&spanUtils.getRootSpan(this)===this||undefined,segment_id:this._isStandaloneSpan?spanUtils.getRootSpan(this).spanContext().spanId:undefined})}isRecording(){return!this._endTime&&!!this._sampled}addEvent(name,attributesOrStartTime,startTime){debugBuild.DEBUG_BUILD&&logger.logger.log("[Tracing] Adding an event to span:",name);const time$1=isSpanTimeInput(attributesOrStartTime)?attributesOrStartTime:startTime||time.timestampInSeconds();const attributes=isSpanTimeInput(attributesOrStartTime)?{}:attributesOrStartTime||{};const event={name:name,time:spanUtils.spanTimeInputToSeconds(time$1),attributes:attributes};this._events.push(event);return this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const client=currentScopes.getClient();if(client){client.emit("spanEnd",this)}const isSegmentSpan=this._isStandaloneSpan||this===spanUtils.getRootSpan(this);if(!isSegmentSpan){return}if(this._isStandaloneSpan){if(this._sampled){sendSpanEnvelope(envelope.createSpanEnvelope([this],client))}else{debugBuild.DEBUG_BUILD&&logger.logger.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled.");if(client){client.recordDroppedEvent("sample_rate","span")}}return}const transactionEvent=this._convertSpanToTransaction();if(transactionEvent){const scope=utils.getCapturedScopesOnSpan(this).scope||currentScopes.getCurrentScope();scope.captureEvent(transactionEvent)}}_convertSpanToTransaction(){if(!isFullFinishedSpan(spanUtils.spanToJSON(this))){return undefined}if(!this._name){debugBuild.DEBUG_BUILD&&logger.logger.warn("Transaction has no name, falling back to `<unlabeled transaction>`.");this._name="<unlabeled transaction>"}const{scope:capturedSpanScope,isolationScope:capturedSpanIsolationScope}=utils.getCapturedScopesOnSpan(this);const scope=capturedSpanScope||currentScopes.getCurrentScope();const client=scope.getClient()||currentScopes.getClient();if(this._sampled!==true){debugBuild.DEBUG_BUILD&&logger.logger.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled.");if(client){client.recordDroppedEvent("sample_rate","transaction")}return undefined}const finishedSpans=spanUtils.getSpanDescendants(this).filter(span=>span!==this&&!isStandaloneSpan(span));const spans=finishedSpans.map(span=>spanUtils.spanToJSON(span)).filter(isFullFinishedSpan);const source=this._attributes[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE];delete this._attributes[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME];spans.forEach(span=>{span.data&&delete span.data[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME]});const transaction={contexts:{trace:spanUtils.spanToTransactionTraceContext(this)},spans:spans.length>MAX_SPAN_COUNT?spans.sort((a,b)=>a.start_timestamp-b.start_timestamp).slice(0,MAX_SPAN_COUNT):spans,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:capturedSpanScope,capturedSpanIsolationScope:capturedSpanIsolationScope,...object.dropUndefinedKeys({dynamicSamplingContext:dynamicSamplingContext.getDynamicSamplingContextFromSpan(this)})},_metrics_summary:metricSummary.getMetricSummaryJsonForSpan(this),...source&&{transaction_info:{source:source}}};const measurements=measurement.timedEventsToMeasurements(this._events);const hasMeasurements=measurements&&Object.keys(measurements).length;if(hasMeasurements){debugBuild.DEBUG_BUILD&&logger.logger.log("[Measurements] Adding measurements to transaction event",JSON.stringify(measurements,undefined,2));transaction.measurements=measurements}return transaction}}function isSpanTimeInput(value){return value&&typeof value==="number"||value instanceof Date||Array.isArray(value)}function isFullFinishedSpan(input){return!!input.start_timestamp&&!!input.timestamp&&!!input.span_id&&!!input.trace_id}function isStandaloneSpan(span){return span instanceof SentrySpan&&span.isStandaloneSpan()}function sendSpanEnvelope(envelope){const client=currentScopes.getClient();if(!client){return}const spanItems=envelope[1];if(!spanItems||spanItems.length===0){client.recordDroppedEvent("before_send","span");return}client.sendEnvelope(envelope)}exports.SentrySpan=SentrySpan},{"../currentScopes.js":78,"../debug-build.js":79,"../envelope.js":81,"../metrics/metric-summary.js":110,"../semanticAttributes.js":115,"../utils-hoist/logger.js":164,"../utils-hoist/object.js":171,"../utils-hoist/propagationContext.js":174,"../utils-hoist/time.js":182,"../utils/spanUtils.js":202,"./dynamicSamplingContext.js":119,"./logSpans.js":123,"./measurement.js":124,"./utils.js":130}],128:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const SPAN_STATUS_UNSET=0;const SPAN_STATUS_OK=1;const SPAN_STATUS_ERROR=2;function getSpanStatusFromHttpCode(httpStatus){if(httpStatus<400&&httpStatus>=100){return{code:SPAN_STATUS_OK}}if(httpStatus>=400&&httpStatus<500){switch(httpStatus){case 401:return{code:SPAN_STATUS_ERROR,message:"unauthenticated"};case 403:return{code:SPAN_STATUS_ERROR,message:"permission_denied"};case 404:return{code:SPAN_STATUS_ERROR,message:"not_found"};case 409:return{code:SPAN_STATUS_ERROR,message:"already_exists"};case 413:return{code:SPAN_STATUS_ERROR,message:"failed_precondition"};case 429:return{code:SPAN_STATUS_ERROR,message:"resource_exhausted"};case 499:return{code:SPAN_STATUS_ERROR,message:"cancelled"};default:return{code:SPAN_STATUS_ERROR,message:"invalid_argument"}}}if(httpStatus>=500&&httpStatus<600){switch(httpStatus){case 501:return{code:SPAN_STATUS_ERROR,message:"unimplemented"};case 503:return{code:SPAN_STATUS_ERROR,message:"unavailable"};case 504:return{code:SPAN_STATUS_ERROR,message:"deadline_exceeded"};default:return{code:SPAN_STATUS_ERROR,message:"internal_error"}}}return{code:SPAN_STATUS_ERROR,message:"unknown_error"}}function setHttpStatus(span,httpStatus){span.setAttribute("http.response.status_code",httpStatus);const spanStatus=getSpanStatusFromHttpCode(httpStatus);if(spanStatus.message!=="unknown_error"){span.setStatus(spanStatus)}}exports.SPAN_STATUS_ERROR=SPAN_STATUS_ERROR;exports.SPAN_STATUS_OK=SPAN_STATUS_OK;exports.SPAN_STATUS_UNSET=SPAN_STATUS_UNSET;exports.getSpanStatusFromHttpCode=getSpanStatusFromHttpCode;exports.setHttpStatus=setHttpStatus},{}],129:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const carrier=require("../carrier.js");const currentScopes=require("../currentScopes.js");const index=require("../asyncContext/index.js");const debugBuild=require("../debug-build.js");const semanticAttributes=require("../semanticAttributes.js");const logger=require("../utils-hoist/logger.js");const propagationContext=require("../utils-hoist/propagationContext.js");const tracing=require("../utils-hoist/tracing.js");const handleCallbackErrors=require("../utils/handleCallbackErrors.js");const hasTracingEnabled=require("../utils/hasTracingEnabled.js");const spanOnScope=require("../utils/spanOnScope.js");const spanUtils=require("../utils/spanUtils.js");const dynamicSamplingContext=require("./dynamicSamplingContext.js");const logSpans=require("./logSpans.js");const sampling=require("./sampling.js");const sentryNonRecordingSpan=require("./sentryNonRecordingSpan.js");const sentrySpan=require("./sentrySpan.js");const spanstatus=require("./spanstatus.js");const utils=require("./utils.js");const SUPPRESS_TRACING_KEY="__SENTRY_SUPPRESS_TRACING__";function startSpan(options,callback){const acs=getAcs();if(acs.startSpan){return acs.startSpan(options,callback)}const spanArguments=parseSentrySpanArguments(options);const{forceTransaction,parentSpan:customParentSpan}=options;return currentScopes.withScope(options.scope,()=>{const wrapper=getActiveSpanWrapper(customParentSpan);return wrapper(()=>{const scope=currentScopes.getCurrentScope();const parentSpan=getParentSpan(scope);const shouldSkipSpan=options.onlyIfParent&&!parentSpan;const activeSpan=shouldSkipSpan?new sentryNonRecordingSpan.SentryNonRecordingSpan:createChildOrRootSpan({parentSpan:parentSpan,spanArguments:spanArguments,forceTransaction:forceTransaction,scope:scope});spanOnScope._setSpanForScope(scope,activeSpan);return handleCallbackErrors.handleCallbackErrors(()=>callback(activeSpan),()=>{const{status}=spanUtils.spanToJSON(activeSpan);if(activeSpan.isRecording()&&(!status||status==="ok")){activeSpan.setStatus({code:spanstatus.SPAN_STATUS_ERROR,message:"internal_error"})}},()=>activeSpan.end())})})}function startSpanManual(options,callback){const acs=getAcs();if(acs.startSpanManual){return acs.startSpanManual(options,callback)}const spanArguments=parseSentrySpanArguments(options);const{forceTransaction,parentSpan:customParentSpan}=options;return currentScopes.withScope(options.scope,()=>{const wrapper=getActiveSpanWrapper(customParentSpan);return wrapper(()=>{const scope=currentScopes.getCurrentScope();const parentSpan=getParentSpan(scope);const shouldSkipSpan=options.onlyIfParent&&!parentSpan;const activeSpan=shouldSkipSpan?new sentryNonRecordingSpan.SentryNonRecordingSpan:createChildOrRootSpan({parentSpan:parentSpan,spanArguments:spanArguments,forceTransaction:forceTransaction,scope:scope});spanOnScope._setSpanForScope(scope,activeSpan);function finishAndSetSpan(){activeSpan.end()}return handleCallbackErrors.handleCallbackErrors(()=>callback(activeSpan,finishAndSetSpan),()=>{const{status}=spanUtils.spanToJSON(activeSpan);if(activeSpan.isRecording()&&(!status||status==="ok")){activeSpan.setStatus({code:spanstatus.SPAN_STATUS_ERROR,message:"internal_error"})}})})})}function startInactiveSpan(options){const acs=getAcs();if(acs.startInactiveSpan){return acs.startInactiveSpan(options)}const spanArguments=parseSentrySpanArguments(options);const{forceTransaction,parentSpan:customParentSpan}=options;const wrapper=options.scope?callback=>currentScopes.withScope(options.scope,callback):customParentSpan!==undefined?callback=>withActiveSpan(customParentSpan,callback):callback=>callback();return wrapper(()=>{const scope=currentScopes.getCurrentScope();const parentSpan=getParentSpan(scope);const shouldSkipSpan=options.onlyIfParent&&!parentSpan;if(shouldSkipSpan){return new sentryNonRecordingSpan.SentryNonRecordingSpan}return createChildOrRootSpan({parentSpan:parentSpan,spanArguments:spanArguments,forceTransaction:forceTransaction,scope:scope})})}const continueTrace=(options,callback)=>{const carrier$1=carrier.getMainCarrier();const acs=index.getAsyncContextStrategy(carrier$1);if(acs.continueTrace){return acs.continueTrace(options,callback)}const{sentryTrace,baggage}=options;return currentScopes.withScope(scope=>{const propagationContext=tracing.propagationContextFromHeaders(sentryTrace,baggage);scope.setPropagationContext(propagationContext);return callback()})};function withActiveSpan(span,callback){const acs=getAcs();if(acs.withActiveSpan){return acs.withActiveSpan(span,callback)}return currentScopes.withScope(scope=>{spanOnScope._setSpanForScope(scope,span||undefined);return callback(scope)})}function suppressTracing(callback){const acs=getAcs();if(acs.suppressTracing){return acs.suppressTracing(callback)}return currentScopes.withScope(scope=>{scope.setSDKProcessingMetadata({[SUPPRESS_TRACING_KEY]:true});return callback()})}function startNewTrace(callback){return currentScopes.withScope(scope=>{scope.setPropagationContext({traceId:propagationContext.generateTraceId()});debugBuild.DEBUG_BUILD&&logger.logger.info(`Starting a new trace with id ${scope.getPropagationContext().traceId}`);return withActiveSpan(null,callback)})}function createChildOrRootSpan({parentSpan,spanArguments,forceTransaction,scope}){if(!hasTracingEnabled.hasTracingEnabled()){return new sentryNonRecordingSpan.SentryNonRecordingSpan}const isolationScope=currentScopes.getIsolationScope();let span;if(parentSpan&&!forceTransaction){span=_startChildSpan(parentSpan,scope,spanArguments);spanUtils.addChildSpanToSpan(parentSpan,span)}else if(parentSpan){const dsc=dynamicSamplingContext.getDynamicSamplingContextFromSpan(parentSpan);const{traceId,spanId:parentSpanId}=parentSpan.spanContext();const parentSampled=spanUtils.spanIsSampled(parentSpan);span=_startRootSpan({traceId:traceId,parentSpanId:parentSpanId,...spanArguments},scope,parentSampled);dynamicSamplingContext.freezeDscOnSpan(span,dsc)}else{const{traceId,dsc,parentSpanId,sampled:parentSampled}={...isolationScope.getPropagationContext(),...scope.getPropagationContext()};span=_startRootSpan({traceId:traceId,parentSpanId:parentSpanId,...spanArguments},scope,parentSampled);if(dsc){dynamicSamplingContext.freezeDscOnSpan(span,dsc)}}logSpans.logSpanStart(span);utils.setCapturedScopesOnSpan(span,scope,isolationScope);return span}function parseSentrySpanArguments(options){const exp=options.experimental||{};const initialCtx={isStandalone:exp.standalone,...options};if(options.startTime){const ctx={...initialCtx};ctx.startTimestamp=spanUtils.spanTimeInputToSeconds(options.startTime);delete ctx.startTime;return ctx}return initialCtx}function getAcs(){const carrier$1=carrier.getMainCarrier();return index.getAsyncContextStrategy(carrier$1)}function _startRootSpan(spanArguments,scope,parentSampled){const client=currentScopes.getClient();const options=client&&client.getOptions()||{};const{name="",attributes}=spanArguments;const[sampled,sampleRate]=scope.getScopeData().sdkProcessingMetadata[SUPPRESS_TRACING_KEY]?[false]:sampling.sampleSpan(options,{name:name,parentSampled:parentSampled,attributes:attributes,transactionContext:{name:name,parentSampled:parentSampled}});const rootSpan=new sentrySpan.SentrySpan({...spanArguments,attributes:{[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"custom",...spanArguments.attributes},sampled:sampled});if(sampleRate!==undefined){rootSpan.setAttribute(semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,sampleRate)}if(client){client.emit("spanStart",rootSpan)}return rootSpan}function _startChildSpan(parentSpan,scope,spanArguments){const{spanId,traceId}=parentSpan.spanContext();const sampled=scope.getScopeData().sdkProcessingMetadata[SUPPRESS_TRACING_KEY]?false:spanUtils.spanIsSampled(parentSpan);const childSpan=sampled?new sentrySpan.SentrySpan({...spanArguments,parentSpanId:spanId,traceId:traceId,sampled:sampled}):new sentryNonRecordingSpan.SentryNonRecordingSpan({traceId:traceId});spanUtils.addChildSpanToSpan(parentSpan,childSpan);const client=currentScopes.getClient();if(client){client.emit("spanStart",childSpan);if(spanArguments.endTimestamp){client.emit("spanEnd",childSpan)}}return childSpan}function getParentSpan(scope){const span=spanOnScope._getSpanForScope(scope);if(!span){return undefined}const client=currentScopes.getClient();const options=client?client.getOptions():{};if(options.parentSpanIsAlwaysRootSpan){return spanUtils.getRootSpan(span)}return span}function getActiveSpanWrapper(parentSpan){return parentSpan!==undefined?callback=>{return withActiveSpan(parentSpan,callback)}:callback=>callback()}exports.continueTrace=continueTrace;exports.startInactiveSpan=startInactiveSpan;exports.startNewTrace=startNewTrace;exports.startSpan=startSpan;exports.startSpanManual=startSpanManual;exports.suppressTracing=suppressTracing;exports.withActiveSpan=withActiveSpan},{"../asyncContext/index.js":71,"../carrier.js":75,"../currentScopes.js":78,"../debug-build.js":79,"../semanticAttributes.js":115,"../utils-hoist/logger.js":164,"../utils-hoist/propagationContext.js":174,"../utils-hoist/tracing.js":183,"../utils/handleCallbackErrors.js":192,"../utils/hasTracingEnabled.js":193,"../utils/spanOnScope.js":201,"../utils/spanUtils.js":202,"./dynamicSamplingContext.js":119,"./logSpans.js":123,"./sampling.js":125,"./sentryNonRecordingSpan.js":126,"./sentrySpan.js":127,"./spanstatus.js":128,"./utils.js":130}],130:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const object=require("../utils-hoist/object.js");const SCOPE_ON_START_SPAN_FIELD="_sentryScope";const ISOLATION_SCOPE_ON_START_SPAN_FIELD="_sentryIsolationScope";function setCapturedScopesOnSpan(span,scope,isolationScope){if(span){object.addNonEnumerableProperty(span,ISOLATION_SCOPE_ON_START_SPAN_FIELD,isolationScope);object.addNonEnumerableProperty(span,SCOPE_ON_START_SPAN_FIELD,scope)}}function getCapturedScopesOnSpan(span){return{scope:span[SCOPE_ON_START_SPAN_FIELD],isolationScope:span[ISOLATION_SCOPE_ON_START_SPAN_FIELD]}}exports.getCapturedScopesOnSpan=getCapturedScopesOnSpan;exports.setCapturedScopesOnSpan=setCapturedScopesOnSpan},{"../utils-hoist/object.js":171}],131:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const debugBuild=require("../debug-build.js");const envelope=require("../utils-hoist/envelope.js");const error=require("../utils-hoist/error.js");const logger=require("../utils-hoist/logger.js");const promisebuffer=require("../utils-hoist/promisebuffer.js");const ratelimit=require("../utils-hoist/ratelimit.js");const syncpromise=require("../utils-hoist/syncpromise.js");const DEFAULT_TRANSPORT_BUFFER_SIZE=64;function createTransport(options,makeRequest,buffer=promisebuffer.makePromiseBuffer(options.bufferSize||DEFAULT_TRANSPORT_BUFFER_SIZE)){let rateLimits={};const flush=timeout=>buffer.drain(timeout);function send(envelope$1){const filteredEnvelopeItems=[];envelope.forEachEnvelopeItem(envelope$1,(item,type)=>{const dataCategory=envelope.envelopeItemTypeToDataCategory(type);if(ratelimit.isRateLimited(rateLimits,dataCategory)){const event=getEventForEnvelopeItem(item,type);options.recordDroppedEvent("ratelimit_backoff",dataCategory,event)}else{filteredEnvelopeItems.push(item)}});if(filteredEnvelopeItems.length===0){return syncpromise.resolvedSyncPromise({})}const filteredEnvelope=envelope.createEnvelope(envelope$1[0],filteredEnvelopeItems);const recordEnvelopeLoss=reason=>{envelope.forEachEnvelopeItem(filteredEnvelope,(item,type)=>{const event=getEventForEnvelopeItem(item,type);options.recordDroppedEvent(reason,envelope.envelopeItemTypeToDataCategory(type),event)})};const requestTask=()=>makeRequest({body:envelope.serializeEnvelope(filteredEnvelope)}).then(response=>{if(response.statusCode!==undefined&&(response.statusCode<200||response.statusCode>=300)){debugBuild.DEBUG_BUILD&&logger.logger.warn(`Sentry responded with status code ${response.statusCode} to sent event.`)}rateLimits=ratelimit.updateRateLimits(rateLimits,response);return response},error=>{recordEnvelopeLoss("network_error");throw error});return buffer.add(requestTask).then(result=>result,error$1=>{if(error$1 instanceof error.SentryError){debugBuild.DEBUG_BUILD&&logger.logger.error("Skipped sending event because buffer is full.");recordEnvelopeLoss("queue_overflow");return syncpromise.resolvedSyncPromise({})}else{throw error$1}})}return{send:send,flush:flush}}function getEventForEnvelopeItem(item,type){if(type!=="event"&&type!=="transaction"){return undefined}return Array.isArray(item)?item[1]:undefined}exports.DEFAULT_TRANSPORT_BUFFER_SIZE=DEFAULT_TRANSPORT_BUFFER_SIZE;exports.createTransport=createTransport},{"../debug-build.js":79,"../utils-hoist/envelope.js":154,"../utils-hoist/error.js":155,"../utils-hoist/logger.js":164,"../utils-hoist/promisebuffer.js":173,"../utils-hoist/ratelimit.js":175,"../utils-hoist/syncpromise.js":181}],132:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const api=require("../api.js");const dsn=require("../utils-hoist/dsn.js");const envelope=require("../utils-hoist/envelope.js");function eventFromEnvelope(env,types){let event;envelope.forEachEnvelopeItem(env,(item,type)=>{if(types.includes(type)){event=Array.isArray(item)?item[1]:undefined}return!!event});return event}function makeOverrideReleaseTransport(createTransport,release){return options=>{const transport=createTransport(options);return{...transport,send:async envelope=>{const event=eventFromEnvelope(envelope,["event","transaction","profile","replay_event"]);if(event){event.release=release}return transport.send(envelope)}}}}function overrideDsn(envelope$1,dsn){return envelope.createEnvelope(dsn?{...envelope$1[0],dsn:dsn}:envelope$1[0],envelope$1[1])}function makeMultiplexedTransport(createTransport,matcher){return options=>{const fallbackTransport=createTransport(options);const otherTransports=new Map;function getTransport(dsn$1,release){const key=release?`${dsn$1}:${release}`:dsn$1;let transport=otherTransports.get(key);if(!transport){const validatedDsn=dsn.dsnFromString(dsn$1);if(!validatedDsn){return undefined}const url=api.getEnvelopeEndpointWithUrlEncodedAuth(validatedDsn,options.tunnel);transport=release?makeOverrideReleaseTransport(createTransport,release)({...options,url:url}):createTransport({...options,url:url});otherTransports.set(key,transport)}return[dsn$1,transport]}async function send(envelope){function getEvent(types){const eventTypes=types&&types.length?types:["event"];return eventFromEnvelope(envelope,eventTypes)}const transports=matcher({envelope:envelope,getEvent:getEvent}).map(result=>{if(typeof result==="string"){return getTransport(result,undefined)}else{return getTransport(result.dsn,result.release)}}).filter(t=>!!t);const transportsWithFallback=transports.length?transports:[["",fallbackTransport]];const results=await Promise.all(transportsWithFallback.map(([dsn,transport])=>transport.send(overrideDsn(envelope,dsn))));return results[0]}async function flush(timeout){const allTransports=[...otherTransports.values(),fallbackTransport];const results=await Promise.all(allTransports.map(transport=>transport.flush(timeout)));return results.every(r=>r)}return{send:send,flush:flush}}}exports.eventFromEnvelope=eventFromEnvelope;exports.makeMultiplexedTransport=makeMultiplexedTransport},{"../api.js":70,"../utils-hoist/dsn.js":152,"../utils-hoist/envelope.js":154}],133:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const debugBuild=require("../debug-build.js");const envelope=require("../utils-hoist/envelope.js");const logger=require("../utils-hoist/logger.js");const ratelimit=require("../utils-hoist/ratelimit.js");const MIN_DELAY=100;const START_DELAY=5e3;const MAX_DELAY=36e5;function makeOfflineTransport(createTransport){function log(...args){debugBuild.DEBUG_BUILD&&logger.logger.info("[Offline]:",...args)}return options=>{const transport=createTransport(options);if(!options.createStore){throw new Error("No `createStore` function was provided")}const store=options.createStore(options);let retryDelay=START_DELAY;let flushTimer;function shouldQueue(env,error,retryDelay){if(envelope.envelopeContainsItemType(env,["client_report"])){return false}if(options.shouldStore){return options.shouldStore(env,error,retryDelay)}return true}function flushIn(delay){if(flushTimer){clearTimeout(flushTimer)}flushTimer=setTimeout(async()=>{flushTimer=undefined;const found=await store.shift();if(found){log("Attempting to send previously queued event");found[0].sent_at=(new Date).toISOString();void send(found,true).catch(e=>{log("Failed to retry sending",e)})}},delay);if(typeof flushTimer!=="number"&&flushTimer.unref){flushTimer.unref()}}function flushWithBackOff(){if(flushTimer){return}flushIn(retryDelay);retryDelay=Math.min(retryDelay*2,MAX_DELAY)}async function send(envelope$1,isRetry=false){if(!isRetry&&envelope.envelopeContainsItemType(envelope$1,["replay_event","replay_recording"])){await store.push(envelope$1);flushIn(MIN_DELAY);return{}}try{const result=await transport.send(envelope$1);let delay=MIN_DELAY;if(result){if(result.headers&&result.headers["retry-after"]){delay=ratelimit.parseRetryAfterHeader(result.headers["retry-after"])}else if(result.headers&&result.headers["x-sentry-rate-limits"]){delay=6e4}else if((result.statusCode||0)>=400){return result}}flushIn(delay);retryDelay=START_DELAY;return result}catch(e){if(await shouldQueue(envelope$1,e,retryDelay)){if(isRetry){await store.unshift(envelope$1)}else{await store.push(envelope$1)}flushWithBackOff();log("Error sending. Event queued.",e);return{}}else{throw e}}}if(options.flushAtStartup){flushWithBackOff()}return{send:send,flush:t=>transport.flush(t)}}}exports.MIN_DELAY=MIN_DELAY;exports.START_DELAY=START_DELAY;exports.makeOfflineTransport=makeOfflineTransport},{"../debug-build.js":79,"../utils-hoist/envelope.js":154,"../utils-hoist/logger.js":164,"../utils-hoist/ratelimit.js":175}],134:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("./currentScopes.js");const exports$1=require("./exports.js");const semanticAttributes=require("./semanticAttributes.js");require("./tracing/errors.js");require("./utils-hoist/version.js");require("./utils-hoist/debug-build.js");require("./utils-hoist/logger.js");require("./debug-build.js");require("./utils-hoist/time.js");const normalize=require("./utils-hoist/normalize.js");require("./utils-hoist/syncpromise.js");const trace=require("./tracing/trace.js");const trpcCaptureContext={mechanism:{handled:false,data:{function:"trpcMiddleware"}}};function captureIfError(nextResult){if(typeof nextResult==="object"&&nextResult!==null&&"ok"in nextResult&&!nextResult.ok&&"error"in nextResult){exports$1.captureException(nextResult.error,trpcCaptureContext)}}function trpcMiddleware(options={}){return async function(opts){const{path,type,next,rawInput,getRawInput}=opts;const client=currentScopes.getClient();const clientOptions=client&&client.getOptions();const trpcContext={procedure_path:path,procedure_type:type};if(options.attachRpcInput!==undefined?options.attachRpcInput:clientOptions&&clientOptions.sendDefaultPii){if(rawInput!==undefined){trpcContext.input=normalize.normalize(rawInput)}if(getRawInput!==undefined&&typeof getRawInput==="function"){try{const rawRes=await getRawInput();trpcContext.input=normalize.normalize(rawRes)}catch(err){}}}return currentScopes.withScope(scope=>{scope.setContext("trpc",trpcContext);return trace.startSpanManual({name:`trpc/${path}`,op:"rpc.server",attributes:{[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"route",[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.rpc.trpc"}},async span=>{try{const nextResult=await next();captureIfError(nextResult);span.end();return nextResult}catch(e){exports$1.captureException(e,trpcCaptureContext);span.end();throw e}})})}}exports.trpcMiddleware=trpcMiddleware},{"./currentScopes.js":78,"./debug-build.js":79,"./exports.js":83,"./semanticAttributes.js":115,"./tracing/errors.js":120,"./tracing/trace.js":129,"./utils-hoist/debug-build.js":150,"./utils-hoist/logger.js":164,"./utils-hoist/normalize.js":170,"./utils-hoist/syncpromise.js":181,"./utils-hoist/time.js":182,"./utils-hoist/version.js":189}],135:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const is=require("./is.js");const string=require("./string.js");function applyAggregateErrorsToEvent(exceptionFromErrorImplementation,parser,maxValueLimit=250,key,limit,event,hint){if(!event.exception||!event.exception.values||!hint||!is.isInstanceOf(hint.originalException,Error)){return}const originalException=event.exception.values.length>0?event.exception.values[event.exception.values.length-1]:undefined;if(originalException){event.exception.values=truncateAggregateExceptions(aggregateExceptionsFromError(exceptionFromErrorImplementation,parser,limit,hint.originalException,key,event.exception.values,originalException,0),maxValueLimit)}}function aggregateExceptionsFromError(exceptionFromErrorImplementation,parser,limit,error,key,prevExceptions,exception,exceptionId){if(prevExceptions.length>=limit+1){return prevExceptions}let newExceptions=[...prevExceptions];if(is.isInstanceOf(error[key],Error)){applyExceptionGroupFieldsForParentException(exception,exceptionId);const newException=exceptionFromErrorImplementation(parser,error[key]);const newExceptionId=newExceptions.length;applyExceptionGroupFieldsForChildException(newException,key,newExceptionId,exceptionId);newExceptions=aggregateExceptionsFromError(exceptionFromErrorImplementation,parser,limit,error[key],key,[newException,...newExceptions],newException,newExceptionId)}if(Array.isArray(error.errors)){error.errors.forEach((childError,i)=>{if(is.isInstanceOf(childError,Error)){applyExceptionGroupFieldsForParentException(exception,exceptionId);const newException=exceptionFromErrorImplementation(parser,childError);const newExceptionId=newExceptions.length;applyExceptionGroupFieldsForChildException(newException,`errors[${i}]`,newExceptionId,exceptionId);newExceptions=aggregateExceptionsFromError(exceptionFromErrorImplementation,parser,limit,childError,key,[newException,...newExceptions],newException,newExceptionId)}})}return newExceptions}function applyExceptionGroupFieldsForParentException(exception,exceptionId){exception.mechanism=exception.mechanism||{type:"generic",handled:true};exception.mechanism={...exception.mechanism,...exception.type==="AggregateError"&&{is_exception_group:true},exception_id:exceptionId}}function applyExceptionGroupFieldsForChildException(exception,source,exceptionId,parentId){exception.mechanism=exception.mechanism||{type:"generic",handled:true};exception.mechanism={...exception.mechanism,type:"chained",source:source,exception_id:exceptionId,parent_id:parentId}}function truncateAggregateExceptions(exceptions,maxValueLength){return exceptions.map(exception=>{if(exception.value){exception.value=string.truncate(exception.value,maxValueLength)}return exception})}exports.applyAggregateErrorsToEvent=applyAggregateErrorsToEvent},{"./is.js":162,"./string.js":179}],136:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const nodeStackTrace=require("./node-stack-trace.js");const object=require("./object.js");const stacktrace=require("./stacktrace.js");function watchdogTimer(createTimer,pollInterval,anrThreshold,callback){const timer=createTimer();let triggered=false;let enabled=true;setInterval(()=>{const diffMs=timer.getTimeMs();if(triggered===false&&diffMs>pollInterval+anrThreshold){triggered=true;if(enabled){callback()}}if(diffMs<pollInterval+anrThreshold){triggered=false}},20);return{poll:()=>{timer.reset()},enabled:state=>{enabled=state}}}function callFrameToStackFrame(frame,url,getModuleFromFilename){const filename=url?url.replace(/^file:\/\//,""):undefined;const colno=frame.location.columnNumber?frame.location.columnNumber+1:undefined;const lineno=frame.location.lineNumber?frame.location.lineNumber+1:undefined;return object.dropUndefinedKeys({filename:filename,module:getModuleFromFilename(filename),function:frame.functionName||stacktrace.UNKNOWN_FUNCTION,colno:colno,lineno:lineno,in_app:filename?nodeStackTrace.filenameIsInApp(filename):undefined})}exports.callFrameToStackFrame=callFrameToStackFrame;exports.watchdogTimer=watchdogTimer},{"./node-stack-trace.js":168,"./object.js":171,"./stacktrace.js":178}],137:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function flatten(input){const result=[];const flattenHelper=input=>{input.forEach(el=>{if(Array.isArray(el)){flattenHelper(el)}else{result.push(el)}})};flattenHelper(input);return result}exports.flatten=flatten},{}],138:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const debugBuild=require("./debug-build.js");const is=require("./is.js");const logger=require("./logger.js");const BAGGAGE_HEADER_NAME="baggage";const SENTRY_BAGGAGE_KEY_PREFIX="sentry-";const SENTRY_BAGGAGE_KEY_PREFIX_REGEX=/^sentry-/;const MAX_BAGGAGE_STRING_LENGTH=8192;function baggageHeaderToDynamicSamplingContext(baggageHeader){const baggageObject=parseBaggageHeader(baggageHeader);if(!baggageObject){return undefined}const dynamicSamplingContext=Object.entries(baggageObject).reduce((acc,[key,value])=>{if(key.match(SENTRY_BAGGAGE_KEY_PREFIX_REGEX)){const nonPrefixedKey=key.slice(SENTRY_BAGGAGE_KEY_PREFIX.length);acc[nonPrefixedKey]=value}return acc},{});if(Object.keys(dynamicSamplingContext).length>0){return dynamicSamplingContext}else{return undefined}}function dynamicSamplingContextToSentryBaggageHeader(dynamicSamplingContext){if(!dynamicSamplingContext){return undefined}const sentryPrefixedDSC=Object.entries(dynamicSamplingContext).reduce((acc,[dscKey,dscValue])=>{if(dscValue){acc[`${SENTRY_BAGGAGE_KEY_PREFIX}${dscKey}`]=dscValue}return acc},{});return objectToBaggageHeader(sentryPrefixedDSC)}function parseBaggageHeader(baggageHeader){if(!baggageHeader||!is.isString(baggageHeader)&&!Array.isArray(baggageHeader)){return undefined}if(Array.isArray(baggageHeader)){return baggageHeader.reduce((acc,curr)=>{const currBaggageObject=baggageHeaderToObject(curr);Object.entries(currBaggageObject).forEach(([key,value])=>{acc[key]=value});return acc},{})}return baggageHeaderToObject(baggageHeader)}function baggageHeaderToObject(baggageHeader){return baggageHeader.split(",").map(baggageEntry=>baggageEntry.split("=").map(keyOrValue=>decodeURIComponent(keyOrValue.trim()))).reduce((acc,[key,value])=>{if(key&&value){acc[key]=value}return acc},{})}function objectToBaggageHeader(object){if(Object.keys(object).length===0){return undefined}return Object.entries(object).reduce((baggageHeader,[objectKey,objectValue],currentIndex)=>{const baggageEntry=`${encodeURIComponent(objectKey)}=${encodeURIComponent(objectValue)}`;const newBaggageHeader=currentIndex===0?baggageEntry:`${baggageHeader},${baggageEntry}`;if(newBaggageHeader.length>MAX_BAGGAGE_STRING_LENGTH){debugBuild.DEBUG_BUILD&&logger.logger.warn(`Not adding key: ${objectKey} with val: ${objectValue} to baggage header due to exceeding baggage size limits.`);return baggageHeader}else{return newBaggageHeader}},"")}exports.BAGGAGE_HEADER_NAME=BAGGAGE_HEADER_NAME;exports.MAX_BAGGAGE_STRING_LENGTH=MAX_BAGGAGE_STRING_LENGTH;exports.SENTRY_BAGGAGE_KEY_PREFIX=SENTRY_BAGGAGE_KEY_PREFIX;exports.SENTRY_BAGGAGE_KEY_PREFIX_REGEX=SENTRY_BAGGAGE_KEY_PREFIX_REGEX;exports.baggageHeaderToDynamicSamplingContext=baggageHeaderToDynamicSamplingContext;exports.dynamicSamplingContextToSentryBaggageHeader=dynamicSamplingContextToSentryBaggageHeader;exports.parseBaggageHeader=parseBaggageHeader},{"./debug-build.js":150,"./is.js":162,"./logger.js":164}],139:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function getBreadcrumbLogLevelFromHttpStatusCode(statusCode){if(statusCode===undefined){return undefined}else if(statusCode>=400&&statusCode<500){return"warning"}else if(statusCode>=500){return"error"}else{return undefined}}exports.getBreadcrumbLogLevelFromHttpStatusCode=getBreadcrumbLogLevelFromHttpStatusCode},{}],140:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const is=require("./is.js");const worldwide=require("./worldwide.js");const WINDOW=worldwide.GLOBAL_OBJ;const DEFAULT_MAX_STRING_LENGTH=80;function htmlTreeAsString(elem,options={}){if(!elem){return"<unknown>"}try{let currentElem=elem;const MAX_TRAVERSE_HEIGHT=5;const out=[];let height=0;let len=0;const separator=" > ";const sepLength=separator.length;let nextStr;const keyAttrs=Array.isArray(options)?options:options.keyAttrs;const maxStringLength=!Array.isArray(options)&&options.maxStringLength||DEFAULT_MAX_STRING_LENGTH;while(currentElem&&height++<MAX_TRAVERSE_HEIGHT){nextStr=_htmlElementAsString(currentElem,keyAttrs);if(nextStr==="html"||height>1&&len+out.length*sepLength+nextStr.length>=maxStringLength){break}out.push(nextStr);len+=nextStr.length;currentElem=currentElem.parentNode}return out.reverse().join(separator)}catch(_oO){return"<unknown>"}}function _htmlElementAsString(el,keyAttrs){const elem=el;const out=[];if(!elem||!elem.tagName){return""}if(WINDOW.HTMLElement){if(elem instanceof HTMLElement&&elem.dataset){if(elem.dataset["sentryComponent"]){return elem.dataset["sentryComponent"]}if(elem.dataset["sentryElement"]){return elem.dataset["sentryElement"]}}}out.push(elem.tagName.toLowerCase());const keyAttrPairs=keyAttrs&&keyAttrs.length?keyAttrs.filter(keyAttr=>elem.getAttribute(keyAttr)).map(keyAttr=>[keyAttr,elem.getAttribute(keyAttr)]):null;if(keyAttrPairs&&keyAttrPairs.length){keyAttrPairs.forEach(keyAttrPair=>{out.push(`[${keyAttrPair[0]}="${keyAttrPair[1]}"]`)})}else{if(elem.id){out.push(`#${elem.id}`)}const className=elem.className;if(className&&is.isString(className)){const classes=className.split(/\s+/);for(const c of classes){out.push(`.${c}`)}}}const allowedAttrs=["aria-label","type","name","title","alt"];for(const k of allowedAttrs){const attr=elem.getAttribute(k);if(attr){out.push(`[${k}="${attr}"]`)}}return out.join("")}function getLocationHref(){try{return WINDOW.document.location.href}catch(oO){return""}}function getDomElement(selector){if(WINDOW.document&&WINDOW.document.querySelector){return WINDOW.document.querySelector(selector)}return null}function getComponentName(elem){if(!WINDOW.HTMLElement){return null}let currentElem=elem;const MAX_TRAVERSE_HEIGHT=5;for(let i=0;i<MAX_TRAVERSE_HEIGHT;i++){if(!currentElem){return null}if(currentElem instanceof HTMLElement){if(currentElem.dataset["sentryComponent"]){return currentElem.dataset["sentryComponent"]}if(currentElem.dataset["sentryElement"]){return currentElem.dataset["sentryElement"]}}currentElem=currentElem.parentNode}return null}exports.getComponentName=getComponentName;exports.getDomElement=getDomElement;exports.getLocationHref=getLocationHref;exports.htmlTreeAsString=htmlTreeAsString},{"./is.js":162,"./worldwide.js":190}],141:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const _nullishCoalesce=require("./_nullishCoalesce.js");async function _asyncNullishCoalesce(lhs,rhsFn){return _nullishCoalesce._nullishCoalesce(lhs,rhsFn)}exports._asyncNullishCoalesce=_asyncNullishCoalesce},{"./_nullishCoalesce.js":144}],142:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});async function _asyncOptionalChain(ops){let lastAccessLHS=undefined;let value=ops[0];let i=1;while(i<ops.length){const op=ops[i];const fn=ops[i+1];i+=2;if((op==="optionalAccess"||op==="optionalCall")&&value==null){return}if(op==="access"||op==="optionalAccess"){lastAccessLHS=value;value=await fn(value)}else if(op==="call"||op==="optionalCall"){value=await fn((...args)=>value.call(lastAccessLHS,...args));lastAccessLHS=undefined}}return value}exports._asyncOptionalChain=_asyncOptionalChain},{}],143:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const _asyncOptionalChain=require("./_asyncOptionalChain.js");async function _asyncOptionalChainDelete(ops){const result=await _asyncOptionalChain._asyncOptionalChain(ops);return result==null?true:result}exports._asyncOptionalChainDelete=_asyncOptionalChainDelete},{"./_asyncOptionalChain.js":142}],144:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function _nullishCoalesce(lhs,rhsFn){return lhs!=null?lhs:rhsFn()}exports._nullishCoalesce=_nullishCoalesce},{}],145:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function _optionalChain(ops){let lastAccessLHS=undefined;let value=ops[0];let i=1;while(i<ops.length){const op=ops[i];const fn=ops[i+1];i+=2;if((op==="optionalAccess"||op==="optionalCall")&&value==null){return}if(op==="access"||op==="optionalAccess"){lastAccessLHS=value;value=fn(value)}else if(op==="call"||op==="optionalCall"){value=fn((...args)=>value.call(lastAccessLHS,...args));lastAccessLHS=undefined}}return value}exports._optionalChain=_optionalChain},{}],146:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const _optionalChain=require("./_optionalChain.js");function _optionalChainDelete(ops){const result=_optionalChain._optionalChain(ops);return result==null?true:result}exports._optionalChainDelete=_optionalChainDelete},{"./_optionalChain.js":145}],147:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function makeFifoCache(size){let evictionOrder=[];let cache={};return{add(key,value){while(evictionOrder.length>=size){const evictCandidate=evictionOrder.shift();if(evictCandidate!==undefined){delete cache[evictCandidate]}}if(cache[key]){this.delete(key)}evictionOrder.push(key);cache[key]=value},clear(){cache={};evictionOrder=[]},get(key){return cache[key]},size(){return evictionOrder.length},delete(key){if(!cache[key]){return false}delete cache[key];for(let i=0;i<evictionOrder.length;i++){if(evictionOrder[i]===key){evictionOrder.splice(i,1);break}}return true}}}exports.makeFifoCache=makeFifoCache},{}],148:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const envelope=require("./envelope.js");const time=require("./time.js");function createClientReportEnvelope(discarded_events,dsn,timestamp){const clientReportItem=[{type:"client_report"},{timestamp:timestamp||time.dateTimestampInSeconds(),discarded_events:discarded_events}];return envelope.createEnvelope(dsn?{dsn:dsn}:{},[clientReportItem])}exports.createClientReportEnvelope=createClientReportEnvelope},{"./envelope.js":154,"./time.js":182}],149:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function parseCookie(str){const obj={};let index=0;while(index<str.length){const eqIdx=str.indexOf("=",index);if(eqIdx===-1){break}let endIdx=str.indexOf(";",index);if(endIdx===-1){endIdx=str.length}else if(endIdx<eqIdx){index=str.lastIndexOf(";",eqIdx-1)+1;continue}const key=str.slice(index,eqIdx).trim();if(undefined===obj[key]){let val=str.slice(eqIdx+1,endIdx).trim();if(val.charCodeAt(0)===34){val=val.slice(1,-1)}try{obj[key]=val.indexOf("%")!==-1?decodeURIComponent(val):val}catch(e){obj[key]=val}}index=endIdx+1}return obj}exports.parseCookie=parseCookie},{}],150:[function(require,module,exports){arguments[4][2][0].apply(exports,arguments)},{dup:2}],151:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const worldwide=require("./worldwide.js");let parsedStackResults;let lastKeysCount;let cachedFilenameDebugIds;function getFilenameToDebugIdMap(stackParser){const debugIdMap=worldwide.GLOBAL_OBJ._sentryDebugIds;if(!debugIdMap){return{}}const debugIdKeys=Object.keys(debugIdMap);if(cachedFilenameDebugIds&&debugIdKeys.length===lastKeysCount){return cachedFilenameDebugIds}lastKeysCount=debugIdKeys.length;cachedFilenameDebugIds=debugIdKeys.reduce((acc,stackKey)=>{if(!parsedStackResults){parsedStackResults={}}const result=parsedStackResults[stackKey];if(result){acc[result[0]]=result[1]}else{const parsedStack=stackParser(stackKey);for(let i=parsedStack.length-1;i>=0;i--){const stackFrame=parsedStack[i];const filename=stackFrame&&stackFrame.filename;const debugId=debugIdMap[stackKey];if(filename&&debugId){acc[filename]=debugId;parsedStackResults[stackKey]=[filename,debugId];break}}}return acc},{});return cachedFilenameDebugIds}function getDebugImagesForResources(stackParser,resource_paths){const filenameDebugIdMap=getFilenameToDebugIdMap(stackParser);if(!filenameDebugIdMap){return[]}const images=[];for(const path of resource_paths){if(path&&filenameDebugIdMap[path]){images.push({type:"sourcemap",code_file:path,debug_id:filenameDebugIdMap[path]})}}return images}exports.getDebugImagesForResources=getDebugImagesForResources;exports.getFilenameToDebugIdMap=getFilenameToDebugIdMap},{"./worldwide.js":190}],152:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const debugBuild=require("./debug-build.js");const logger=require("./logger.js");const DSN_REGEX=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function isValidProtocol(protocol){return protocol==="http"||protocol==="https"}function dsnToString(dsn,withPassword=false){const{host,path,pass,port,projectId,protocol,publicKey}=dsn;return`${protocol}://${publicKey}${withPassword&&pass?`:${pass}`:""}`+`@${host}${port?`:${port}`:""}/${path?`${path}/`:path}${projectId}`}function dsnFromString(str){const match=DSN_REGEX.exec(str);if(!match){logger.consoleSandbox(()=>{console.error(`Invalid Sentry Dsn: ${str}`)});return undefined}const[protocol,publicKey,pass="",host="",port="",lastPath=""]=match.slice(1);let path="";let projectId=lastPath;const split=projectId.split("/");if(split.length>1){path=split.slice(0,-1).join("/");projectId=split.pop()}if(projectId){const projectMatch=projectId.match(/^\d+/);if(projectMatch){projectId=projectMatch[0]}}return dsnFromComponents({host:host,pass:pass,path:path,projectId:projectId,port:port,protocol:protocol,publicKey:publicKey})}function dsnFromComponents(components){return{protocol:components.protocol,publicKey:components.publicKey||"",pass:components.pass||"",host:components.host,port:components.port||"",path:components.path||"",projectId:components.projectId}}function validateDsn(dsn){if(!debugBuild.DEBUG_BUILD){return true}const{port,projectId,protocol}=dsn;const requiredComponents=["protocol","publicKey","host","projectId"];const hasMissingRequiredComponent=requiredComponents.find(component=>{if(!dsn[component]){logger.logger.error(`Invalid Sentry Dsn: ${component} missing`);return true}return false});if(hasMissingRequiredComponent){return false}if(!projectId.match(/^\d+$/)){logger.logger.error(`Invalid Sentry Dsn: Invalid projectId ${projectId}`);return false}if(!isValidProtocol(protocol)){logger.logger.error(`Invalid Sentry Dsn: Invalid protocol ${protocol}`);return false}if(port&&isNaN(parseInt(port,10))){logger.logger.error(`Invalid Sentry Dsn: Invalid port ${port}`);return false}return true}function makeDsn(from){const components=typeof from==="string"?dsnFromString(from):dsnFromComponents(from);if(!components||!validateDsn(components)){return undefined}return components}exports.dsnFromString=dsnFromString;exports.dsnToString=dsnToString;exports.makeDsn=makeDsn},{"./debug-build.js":150,"./logger.js":164}],153:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function isBrowserBundle(){return typeof __SENTRY_BROWSER_BUNDLE__!=="undefined"&&!!__SENTRY_BROWSER_BUNDLE__}function getSDKSource(){return"npm"}exports.getSDKSource=getSDKSource;exports.isBrowserBundle=isBrowserBundle},{}],154:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const dsn=require("./dsn.js");const normalize=require("./normalize.js");const object=require("./object.js");const worldwide=require("./worldwide.js");function createEnvelope(headers,items=[]){return[headers,items]}function addItemToEnvelope(envelope,newItem){const[headers,items]=envelope;return[headers,[...items,newItem]]}function forEachEnvelopeItem(envelope,callback){const envelopeItems=envelope[1];for(const envelopeItem of envelopeItems){const envelopeItemType=envelopeItem[0].type;const result=callback(envelopeItem,envelopeItemType);if(result){return true}}return false}function envelopeContainsItemType(envelope,types){return forEachEnvelopeItem(envelope,(_,type)=>types.includes(type))}function encodeUTF8(input){return worldwide.GLOBAL_OBJ.__SENTRY__&&worldwide.GLOBAL_OBJ.__SENTRY__.encodePolyfill?worldwide.GLOBAL_OBJ.__SENTRY__.encodePolyfill(input):(new TextEncoder).encode(input)}function decodeUTF8(input){return worldwide.GLOBAL_OBJ.__SENTRY__&&worldwide.GLOBAL_OBJ.__SENTRY__.decodePolyfill?worldwide.GLOBAL_OBJ.__SENTRY__.decodePolyfill(input):(new TextDecoder).decode(input)}function serializeEnvelope(envelope){const[envHeaders,items]=envelope;let parts=JSON.stringify(envHeaders);function append(next){if(typeof parts==="string"){parts=typeof next==="string"?parts+next:[encodeUTF8(parts),next]}else{parts.push(typeof next==="string"?encodeUTF8(next):next)}}for(const item of items){const[itemHeaders,payload]=item;append(`\n${JSON.stringify(itemHeaders)}\n`);if(typeof payload==="string"||payload instanceof Uint8Array){append(payload)}else{let stringifiedPayload;try{stringifiedPayload=JSON.stringify(payload)}catch(e){stringifiedPayload=JSON.stringify(normalize.normalize(payload))}append(stringifiedPayload)}}return typeof parts==="string"?parts:concatBuffers(parts)}function concatBuffers(buffers){const totalLength=buffers.reduce((acc,buf)=>acc+buf.length,0);const merged=new Uint8Array(totalLength);let offset=0;for(const buffer of buffers){merged.set(buffer,offset);offset+=buffer.length}return merged}function parseEnvelope(env){let buffer=typeof env==="string"?encodeUTF8(env):env;function readBinary(length){const bin=buffer.subarray(0,length);buffer=buffer.subarray(length+1);return bin}function readJson(){let i=buffer.indexOf(10);if(i<0){i=buffer.length}return JSON.parse(decodeUTF8(readBinary(i)))}const envelopeHeader=readJson();const items=[];while(buffer.length){const itemHeader=readJson();const binaryLength=typeof itemHeader.length==="number"?itemHeader.length:undefined;items.push([itemHeader,binaryLength?readBinary(binaryLength):readJson()])}return[envelopeHeader,items]}function createSpanEnvelopeItem(spanJson){const spanHeaders={type:"span"};return[spanHeaders,spanJson]}function createAttachmentEnvelopeItem(attachment){const buffer=typeof attachment.data==="string"?encodeUTF8(attachment.data):attachment.data;return[object.dropUndefinedKeys({type:"attachment",length:buffer.length,filename:attachment.filename,content_type:attachment.contentType,attachment_type:attachment.attachmentType}),buffer]}const ITEM_TYPE_TO_DATA_CATEGORY_MAP={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket",raw_security:"security"};function envelopeItemTypeToDataCategory(type){return ITEM_TYPE_TO_DATA_CATEGORY_MAP[type]}function getSdkMetadataForEnvelopeHeader(metadataOrEvent){if(!metadataOrEvent||!metadataOrEvent.sdk){return}const{name,version}=metadataOrEvent.sdk;return{name:name,version:version}}function createEventEnvelopeHeaders(event,sdkInfo,tunnel,dsn$1){const dynamicSamplingContext=event.sdkProcessingMetadata&&event.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:event.event_id,sent_at:(new Date).toISOString(),...sdkInfo&&{sdk:sdkInfo},...!!tunnel&&dsn$1&&{dsn:dsn.dsnToString(dsn$1)},...dynamicSamplingContext&&{trace:object.dropUndefinedKeys({...dynamicSamplingContext})}}}exports.addItemToEnvelope=addItemToEnvelope;exports.createAttachmentEnvelopeItem=createAttachmentEnvelopeItem;exports.createEnvelope=createEnvelope;exports.createEventEnvelopeHeaders=createEventEnvelopeHeaders;exports.createSpanEnvelopeItem=createSpanEnvelopeItem;exports.envelopeContainsItemType=envelopeContainsItemType;exports.envelopeItemTypeToDataCategory=envelopeItemTypeToDataCategory;exports.forEachEnvelopeItem=forEachEnvelopeItem;exports.getSdkMetadataForEnvelopeHeader=getSdkMetadataForEnvelopeHeader;exports.parseEnvelope=parseEnvelope;exports.serializeEnvelope=serializeEnvelope},{"./dsn.js":152,"./normalize.js":170,"./object.js":171,"./worldwide.js":190}],155:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});class SentryError extends Error{constructor(message,logLevel="warn"){super(message);this.message=message;this.name=new.target.prototype.constructor.name;Object.setPrototypeOf(this,new.target.prototype);this.logLevel=logLevel}}exports.SentryError=SentryError},{}],156:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const is=require("./is.js");const misc=require("./misc.js");const normalize=require("./normalize.js");const object=require("./object.js");function parseStackFrames(stackParser,error){return stackParser(error.stack||"",1)}function exceptionFromError(stackParser,error){const exception={type:error.name||error.constructor.name,value:error.message};const frames=parseStackFrames(stackParser,error);if(frames.length){exception.stacktrace={frames:frames}}return exception}function getErrorPropertyFromObject(obj){for(const prop in obj){if(Object.prototype.hasOwnProperty.call(obj,prop)){const value=obj[prop];if(value instanceof Error){return value}}}return undefined}function getMessageForObject(exception){if("name"in exception&&typeof exception.name==="string"){let message=`'${exception.name}' captured as exception`;if("message"in exception&&typeof exception.message==="string"){message+=` with message '${exception.message}'`}return message}else if("message"in exception&&typeof exception.message==="string"){return exception.message}const keys=object.extractExceptionKeysForMessage(exception);if(is.isErrorEvent(exception)){return`Event \`ErrorEvent\` captured as exception with message \`${exception.message}\``}const className=getObjectClassName(exception);return`${className&&className!=="Object"?`'${className}'`:"Object"} captured as exception with keys: ${keys}`}function getObjectClassName(obj){try{const prototype=Object.getPrototypeOf(obj);return prototype?prototype.constructor.name:undefined}catch(e){}}function getException(client,mechanism,exception,hint){if(is.isError(exception)){return[exception,undefined]}mechanism.synthetic=true;if(is.isPlainObject(exception)){const normalizeDepth=client&&client.getOptions().normalizeDepth;const extras={["__serialized__"]:normalize.normalizeToSize(exception,normalizeDepth)};const errorFromProp=getErrorPropertyFromObject(exception);if(errorFromProp){return[errorFromProp,extras]}const message=getMessageForObject(exception);const ex=hint&&hint.syntheticException||new Error(message);ex.message=message;return[ex,extras]}const ex=hint&&hint.syntheticException||new Error(exception);ex.message=`${exception}`;return[ex,undefined]}function eventFromUnknownInput(client,stackParser,exception,hint){const providedMechanism=hint&&hint.data&&hint.data.mechanism;const mechanism=providedMechanism||{handled:true,type:"generic"};const[ex,extras]=getException(client,mechanism,exception,hint);const event={exception:{values:[exceptionFromError(stackParser,ex)]}};if(extras){event.extra=extras}misc.addExceptionTypeValue(event,undefined,undefined);misc.addExceptionMechanism(event,mechanism);return{...event,event_id:hint&&hint.event_id}}function eventFromMessage(stackParser,message,level="info",hint,attachStacktrace){const event={event_id:hint&&hint.event_id,level:level};if(attachStacktrace&&hint&&hint.syntheticException){const frames=parseStackFrames(stackParser,hint.syntheticException);if(frames.length){event.exception={values:[{value:message,stacktrace:{frames:frames}}]};misc.addExceptionMechanism(event,{synthetic:true})}}if(is.isParameterizedString(message)){const{__sentry_template_string__,__sentry_template_values__}=message;event.logentry={message:__sentry_template_string__,params:__sentry_template_values__};return event}event.message=message;return event}exports.eventFromMessage=eventFromMessage;exports.eventFromUnknownInput=eventFromUnknownInput;exports.exceptionFromError=exceptionFromError;exports.parseStackFrames=parseStackFrames},{"./is.js":162,"./misc.js":167,"./normalize.js":170,"./object.js":171}],157:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const logger=require("../logger.js");const object=require("../object.js");const worldwide=require("../worldwide.js");const handlers=require("./handlers.js");function addConsoleInstrumentationHandler(handler){const type="console";handlers.addHandler(type,handler);handlers.maybeInstrument(type,instrumentConsole)}function instrumentConsole(){if(!("console"in worldwide.GLOBAL_OBJ)){return}logger.CONSOLE_LEVELS.forEach(function(level){if(!(level in worldwide.GLOBAL_OBJ.console)){return}object.fill(worldwide.GLOBAL_OBJ.console,level,function(originalConsoleMethod){logger.originalConsoleMethods[level]=originalConsoleMethod;return function(...args){const handlerData={args:args,level:level};handlers.triggerHandlers("console",handlerData);const log=logger.originalConsoleMethods[level];log&&log.apply(worldwide.GLOBAL_OBJ.console,args)}})})}exports.addConsoleInstrumentationHandler=addConsoleInstrumentationHandler},{"../logger.js":164,"../object.js":171,"../worldwide.js":190,"./handlers.js":161}],158:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const is=require("../is.js");const object=require("../object.js");const supports=require("../supports.js");const time=require("../time.js");const worldwide=require("../worldwide.js");const handlers=require("./handlers.js");function addFetchInstrumentationHandler(handler,skipNativeFetchCheck){const type="fetch";handlers.addHandler(type,handler);handlers.maybeInstrument(type,()=>instrumentFetch(undefined,skipNativeFetchCheck))}function addFetchEndInstrumentationHandler(handler){const type="fetch-body-resolved";handlers.addHandler(type,handler);handlers.maybeInstrument(type,()=>instrumentFetch(streamHandler))}function instrumentFetch(onFetchResolved,skipNativeFetchCheck=false){if(skipNativeFetchCheck&&!supports.supportsNativeFetch()){return}object.fill(worldwide.GLOBAL_OBJ,"fetch",function(originalFetch){return function(...args){const virtualError=new Error;const{method,url}=parseFetchArgs(args);const handlerData={args:args,fetchData:{method:method,url:url},startTimestamp:time.timestampInSeconds()*1e3,virtualError:virtualError};if(!onFetchResolved){handlers.triggerHandlers("fetch",{...handlerData})}return originalFetch.apply(worldwide.GLOBAL_OBJ,args).then(async response=>{if(onFetchResolved){onFetchResolved(response)}else{handlers.triggerHandlers("fetch",{...handlerData,endTimestamp:time.timestampInSeconds()*1e3,response:response})}return response},error=>{handlers.triggerHandlers("fetch",{...handlerData,endTimestamp:time.timestampInSeconds()*1e3,error:error});if(is.isError(error)&&error.stack===undefined){error.stack=virtualError.stack;object.addNonEnumerableProperty(error,"framesToPop",1)}throw error})}})}async function resolveResponse(res,onFinishedResolving){if(res&&res.body){const body=res.body;const responseReader=body.getReader();const maxFetchDurationTimeout=setTimeout(()=>{body.cancel().then(null,()=>{})},90*1e3);let readingActive=true;while(readingActive){let chunkTimeout;try{chunkTimeout=setTimeout(()=>{body.cancel().then(null,()=>{})},5e3);const{done}=await responseReader.read();clearTimeout(chunkTimeout);if(done){onFinishedResolving();readingActive=false}}catch(error){readingActive=false}finally{clearTimeout(chunkTimeout)}}clearTimeout(maxFetchDurationTimeout);responseReader.releaseLock();body.cancel().then(null,()=>{})}}function streamHandler(response){let clonedResponseForResolving;try{clonedResponseForResolving=response.clone()}catch(e){return}resolveResponse(clonedResponseForResolving,()=>{handlers.triggerHandlers("fetch-body-resolved",{endTimestamp:time.timestampInSeconds()*1e3,response:response})})}function hasProp(obj,prop){return!!obj&&typeof obj==="object"&&!!obj[prop]}function getUrlFromResource(resource){if(typeof resource==="string"){return resource}if(!resource){return""}if(hasProp(resource,"url")){return resource.url}if(resource.toString){return resource.toString()}return""}function parseFetchArgs(fetchArgs){if(fetchArgs.length===0){return{method:"GET",url:""}}if(fetchArgs.length===2){const[url,options]=fetchArgs;return{url:getUrlFromResource(url),method:hasProp(options,"method")?String(options.method).toUpperCase():"GET"}}const arg=fetchArgs[0];return{url:getUrlFromResource(arg),method:hasProp(arg,"method")?String(arg.method).toUpperCase():"GET"}}exports.addFetchEndInstrumentationHandler=addFetchEndInstrumentationHandler;exports.addFetchInstrumentationHandler=addFetchInstrumentationHandler;exports.parseFetchArgs=parseFetchArgs},{"../is.js":162,"../object.js":171,"../supports.js":180,"../time.js":182,"../worldwide.js":190,"./handlers.js":161}],159:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const worldwide=require("../worldwide.js");const handlers=require("./handlers.js");let _oldOnErrorHandler=null;function addGlobalErrorInstrumentationHandler(handler){const type="error";handlers.addHandler(type,handler);handlers.maybeInstrument(type,instrumentError)}function instrumentError(){_oldOnErrorHandler=worldwide.GLOBAL_OBJ.onerror;worldwide.GLOBAL_OBJ.onerror=function(msg,url,line,column,error){const handlerData={column:column,error:error,line:line,msg:msg,url:url};handlers.triggerHandlers("error",handlerData);if(_oldOnErrorHandler){return _oldOnErrorHandler.apply(this,arguments)}return false};worldwide.GLOBAL_OBJ.onerror.__SENTRY_INSTRUMENTED__=true}exports.addGlobalErrorInstrumentationHandler=addGlobalErrorInstrumentationHandler},{"../worldwide.js":190,"./handlers.js":161}],160:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const worldwide=require("../worldwide.js");const handlers=require("./handlers.js");let _oldOnUnhandledRejectionHandler=null;function addGlobalUnhandledRejectionInstrumentationHandler(handler){const type="unhandledrejection";handlers.addHandler(type,handler);handlers.maybeInstrument(type,instrumentUnhandledRejection)}function instrumentUnhandledRejection(){_oldOnUnhandledRejectionHandler=worldwide.GLOBAL_OBJ.onunhandledrejection;worldwide.GLOBAL_OBJ.onunhandledrejection=function(e){const handlerData=e;handlers.triggerHandlers("unhandledrejection",handlerData);if(_oldOnUnhandledRejectionHandler){return _oldOnUnhandledRejectionHandler.apply(this,arguments)}return true};worldwide.GLOBAL_OBJ.onunhandledrejection.__SENTRY_INSTRUMENTED__=true}exports.addGlobalUnhandledRejectionInstrumentationHandler=addGlobalUnhandledRejectionInstrumentationHandler},{"../worldwide.js":190,"./handlers.js":161}],161:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const debugBuild=require("../debug-build.js");const logger=require("../logger.js");const stacktrace=require("../stacktrace.js");const handlers={};const instrumented={};function addHandler(type,handler){handlers[type]=handlers[type]||[];handlers[type].push(handler)}function resetInstrumentationHandlers(){Object.keys(handlers).forEach(key=>{handlers[key]=undefined})}function maybeInstrument(type,instrumentFn){if(!instrumented[type]){instrumented[type]=true;try{instrumentFn()}catch(e){debugBuild.DEBUG_BUILD&&logger.logger.error(`Error while instrumenting ${type}`,e)}}}function triggerHandlers(type,data){const typeHandlers=type&&handlers[type];if(!typeHandlers){return}for(const handler of typeHandlers){try{handler(data)}catch(e){debugBuild.DEBUG_BUILD&&logger.logger.error(`Error while triggering instrumentation handler.\nType: ${type}\nName: ${stacktrace.getFunctionName(handler)}\nError:`,e)}}}exports.addHandler=addHandler;exports.maybeInstrument=maybeInstrument;exports.resetInstrumentationHandlers=resetInstrumentationHandlers;exports.triggerHandlers=triggerHandlers},{"../debug-build.js":150,"../logger.js":164,"../stacktrace.js":178}],162:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const objectToString=Object.prototype.toString;function isError(wat){switch(objectToString.call(wat)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return true;default:return isInstanceOf(wat,Error)}}function isBuiltin(wat,className){return objectToString.call(wat)===`[object ${className}]`}function isErrorEvent(wat){return isBuiltin(wat,"ErrorEvent")}function isDOMError(wat){return isBuiltin(wat,"DOMError")}function isDOMException(wat){return isBuiltin(wat,"DOMException")}function isString(wat){return isBuiltin(wat,"String")}function isParameterizedString(wat){return typeof wat==="object"&&wat!==null&&"__sentry_template_string__"in wat&&"__sentry_template_values__"in wat}function isPrimitive(wat){return wat===null||isParameterizedString(wat)||typeof wat!=="object"&&typeof wat!=="function"}function isPlainObject(wat){return isBuiltin(wat,"Object")}function isEvent(wat){return typeof Event!=="undefined"&&isInstanceOf(wat,Event)}function isElement(wat){return typeof Element!=="undefined"&&isInstanceOf(wat,Element)}function isRegExp(wat){return isBuiltin(wat,"RegExp")}function isThenable(wat){return Boolean(wat&&wat.then&&typeof wat.then==="function")}function isSyntheticEvent(wat){return isPlainObject(wat)&&"nativeEvent"in wat&&"preventDefault"in wat&&"stopPropagation"in wat}function isInstanceOf(wat,base){try{return wat instanceof base}catch(_e){return false}}function isVueViewModel(wat){return!!(typeof wat==="object"&&wat!==null&&(wat.__isVue||wat._isVue))}exports.isDOMError=isDOMError;exports.isDOMException=isDOMException;exports.isElement=isElement;exports.isError=isError;exports.isErrorEvent=isErrorEvent;exports.isEvent=isEvent;exports.isInstanceOf=isInstanceOf;exports.isParameterizedString=isParameterizedString;exports.isPlainObject=isPlainObject;exports.isPrimitive=isPrimitive;exports.isRegExp=isRegExp;exports.isString=isString;exports.isSyntheticEvent=isSyntheticEvent;exports.isThenable=isThenable;exports.isVueViewModel=isVueViewModel},{}],163:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const node=require("./node.js");const worldwide=require("./worldwide.js");function isBrowser(){return typeof window!=="undefined"&&(!node.isNodeEnv()||isElectronNodeRenderer())}function isElectronNodeRenderer(){const process=worldwide.GLOBAL_OBJ.process;return!!process&&process.type==="renderer"}exports.isBrowser=isBrowser},{"./node.js":169,"./worldwide.js":190}],164:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const debugBuild=require("./debug-build.js");const worldwide=require("./worldwide.js");const PREFIX="Sentry Logger ";const CONSOLE_LEVELS=["debug","info","warn","error","log","assert","trace"];const originalConsoleMethods={};function consoleSandbox(callback){if(!("console"in worldwide.GLOBAL_OBJ)){return callback()}const console=worldwide.GLOBAL_OBJ.console;const wrappedFuncs={};const wrappedLevels=Object.keys(originalConsoleMethods);wrappedLevels.forEach(level=>{const originalConsoleMethod=originalConsoleMethods[level];wrappedFuncs[level]=console[level];console[level]=originalConsoleMethod});try{return callback()}finally{wrappedLevels.forEach(level=>{console[level]=wrappedFuncs[level]})}}function makeLogger(){let enabled=false;const logger={enable:()=>{enabled=true},disable:()=>{enabled=false},isEnabled:()=>enabled};if(debugBuild.DEBUG_BUILD){CONSOLE_LEVELS.forEach(name=>{logger[name]=(...args)=>{if(enabled){consoleSandbox(()=>{worldwide.GLOBAL_OBJ.console[name](`${PREFIX}[${name}]:`,...args)})}}})}else{CONSOLE_LEVELS.forEach(name=>{logger[name]=()=>undefined})}return logger}const logger=worldwide.getGlobalSingleton("logger",makeLogger);exports.CONSOLE_LEVELS=CONSOLE_LEVELS;exports.consoleSandbox=consoleSandbox;exports.logger=logger;exports.originalConsoleMethods=originalConsoleMethods},{"./debug-build.js":150,"./worldwide.js":190}],165:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});class LRUMap{constructor(_maxSize){this._maxSize=_maxSize;this._cache=new Map}get size(){return this._cache.size}get(key){const value=this._cache.get(key);if(value===undefined){return undefined}this._cache.delete(key);this._cache.set(key,value);return value}set(key,value){if(this._cache.size>=this._maxSize){this._cache.delete(this._cache.keys().next().value)}this._cache.set(key,value)}remove(key){const value=this._cache.get(key);if(value){this._cache.delete(key)}return value}clear(){this._cache.clear()}keys(){return Array.from(this._cache.keys())}values(){const values=[];this._cache.forEach(value=>values.push(value));return values}}exports.LRUMap=LRUMap},{}],166:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function memoBuilder(){const hasWeakSet=typeof WeakSet==="function";const inner=hasWeakSet?new WeakSet:[];function memoize(obj){if(hasWeakSet){if(inner.has(obj)){return true}inner.add(obj);return false}for(let i=0;i<inner.length;i++){const value=inner[i];if(value===obj){return true}}inner.push(obj);return false}function unmemoize(obj){if(hasWeakSet){inner.delete(obj)}else{for(let i=0;i<inner.length;i++){if(inner[i]===obj){inner.splice(i,1);break}}}}return[memoize,unmemoize]}exports.memoBuilder=memoBuilder},{}],167:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const object=require("./object.js");const string=require("./string.js");const worldwide=require("./worldwide.js");function uuid4(){const gbl=worldwide.GLOBAL_OBJ;const crypto=gbl.crypto||gbl.msCrypto;let getRandomByte=()=>Math.random()*16;try{if(crypto&&crypto.randomUUID){return crypto.randomUUID().replace(/-/g,"")}if(crypto&&crypto.getRandomValues){getRandomByte=()=>{const typedArray=new Uint8Array(1);crypto.getRandomValues(typedArray);return typedArray[0]}}}catch(_){}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,c=>(c^(getRandomByte()&15)>>c/4).toString(16))}function getFirstException(event){return event.exception&&event.exception.values?event.exception.values[0]:undefined}function getEventDescription(event){const{message,event_id:eventId}=event;if(message){return message}const firstException=getFirstException(event);if(firstException){if(firstException.type&&firstException.value){return`${firstException.type}: ${firstException.value}`}return firstException.type||firstException.value||eventId||"<unknown>"}return eventId||"<unknown>"}function addExceptionTypeValue(event,value,type){const exception=event.exception=event.exception||{};const values=exception.values=exception.values||[];const firstException=values[0]=values[0]||{};if(!firstException.value){firstException.value=value||""}if(!firstException.type){firstException.type=type||"Error"}}function addExceptionMechanism(event,newMechanism){const firstException=getFirstException(event);if(!firstException){return}const defaultMechanism={type:"generic",handled:true};const currentMechanism=firstException.mechanism;firstException.mechanism={...defaultMechanism,...currentMechanism,...newMechanism};if(newMechanism&&"data"in newMechanism){const mergedData={...currentMechanism&&currentMechanism.data,...newMechanism.data};firstException.mechanism.data=mergedData}}const SEMVER_REGEXP=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/;function _parseInt(input){return parseInt(input||"",10)}function parseSemver(input){const match=input.match(SEMVER_REGEXP)||[];const major=_parseInt(match[1]);const minor=_parseInt(match[2]);const patch=_parseInt(match[3]);return{buildmetadata:match[5],major:isNaN(major)?undefined:major,minor:isNaN(minor)?undefined:minor,patch:isNaN(patch)?undefined:patch,prerelease:match[4]}}function addContextToFrame(lines,frame,linesOfContext=5){if(frame.lineno===undefined){return}const maxLines=lines.length;const sourceLine=Math.max(Math.min(maxLines-1,frame.lineno-1),0);frame.pre_context=lines.slice(Math.max(0,sourceLine-linesOfContext),sourceLine).map(line=>string.snipLine(line,0));const lineIndex=Math.min(maxLines-1,sourceLine);frame.context_line=string.snipLine(lines[lineIndex],frame.colno||0);frame.post_context=lines.slice(Math.min(sourceLine+1,maxLines),sourceLine+1+linesOfContext).map(line=>string.snipLine(line,0))}function checkOrSetAlreadyCaught(exception){if(isAlreadyCaptured(exception)){return true}try{object.addNonEnumerableProperty(exception,"__sentry_captured__",true)}catch(err){}return false}function isAlreadyCaptured(exception){try{return exception.__sentry_captured__}catch(e){}}function arrayify(maybeArray){return Array.isArray(maybeArray)?maybeArray:[maybeArray]}exports.addContextToFrame=addContextToFrame;exports.addExceptionMechanism=addExceptionMechanism;exports.addExceptionTypeValue=addExceptionTypeValue;exports.arrayify=arrayify;exports.checkOrSetAlreadyCaught=checkOrSetAlreadyCaught;exports.getEventDescription=getEventDescription;exports.parseSemver=parseSemver;exports.uuid4=uuid4},{"./object.js":171,"./string.js":179,"./worldwide.js":190}],168:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const stacktrace=require("./stacktrace.js");function filenameIsInApp(filename,isNative=false){const isInternal=isNative||filename&&!filename.startsWith("/")&&!filename.match(/^[A-Z]:/)&&!filename.startsWith(".")&&!filename.match(/^[a-zA-Z]([a-zA-Z0-9.\-+])*:\/\//);return!isInternal&&filename!==undefined&&!filename.includes("node_modules/")}function node(getModule){const FILENAME_MATCH=/^\s*[-]{4,}$/;const FULL_MATCH=/at (?:async )?(?:(.+?)\s+\()?(?:(.+):(\d+):(\d+)?|([^)]+))\)?/;return line=>{const lineMatch=line.match(FULL_MATCH);if(lineMatch){let object;let method;let functionName;let typeName;let methodName;if(lineMatch[1]){functionName=lineMatch[1];let methodStart=functionName.lastIndexOf(".");if(functionName[methodStart-1]==="."){methodStart--}if(methodStart>0){object=functionName.slice(0,methodStart);method=functionName.slice(methodStart+1);const objectEnd=object.indexOf(".Module");if(objectEnd>0){functionName=functionName.slice(objectEnd+1);object=object.slice(0,objectEnd)}}typeName=undefined}if(method){typeName=object;methodName=method}if(method==="<anonymous>"){methodName=undefined;functionName=undefined}if(functionName===undefined){methodName=methodName||stacktrace.UNKNOWN_FUNCTION;functionName=typeName?`${typeName}.${methodName}`:methodName}let filename=lineMatch[2]&&lineMatch[2].startsWith("file://")?lineMatch[2].slice(7):lineMatch[2];const isNative=lineMatch[5]==="native";if(filename&&filename.match(/\/[A-Z]:/)){filename=filename.slice(1)}if(!filename&&lineMatch[5]&&!isNative){filename=lineMatch[5]}return{filename:filename?decodeURI(filename):undefined,module:getModule?getModule(filename):undefined,function:functionName,lineno:_parseIntOrUndefined(lineMatch[3]),colno:_parseIntOrUndefined(lineMatch[4]),in_app:filenameIsInApp(filename||"",isNative)}}if(line.match(FILENAME_MATCH)){return{filename:line}}return undefined}}function nodeStackLineParser(getModule){return[90,node(getModule)]}function _parseIntOrUndefined(input){return parseInt(input||"",10)||undefined}exports.filenameIsInApp=filenameIsInApp;exports.node=node;exports.nodeStackLineParser=nodeStackLineParser},{"./stacktrace.js":178}],169:[function(require,module,exports){(function(process){(function(){Object.defineProperty(exports,"__esModule",{value:true});const env=require("./env.js");function isNodeEnv(){return!env.isBrowserBundle()&&Object.prototype.toString.call(typeof process!=="undefined"?process:0)==="[object process]"}function dynamicRequire(mod,request){return mod.require(request)}function loadModule(moduleName){let mod;try{mod=dynamicRequire(module,moduleName)}catch(e){}if(!mod){try{const{cwd}=dynamicRequire(module,"process");mod=dynamicRequire(module,`${cwd()}/node_modules/${moduleName}`)}catch(e){}}return mod}exports.dynamicRequire=dynamicRequire;exports.isNodeEnv=isNodeEnv;exports.loadModule=loadModule}).call(this)}).call(this,require("_process"))},{"./env.js":153,_process:1}],170:[function(require,module,exports){(function(global){(function(){Object.defineProperty(exports,"__esModule",{value:true});const is=require("./is.js");const memo=require("./memo.js");const object=require("./object.js");const stacktrace=require("./stacktrace.js");function normalize(input,depth=100,maxProperties=+Infinity){try{return visit("",input,depth,maxProperties)}catch(err){return{ERROR:`**non-serializable** (${err})`}}}function normalizeToSize(object,depth=3,maxSize=100*1024){const normalized=normalize(object,depth);if(jsonSize(normalized)>maxSize){return normalizeToSize(object,depth-1,maxSize)}return normalized}function visit(key,value,depth=+Infinity,maxProperties=+Infinity,memo$1=memo.memoBuilder()){const[memoize,unmemoize]=memo$1;if(value==null||["boolean","string"].includes(typeof value)||typeof value==="number"&&Number.isFinite(value)){return value}const stringified=stringifyValue(key,value);if(!stringified.startsWith("[object ")){return stringified}if(value["__sentry_skip_normalization__"]){return value}const remainingDepth=typeof value["__sentry_override_normalization_depth__"]==="number"?value["__sentry_override_normalization_depth__"]:depth;if(remainingDepth===0){return stringified.replace("object ","")}if(memoize(value)){return"[Circular ~]"}const valueWithToJSON=value;if(valueWithToJSON&&typeof valueWithToJSON.toJSON==="function"){try{const jsonValue=valueWithToJSON.toJSON();return visit("",jsonValue,remainingDepth-1,maxProperties,memo$1)}catch(err){}}const normalized=Array.isArray(value)?[]:{};let numAdded=0;const visitable=object.convertToPlainObject(value);for(const visitKey in visitable){if(!Object.prototype.hasOwnProperty.call(visitable,visitKey)){continue}if(numAdded>=maxProperties){normalized[visitKey]="[MaxProperties ~]";break}const visitValue=visitable[visitKey];normalized[visitKey]=visit(visitKey,visitValue,remainingDepth-1,maxProperties,memo$1);numAdded++}unmemoize(value);return normalized}function stringifyValue(key,value){try{if(key==="domain"&&value&&typeof value==="object"&&value._events){return"[Domain]"}if(key==="domainEmitter"){return"[DomainEmitter]"}if(typeof global!=="undefined"&&value===global){return"[Global]"}if(typeof window!=="undefined"&&value===window){return"[Window]"}if(typeof document!=="undefined"&&value===document){return"[Document]"}if(is.isVueViewModel(value)){return"[VueViewModel]"}if(is.isSyntheticEvent(value)){return"[SyntheticEvent]"}if(typeof value==="number"&&!Number.isFinite(value)){return`[${value}]`}if(typeof value==="function"){return`[Function: ${stacktrace.getFunctionName(value)}]`}if(typeof value==="symbol"){return`[${String(value)}]`}if(typeof value==="bigint"){return`[BigInt: ${String(value)}]`}const objName=getConstructorName(value);if(/^HTML(\w*)Element$/.test(objName)){return`[HTMLElement: ${objName}]`}return`[object ${objName}]`}catch(err){return`**non-serializable** (${err})`}}function getConstructorName(value){const prototype=Object.getPrototypeOf(value);return prototype?prototype.constructor.name:"null prototype"}function utf8Length(value){return~-encodeURI(value).split(/%..|./).length}function jsonSize(value){return utf8Length(JSON.stringify(value))}function normalizeUrlToBase(url,basePath){const escapedBase=basePath.replace(/\\/g,"/").replace(/[|\\{}()[\]^$+*?.]/g,"\\$&");let newUrl=url;try{newUrl=decodeURI(url)}catch(_Oo){}return newUrl.replace(/\\/g,"/").replace(/webpack:\/?/g,"").replace(new RegExp(`(file://)?/*${escapedBase}/*`,"ig"),"app:///")}exports.normalize=normalize;exports.normalizeToSize=normalizeToSize;exports.normalizeUrlToBase=normalizeUrlToBase}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./is.js":162,"./memo.js":166,"./object.js":171,"./stacktrace.js":178}],171:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const browser=require("./browser.js");const debugBuild=require("./debug-build.js");const is=require("./is.js");const logger=require("./logger.js");const string=require("./string.js");function fill(source,name,replacementFactory){if(!(name in source)){return}const original=source[name];const wrapped=replacementFactory(original);if(typeof wrapped==="function"){markFunctionWrapped(wrapped,original)}try{source[name]=wrapped}catch(e){debugBuild.DEBUG_BUILD&&logger.logger.log(`Failed to replace method "${name}" in object`,source)}}function addNonEnumerableProperty(obj,name,value){try{Object.defineProperty(obj,name,{value:value,writable:true,configurable:true})}catch(o_O){debugBuild.DEBUG_BUILD&&logger.logger.log(`Failed to add non-enumerable property "${name}" to object`,obj)}}function markFunctionWrapped(wrapped,original){try{const proto=original.prototype||{};wrapped.prototype=original.prototype=proto;addNonEnumerableProperty(wrapped,"__sentry_original__",original)}catch(o_O){}}function getOriginalFunction(func){return func.__sentry_original__}function urlEncode(object){return Object.entries(object).map(([key,value])=>`${encodeURIComponent(key)}=${encodeURIComponent(value)}`).join("&")}function convertToPlainObject(value){if(is.isError(value)){return{message:value.message,name:value.name,stack:value.stack,...getOwnProperties(value)}}else if(is.isEvent(value)){const newObj={type:value.type,target:serializeEventTarget(value.target),currentTarget:serializeEventTarget(value.currentTarget),...getOwnProperties(value)};if(typeof CustomEvent!=="undefined"&&is.isInstanceOf(value,CustomEvent)){newObj.detail=value.detail}return newObj}else{return value}}function serializeEventTarget(target){try{return is.isElement(target)?browser.htmlTreeAsString(target):Object.prototype.toString.call(target)}catch(_oO){return"<unknown>"}}function getOwnProperties(obj){if(typeof obj==="object"&&obj!==null){const extractedProps={};for(const property in obj){if(Object.prototype.hasOwnProperty.call(obj,property)){extractedProps[property]=obj[property]}}return extractedProps}else{return{}}}function extractExceptionKeysForMessage(exception,maxLength=40){const keys=Object.keys(convertToPlainObject(exception));keys.sort();const firstKey=keys[0];if(!firstKey){return"[object has no keys]"}if(firstKey.length>=maxLength){return string.truncate(firstKey,maxLength)}for(let includedKeys=keys.length;includedKeys>0;includedKeys--){const serialized=keys.slice(0,includedKeys).join(", ");if(serialized.length>maxLength){continue}if(includedKeys===keys.length){return serialized}return string.truncate(serialized,maxLength)}return""}function dropUndefinedKeys(inputValue){const memoizationMap=new Map;return _dropUndefinedKeys(inputValue,memoizationMap)}function _dropUndefinedKeys(inputValue,memoizationMap){if(isPojo(inputValue)){const memoVal=memoizationMap.get(inputValue);if(memoVal!==undefined){return memoVal}const returnValue={};memoizationMap.set(inputValue,returnValue);for(const key of Object.getOwnPropertyNames(inputValue)){if(typeof inputValue[key]!=="undefined"){returnValue[key]=_dropUndefinedKeys(inputValue[key],memoizationMap)}}return returnValue}if(Array.isArray(inputValue)){const memoVal=memoizationMap.get(inputValue);if(memoVal!==undefined){return memoVal}const returnValue=[];memoizationMap.set(inputValue,returnValue);inputValue.forEach(item=>{returnValue.push(_dropUndefinedKeys(item,memoizationMap))});return returnValue}return inputValue}function isPojo(input){if(!is.isPlainObject(input)){return false}try{const name=Object.getPrototypeOf(input).constructor.name;return!name||name==="Object"}catch(e2){return true}}function objectify(wat){let objectified;switch(true){case wat==undefined:objectified=new String(wat);break;case typeof wat==="symbol"||typeof wat==="bigint":objectified=Object(wat);break;case is.isPrimitive(wat):objectified=new wat.constructor(wat);break;default:objectified=wat;break}return objectified}exports.addNonEnumerableProperty=addNonEnumerableProperty;exports.convertToPlainObject=convertToPlainObject;exports.dropUndefinedKeys=dropUndefinedKeys;exports.extractExceptionKeysForMessage=extractExceptionKeysForMessage;exports.fill=fill;exports.getOriginalFunction=getOriginalFunction;exports.markFunctionWrapped=markFunctionWrapped;exports.objectify=objectify;exports.urlEncode=urlEncode},{"./browser.js":140,"./debug-build.js":150,"./is.js":162,"./logger.js":164,"./string.js":179}],172:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function normalizeArray(parts,allowAboveRoot){let up=0;for(let i=parts.length-1;i>=0;i--){const last=parts[i];if(last==="."){parts.splice(i,1)}else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift("..")}}return parts}const splitPathRe=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function splitPath(filename){const truncated=filename.length>1024?`<truncated>${filename.slice(-1024)}`:filename;const parts=splitPathRe.exec(truncated);return parts?parts.slice(1):[]}function resolve(...args){let resolvedPath="";let resolvedAbsolute=false;for(let i=args.length-1;i>=-1&&!resolvedAbsolute;i--){const path=i>=0?args[i]:"/";if(!path){continue}resolvedPath=`${path}/${resolvedPath}`;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(resolvedPath.split("/").filter(p=>!!p),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."}function trim(arr){let start=0;for(;start<arr.length;start++){if(arr[start]!==""){break}}let end=arr.length-1;for(;end>=0;end--){if(arr[end]!==""){break}}if(start>end){return[]}return arr.slice(start,end-start+1)}function relative(from,to){from=resolve(from).slice(1);to=resolve(to).slice(1);const fromParts=trim(from.split("/"));const toParts=trim(to.split("/"));const length=Math.min(fromParts.length,toParts.length);let samePartsLength=length;for(let i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break}}let outputParts=[];for(let i=samePartsLength;i<fromParts.length;i++){outputParts.push("..")}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join("/")}function normalizePath(path){const isPathAbsolute=isAbsolute(path);const trailingSlash=path.slice(-1)==="/";let normalizedPath=normalizeArray(path.split("/").filter(p=>!!p),!isPathAbsolute).join("/");if(!normalizedPath&&!isPathAbsolute){normalizedPath="."}if(normalizedPath&&trailingSlash){normalizedPath+="/"}return(isPathAbsolute?"/":"")+normalizedPath}function isAbsolute(path){return path.charAt(0)==="/"}function join(...args){return normalizePath(args.join("/"))}function dirname(path){const result=splitPath(path);const root=result[0]||"";let dir=result[1];if(!root&&!dir){return"."}if(dir){dir=dir.slice(0,dir.length-1)}return root+dir}function basename(path,ext){let f=splitPath(path)[2]||"";if(ext&&f.slice(ext.length*-1)===ext){f=f.slice(0,f.length-ext.length)}return f}exports.basename=basename;exports.dirname=dirname;exports.isAbsolute=isAbsolute;exports.join=join;exports.normalizePath=normalizePath;exports.relative=relative;exports.resolve=resolve},{}],173:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const error=require("./error.js");const syncpromise=require("./syncpromise.js");function makePromiseBuffer(limit){const buffer=[];function isReady(){return limit===undefined||buffer.length<limit}function remove(task){return buffer.splice(buffer.indexOf(task),1)[0]||Promise.resolve(undefined)}function add(taskProducer){if(!isReady()){return syncpromise.rejectedSyncPromise(new error.SentryError("Not adding Promise because buffer limit was reached."))}const task=taskProducer();if(buffer.indexOf(task)===-1){buffer.push(task)}void task.then(()=>remove(task)).then(null,()=>remove(task).then(null,()=>{}));return task}function drain(timeout){return new syncpromise.SyncPromise((resolve,reject)=>{let counter=buffer.length;if(!counter){return resolve(true)}const capturedSetTimeout=setTimeout(()=>{if(timeout&&timeout>0){resolve(false)}},timeout);buffer.forEach(item=>{void syncpromise.resolvedSyncPromise(item).then(()=>{if(!--counter){clearTimeout(capturedSetTimeout);resolve(true)}},reject)})})}return{$:buffer,add:add,drain:drain}}exports.makePromiseBuffer=makePromiseBuffer},{"./error.js":155,"./syncpromise.js":181}],174:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const misc=require("./misc.js");function generatePropagationContext(){return{traceId:generateTraceId(),spanId:generateSpanId()}}function generateTraceId(){return misc.uuid4()}function generateSpanId(){return misc.uuid4().substring(16)}exports.generatePropagationContext=generatePropagationContext;exports.generateSpanId=generateSpanId;exports.generateTraceId=generateTraceId},{"./misc.js":167}],175:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const DEFAULT_RETRY_AFTER=60*1e3;function parseRetryAfterHeader(header,now=Date.now()){const headerDelay=parseInt(`${header}`,10);if(!isNaN(headerDelay)){return headerDelay*1e3}const headerDate=Date.parse(`${header}`);if(!isNaN(headerDate)){return headerDate-now}return DEFAULT_RETRY_AFTER}function disabledUntil(limits,dataCategory){return limits[dataCategory]||limits.all||0}function isRateLimited(limits,dataCategory,now=Date.now()){return disabledUntil(limits,dataCategory)>now}function updateRateLimits(limits,{statusCode,headers},now=Date.now()){const updatedRateLimits={...limits};const rateLimitHeader=headers&&headers["x-sentry-rate-limits"];const retryAfterHeader=headers&&headers["retry-after"];if(rateLimitHeader){for(const limit of rateLimitHeader.trim().split(",")){const[retryAfter,categories,,,namespaces]=limit.split(":",5);const headerDelay=parseInt(retryAfter,10);const delay=(!isNaN(headerDelay)?headerDelay:60)*1e3;if(!categories){updatedRateLimits.all=now+delay}else{for(const category of categories.split(";")){if(category==="metric_bucket"){if(!namespaces||namespaces.split(";").includes("custom")){updatedRateLimits[category]=now+delay}}else{updatedRateLimits[category]=now+delay}}}}}else if(retryAfterHeader){updatedRateLimits.all=now+parseRetryAfterHeader(retryAfterHeader,now)}else if(statusCode===429){updatedRateLimits.all=now+60*1e3}return updatedRateLimits}exports.DEFAULT_RETRY_AFTER=DEFAULT_RETRY_AFTER;exports.disabledUntil=disabledUntil;exports.isRateLimited=isRateLimited;exports.parseRetryAfterHeader=parseRetryAfterHeader;exports.updateRateLimits=updateRateLimits},{}],176:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const cookie=require("./cookie.js");const debugBuild=require("./debug-build.js");const is=require("./is.js");const logger=require("./logger.js");const normalize=require("./normalize.js");const object=require("./object.js");const string=require("./string.js");const url=require("./url.js");const getIpAddress=require("./vendor/getIpAddress.js");const DEFAULT_INCLUDES={ip:false,request:true,user:true};const DEFAULT_REQUEST_INCLUDES=["cookies","data","headers","method","query_string","url"];const DEFAULT_USER_INCLUDES=["id","username","email"];function extractPathForTransaction(req,options={}){const method=req.method&&req.method.toUpperCase();let path="";let source="url";if(options.customRoute||req.route){path=options.customRoute||`${req.baseUrl||""}${req.route&&req.route.path}`;source="route"}else if(req.originalUrl||req.url){path=url.stripUrlQueryAndFragment(req.originalUrl||req.url||"")}let name="";if(options.method&&method){name+=method}if(options.method&&options.path){name+=" "}if(options.path&&path){name+=path}return[name,source]}function extractUserData(user,keys){const extractedUser={};const attributes=Array.isArray(keys)?keys:DEFAULT_USER_INCLUDES;attributes.forEach(key=>{if(user&&key in user){extractedUser[key]=user[key]}});return extractedUser}function extractRequestData(req,options={}){const{include=DEFAULT_REQUEST_INCLUDES}=options;const requestData={};const headers=req.headers||{};const method=req.method;const host=headers.host||req.hostname||req.host||"<no host>";const protocol=req.protocol==="https"||req.socket&&req.socket.encrypted?"https":"http";const originalUrl=req.originalUrl||req.url||"";const absoluteUrl=originalUrl.startsWith(protocol)?originalUrl:`${protocol}://${host}${originalUrl}`;include.forEach(key=>{switch(key){case"headers":{requestData.headers=headers;if(!include.includes("cookies")){delete requestData.headers.cookie}if(!include.includes("ip")){getIpAddress.ipHeaderNames.forEach(ipHeaderName=>{delete requestData.headers[ipHeaderName]})}break}case"method":{requestData.method=method;break}case"url":{requestData.url=absoluteUrl;break}case"cookies":{requestData.cookies=req.cookies||headers.cookie&&cookie.parseCookie(headers.cookie)||{};break}case"query_string":{requestData.query_string=extractQueryParams(req);break}case"data":{if(method==="GET"||method==="HEAD"){break}const body=req.body;if(body!==undefined){const stringBody=is.isString(body)?body:is.isPlainObject(body)?JSON.stringify(normalize.normalize(body)):string.truncate(`${body}`,1024);if(stringBody){requestData.data=stringBody}}break}default:{if({}.hasOwnProperty.call(req,key)){requestData[key]=req[key]}}}});return requestData}function addNormalizedRequestDataToEvent(event,req,additionalData,options){const include={...DEFAULT_INCLUDES,...options&&options.include};if(include.request){const includeRequest=Array.isArray(include.request)?[...include.request]:[...DEFAULT_REQUEST_INCLUDES];if(include.ip){includeRequest.push("ip")}const extractedRequestData=extractNormalizedRequestData(req,{include:includeRequest});event.request={...event.request,...extractedRequestData}}if(include.user){const extractedUser=additionalData.user&&is.isPlainObject(additionalData.user)?extractUserData(additionalData.user,include.user):{};if(Object.keys(extractedUser).length){event.user={...extractedUser,...event.user}}}if(include.ip){const ip=req.headers&&getIpAddress.getClientIPAddress(req.headers)||additionalData.ipAddress;if(ip){event.user={...event.user,ip_address:ip}}}}function addRequestDataToEvent(event,req,options){const include={...DEFAULT_INCLUDES,...options&&options.include};if(include.request){const includeRequest=Array.isArray(include.request)?[...include.request]:[...DEFAULT_REQUEST_INCLUDES];if(include.ip){includeRequest.push("ip")}const extractedRequestData=extractRequestData(req,{include:includeRequest});event.request={...event.request,...extractedRequestData}}if(include.user){const extractedUser=req.user&&is.isPlainObject(req.user)?extractUserData(req.user,include.user):{};if(Object.keys(extractedUser).length){event.user={...event.user,...extractedUser}}}if(include.ip){const ip=req.headers&&getIpAddress.getClientIPAddress(req.headers)||req.ip||req.socket&&req.socket.remoteAddress;if(ip){event.user={...event.user,ip_address:ip}}}return event}function extractQueryParams(req){let originalUrl=req.originalUrl||req.url||"";if(!originalUrl){return}if(originalUrl.startsWith("/")){originalUrl=`http://dogs.are.great${originalUrl}`}try{const queryParams=req.query||new URL(originalUrl).search.slice(1);return queryParams.length?queryParams:undefined}catch(e2){return undefined}}function winterCGHeadersToDict(winterCGHeaders){const headers={};try{winterCGHeaders.forEach((value,key)=>{if(typeof value==="string"){headers[key]=value}})}catch(e){debugBuild.DEBUG_BUILD&&logger.logger.warn("Sentry failed extracting headers from a request object. If you see this, please file an issue.")}return headers}function headersToDict(reqHeaders){const headers=Object.create(null);try{Object.entries(reqHeaders).forEach(([key,value])=>{if(typeof value==="string"){headers[key]=value}})}catch(e){debugBuild.DEBUG_BUILD&&logger.logger.warn("Sentry failed extracting headers from a request object. If you see this, please file an issue.")}return headers}function winterCGRequestToRequestData(req){const headers=winterCGHeadersToDict(req.headers);return{method:req.method,url:req.url,query_string:extractQueryParamsFromUrl(req.url),headers:headers}}function httpRequestToRequestData(request){const headers=request.headers||{};const host=headers.host||"<no host>";const protocol=request.socket&&request.socket.encrypted?"https":"http";const originalUrl=request.url||"";const absoluteUrl=originalUrl.startsWith(protocol)?originalUrl:`${protocol}://${host}${originalUrl}`;const data=request.body||undefined;const cookies=request.cookies;return object.dropUndefinedKeys({url:absoluteUrl,method:request.method,query_string:extractQueryParamsFromUrl(originalUrl),headers:headersToDict(headers),cookies:cookies,data:data})}function extractQueryParamsFromUrl(url){if(!url){return}try{const queryParams=new URL(url,"http://dogs.are.great").search.slice(1);return queryParams.length?queryParams:undefined}catch(e3){return undefined}}function extractNormalizedRequestData(normalizedRequest,{include}){const includeKeys=include?Array.isArray(include)?include:DEFAULT_REQUEST_INCLUDES:[];const requestData={};const headers={...normalizedRequest.headers};if(includeKeys.includes("headers")){requestData.headers=headers;if(!include.includes("cookies")){delete headers.cookie}if(!include.includes("ip")){getIpAddress.ipHeaderNames.forEach(ipHeaderName=>{delete headers[ipHeaderName]})}}if(includeKeys.includes("method")){requestData.method=normalizedRequest.method}if(includeKeys.includes("url")){requestData.url=normalizedRequest.url}if(includeKeys.includes("cookies")){const cookies=normalizedRequest.cookies||(headers&&headers.cookie?cookie.parseCookie(headers.cookie):undefined);requestData.cookies=cookies||{}}if(includeKeys.includes("query_string")){requestData.query_string=normalizedRequest.query_string}if(includeKeys.includes("data")){requestData.data=normalizedRequest.data}return requestData}exports.DEFAULT_USER_INCLUDES=DEFAULT_USER_INCLUDES;exports.addNormalizedRequestDataToEvent=addNormalizedRequestDataToEvent;exports.addRequestDataToEvent=addRequestDataToEvent;exports.extractPathForTransaction=extractPathForTransaction;exports.extractQueryParamsFromUrl=extractQueryParamsFromUrl;exports.extractRequestData=extractRequestData;exports.headersToDict=headersToDict;exports.httpRequestToRequestData=httpRequestToRequestData;exports.winterCGHeadersToDict=winterCGHeadersToDict;exports.winterCGRequestToRequestData=winterCGRequestToRequestData},{"./cookie.js":149,"./debug-build.js":150,"./is.js":162,"./logger.js":164,"./normalize.js":170,"./object.js":171,"./string.js":179,"./url.js":184,"./vendor/getIpAddress.js":186}],177:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const validSeverityLevels=["fatal","error","warning","log","info","debug"];function severityLevelFromString(level){return level==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(level)?level:"log"}exports.severityLevelFromString=severityLevelFromString;exports.validSeverityLevels=validSeverityLevels},{}],178:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const STACKTRACE_FRAME_LIMIT=50;const UNKNOWN_FUNCTION="?";const WEBPACK_ERROR_REGEXP=/\(error: (.*)\)/;const STRIP_FRAME_REGEXP=/captureMessage|captureException/;function createStackParser(...parsers){const sortedParsers=parsers.sort((a,b)=>a[0]-b[0]).map(p=>p[1]);return(stack,skipFirstLines=0,framesToPop=0)=>{const frames=[];const lines=stack.split("\n");for(let i=skipFirstLines;i<lines.length;i++){const line=lines[i];if(line.length>1024){continue}const cleanedLine=WEBPACK_ERROR_REGEXP.test(line)?line.replace(WEBPACK_ERROR_REGEXP,"$1"):line;if(cleanedLine.match(/\S*Error: /)){continue}for(const parser of sortedParsers){const frame=parser(cleanedLine);if(frame){frames.push(frame);break}}if(frames.length>=STACKTRACE_FRAME_LIMIT+framesToPop){break}}return stripSentryFramesAndReverse(frames.slice(framesToPop))}}function stackParserFromStackParserOptions(stackParser){if(Array.isArray(stackParser)){return createStackParser(...stackParser)}return stackParser}function stripSentryFramesAndReverse(stack){if(!stack.length){return[]}const localStack=Array.from(stack);if(/sentryWrapped/.test(getLastStackFrame(localStack).function||"")){localStack.pop()}localStack.reverse();if(STRIP_FRAME_REGEXP.test(getLastStackFrame(localStack).function||"")){localStack.pop();if(STRIP_FRAME_REGEXP.test(getLastStackFrame(localStack).function||"")){localStack.pop()}}return localStack.slice(0,STACKTRACE_FRAME_LIMIT).map(frame=>({...frame,filename:frame.filename||getLastStackFrame(localStack).filename,function:frame.function||UNKNOWN_FUNCTION}))}function getLastStackFrame(arr){return arr[arr.length-1]||{}}const defaultFunctionName="<anonymous>";function getFunctionName(fn){try{if(!fn||typeof fn!=="function"){return defaultFunctionName}return fn.name||defaultFunctionName}catch(e){return defaultFunctionName}}function getFramesFromEvent(event){const exception=event.exception;if(exception){const frames=[];try{exception.values.forEach(value=>{if(value.stacktrace.frames){frames.push(...value.stacktrace.frames)}});return frames}catch(_oO){return undefined}}return undefined}exports.UNKNOWN_FUNCTION=UNKNOWN_FUNCTION;exports.createStackParser=createStackParser;exports.getFramesFromEvent=getFramesFromEvent;exports.getFunctionName=getFunctionName;exports.stackParserFromStackParserOptions=stackParserFromStackParserOptions;exports.stripSentryFramesAndReverse=stripSentryFramesAndReverse},{}],179:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const is=require("./is.js");function truncate(str,max=0){if(typeof str!=="string"||max===0){return str}return str.length<=max?str:`${str.slice(0,max)}...`}function snipLine(line,colno){let newLine=line;const lineLength=newLine.length;if(lineLength<=150){return newLine}if(colno>lineLength){colno=lineLength}let start=Math.max(colno-60,0);if(start<5){start=0}let end=Math.min(start+140,lineLength);if(end>lineLength-5){end=lineLength}if(end===lineLength){start=Math.max(end-140,0)}newLine=newLine.slice(start,end);if(start>0){newLine=`'{snip} ${newLine}`}if(end<lineLength){newLine+=" {snip}"}return newLine}function safeJoin(input,delimiter){if(!Array.isArray(input)){return""}const output=[];for(let i=0;i<input.length;i++){const value=input[i];try{if(is.isVueViewModel(value)){output.push("[VueViewModel]")}else{output.push(String(value))}}catch(e){output.push("[value cannot be serialized]")}}return output.join(delimiter)}function isMatchingPattern(value,pattern,requireExactStringMatch=false){if(!is.isString(value)){return false}if(is.isRegExp(pattern)){return pattern.test(value)}if(is.isString(pattern)){return requireExactStringMatch?value===pattern:value.includes(pattern)}return false}function stringMatchesSomePattern(testString,patterns=[],requireExactStringMatch=false){return patterns.some(pattern=>isMatchingPattern(testString,pattern,requireExactStringMatch))}exports.isMatchingPattern=isMatchingPattern;exports.safeJoin=safeJoin;exports.snipLine=snipLine;exports.stringMatchesSomePattern=stringMatchesSomePattern;exports.truncate=truncate},{"./is.js":162}],180:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const debugBuild=require("./debug-build.js");const logger=require("./logger.js");const worldwide=require("./worldwide.js");const WINDOW=worldwide.GLOBAL_OBJ;function supportsErrorEvent(){try{new ErrorEvent("");return true}catch(e){return false}}function supportsDOMError(){try{new DOMError("");return true}catch(e){return false}}function supportsDOMException(){try{new DOMException("");return true}catch(e){return false}}function supportsFetch(){if(!("fetch"in WINDOW)){return false}try{new Headers;new Request("http://www.example.com");new Response;return true}catch(e){return false}}function isNativeFunction(func){return func&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(func.toString())}function supportsNativeFetch(){if(typeof EdgeRuntime==="string"){return true}if(!supportsFetch()){return false}if(isNativeFunction(WINDOW.fetch)){return true}let result=false;const doc=WINDOW.document;if(doc&&typeof doc.createElement==="function"){try{const sandbox=doc.createElement("iframe");sandbox.hidden=true;doc.head.appendChild(sandbox);if(sandbox.contentWindow&&sandbox.contentWindow.fetch){result=isNativeFunction(sandbox.contentWindow.fetch)}doc.head.removeChild(sandbox)}catch(err){debugBuild.DEBUG_BUILD&&logger.logger.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",err)}}return result}function supportsReportingObserver(){return"ReportingObserver"in WINDOW}function supportsReferrerPolicy(){if(!supportsFetch()){return false}try{new Request("_",{referrerPolicy:"origin"});return true}catch(e){return false}}exports.isNativeFunction=isNativeFunction;exports.supportsDOMError=supportsDOMError;exports.supportsDOMException=supportsDOMException;exports.supportsErrorEvent=supportsErrorEvent;exports.supportsFetch=supportsFetch;exports.supportsNativeFetch=supportsNativeFetch;exports.supportsReferrerPolicy=supportsReferrerPolicy;exports.supportsReportingObserver=supportsReportingObserver},{"./debug-build.js":150,"./logger.js":164,"./worldwide.js":190}],181:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const is=require("./is.js");var States;(function(States){const PENDING=0;States[States["PENDING"]=PENDING]="PENDING";const RESOLVED=1;States[States["RESOLVED"]=RESOLVED]="RESOLVED";const REJECTED=2;States[States["REJECTED"]=REJECTED]="REJECTED"})(States||(States={}));function resolvedSyncPromise(value){return new SyncPromise(resolve=>{resolve(value)})}function rejectedSyncPromise(reason){return new SyncPromise((_,reject)=>{reject(reason)})}class SyncPromise{constructor(executor){SyncPromise.prototype.__init.call(this);SyncPromise.prototype.__init2.call(this);SyncPromise.prototype.__init3.call(this);SyncPromise.prototype.__init4.call(this);this._state=States.PENDING;this._handlers=[];try{executor(this._resolve,this._reject)}catch(e){this._reject(e)}}then(onfulfilled,onrejected){return new SyncPromise((resolve,reject)=>{this._handlers.push([false,result=>{if(!onfulfilled){resolve(result)}else{try{resolve(onfulfilled(result))}catch(e){reject(e)}}},reason=>{if(!onrejected){reject(reason)}else{try{resolve(onrejected(reason))}catch(e){reject(e)}}}]);this._executeHandlers()})}catch(onrejected){return this.then(val=>val,onrejected)}finally(onfinally){return new SyncPromise((resolve,reject)=>{let val;let isRejected;return this.then(value=>{isRejected=false;val=value;if(onfinally){onfinally()}},reason=>{isRejected=true;val=reason;if(onfinally){onfinally()}}).then(()=>{if(isRejected){reject(val);return}resolve(val)})})}__init(){this._resolve=value=>{this._setResult(States.RESOLVED,value)}}__init2(){this._reject=reason=>{this._setResult(States.REJECTED,reason)}}__init3(){this._setResult=(state,value)=>{if(this._state!==States.PENDING){return}if(is.isThenable(value)){void value.then(this._resolve,this._reject);return}this._state=state;this._value=value;this._executeHandlers()}}__init4(){this._executeHandlers=()=>{if(this._state===States.PENDING){return}const cachedHandlers=this._handlers.slice();this._handlers=[];cachedHandlers.forEach(handler=>{if(handler[0]){return}if(this._state===States.RESOLVED){handler[1](this._value)}if(this._state===States.REJECTED){handler[2](this._value)}handler[0]=true})}}}exports.SyncPromise=SyncPromise;exports.rejectedSyncPromise=rejectedSyncPromise;exports.resolvedSyncPromise=resolvedSyncPromise},{"./is.js":162}],182:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const worldwide=require("./worldwide.js");const ONE_SECOND_IN_MS=1e3;function dateTimestampInSeconds(){return Date.now()/ONE_SECOND_IN_MS}function createUnixTimestampInSecondsFunc(){const{performance}=worldwide.GLOBAL_OBJ;if(!performance||!performance.now){return dateTimestampInSeconds}const approxStartingTimeOrigin=Date.now()-performance.now();const timeOrigin=performance.timeOrigin==undefined?approxStartingTimeOrigin:performance.timeOrigin;return()=>{return(timeOrigin+performance.now())/ONE_SECOND_IN_MS}}const timestampInSeconds=createUnixTimestampInSecondsFunc();exports._browserPerformanceTimeOriginMode=void 0;const browserPerformanceTimeOrigin=(()=>{const{performance}=worldwide.GLOBAL_OBJ;if(!performance||!performance.now){exports._browserPerformanceTimeOriginMode="none";return undefined}const threshold=3600*1e3;const performanceNow=performance.now();const dateNow=Date.now();const timeOriginDelta=performance.timeOrigin?Math.abs(performance.timeOrigin+performanceNow-dateNow):threshold;const timeOriginIsReliable=timeOriginDelta<threshold;const navigationStart=performance.timing&&performance.timing.navigationStart;const hasNavigationStart=typeof navigationStart==="number";const navigationStartDelta=hasNavigationStart?Math.abs(navigationStart+performanceNow-dateNow):threshold;const navigationStartIsReliable=navigationStartDelta<threshold;if(timeOriginIsReliable||navigationStartIsReliable){if(timeOriginDelta<=navigationStartDelta){exports._browserPerformanceTimeOriginMode="timeOrigin";return performance.timeOrigin}else{exports._browserPerformanceTimeOriginMode="navigationStart";return navigationStart}}exports._browserPerformanceTimeOriginMode="dateNow";return dateNow})();exports.browserPerformanceTimeOrigin=browserPerformanceTimeOrigin;exports.dateTimestampInSeconds=dateTimestampInSeconds;exports.timestampInSeconds=timestampInSeconds},{"./worldwide.js":190}],183:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const baggage=require("./baggage.js");const propagationContext=require("./propagationContext.js");const TRACEPARENT_REGEXP=new RegExp("^[ \\t]*"+"([0-9a-f]{32})?"+"-?([0-9a-f]{16})?"+"-?([01])?"+"[ \\t]*$");function extractTraceparentData(traceparent){if(!traceparent){return undefined}const matches=traceparent.match(TRACEPARENT_REGEXP);if(!matches){return undefined}let parentSampled;if(matches[3]==="1"){parentSampled=true}else if(matches[3]==="0"){parentSampled=false}return{traceId:matches[1],parentSampled:parentSampled,parentSpanId:matches[2]}}function propagationContextFromHeaders(sentryTrace,baggage$1){const traceparentData=extractTraceparentData(sentryTrace);const dynamicSamplingContext=baggage.baggageHeaderToDynamicSamplingContext(baggage$1);if(!traceparentData||!traceparentData.traceId){return{traceId:propagationContext.generateTraceId(),spanId:propagationContext.generateSpanId()}}const{traceId,parentSpanId,parentSampled}=traceparentData;const virtualSpanId=propagationContext.generateSpanId();return{traceId:traceId,parentSpanId:parentSpanId,spanId:virtualSpanId,sampled:parentSampled,dsc:dynamicSamplingContext||{}}}function generateSentryTraceHeader(traceId=propagationContext.generateTraceId(),spanId=propagationContext.generateSpanId(),sampled){let sampledString="";if(sampled!==undefined){sampledString=sampled?"-1":"-0"}return`${traceId}-${spanId}${sampledString}`}exports.TRACEPARENT_REGEXP=TRACEPARENT_REGEXP;exports.extractTraceparentData=extractTraceparentData;exports.generateSentryTraceHeader=generateSentryTraceHeader;exports.propagationContextFromHeaders=propagationContextFromHeaders},{"./baggage.js":138,"./propagationContext.js":174}],184:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function parseUrl(url){if(!url){return{}}const match=url.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!match){return{}}const query=match[6]||"";const fragment=match[8]||"";return{host:match[4],path:match[5],protocol:match[2],search:query,hash:fragment,relative:match[5]+query+fragment}}function stripUrlQueryAndFragment(urlPath){return urlPath.split(/[?#]/,1)[0]}function getNumberOfUrlSegments(url){return url.split(/\\?\//).filter(s=>s.length>0&&s!==",").length}function getSanitizedUrlString(url){const{protocol,host,path}=url;const filteredHost=host&&host.replace(/^.*@/,"[filtered]:[filtered]@").replace(/(:80)$/,"").replace(/(:443)$/,"")||"";return`${protocol?`${protocol}://`:""}${filteredHost}${path}`}exports.getNumberOfUrlSegments=getNumberOfUrlSegments;exports.getSanitizedUrlString=getSanitizedUrlString;exports.parseUrl=parseUrl;exports.stripUrlQueryAndFragment=stripUrlQueryAndFragment},{}],185:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function escapeStringForRegex(regexString){return regexString.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}exports.escapeStringForRegex=escapeStringForRegex},{}],186:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const ipHeaderNames=["X-Client-IP","X-Forwarded-For","Fly-Client-IP","CF-Connecting-IP","Fastly-Client-Ip","True-Client-Ip","X-Real-IP","X-Cluster-Client-IP","X-Forwarded","Forwarded-For","Forwarded","X-Vercel-Forwarded-For"];function getClientIPAddress(headers){const headerValues=ipHeaderNames.map(headerName=>{const rawValue=headers[headerName];const value=Array.isArray(rawValue)?rawValue.join(";"):rawValue;if(headerName==="Forwarded"){return parseForwardedHeader(value)}return value&&value.split(",").map(v=>v.trim())});const flattenedHeaderValues=headerValues.reduce((acc,val)=>{if(!val){return acc}return acc.concat(val)},[]);const ipAddress=flattenedHeaderValues.find(ip=>ip!==null&&isIP(ip));return ipAddress||null}function parseForwardedHeader(value){if(!value){return null}for(const part of value.split(";")){if(part.startsWith("for=")){return part.slice(4)}}return null}function isIP(str){const regex=/(?:^(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}$)|(?:^(?:(?:[a-fA-F\d]{1,4}:){7}(?:[a-fA-F\d]{1,4}|:)|(?:[a-fA-F\d]{1,4}:){6}(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|:[a-fA-F\d]{1,4}|:)|(?:[a-fA-F\d]{1,4}:){5}(?::(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,2}|:)|(?:[a-fA-F\d]{1,4}:){4}(?:(?::[a-fA-F\d]{1,4}){0,1}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,3}|:)|(?:[a-fA-F\d]{1,4}:){3}(?:(?::[a-fA-F\d]{1,4}){0,2}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,4}|:)|(?:[a-fA-F\d]{1,4}:){2}(?:(?::[a-fA-F\d]{1,4}){0,3}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,5}|:)|(?:[a-fA-F\d]{1,4}:){1}(?:(?::[a-fA-F\d]{1,4}){0,4}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,6}|:)|(?::(?:(?::[a-fA-F\d]{1,4}){0,5}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,7}|:)))(?:%[0-9a-zA-Z]{1,})?$)/;return regex.test(str)}exports.getClientIPAddress=getClientIPAddress;exports.ipHeaderNames=ipHeaderNames},{}],187:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const worldwide=require("../worldwide.js");const WINDOW=worldwide.GLOBAL_OBJ;function supportsHistory(){const chromeVar=WINDOW.chrome;const isChromePackagedApp=chromeVar&&chromeVar.app&&chromeVar.app.runtime;const hasHistoryApi="history"in WINDOW&&!!WINDOW.history.pushState&&!!WINDOW.history.replaceState;return!isChromePackagedApp&&hasHistoryApi}exports.supportsHistory=supportsHistory},{"../worldwide.js":190}],188:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const worldwide=require("./worldwide.js");function vercelWaitUntil(task){const vercelRequestContextGlobal=worldwide.GLOBAL_OBJ[Symbol.for("@vercel/request-context")];const ctx=vercelRequestContextGlobal&&vercelRequestContextGlobal.get&&vercelRequestContextGlobal.get()?vercelRequestContextGlobal.get():{};if(ctx&&ctx.waitUntil){ctx.waitUntil(task)}}exports.vercelWaitUntil=vercelWaitUntil},{"./worldwide.js":190}],189:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const SDK_VERSION="8.48.0";exports.SDK_VERSION=SDK_VERSION},{}],190:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const version=require("./version.js");const GLOBAL_OBJ=globalThis;function getGlobalSingleton(name,creator,obj){const gbl=obj||GLOBAL_OBJ;const __SENTRY__=gbl.__SENTRY__=gbl.__SENTRY__||{};const versionedCarrier=__SENTRY__[version.SDK_VERSION]=__SENTRY__[version.SDK_VERSION]||{};return versionedCarrier[name]||(versionedCarrier[name]=creator())}exports.GLOBAL_OBJ=GLOBAL_OBJ;exports.getGlobalSingleton=getGlobalSingleton},{"./version.js":189}],191:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const dynamicSamplingContext=require("../tracing/dynamicSamplingContext.js");const object=require("../utils-hoist/object.js");const merge=require("./merge.js");const spanUtils=require("./spanUtils.js");function applyScopeDataToEvent(event,data){const{fingerprint,span,breadcrumbs,sdkProcessingMetadata}=data;applyDataToEvent(event,data);if(span){applySpanToEvent(event,span)}applyFingerprintToEvent(event,fingerprint);applyBreadcrumbsToEvent(event,breadcrumbs);applySdkMetadataToEvent(event,sdkProcessingMetadata)}function mergeScopeData(data,mergeData){const{extra,tags,user,contexts,level,sdkProcessingMetadata,breadcrumbs,fingerprint,eventProcessors,attachments,propagationContext,transactionName,span}=mergeData;mergeAndOverwriteScopeData(data,"extra",extra);mergeAndOverwriteScopeData(data,"tags",tags);mergeAndOverwriteScopeData(data,"user",user);mergeAndOverwriteScopeData(data,"contexts",contexts);data.sdkProcessingMetadata=merge.merge(data.sdkProcessingMetadata,sdkProcessingMetadata,2);if(level){data.level=level}if(transactionName){data.transactionName=transactionName}if(span){data.span=span}if(breadcrumbs.length){data.breadcrumbs=[...data.breadcrumbs,...breadcrumbs]}if(fingerprint.length){data.fingerprint=[...data.fingerprint,...fingerprint]}if(eventProcessors.length){data.eventProcessors=[...data.eventProcessors,...eventProcessors]}if(attachments.length){data.attachments=[...data.attachments,...attachments]}data.propagationContext={...data.propagationContext,...propagationContext}}function mergeAndOverwriteScopeData(data,prop,mergeVal){data[prop]=merge.merge(data[prop],mergeVal,1)}function applyDataToEvent(event,data){const{extra,tags,user,contexts,level,transactionName}=data;const cleanedExtra=object.dropUndefinedKeys(extra);if(cleanedExtra&&Object.keys(cleanedExtra).length){event.extra={...cleanedExtra,...event.extra}}const cleanedTags=object.dropUndefinedKeys(tags);if(cleanedTags&&Object.keys(cleanedTags).length){event.tags={...cleanedTags,...event.tags}}const cleanedUser=object.dropUndefinedKeys(user);if(cleanedUser&&Object.keys(cleanedUser).length){event.user={...cleanedUser,...event.user}}const cleanedContexts=object.dropUndefinedKeys(contexts);if(cleanedContexts&&Object.keys(cleanedContexts).length){event.contexts={...cleanedContexts,...event.contexts}}if(level){event.level=level}if(transactionName&&event.type!=="transaction"){event.transaction=transactionName}}function applyBreadcrumbsToEvent(event,breadcrumbs){const mergedBreadcrumbs=[...event.breadcrumbs||[],...breadcrumbs];event.breadcrumbs=mergedBreadcrumbs.length?mergedBreadcrumbs:undefined}function applySdkMetadataToEvent(event,sdkProcessingMetadata){event.sdkProcessingMetadata={...event.sdkProcessingMetadata,...sdkProcessingMetadata}}function applySpanToEvent(event,span){event.contexts={trace:spanUtils.spanToTraceContext(span),...event.contexts};event.sdkProcessingMetadata={dynamicSamplingContext:dynamicSamplingContext.getDynamicSamplingContextFromSpan(span),...event.sdkProcessingMetadata};const rootSpan=spanUtils.getRootSpan(span);const transactionName=spanUtils.spanToJSON(rootSpan).description;if(transactionName&&!event.transaction&&event.type==="transaction"){event.transaction=transactionName}}function applyFingerprintToEvent(event,fingerprint){event.fingerprint=event.fingerprint?Array.isArray(event.fingerprint)?event.fingerprint:[event.fingerprint]:[];if(fingerprint){event.fingerprint=event.fingerprint.concat(fingerprint)}if(event.fingerprint&&!event.fingerprint.length){delete event.fingerprint}}exports.applyScopeDataToEvent=applyScopeDataToEvent;exports.mergeAndOverwriteScopeData=mergeAndOverwriteScopeData;exports.mergeScopeData=mergeScopeData},{"../tracing/dynamicSamplingContext.js":119,"../utils-hoist/object.js":171,"./merge.js":195,"./spanUtils.js":202}],192:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const is=require("../utils-hoist/is.js");function handleCallbackErrors(fn,onError,onFinally=()=>{}){let maybePromiseResult;try{maybePromiseResult=fn()}catch(e){onError(e);onFinally();throw e}return maybeHandlePromiseRejection(maybePromiseResult,onError,onFinally)}function maybeHandlePromiseRejection(value,onError,onFinally){if(is.isThenable(value)){return value.then(res=>{onFinally();return res},e=>{onError(e);onFinally();throw e})}onFinally();return value}exports.handleCallbackErrors=handleCallbackErrors},{"../utils-hoist/is.js":162}],193:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const currentScopes=require("../currentScopes.js");function hasTracingEnabled(maybeOptions){if(typeof __SENTRY_TRACING__==="boolean"&&!__SENTRY_TRACING__){return false}const client=currentScopes.getClient();const options=maybeOptions||client&&client.getOptions();return!!options&&(options.enableTracing||"tracesSampleRate"in options||"tracesSampler"in options)}exports.hasTracingEnabled=hasTracingEnabled},{"../currentScopes.js":78}],194:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function isSentryRequestUrl(url,client){const dsn=client&&client.getDsn();const tunnel=client&&client.getOptions().tunnel;return checkDsn(url,dsn)||checkTunnel(url,tunnel)}function checkTunnel(url,tunnel){if(!tunnel){return false}return removeTrailingSlash(url)===removeTrailingSlash(tunnel)}function checkDsn(url,dsn){return dsn?url.includes(dsn.host):false}function removeTrailingSlash(str){return str[str.length-1]==="/"?str.slice(0,-1):str}exports.isSentryRequestUrl=isSentryRequestUrl},{}],195:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function merge(initialObj,mergeObj,levels=2){if(!mergeObj||typeof mergeObj!=="object"||levels<=0){return mergeObj}if(initialObj&&mergeObj&&Object.keys(mergeObj).length===0){return initialObj}const output={...initialObj};for(const key in mergeObj){if(Object.prototype.hasOwnProperty.call(mergeObj,key)){output[key]=merge(output[key],mergeObj[key],levels-1)}}return output}exports.merge=merge},{}],196:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const traceData=require("./traceData.js");function getTraceMetaTags(){return Object.entries(traceData.getTraceData()).map(([key,value])=>`<meta name="${key}" content="${value}"/>`).join("\n")}exports.getTraceMetaTags=getTraceMetaTags},{"./traceData.js":203}],197:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});function parameterize(strings,...values){const formatted=new String(String.raw(strings,...values));formatted.__sentry_template_string__=strings.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s");formatted.__sentry_template_values__=values;return formatted}exports.parameterize=parameterize},{}],198:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const debugBuild=require("../debug-build.js");const logger=require("../utils-hoist/logger.js");function parseSampleRate(sampleRate){if(typeof sampleRate==="boolean"){return Number(sampleRate)}const rate=typeof sampleRate==="string"?parseFloat(sampleRate):sampleRate;if(typeof rate!=="number"||isNaN(rate)||rate<0||rate>1){debugBuild.DEBUG_BUILD&&logger.logger.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(sampleRate)} of type ${JSON.stringify(typeof sampleRate)}.`);return undefined}return rate}exports.parseSampleRate=parseSampleRate},{"../debug-build.js":79,"../utils-hoist/logger.js":164}],199:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const constants=require("../constants.js");const currentScopes=require("../currentScopes.js");const eventProcessors=require("../eventProcessors.js");const scope=require("../scope.js");const debugIds=require("../utils-hoist/debug-ids.js");const misc=require("../utils-hoist/misc.js");const normalize=require("../utils-hoist/normalize.js");const string=require("../utils-hoist/string.js");const time=require("../utils-hoist/time.js");const applyScopeDataToEvent=require("./applyScopeDataToEvent.js");function prepareEvent(options,event,hint,scope,client,isolationScope){const{normalizeDepth=3,normalizeMaxBreadth=1e3}=options;const prepared={...event,event_id:event.event_id||hint.event_id||misc.uuid4(),timestamp:event.timestamp||time.dateTimestampInSeconds()};const integrations=hint.integrations||options.integrations.map(i=>i.name);applyClientOptions(prepared,options);applyIntegrationsMetadata(prepared,integrations);if(client){client.emit("applyFrameMetadata",event)}if(event.type===undefined){applyDebugIds(prepared,options.stackParser)}const finalScope=getFinalScope(scope,hint.captureContext);if(hint.mechanism){misc.addExceptionMechanism(prepared,hint.mechanism)}const clientEventProcessors=client?client.getEventProcessors():[];const data=currentScopes.getGlobalScope().getScopeData();if(isolationScope){const isolationData=isolationScope.getScopeData();applyScopeDataToEvent.mergeScopeData(data,isolationData)}if(finalScope){const finalScopeData=finalScope.getScopeData();applyScopeDataToEvent.mergeScopeData(data,finalScopeData)}const attachments=[...hint.attachments||[],...data.attachments];if(attachments.length){hint.attachments=attachments}applyScopeDataToEvent.applyScopeDataToEvent(prepared,data);const eventProcessors$1=[...clientEventProcessors,...data.eventProcessors];const result=eventProcessors.notifyEventProcessors(eventProcessors$1,prepared,hint);return result.then(evt=>{if(evt){applyDebugMeta(evt)}if(typeof normalizeDepth==="number"&&normalizeDepth>0){return normalizeEvent(evt,normalizeDepth,normalizeMaxBreadth)}return evt})}function applyClientOptions(event,options){const{environment,release,dist,maxValueLength=250}=options;event.environment=event.environment||environment||constants.DEFAULT_ENVIRONMENT;if(!event.release&&release){event.release=release}if(!event.dist&&dist){event.dist=dist}if(event.message){event.message=string.truncate(event.message,maxValueLength)}const exception=event.exception&&event.exception.values&&event.exception.values[0];if(exception&&exception.value){exception.value=string.truncate(exception.value,maxValueLength)}const request=event.request;if(request&&request.url){request.url=string.truncate(request.url,maxValueLength)}}function applyDebugIds(event,stackParser){const filenameDebugIdMap=debugIds.getFilenameToDebugIdMap(stackParser);try{event.exception.values.forEach(exception=>{exception.stacktrace.frames.forEach(frame=>{if(filenameDebugIdMap&&frame.filename){frame.debug_id=filenameDebugIdMap[frame.filename]}})})}catch(e){}}function applyDebugMeta(event){const filenameDebugIdMap={};try{event.exception.values.forEach(exception=>{exception.stacktrace.frames.forEach(frame=>{if(frame.debug_id){if(frame.abs_path){filenameDebugIdMap[frame.abs_path]=frame.debug_id}else if(frame.filename){filenameDebugIdMap[frame.filename]=frame.debug_id}delete frame.debug_id}})})}catch(e){}if(Object.keys(filenameDebugIdMap).length===0){return}event.debug_meta=event.debug_meta||{};event.debug_meta.images=event.debug_meta.images||[];const images=event.debug_meta.images;Object.entries(filenameDebugIdMap).forEach(([filename,debug_id])=>{images.push({type:"sourcemap",code_file:filename,debug_id:debug_id})})}function applyIntegrationsMetadata(event,integrationNames){if(integrationNames.length>0){event.sdk=event.sdk||{};event.sdk.integrations=[...event.sdk.integrations||[],...integrationNames]}}function normalizeEvent(event,depth,maxBreadth){if(!event){return null}const normalized={...event,...event.breadcrumbs&&{breadcrumbs:event.breadcrumbs.map(b=>({...b,...b.data&&{data:normalize.normalize(b.data,depth,maxBreadth)}}))},...event.user&&{user:normalize.normalize(event.user,depth,maxBreadth)},...event.contexts&&{contexts:normalize.normalize(event.contexts,depth,maxBreadth)},...event.extra&&{extra:normalize.normalize(event.extra,depth,maxBreadth)}};if(event.contexts&&event.contexts.trace&&normalized.contexts){normalized.contexts.trace=event.contexts.trace;if(event.contexts.trace.data){normalized.contexts.trace.data=normalize.normalize(event.contexts.trace.data,depth,maxBreadth)}}if(event.spans){normalized.spans=event.spans.map(span=>{return{...span,...span.data&&{data:normalize.normalize(span.data,depth,maxBreadth)}}})}if(event.contexts&&event.contexts.flags&&normalized.contexts){normalized.contexts.flags=normalize.normalize(event.contexts.flags,3,maxBreadth)}return normalized}function getFinalScope(scope$1,captureContext){if(!captureContext){return scope$1}const finalScope=scope$1?scope$1.clone():new scope.Scope;finalScope.update(captureContext);return finalScope}function parseEventHintOrCaptureContext(hint){if(!hint){return undefined}if(hintIsScopeOrFunction(hint)){return{captureContext:hint}}if(hintIsScopeContext(hint)){return{captureContext:hint}}return hint}function hintIsScopeOrFunction(hint){return hint instanceof scope.Scope||typeof hint==="function"}const captureContextKeys=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function hintIsScopeContext(hint){return Object.keys(hint).some(key=>captureContextKeys.includes(key))}exports.applyClientOptions=applyClientOptions;exports.applyDebugIds=applyDebugIds;exports.applyDebugMeta=applyDebugMeta;exports.parseEventHintOrCaptureContext=parseEventHintOrCaptureContext;exports.prepareEvent=prepareEvent},{"../constants.js":77,"../currentScopes.js":78,"../eventProcessors.js":82,"../scope.js":113,"../utils-hoist/debug-ids.js":151,"../utils-hoist/misc.js":167,"../utils-hoist/normalize.js":170,"../utils-hoist/string.js":179,"../utils-hoist/time.js":182,"./applyScopeDataToEvent.js":191}],200:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const version=require("../utils-hoist/version.js");function applySdkMetadata(options,name,names=[name],source="npm"){const metadata=options._metadata||{};if(!metadata.sdk){metadata.sdk={name:`sentry.javascript.${name}`,packages:names.map(name=>({name:`${source}:@sentry/${name}`,version:version.SDK_VERSION})),version:version.SDK_VERSION}}options._metadata=metadata}exports.applySdkMetadata=applySdkMetadata},{"../utils-hoist/version.js":189}],201:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const object=require("../utils-hoist/object.js");const SCOPE_SPAN_FIELD="_sentrySpan";function _setSpanForScope(scope,span){if(span){object.addNonEnumerableProperty(scope,SCOPE_SPAN_FIELD,span)}else{delete scope[SCOPE_SPAN_FIELD]}}function _getSpanForScope(scope){return scope[SCOPE_SPAN_FIELD]}exports._getSpanForScope=_getSpanForScope;exports._setSpanForScope=_setSpanForScope},{"../utils-hoist/object.js":171}],202:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const index=require("../asyncContext/index.js");const carrier=require("../carrier.js");const currentScopes=require("../currentScopes.js");const metricSummary=require("../metrics/metric-summary.js");const semanticAttributes=require("../semanticAttributes.js");const spanstatus=require("../tracing/spanstatus.js");const logger=require("../utils-hoist/logger.js");const object=require("../utils-hoist/object.js");const propagationContext=require("../utils-hoist/propagationContext.js");const time=require("../utils-hoist/time.js");const tracing=require("../utils-hoist/tracing.js");const spanOnScope=require("./spanOnScope.js");const TRACE_FLAG_NONE=0;const TRACE_FLAG_SAMPLED=1;let hasShownSpanDropWarning=false;function spanToTransactionTraceContext(span){const{spanId:span_id,traceId:trace_id}=span.spanContext();const{data,op,parent_span_id,status,origin}=spanToJSON(span);return object.dropUndefinedKeys({parent_span_id:parent_span_id,span_id:span_id,trace_id:trace_id,data:data,op:op,status:status,origin:origin})}function spanToTraceContext(span){const{spanId,traceId:trace_id,isRemote}=span.spanContext();const parent_span_id=isRemote?spanId:spanToJSON(span).parent_span_id;const span_id=isRemote?propagationContext.generateSpanId():spanId;return object.dropUndefinedKeys({parent_span_id:parent_span_id,span_id:span_id,trace_id:trace_id})}function spanToTraceHeader(span){const{traceId,spanId}=span.spanContext();const sampled=spanIsSampled(span);return tracing.generateSentryTraceHeader(traceId,spanId,sampled)}function spanTimeInputToSeconds(input){if(typeof input==="number"){return ensureTimestampInSeconds(input)}if(Array.isArray(input)){return input[0]+input[1]/1e9}if(input instanceof Date){return ensureTimestampInSeconds(input.getTime())}return time.timestampInSeconds()}function ensureTimestampInSeconds(timestamp){const isMs=timestamp>9999999999;return isMs?timestamp/1e3:timestamp}function spanToJSON(span){if(spanIsSentrySpan(span)){return span.getSpanJSON()}try{const{spanId:span_id,traceId:trace_id}=span.spanContext();if(spanIsOpenTelemetrySdkTraceBaseSpan(span)){const{attributes,startTime,name,endTime,parentSpanId,status}=span;return object.dropUndefinedKeys({span_id:span_id,trace_id:trace_id,data:attributes,description:name,parent_span_id:parentSpanId,start_timestamp:spanTimeInputToSeconds(startTime),timestamp:spanTimeInputToSeconds(endTime)||undefined,status:getStatusMessage(status),op:attributes[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_OP],origin:attributes[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN],_metrics_summary:metricSummary.getMetricSummaryJsonForSpan(span)})}return{span_id:span_id,trace_id:trace_id}}catch(e){return{}}}function spanIsOpenTelemetrySdkTraceBaseSpan(span){const castSpan=span;return!!castSpan.attributes&&!!castSpan.startTime&&!!castSpan.name&&!!castSpan.endTime&&!!castSpan.status}function spanIsSentrySpan(span){return typeof span.getSpanJSON==="function"}function spanIsSampled(span){const{traceFlags}=span.spanContext();return traceFlags===TRACE_FLAG_SAMPLED}function getStatusMessage(status){if(!status||status.code===spanstatus.SPAN_STATUS_UNSET){return undefined}if(status.code===spanstatus.SPAN_STATUS_OK){return"ok"}return status.message||"unknown_error"}const CHILD_SPANS_FIELD="_sentryChildSpans";const ROOT_SPAN_FIELD="_sentryRootSpan";function addChildSpanToSpan(span,childSpan){const rootSpan=span[ROOT_SPAN_FIELD]||span;object.addNonEnumerableProperty(childSpan,ROOT_SPAN_FIELD,rootSpan);if(span[CHILD_SPANS_FIELD]){span[CHILD_SPANS_FIELD].add(childSpan)}else{object.addNonEnumerableProperty(span,CHILD_SPANS_FIELD,new Set([childSpan]))}}function removeChildSpanFromSpan(span,childSpan){if(span[CHILD_SPANS_FIELD]){span[CHILD_SPANS_FIELD].delete(childSpan)}}function getSpanDescendants(span){const resultSet=new Set;function addSpanChildren(span){if(resultSet.has(span)){return}else if(spanIsSampled(span)){resultSet.add(span);const childSpans=span[CHILD_SPANS_FIELD]?Array.from(span[CHILD_SPANS_FIELD]):[];for(const childSpan of childSpans){addSpanChildren(childSpan)}}}addSpanChildren(span);return Array.from(resultSet)}function getRootSpan(span){return span[ROOT_SPAN_FIELD]||span}function getActiveSpan(){const carrier$1=carrier.getMainCarrier();const acs=index.getAsyncContextStrategy(carrier$1);if(acs.getActiveSpan){return acs.getActiveSpan()}return spanOnScope._getSpanForScope(currentScopes.getCurrentScope())}function updateMetricSummaryOnActiveSpan(metricType,sanitizedName,value,unit,tags,bucketKey){const span=getActiveSpan();if(span){metricSummary.updateMetricSummaryOnSpan(span,metricType,sanitizedName,value,unit,tags,bucketKey)}}function showSpanDropWarning(){if(!hasShownSpanDropWarning){logger.consoleSandbox(()=>{console.warn("[Sentry] Deprecation warning: Returning null from `beforeSendSpan` will be disallowed from SDK version 9.0.0 onwards. The callback will only support mutating spans. To drop certain spans, configure the respective integrations directly.")});hasShownSpanDropWarning=true}}function updateSpanName(span,name){span.updateName(name);span.setAttributes({[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"custom",[semanticAttributes.SEMANTIC_ATTRIBUTE_SENTRY_CUSTOM_SPAN_NAME]:name})}exports.TRACE_FLAG_NONE=TRACE_FLAG_NONE;exports.TRACE_FLAG_SAMPLED=TRACE_FLAG_SAMPLED;exports.addChildSpanToSpan=addChildSpanToSpan;exports.getActiveSpan=getActiveSpan;exports.getRootSpan=getRootSpan;exports.getSpanDescendants=getSpanDescendants;exports.getStatusMessage=getStatusMessage;exports.removeChildSpanFromSpan=removeChildSpanFromSpan;exports.showSpanDropWarning=showSpanDropWarning;exports.spanIsSampled=spanIsSampled;exports.spanTimeInputToSeconds=spanTimeInputToSeconds;exports.spanToJSON=spanToJSON;exports.spanToTraceContext=spanToTraceContext;exports.spanToTraceHeader=spanToTraceHeader;exports.spanToTransactionTraceContext=spanToTransactionTraceContext;exports.updateMetricSummaryOnActiveSpan=updateMetricSummaryOnActiveSpan;exports.updateSpanName=updateSpanName},{"../asyncContext/index.js":71,"../carrier.js":75,"../currentScopes.js":78,"../metrics/metric-summary.js":110,"../semanticAttributes.js":115,"../tracing/spanstatus.js":128,"../utils-hoist/logger.js":164,"../utils-hoist/object.js":171,"../utils-hoist/propagationContext.js":174,"../utils-hoist/time.js":182,"../utils-hoist/tracing.js":183,"./spanOnScope.js":201}],203:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:true});const index=require("../asyncContext/index.js");const carrier=require("../carrier.js");const currentScopes=require("../currentScopes.js");const exports$1=require("../exports.js");require("../tracing/errors.js");require("../utils-hoist/version.js");require("../utils-hoist/debug-build.js");const logger=require("../utils-hoist/logger.js");require("../debug-build.js");require("../utils-hoist/time.js");const spanUtils=require("./spanUtils.js");const tracing=require("../utils-hoist/tracing.js");const dynamicSamplingContext=require("../tracing/dynamicSamplingContext.js");const baggage=require("../utils-hoist/baggage.js");function getTraceData(options={}){const client=currentScopes.getClient();if(!exports$1.isEnabled()||!client){return{}}const carrier$1=carrier.getMainCarrier();const acs=index.getAsyncContextStrategy(carrier$1);if(acs.getTraceData){return acs.getTraceData(options)}const scope=currentScopes.getCurrentScope();const span=options.span||spanUtils.getActiveSpan();const sentryTrace=span?spanUtils.spanToTraceHeader(span):scopeToTraceHeader(scope);const dsc=span?dynamicSamplingContext.getDynamicSamplingContextFromSpan(span):dynamicSamplingContext.getDynamicSamplingContextFromScope(client,scope);const baggage$1=baggage.dynamicSamplingContextToSentryBaggageHeader(dsc);const isValidSentryTraceHeader=tracing.TRACEPARENT_REGEXP.test(sentryTrace);if(!isValidSentryTraceHeader){logger.logger.warn("Invalid sentry-trace data. Cannot generate trace data");return{}}return{"sentry-trace":sentryTrace,baggage:baggage$1}}function scopeToTraceHeader(scope){const{traceId,sampled,spanId}=scope.getPropagationContext();return tracing.generateSentryTraceHeader(traceId,spanId,sampled)}exports.getTraceData=getTraceData},{"../asyncContext/index.js":71,"../carrier.js":75,"../currentScopes.js":78,"../debug-build.js":79,"../exports.js":83,"../tracing/dynamicSamplingContext.js":119,"../tracing/errors.js":120,"../utils-hoist/baggage.js":138,"../utils-hoist/debug-build.js":150,"../utils-hoist/logger.js":164,"../utils-hoist/time.js":182,"../utils-hoist/tracing.js":183,"../utils-hoist/version.js":189,"./spanUtils.js":202}],204:[function(require,module,exports){const Sentry=require("@sentry/browser");Sentry.init({dsn:"https://1df8b78fb755401f9cfcf8b1261ab81b@sentry-api-new.ubn-ele.com/2",release:window.sentry_v.release,environment:window.sentry_v.environment,integrations:[Sentry.browserTracingIntegration(),Sentry.replayIntegration()],tracesSampleRate:1,replaysSessionSampleRate:.4,replaysOnErrorSampleRate:1})},{"@sentry/browser":42}]},{},[204]);